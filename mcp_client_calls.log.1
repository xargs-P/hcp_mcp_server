2025-10-10 11:37:41,699 - mcp_server - INFO - Request data: stdio_main: {'jsonrpc': '2.0', 'result': {'tools': [{'name': 'list_projects', 'description': 'Lists all HCP projects for a given organization.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}}, 'required': ['organization_id']}}, {'name': 'get_project', 'description': 'Gets an HCP project by its ID.', 'inputSchema': {'type': 'object', 'properties': {'project_id': {'type': 'string', 'description': 'The ID of the project.'}}, 'required': ['project_id']}}, {'name': 'delete_project', 'description': 'Deletes an HCP project by its ID.', 'inputSchema': {'type': 'object', 'properties': {'project_id': {'type': 'string', 'description': 'The ID of the project.'}}, 'required': ['project_id']}}, {'name': 'create_project', 'description': 'Creates a new HCP project.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'name': {'type': 'string', 'description': 'The name of the new project.'}}, 'required': ['organization_id', 'name']}}, {'name': 'update_project', 'description': 'Updates an HCP project.', 'inputSchema': {'type': 'object', 'properties': {'project_id': {'type': 'string', 'description': 'The ID of the project.'}, 'name': {'type': 'string', 'description': 'The new name of the project.'}}, 'required': ['project_id', 'name']}}, {'name': 'get_organization', 'description': 'Gets an HCP organization by its ID.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}}, 'required': ['organization_id']}}, {'name': 'list_organizations', 'description': 'Lists all HCP organizations.', 'inputSchema': {'type': 'object', 'properties': {}}}, {'name': 'update_organization', 'description': 'Updates an HCP organization.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'name': {'type': 'string', 'description': 'The new name of the organization.'}}, 'required': ['organization_id', 'name']}}, {'name': 'search_principals', 'description': 'Searches for principals in an organization.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'filter_str': {'type': 'string', 'description': 'The filter string to use for the search.'}}, 'required': ['organization_id']}}, {'name': 'get_principals', 'description': 'Gets principals by their IDs.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'principal_ids': {'type': 'array', 'items': {'type': 'string'}, 'description': 'The IDs of the principals to get.'}}, 'required': ['organization_id', 'principal_ids']}}, {'name': 'delete_service_principal', 'description': 'Deletes a service principal by its ID.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'principal_id': {'type': 'string', 'description': 'The ID of the service principal.'}}, 'required': ['organization_id', 'principal_id']}}, {'name': 'create_service_principal', 'description': 'Creates a new service principal.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'name': {'type': 'string', 'description': 'The name of the new service principal.'}}, 'required': ['organization_id', 'name']}}, {'name': 'update_service_principal', 'description': 'Updates a service principal.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'principal_id': {'type': 'string', 'description': 'The ID of the service principal.'}, 'name': {'type': 'string', 'description': 'The new name of the service principal.'}}, 'required': ['organization_id', 'principal_id', 'name']}}, {'name': 'list_secrets', 'description': 'Lists all secrets for a given application.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'project_id': {'type': 'string', 'description': 'The ID of the project.'}, 'app_name': {'type': 'string', 'description': 'The name of the application.'}}, 'required': ['organization_id', 'project_id', 'app_name']}}, {'name': 'get_secret', 'description': 'Gets a secret by its name.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'project_id': {'type': 'string', 'description': 'The ID of the project.'}, 'app_name': {'type': 'string', 'description': 'The name of the application.'}, 'secret_name': {'type': 'string', 'description': 'The name of the secret.'}}, 'required': ['organization_id', 'project_id', 'app_name', 'secret_name']}}, {'name': 'delete_secret', 'description': 'Deletes a secret by its name.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'project_id': {'type': 'string', 'description': 'The ID of the project.'}, 'app_name': {'type': 'string', 'description': 'The name of the application.'}, 'secret_name': {'type': 'string', 'description': 'The name of the secret.'}}, 'required': ['organization_id', 'project_id', 'app_name', 'secret_name']}}, {'name': 'create_secret', 'description': 'Creates a new secret.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'project_id': {'type': 'string', 'description': 'The ID of the project.'}, 'app_name': {'type': 'string', 'description': 'The name of the application.'}, 'secret_name': {'type': 'string', 'description': 'The name of the new secret.'}, 'secret_value': {'type': 'string', 'description': 'The value of the new secret.'}}, 'required': ['organization_id', 'project_id', 'app_name', 'secret_name', 'secret_value']}}, {'name': 'find_project_by_name', 'description': 'Finds a project by its name.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'name': {'type': 'string', 'description': 'The name of the project.'}}, 'required': ['organization_id', 'name']}}, {'name': 'find_user_by_email', 'description': 'Finds a user by their email.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'email': {'type': 'string', 'description': 'The email of the user.'}}, 'required': ['organization_id', 'email']}}, {'name': 'find_organization_by_name', 'description': 'Finds an organization by its name.', 'inputSchema': {'type': 'object', 'properties': {'name': {'type': 'string', 'description': 'The name of the organization.'}}, 'required': ['name']}}, {'name': 'list_resources', 'description': 'Lists all resources in a project.', 'inputSchema': {'type': 'object', 'properties': {'project_id': {'type': 'string', 'description': 'The ID of the project.'}}, 'required': ['project_id']}}, {'name': 'search_logs', 'description': 'Searches for audit logs in an organization using LogQL. At least one of `query`, `project_id`, or `topic` must be provided. For advanced filtering, use the `query` parameter with LogQL syntax. To filter on specific JSON fields in the log entries, use the `| json` parser in your query. For example: `query=\'| json | control_plane_event_action="CREATE"\'`', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'query': {'type': 'string', 'description': 'The LogQL query string for advanced filtering. Can be combined with `project_id` and `topic`. Example: \'| json | resource_uuid="some-uuid"\''}, 'project_id': {'type': 'string', 'description': 'A project ID to filter by.'}, 'topic': {'type': 'string', 'description': "A log topic to search. Example topics: 'hashicorp.platform.audit', 'hashicorp.packer.registry.audit', 'hashicorp.boundary.cluster.audit', 'hashicorp.consul.cluster.audit'"}, 'start_time': {'type': 'string', 'description': "The start time for the search. Accepts formats like '24 hours ago', 'yesterday at 5pm', or 'Oct 1, 2025'."}, 'end_time': {'type': 'string', 'description': "The end time for the search. Accepts formats like 'now', 'today', or 'Oct 3, 2025'."}}, 'required': ['organization_id', 'start_time', 'end_time']}}]}, 'id': 2}
2025-10-10 11:37:41,700 - mcp_server - INFO - Request data: stdio_main json: {"jsonrpc": "2.0", "result": {"tools": [{"name": "list_projects", "description": "Lists all HCP projects for a given organization.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}}, "required": ["organization_id"]}}, {"name": "get_project", "description": "Gets an HCP project by its ID.", "inputSchema": {"type": "object", "properties": {"project_id": {"type": "string", "description": "The ID of the project."}}, "required": ["project_id"]}}, {"name": "delete_project", "description": "Deletes an HCP project by its ID.", "inputSchema": {"type": "object", "properties": {"project_id": {"type": "string", "description": "The ID of the project."}}, "required": ["project_id"]}}, {"name": "create_project", "description": "Creates a new HCP project.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "name": {"type": "string", "description": "The name of the new project."}}, "required": ["organization_id", "name"]}}, {"name": "update_project", "description": "Updates an HCP project.", "inputSchema": {"type": "object", "properties": {"project_id": {"type": "string", "description": "The ID of the project."}, "name": {"type": "string", "description": "The new name of the project."}}, "required": ["project_id", "name"]}}, {"name": "get_organization", "description": "Gets an HCP organization by its ID.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}}, "required": ["organization_id"]}}, {"name": "list_organizations", "description": "Lists all HCP organizations.", "inputSchema": {"type": "object", "properties": {}}}, {"name": "update_organization", "description": "Updates an HCP organization.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "name": {"type": "string", "description": "The new name of the organization."}}, "required": ["organization_id", "name"]}}, {"name": "search_principals", "description": "Searches for principals in an organization.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "filter_str": {"type": "string", "description": "The filter string to use for the search."}}, "required": ["organization_id"]}}, {"name": "get_principals", "description": "Gets principals by their IDs.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "principal_ids": {"type": "array", "items": {"type": "string"}, "description": "The IDs of the principals to get."}}, "required": ["organization_id", "principal_ids"]}}, {"name": "delete_service_principal", "description": "Deletes a service principal by its ID.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "principal_id": {"type": "string", "description": "The ID of the service principal."}}, "required": ["organization_id", "principal_id"]}}, {"name": "create_service_principal", "description": "Creates a new service principal.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "name": {"type": "string", "description": "The name of the new service principal."}}, "required": ["organization_id", "name"]}}, {"name": "update_service_principal", "description": "Updates a service principal.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "principal_id": {"type": "string", "description": "The ID of the service principal."}, "name": {"type": "string", "description": "The new name of the service principal."}}, "required": ["organization_id", "principal_id", "name"]}}, {"name": "list_secrets", "description": "Lists all secrets for a given application.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "project_id": {"type": "string", "description": "The ID of the project."}, "app_name": {"type": "string", "description": "The name of the application."}}, "required": ["organization_id", "project_id", "app_name"]}}, {"name": "get_secret", "description": "Gets a secret by its name.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "project_id": {"type": "string", "description": "The ID of the project."}, "app_name": {"type": "string", "description": "The name of the application."}, "secret_name": {"type": "string", "description": "The name of the secret."}}, "required": ["organization_id", "project_id", "app_name", "secret_name"]}}, {"name": "delete_secret", "description": "Deletes a secret by its name.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "project_id": {"type": "string", "description": "The ID of the project."}, "app_name": {"type": "string", "description": "The name of the application."}, "secret_name": {"type": "string", "description": "The name of the secret."}}, "required": ["organization_id", "project_id", "app_name", "secret_name"]}}, {"name": "create_secret", "description": "Creates a new secret.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "project_id": {"type": "string", "description": "The ID of the project."}, "app_name": {"type": "string", "description": "The name of the application."}, "secret_name": {"type": "string", "description": "The name of the new secret."}, "secret_value": {"type": "string", "description": "The value of the new secret."}}, "required": ["organization_id", "project_id", "app_name", "secret_name", "secret_value"]}}, {"name": "find_project_by_name", "description": "Finds a project by its name.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "name": {"type": "string", "description": "The name of the project."}}, "required": ["organization_id", "name"]}}, {"name": "find_user_by_email", "description": "Finds a user by their email.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "email": {"type": "string", "description": "The email of the user."}}, "required": ["organization_id", "email"]}}, {"name": "find_organization_by_name", "description": "Finds an organization by its name.", "inputSchema": {"type": "object", "properties": {"name": {"type": "string", "description": "The name of the organization."}}, "required": ["name"]}}, {"name": "list_resources", "description": "Lists all resources in a project.", "inputSchema": {"type": "object", "properties": {"project_id": {"type": "string", "description": "The ID of the project."}}, "required": ["project_id"]}}, {"name": "search_logs", "description": "Searches for audit logs in an organization using LogQL. At least one of `query`, `project_id`, or `topic` must be provided. For advanced filtering, use the `query` parameter with LogQL syntax. To filter on specific JSON fields in the log entries, use the `| json` parser in your query. For example: `query='| json | control_plane_event_action=\"CREATE\"'`", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "query": {"type": "string", "description": "The LogQL query string for advanced filtering. Can be combined with `project_id` and `topic`. Example: '| json | resource_uuid=\"some-uuid\"'"}, "project_id": {"type": "string", "description": "A project ID to filter by."}, "topic": {"type": "string", "description": "A log topic to search. Example topics: 'hashicorp.platform.audit', 'hashicorp.packer.registry.audit', 'hashicorp.boundary.cluster.audit', 'hashicorp.consul.cluster.audit'"}, "start_time": {"type": "string", "description": "The start time for the search. Accepts formats like '24 hours ago', 'yesterday at 5pm', or 'Oct 1, 2025'."}, "end_time": {"type": "string", "description": "The end time for the search. Accepts formats like 'now', 'today', or 'Oct 3, 2025'."}}, "required": ["organization_id", "start_time", "end_time"]}}]}, "id": 2}
2025-10-10 11:38:51,389 - mcp_server - INFO - Client call: {"method": "tools/call", "params": {"name": "search_logs", "arguments": {"start_time": "5 days ago", "end_time": "now", "topic": "hashicorp.platform.audit", "organization_id": "11eab4a9-75f1-e0a5-8be1-0242ac110016"}}, "jsonrpc": "2.0", "id": 3}
2025-10-10 11:38:57,292 - mcp_server - ERROR - An unexpected error occurred: 
Traceback (most recent call last):
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpx/_transports/default.py", line 101, in map_httpcore_exceptions
    yield
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpx/_transports/default.py", line 394, in handle_async_request
    resp = await self._pool.handle_async_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpcore/_async/connection_pool.py", line 256, in handle_async_request
    raise exc from None
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpcore/_async/connection_pool.py", line 236, in handle_async_request
    response = await connection.handle_async_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpcore/_async/connection.py", line 103, in handle_async_request
    return await self._connection.handle_async_request(request)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpcore/_async/http11.py", line 136, in handle_async_request
    raise exc
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpcore/_async/http11.py", line 106, in handle_async_request
    ) = await self._receive_response_headers(**kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpcore/_async/http11.py", line 177, in _receive_response_headers
    event = await self._receive_event(timeout=timeout)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpcore/_async/http11.py", line 217, in _receive_event
    data = await self._network_stream.read(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpcore/_backends/anyio.py", line 32, in read
    with map_exceptions(exc_map):
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/contextlib.py", line 158, in __exit__
    self.gen.throw(value)
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ReadTimeout

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/tpowell/Documents/workspace/hcp_mcp_server/main.py", line 174, in process_mcp_request
    result = await TOOL_MAP[tool_name](**arguments)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/Documents/workspace/hcp_mcp_server/hcp/audit_logs.py", line 77, in search_logs
    response = await client.post(
               ^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpx/_client.py", line 1859, in post
    return await self.request(
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpx/_client.py", line 1540, in request
    return await self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpx/_client.py", line 1629, in send
    response = await self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpx/_client.py", line 1657, in _send_handling_auth
    response = await self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpx/_client.py", line 1694, in _send_handling_redirects
    response = await self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpx/_client.py", line 1730, in _send_single_request
    response = await transport.handle_async_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpx/_transports/default.py", line 393, in handle_async_request
    with map_httpcore_exceptions():
         ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/contextlib.py", line 158, in __exit__
    self.gen.throw(value)
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpx/_transports/default.py", line 118, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ReadTimeout
2025-10-10 11:38:57,305 - mcp_server - INFO - Request data: stdio_main: {'jsonrpc': '2.0', 'error': {'code': -32000, 'message': 'Server error', 'data': 'An unexpected error occurred. See logs for details.'}, 'id': 3}
2025-10-10 11:38:57,305 - mcp_server - INFO - Request data: stdio_main json: {"jsonrpc": "2.0", "error": {"code": -32000, "message": "Server error", "data": "An unexpected error occurred. See logs for details."}, "id": 3}
2025-10-10 11:46:49,536 - mcp_server - INFO - Received request: {"method": "initialize", "params": {"protocolVersion": "2025-06-18", "capabilities": {"roots": {}}, "clientInfo": {"name": "gemini-cli-mcp-client-HCP", "version": "0.0.1"}}, "jsonrpc": "2.0", "id": 0}
2025-10-10 11:46:49,536 - mcp_server - INFO - Request data: stdio_main: {'jsonrpc': '2.0', 'result': {'protocolVersion': '2024-11-05', 'serverInfo': {'name': 'HCP', 'version': '0.0.1'}, 'capabilities': {'tools': {'listChanged': True}, 'prompts': {'listChanged': True}, 'resources': {'listChanged': True}}}, 'id': 0}
2025-10-10 11:46:49,536 - mcp_server - INFO - Request data: stdio_main json: {"jsonrpc": "2.0", "result": {"protocolVersion": "2024-11-05", "serverInfo": {"name": "HCP", "version": "0.0.1"}, "capabilities": {"tools": {"listChanged": true}, "prompts": {"listChanged": true}, "resources": {"listChanged": true}}}, "id": 0}
2025-10-10 11:46:49,537 - mcp_server - INFO - Received request: {"method": "notifications/initialized", "jsonrpc": "2.0"}
2025-10-10 11:46:49,537 - mcp_server - INFO - Client initialized.
2025-10-10 11:46:49,537 - mcp_server - INFO - Received request: {"method": "prompts/list", "params": {}, "jsonrpc": "2.0", "id": 1}
2025-10-10 11:46:49,537 - mcp_server - INFO - Request data: stdio_main: {'jsonrpc': '2.0', 'result': {'prompts': [{'name': 'list_projects', 'title': 'List Projects', 'description': 'Lists all HCP projects for a given organization.', 'arguments': [{'name': 'organization_id', 'description': 'The ID of the organization.', 'required': True}]}, {'name': 'get_project', 'title': 'Get Project', 'description': 'Gets an HCP project by its ID.', 'arguments': [{'name': 'project_id', 'description': 'The ID of the project.', 'required': True}]}, {'name': 'delete_project', 'title': 'Delete Project', 'description': 'Deletes an HCP project by its ID.', 'arguments': [{'name': 'project_id', 'description': 'The ID of the project.', 'required': True}]}, {'name': 'create_project', 'title': 'Create Project', 'description': 'Creates a new HCP project.', 'arguments': [{'name': 'name', 'description': 'The name of the new project.', 'required': True}, {'name': 'organization_id', 'description': 'The ID of the organization.', 'required': True}]}, {'name': 'update_project', 'title': 'Update Project', 'description': 'Updates an HCP project.', 'arguments': [{'name': 'project_id', 'description': 'The ID of the project.', 'required': True}, {'name': 'name', 'description': 'The new name for the project.', 'required': True}, {'name': 'organization_id', 'description': 'The ID of the organization.', 'required': True}]}, {'name': 'get_organization', 'title': 'Get Organization', 'description': 'Gets an HCP organization by its ID.', 'arguments': [{'name': 'organization_id', 'description': 'The ID of the organization.', 'required': True}]}, {'name': 'list_organizations', 'title': 'List Organizations', 'description': 'Lists all HCP organizations.', 'arguments': None}, {'name': 'update_organization', 'title': 'Update Organization', 'description': 'Updates an HCP organization.', 'arguments': [{'name': 'organization_id', 'description': 'The ID of the organization.', 'required': True}, {'name': 'name', 'description': 'The new name for the organization.', 'required': True}]}, {'name': 'list_secrets', 'title': 'List Secrets', 'description': 'Lists all secrets for a given application.', 'arguments': [{'name': 'project_id', 'description': 'The ID of the project.', 'required': True}, {'name': 'app_name', 'description': 'The name of the application.', 'required': True}]}, {'name': 'get_secret', 'title': 'Get Secret', 'description': 'Gets a secret by its name.', 'arguments': [{'name': 'secret_name', 'description': 'The name of the secret.', 'required': True}, {'name': 'project_id', 'description': 'The ID of the project.', 'required': True}, {'name': 'app_name', 'description': 'The name of the application.', 'required': True}]}, {'name': 'delete_secret', 'title': 'Delete Secret', 'description': 'Deletes a secret by its name.', 'arguments': [{'name': 'secret_name', 'description': 'The name of the secret.', 'required': True}, {'name': 'project_id', 'description': 'The ID of the project.', 'required': True}, {'name': 'app_name', 'description': 'The name of the application.', 'required': True}]}, {'name': 'create_secret', 'title': 'Create Secret', 'description': 'Creates a new secret.', 'arguments': [{'name': 'secret_name', 'description': 'The name of the new secret.', 'required': True}, {'name': 'secret_value', 'description': 'The value of the new secret.', 'required': True}, {'name': 'project_id', 'description': 'The ID of the project.', 'required': True}, {'name': 'app_name', 'description': 'The name of the application.', 'required': True}]}, {'name': 'find_project_and_list_secrets', 'title': 'Find Project and List Secrets', 'description': 'Finds a project by name and lists its secrets.', 'arguments': [{'name': 'project_name', 'description': 'The name of the project.', 'required': True}, {'name': 'organization_id', 'description': 'The ID of the organization.', 'required': True}, {'name': 'app_name', 'description': 'The name of the application.', 'required': True}]}, {'name': 'list_resources', 'title': 'List Resources', 'description': 'Lists all resources in a project.', 'arguments': [{'name': 'project_id', 'description': 'The ID of the project.', 'required': True}]}, {'name': 'search_logs', 'title': 'Search Logs', 'description': 'Searches for audit logs in an organization using LogQL. The LLM should determine the best topic to use based on the user\'s query, or default to \'hashicorp.platform.audit\' if the user is not specific. For advanced filtering, use the `query` parameter with LogQL syntax. To filter on specific JSON fields in the log entries, use the `| json` parser in your query. For example: `query=\'| json | control_plane_event_action="CREATE"\'`', 'arguments': [{'name': 'organization_id', 'description': 'The ID of the organization.', 'required': True}, {'name': 'query', 'description': 'The LogQL query string for advanced filtering. Can be combined with `project_id` and `topic`. Example: \'| json | resource_uuid="some-uuid"\'', 'required': False}, {'name': 'project_id', 'description': 'A project ID to filter by.', 'required': False}, {'name': 'topic', 'description': "A log topic to search. Example topics: 'hashicorp.platform.audit', 'hashicorp.packer.registry.audit', 'hashicorp.boundary.cluster.audit', 'hashicorp.consul.cluster.audit'", 'required': True}, {'name': 'start_time', 'description': "The start time for the search. Accepts formats like '24 hours ago', 'yesterday at 5pm', or 'Oct 1, 2025'.", 'required': True}, {'name': 'end_time', 'description': "The end time for the search. Accepts formats like 'now', 'today', or 'Oct 3, 2025'.", 'required': True}]}]}, 'id': 1}
2025-10-10 11:46:49,537 - mcp_server - INFO - Request data: stdio_main json: {"jsonrpc": "2.0", "result": {"prompts": [{"name": "list_projects", "title": "List Projects", "description": "Lists all HCP projects for a given organization.", "arguments": [{"name": "organization_id", "description": "The ID of the organization.", "required": true}]}, {"name": "get_project", "title": "Get Project", "description": "Gets an HCP project by its ID.", "arguments": [{"name": "project_id", "description": "The ID of the project.", "required": true}]}, {"name": "delete_project", "title": "Delete Project", "description": "Deletes an HCP project by its ID.", "arguments": [{"name": "project_id", "description": "The ID of the project.", "required": true}]}, {"name": "create_project", "title": "Create Project", "description": "Creates a new HCP project.", "arguments": [{"name": "name", "description": "The name of the new project.", "required": true}, {"name": "organization_id", "description": "The ID of the organization.", "required": true}]}, {"name": "update_project", "title": "Update Project", "description": "Updates an HCP project.", "arguments": [{"name": "project_id", "description": "The ID of the project.", "required": true}, {"name": "name", "description": "The new name for the project.", "required": true}, {"name": "organization_id", "description": "The ID of the organization.", "required": true}]}, {"name": "get_organization", "title": "Get Organization", "description": "Gets an HCP organization by its ID.", "arguments": [{"name": "organization_id", "description": "The ID of the organization.", "required": true}]}, {"name": "list_organizations", "title": "List Organizations", "description": "Lists all HCP organizations.", "arguments": null}, {"name": "update_organization", "title": "Update Organization", "description": "Updates an HCP organization.", "arguments": [{"name": "organization_id", "description": "The ID of the organization.", "required": true}, {"name": "name", "description": "The new name for the organization.", "required": true}]}, {"name": "list_secrets", "title": "List Secrets", "description": "Lists all secrets for a given application.", "arguments": [{"name": "project_id", "description": "The ID of the project.", "required": true}, {"name": "app_name", "description": "The name of the application.", "required": true}]}, {"name": "get_secret", "title": "Get Secret", "description": "Gets a secret by its name.", "arguments": [{"name": "secret_name", "description": "The name of the secret.", "required": true}, {"name": "project_id", "description": "The ID of the project.", "required": true}, {"name": "app_name", "description": "The name of the application.", "required": true}]}, {"name": "delete_secret", "title": "Delete Secret", "description": "Deletes a secret by its name.", "arguments": [{"name": "secret_name", "description": "The name of the secret.", "required": true}, {"name": "project_id", "description": "The ID of the project.", "required": true}, {"name": "app_name", "description": "The name of the application.", "required": true}]}, {"name": "create_secret", "title": "Create Secret", "description": "Creates a new secret.", "arguments": [{"name": "secret_name", "description": "The name of the new secret.", "required": true}, {"name": "secret_value", "description": "The value of the new secret.", "required": true}, {"name": "project_id", "description": "The ID of the project.", "required": true}, {"name": "app_name", "description": "The name of the application.", "required": true}]}, {"name": "find_project_and_list_secrets", "title": "Find Project and List Secrets", "description": "Finds a project by name and lists its secrets.", "arguments": [{"name": "project_name", "description": "The name of the project.", "required": true}, {"name": "organization_id", "description": "The ID of the organization.", "required": true}, {"name": "app_name", "description": "The name of the application.", "required": true}]}, {"name": "list_resources", "title": "List Resources", "description": "Lists all resources in a project.", "arguments": [{"name": "project_id", "description": "The ID of the project.", "required": true}]}, {"name": "search_logs", "title": "Search Logs", "description": "Searches for audit logs in an organization using LogQL. The LLM should determine the best topic to use based on the user's query, or default to 'hashicorp.platform.audit' if the user is not specific. For advanced filtering, use the `query` parameter with LogQL syntax. To filter on specific JSON fields in the log entries, use the `| json` parser in your query. For example: `query='| json | control_plane_event_action=\"CREATE\"'`", "arguments": [{"name": "organization_id", "description": "The ID of the organization.", "required": true}, {"name": "query", "description": "The LogQL query string for advanced filtering. Can be combined with `project_id` and `topic`. Example: '| json | resource_uuid=\"some-uuid\"'", "required": false}, {"name": "project_id", "description": "A project ID to filter by.", "required": false}, {"name": "topic", "description": "A log topic to search. Example topics: 'hashicorp.platform.audit', 'hashicorp.packer.registry.audit', 'hashicorp.boundary.cluster.audit', 'hashicorp.consul.cluster.audit'", "required": true}, {"name": "start_time", "description": "The start time for the search. Accepts formats like '24 hours ago', 'yesterday at 5pm', or 'Oct 1, 2025'.", "required": true}, {"name": "end_time", "description": "The end time for the search. Accepts formats like 'now', 'today', or 'Oct 3, 2025'.", "required": true}]}]}, "id": 1}
2025-10-10 11:46:49,538 - mcp_server - INFO - Received request: {"method": "tools/list", "params": {}, "jsonrpc": "2.0", "id": 2}
2025-10-10 11:46:49,538 - mcp_server - INFO - Request data: stdio_main: {'jsonrpc': '2.0', 'result': {'tools': [{'name': 'list_projects', 'description': 'Lists all HCP projects for a given organization.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}}, 'required': ['organization_id']}}, {'name': 'get_project', 'description': 'Gets an HCP project by its ID.', 'inputSchema': {'type': 'object', 'properties': {'project_id': {'type': 'string', 'description': 'The ID of the project.'}}, 'required': ['project_id']}}, {'name': 'delete_project', 'description': 'Deletes an HCP project by its ID.', 'inputSchema': {'type': 'object', 'properties': {'project_id': {'type': 'string', 'description': 'The ID of the project.'}}, 'required': ['project_id']}}, {'name': 'create_project', 'description': 'Creates a new HCP project.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'name': {'type': 'string', 'description': 'The name of the new project.'}}, 'required': ['organization_id', 'name']}}, {'name': 'update_project', 'description': 'Updates an HCP project.', 'inputSchema': {'type': 'object', 'properties': {'project_id': {'type': 'string', 'description': 'The ID of the project.'}, 'name': {'type': 'string', 'description': 'The new name of the project.'}}, 'required': ['project_id', 'name']}}, {'name': 'get_organization', 'description': 'Gets an HCP organization by its ID.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}}, 'required': ['organization_id']}}, {'name': 'list_organizations', 'description': 'Lists all HCP organizations.', 'inputSchema': {'type': 'object', 'properties': {}}}, {'name': 'update_organization', 'description': 'Updates an HCP organization.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'name': {'type': 'string', 'description': 'The new name of the organization.'}}, 'required': ['organization_id', 'name']}}, {'name': 'search_principals', 'description': 'Searches for principals in an organization.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'filter_str': {'type': 'string', 'description': 'The filter string to use for the search.'}}, 'required': ['organization_id']}}, {'name': 'get_principals', 'description': 'Gets principals by their IDs.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'principal_ids': {'type': 'array', 'items': {'type': 'string'}, 'description': 'The IDs of the principals to get.'}}, 'required': ['organization_id', 'principal_ids']}}, {'name': 'delete_service_principal', 'description': 'Deletes a service principal by its ID.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'principal_id': {'type': 'string', 'description': 'The ID of the service principal.'}}, 'required': ['organization_id', 'principal_id']}}, {'name': 'create_service_principal', 'description': 'Creates a new service principal.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'name': {'type': 'string', 'description': 'The name of the new service principal.'}}, 'required': ['organization_id', 'name']}}, {'name': 'update_service_principal', 'description': 'Updates a service principal.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'principal_id': {'type': 'string', 'description': 'The ID of the service principal.'}, 'name': {'type': 'string', 'description': 'The new name of the service principal.'}}, 'required': ['organization_id', 'principal_id', 'name']}}, {'name': 'list_secrets', 'description': 'Lists all secrets for a given application.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'project_id': {'type': 'string', 'description': 'The ID of the project.'}, 'app_name': {'type': 'string', 'description': 'The name of the application.'}}, 'required': ['organization_id', 'project_id', 'app_name']}}, {'name': 'get_secret', 'description': 'Gets a secret by its name.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'project_id': {'type': 'string', 'description': 'The ID of the project.'}, 'app_name': {'type': 'string', 'description': 'The name of the application.'}, 'secret_name': {'type': 'string', 'description': 'The name of the secret.'}}, 'required': ['organization_id', 'project_id', 'app_name', 'secret_name']}}, {'name': 'delete_secret', 'description': 'Deletes a secret by its name.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'project_id': {'type': 'string', 'description': 'The ID of the project.'}, 'app_name': {'type': 'string', 'description': 'The name of the application.'}, 'secret_name': {'type': 'string', 'description': 'The name of the secret.'}}, 'required': ['organization_id', 'project_id', 'app_name', 'secret_name']}}, {'name': 'create_secret', 'description': 'Creates a new secret.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'project_id': {'type': 'string', 'description': 'The ID of the project.'}, 'app_name': {'type': 'string', 'description': 'The name of the application.'}, 'secret_name': {'type': 'string', 'description': 'The name of the new secret.'}, 'secret_value': {'type': 'string', 'description': 'The value of the new secret.'}}, 'required': ['organization_id', 'project_id', 'app_name', 'secret_name', 'secret_value']}}, {'name': 'find_project_by_name', 'description': 'Finds a project by its name.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'name': {'type': 'string', 'description': 'The name of the project.'}}, 'required': ['organization_id', 'name']}}, {'name': 'find_user_by_email', 'description': 'Finds a user by their email.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'email': {'type': 'string', 'description': 'The email of the user.'}}, 'required': ['organization_id', 'email']}}, {'name': 'find_organization_by_name', 'description': 'Finds an organization by its name.', 'inputSchema': {'type': 'object', 'properties': {'name': {'type': 'string', 'description': 'The name of the organization.'}}, 'required': ['name']}}, {'name': 'list_resources', 'description': 'Lists all resources in a project.', 'inputSchema': {'type': 'object', 'properties': {'project_id': {'type': 'string', 'description': 'The ID of the project.'}}, 'required': ['project_id']}}, {'name': 'search_logs', 'description': 'Searches for audit logs in an organization using LogQL. At least one of `query`, `project_id`, or `topic` must be provided. For advanced filtering, use the `query` parameter with LogQL syntax. To filter on specific JSON fields in the log entries, use the `| json` parser in your query. For example: `query=\'| json | control_plane_event_action="CREATE"\'`', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'query': {'type': 'string', 'description': 'The LogQL query string for advanced filtering. Can be combined with `project_id` and `topic`. Example: \'| json | resource_uuid="some-uuid"\''}, 'project_id': {'type': 'string', 'description': 'A project ID to filter by.'}, 'topic': {'type': 'string', 'description': "A log topic to search. Example topics: 'hashicorp.platform.audit', 'hashicorp.packer.registry.audit', 'hashicorp.boundary.cluster.audit', 'hashicorp.consul.cluster.audit'"}, 'start_time': {'type': 'string', 'description': "The start time for the search. Accepts formats like '24 hours ago', 'yesterday at 5pm', or 'Oct 1, 2025'."}, 'end_time': {'type': 'string', 'description': "The end time for the search. Accepts formats like 'now', 'today', or 'Oct 3, 2025'."}}, 'required': ['organization_id', 'start_time', 'end_time']}}]}, 'id': 2}
2025-10-10 11:46:49,538 - mcp_server - INFO - Request data: stdio_main json: {"jsonrpc": "2.0", "result": {"tools": [{"name": "list_projects", "description": "Lists all HCP projects for a given organization.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}}, "required": ["organization_id"]}}, {"name": "get_project", "description": "Gets an HCP project by its ID.", "inputSchema": {"type": "object", "properties": {"project_id": {"type": "string", "description": "The ID of the project."}}, "required": ["project_id"]}}, {"name": "delete_project", "description": "Deletes an HCP project by its ID.", "inputSchema": {"type": "object", "properties": {"project_id": {"type": "string", "description": "The ID of the project."}}, "required": ["project_id"]}}, {"name": "create_project", "description": "Creates a new HCP project.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "name": {"type": "string", "description": "The name of the new project."}}, "required": ["organization_id", "name"]}}, {"name": "update_project", "description": "Updates an HCP project.", "inputSchema": {"type": "object", "properties": {"project_id": {"type": "string", "description": "The ID of the project."}, "name": {"type": "string", "description": "The new name of the project."}}, "required": ["project_id", "name"]}}, {"name": "get_organization", "description": "Gets an HCP organization by its ID.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}}, "required": ["organization_id"]}}, {"name": "list_organizations", "description": "Lists all HCP organizations.", "inputSchema": {"type": "object", "properties": {}}}, {"name": "update_organization", "description": "Updates an HCP organization.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "name": {"type": "string", "description": "The new name of the organization."}}, "required": ["organization_id", "name"]}}, {"name": "search_principals", "description": "Searches for principals in an organization.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "filter_str": {"type": "string", "description": "The filter string to use for the search."}}, "required": ["organization_id"]}}, {"name": "get_principals", "description": "Gets principals by their IDs.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "principal_ids": {"type": "array", "items": {"type": "string"}, "description": "The IDs of the principals to get."}}, "required": ["organization_id", "principal_ids"]}}, {"name": "delete_service_principal", "description": "Deletes a service principal by its ID.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "principal_id": {"type": "string", "description": "The ID of the service principal."}}, "required": ["organization_id", "principal_id"]}}, {"name": "create_service_principal", "description": "Creates a new service principal.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "name": {"type": "string", "description": "The name of the new service principal."}}, "required": ["organization_id", "name"]}}, {"name": "update_service_principal", "description": "Updates a service principal.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "principal_id": {"type": "string", "description": "The ID of the service principal."}, "name": {"type": "string", "description": "The new name of the service principal."}}, "required": ["organization_id", "principal_id", "name"]}}, {"name": "list_secrets", "description": "Lists all secrets for a given application.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "project_id": {"type": "string", "description": "The ID of the project."}, "app_name": {"type": "string", "description": "The name of the application."}}, "required": ["organization_id", "project_id", "app_name"]}}, {"name": "get_secret", "description": "Gets a secret by its name.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "project_id": {"type": "string", "description": "The ID of the project."}, "app_name": {"type": "string", "description": "The name of the application."}, "secret_name": {"type": "string", "description": "The name of the secret."}}, "required": ["organization_id", "project_id", "app_name", "secret_name"]}}, {"name": "delete_secret", "description": "Deletes a secret by its name.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "project_id": {"type": "string", "description": "The ID of the project."}, "app_name": {"type": "string", "description": "The name of the application."}, "secret_name": {"type": "string", "description": "The name of the secret."}}, "required": ["organization_id", "project_id", "app_name", "secret_name"]}}, {"name": "create_secret", "description": "Creates a new secret.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "project_id": {"type": "string", "description": "The ID of the project."}, "app_name": {"type": "string", "description": "The name of the application."}, "secret_name": {"type": "string", "description": "The name of the new secret."}, "secret_value": {"type": "string", "description": "The value of the new secret."}}, "required": ["organization_id", "project_id", "app_name", "secret_name", "secret_value"]}}, {"name": "find_project_by_name", "description": "Finds a project by its name.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "name": {"type": "string", "description": "The name of the project."}}, "required": ["organization_id", "name"]}}, {"name": "find_user_by_email", "description": "Finds a user by their email.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "email": {"type": "string", "description": "The email of the user."}}, "required": ["organization_id", "email"]}}, {"name": "find_organization_by_name", "description": "Finds an organization by its name.", "inputSchema": {"type": "object", "properties": {"name": {"type": "string", "description": "The name of the organization."}}, "required": ["name"]}}, {"name": "list_resources", "description": "Lists all resources in a project.", "inputSchema": {"type": "object", "properties": {"project_id": {"type": "string", "description": "The ID of the project."}}, "required": ["project_id"]}}, {"name": "search_logs", "description": "Searches for audit logs in an organization using LogQL. At least one of `query`, `project_id`, or `topic` must be provided. For advanced filtering, use the `query` parameter with LogQL syntax. To filter on specific JSON fields in the log entries, use the `| json` parser in your query. For example: `query='| json | control_plane_event_action=\"CREATE\"'`", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "query": {"type": "string", "description": "The LogQL query string for advanced filtering. Can be combined with `project_id` and `topic`. Example: '| json | resource_uuid=\"some-uuid\"'"}, "project_id": {"type": "string", "description": "A project ID to filter by."}, "topic": {"type": "string", "description": "A log topic to search. Example topics: 'hashicorp.platform.audit', 'hashicorp.packer.registry.audit', 'hashicorp.boundary.cluster.audit', 'hashicorp.consul.cluster.audit'"}, "start_time": {"type": "string", "description": "The start time for the search. Accepts formats like '24 hours ago', 'yesterday at 5pm', or 'Oct 1, 2025'."}, "end_time": {"type": "string", "description": "The end time for the search. Accepts formats like 'now', 'today', or 'Oct 3, 2025'."}}, "required": ["organization_id", "start_time", "end_time"]}}]}, "id": 2}
2025-10-10 11:47:18,733 - mcp_server - INFO - Client call: {"method": "tools/call", "params": {"name": "search_logs", "arguments": {"organization_id": "11eab4a9-75f1-e0a5-8be1-0242ac110016", "topic": "hashicorp.platform.audit", "start_time": "5 days ago", "end_time": "now"}}, "jsonrpc": "2.0", "id": 3}
2025-10-10 11:47:23,015 - mcp_server - INFO - Tool request data: {'streams': {'entries': [{'id': '122f81e8-22e6-4904-93b9-66bc619eabfe', 'timestamp': '2025-10-10T08:56:52.023953993Z', 'stream': {'organization_id': '11eab4a9-75f1-e0a5-8be1-0242ac110016', 'project_id': '11eab4a9-760d-c9f2-adc9-0242ac11000a', 'topic': 'hashicorp.platform.audit'}, 'resource': None, 'control_plane_event': {'request_info': {'http_verb': 'POST', 'http_path': '/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive', 'http_user_agent': 'HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (1f2925d)', 'http_client_ip': '35.91.140.117'}, 'authentication_info': {'principal': None, 'service_principal_delegation_chain': []}, 'authorization_info': [], 'metadata': {'cluster_id': 'vault-cluster'}, 'operation_info': {'operation_id': ''}, 'description': 'Host Manager Alive Requested', 'action': 'CREATE', 'status_code': 'OK'}, 'subject': None}, {'id': '02427d1f-9e48-4055-9eeb-1f938f6ca429', 'timestamp': '2025-10-10T08:56:50.585409396Z', 'stream': {'organization_id': '11eab4a9-75f1-e0a5-8be1-0242ac110016', 'project_id': '11eab4a9-760d-c9f2-adc9-0242ac11000a', 'topic': 'hashicorp.platform.audit'}, 'resource': None, 'control_plane_event': {'request_info': {'http_verb': 'POST', 'http_path': '/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive', 'http_user_agent': 'HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (1f2925d)', 'http_client_ip': '35.87.142.147'}, 'authentication_info': {'principal': None, 'service_principal_delegation_chain': []}, 'authorization_info': [], 'metadata': {'cluster_id': 'vault-cluster'}, 'operation_info': {'operation_id': ''}, 'description': 'Host Manager Alive Requested', 'action': 'CREATE', 'status_code': 'OK'}, 'subject': None}, {'id': '69a76856-4cb0-4609-b574-01b4cdba84d6', 'timestamp': '2025-10-10T08:56:48.565603242Z', 'stream': {'organization_id': '11eab4a9-75f1-e0a5-8be1-0242ac110016', 'project_id': '11eab4a9-760d-c9f2-adc9-0242ac11000a', 'topic': 'hashicorp.platform.audit'}, 'resource': None, 'control_plane_event': {'request_info': {'http_verb': 'POST', 'http_path': '/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive', 'http_user_agent': 'HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (1f2925d)', 'http_client_ip': '54.187.49.218'}, 'authentication_info': {'principal': None, 'service_principal_delegation_chain': []}, 'authorization_info': [], 'metadata': {'cluster_id': 'vault-cluster'}, 'operation_info': {'operation_id': ''}, 'description': 'Host Manager Alive Requested', 'action': 'CREATE', 'status_code': 'OK'}, 'subject': None}, {'id': '08813e54-bd3e-4e42-81a3-daadd2672e7e', 'timestamp': '2025-10-10T06:31:50.900038725Z', 'stream': {'organization_id': '11eab4a9-75f1-e0a5-8be1-0242ac110016', 'project_id': '11eab4a9-760d-c9f2-adc9-0242ac11000a', 'topic': 'hashicorp.platform.audit'}, 'resource': None, 'control_plane_event': {'request_info': {'http_verb': 'POST', 'http_path': '/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster-4/host-alive', 'http_user_agent': 'HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (98d7292)', 'http_client_ip': '54.188.11.180'}, 'authentication_info': {'principal': None, 'service_principal_delegation_chain': []}, 'authorization_info': [], 'metadata': {'cluster_id': 'vault-cluster-4'}, 'operation_info': {'operation_id': ''}, 'description': 'Host Manager Alive Requested', 'action': 'CREATE', 'status_code': 'OK'}, 'subject': None}, {'id': 'bd27928c-ae21-462e-be06-6630a49057d8', 'timestamp': '2025-10-09T20:24:13.287295802Z', 'stream': {'organization_id': '11eab4a9-75f1-e0a5-8be1-0242ac110016', 'project_id': '', 'topic': 'hashicorp.platform.audit'}, 'resource': None, 'control_plane_event': {'request_info': {'http_verb': 'GET', 'http_path': '/consent/complete', 'http_user_agent': '', 'http_client_ip': ''}, 'authentication_info': {'principal': {'id': '5f32f218-a0c0-4191-bd10-f2c1169bcfde', 'type': 'PRINCIPAL_TYPE_USER', 'user': {'id': '5f32f218-a0c0-4191-bd10-f2c1169bcfde', 'email': 'tpowell@hashicorp.com', 'full_name': 'tpowell@hashicorp.com', 'identity_type': 'UNSET', 'identity_types': [], 'subject': '5f32f218-a0c0-4191-bd10-f2c1169bcfde', 'scim_synchronized': False}, 'group_ids': []}, 'service_principal_delegation_chain': []}, 'authorization_info': [], 'metadata': {'email': 'tpowell@hashicorp.com', 'event_type': 'hcp_id_auth_success', 'ip': '73.252.181.35', 'message': 'Authenticated successfully', 'timestamp': '2025-10-09 20:24:12 +0000 UTC', 'user_id': '5f32f218-a0c0-4191-bd10-f2c1169bcfde'}, 'operation_info': {'operation_id': ''}, 'description': 'Authenticated successfully', 'action': 'CREATE', 'status_code': 'OK'}, 'subject': None}, {'id': '0e7bdf42-82d1-422c-9c34-ca0107593c76', 'timestamp': '2025-10-08T06:01:56.587155304Z', 'stream': {'organization_id': '11eab4a9-75f1-e0a5-8be1-0242ac110016', 'project_id': '11eab4a9-760d-c9f2-adc9-0242ac11000a', 'topic': 'hashicorp.platform.audit'}, 'resource': None, 'control_plane_event': {'request_info': {'http_verb': 'POST', 'http_path': '/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster1/host-alive', 'http_user_agent': 'HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (ee02d1c)', 'http_client_ip': '34.221.205.1'}, 'authentication_info': {'principal': None, 'service_principal_delegation_chain': []}, 'authorization_info': [], 'metadata': {'cluster_id': 'vault-cluster1'}, 'operation_info': {'operation_id': ''}, 'description': 'Host Manager Alive Requested', 'action': 'CREATE', 'status_code': 'OK'}, 'subject': None}, {'id': '89634f56-97e0-4ac6-bf39-7dc90a3ab1a1', 'timestamp': '2025-10-07T08:56:55.771365379Z', 'stream': {'organization_id': '11eab4a9-75f1-e0a5-8be1-0242ac110016', 'project_id': '11eab4a9-760d-c9f2-adc9-0242ac11000a', 'topic': 'hashicorp.platform.audit'}, 'resource': None, 'control_plane_event': {'request_info': {'http_verb': 'POST', 'http_path': '/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive', 'http_user_agent': 'HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (bfea313)', 'http_client_ip': '35.90.87.232'}, 'authentication_info': {'principal': None, 'service_principal_delegation_chain': []}, 'authorization_info': [], 'metadata': {'cluster_id': 'vault-cluster'}, 'operation_info': {'operation_id': ''}, 'description': 'Host Manager Alive Requested', 'action': 'CREATE', 'status_code': 'OK'}, 'subject': None}, {'id': '3ee2bab5-e951-4489-ae35-d3a052ab05c3', 'timestamp': '2025-10-07T08:56:49.242102158Z', 'stream': {'organization_id': '11eab4a9-75f1-e0a5-8be1-0242ac110016', 'project_id': '11eab4a9-760d-c9f2-adc9-0242ac11000a', 'topic': 'hashicorp.platform.audit'}, 'resource': None, 'control_plane_event': {'request_info': {'http_verb': 'POST', 'http_path': '/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive', 'http_user_agent': 'HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (bfea313)', 'http_client_ip': '16.144.10.31'}, 'authentication_info': {'principal': None, 'service_principal_delegation_chain': []}, 'authorization_info': [], 'metadata': {'cluster_id': 'vault-cluster'}, 'operation_info': {'operation_id': ''}, 'description': 'Host Manager Alive Requested', 'action': 'CREATE', 'status_code': 'OK'}, 'subject': None}, {'id': '118d591d-5d43-496a-8cfd-f377861a82a3', 'timestamp': '2025-10-07T08:56:48.074774296Z', 'stream': {'organization_id': '11eab4a9-75f1-e0a5-8be1-0242ac110016', 'project_id': '11eab4a9-760d-c9f2-adc9-0242ac11000a', 'topic': 'hashicorp.platform.audit'}, 'resource': None, 'control_plane_event': {'request_info': {'http_verb': 'POST', 'http_path': '/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive', 'http_user_agent': 'HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (bfea313)', 'http_client_ip': '34.216.173.150'}, 'authentication_info': {'principal': None, 'service_principal_delegation_chain': []}, 'authorization_info': [], 'metadata': {'cluster_id': 'vault-cluster'}, 'operation_info': {'operation_id': ''}, 'description': 'Host Manager Alive Requested', 'action': 'CREATE', 'status_code': 'OK'}, 'subject': None}, {'id': '490c67cd-67c2-4365-a3fe-55741bc09bf0', 'timestamp': '2025-10-07T06:31:50.875751353Z', 'stream': {'organization_id': '11eab4a9-75f1-e0a5-8be1-0242ac110016', 'project_id': '11eab4a9-760d-c9f2-adc9-0242ac11000a', 'topic': 'hashicorp.platform.audit'}, 'resource': None, 'control_plane_event': {'request_info': {'http_verb': 'POST', 'http_path': '/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster-4/host-alive', 'http_user_agent': 'HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (bfea313)', 'http_client_ip': '54.200.13.172'}, 'authentication_info': {'principal': None, 'service_principal_delegation_chain': []}, 'authorization_info': [], 'metadata': {'cluster_id': 'vault-cluster-4'}, 'operation_info': {'operation_id': ''}, 'description': 'Host Manager Alive Requested', 'action': 'CREATE', 'status_code': 'OK'}, 'subject': None}]}, 'next_page_token': 'eyJ0aW1lc3RhbXAiOiIyMDI1LTEwLTA3VDA2OjMxOjUwLjg3NTc1MTM1M1oiLCJpZCI6IjQ5MGM2N2NkLTY3YzItNDM2NS1hM2ZlLTU1NzQxYmMwOWJmMCIsIm9mZnNldCI6MX0='}
2025-10-10 11:47:23,015 - mcp_server - INFO - Request data: stdio_main: {'jsonrpc': '2.0', 'result': {'content': [{'type': 'text', 'text': '{"streams": {"entries": [{"id": "122f81e8-22e6-4904-93b9-66bc619eabfe", "timestamp": "2025-10-10T08:56:52.023953993Z", "stream": {"organization_id": "11eab4a9-75f1-e0a5-8be1-0242ac110016", "project_id": "11eab4a9-760d-c9f2-adc9-0242ac11000a", "topic": "hashicorp.platform.audit"}, "resource": null, "control_plane_event": {"request_info": {"http_verb": "POST", "http_path": "/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive", "http_user_agent": "HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (1f2925d)", "http_client_ip": "35.91.140.117"}, "authentication_info": {"principal": null, "service_principal_delegation_chain": []}, "authorization_info": [], "metadata": {"cluster_id": "vault-cluster"}, "operation_info": {"operation_id": ""}, "description": "Host Manager Alive Requested", "action": "CREATE", "status_code": "OK"}, "subject": null}, {"id": "02427d1f-9e48-4055-9eeb-1f938f6ca429", "timestamp": "2025-10-10T08:56:50.585409396Z", "stream": {"organization_id": "11eab4a9-75f1-e0a5-8be1-0242ac110016", "project_id": "11eab4a9-760d-c9f2-adc9-0242ac11000a", "topic": "hashicorp.platform.audit"}, "resource": null, "control_plane_event": {"request_info": {"http_verb": "POST", "http_path": "/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive", "http_user_agent": "HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (1f2925d)", "http_client_ip": "35.87.142.147"}, "authentication_info": {"principal": null, "service_principal_delegation_chain": []}, "authorization_info": [], "metadata": {"cluster_id": "vault-cluster"}, "operation_info": {"operation_id": ""}, "description": "Host Manager Alive Requested", "action": "CREATE", "status_code": "OK"}, "subject": null}, {"id": "69a76856-4cb0-4609-b574-01b4cdba84d6", "timestamp": "2025-10-10T08:56:48.565603242Z", "stream": {"organization_id": "11eab4a9-75f1-e0a5-8be1-0242ac110016", "project_id": "11eab4a9-760d-c9f2-adc9-0242ac11000a", "topic": "hashicorp.platform.audit"}, "resource": null, "control_plane_event": {"request_info": {"http_verb": "POST", "http_path": "/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive", "http_user_agent": "HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (1f2925d)", "http_client_ip": "54.187.49.218"}, "authentication_info": {"principal": null, "service_principal_delegation_chain": []}, "authorization_info": [], "metadata": {"cluster_id": "vault-cluster"}, "operation_info": {"operation_id": ""}, "description": "Host Manager Alive Requested", "action": "CREATE", "status_code": "OK"}, "subject": null}, {"id": "08813e54-bd3e-4e42-81a3-daadd2672e7e", "timestamp": "2025-10-10T06:31:50.900038725Z", "stream": {"organization_id": "11eab4a9-75f1-e0a5-8be1-0242ac110016", "project_id": "11eab4a9-760d-c9f2-adc9-0242ac11000a", "topic": "hashicorp.platform.audit"}, "resource": null, "control_plane_event": {"request_info": {"http_verb": "POST", "http_path": "/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster-4/host-alive", "http_user_agent": "HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (98d7292)", "http_client_ip": "54.188.11.180"}, "authentication_info": {"principal": null, "service_principal_delegation_chain": []}, "authorization_info": [], "metadata": {"cluster_id": "vault-cluster-4"}, "operation_info": {"operation_id": ""}, "description": "Host Manager Alive Requested", "action": "CREATE", "status_code": "OK"}, "subject": null}, {"id": "bd27928c-ae21-462e-be06-6630a49057d8", "timestamp": "2025-10-09T20:24:13.287295802Z", "stream": {"organization_id": "11eab4a9-75f1-e0a5-8be1-0242ac110016", "project_id": "", "topic": "hashicorp.platform.audit"}, "resource": null, "control_plane_event": {"request_info": {"http_verb": "GET", "http_path": "/consent/complete", "http_user_agent": "", "http_client_ip": ""}, "authentication_info": {"principal": {"id": "5f32f218-a0c0-4191-bd10-f2c1169bcfde", "type": "PRINCIPAL_TYPE_USER", "user": {"id": "5f32f218-a0c0-4191-bd10-f2c1169bcfde", "email": "tpowell@hashicorp.com", "full_name": "tpowell@hashicorp.com", "identity_type": "UNSET", "identity_types": [], "subject": "5f32f218-a0c0-4191-bd10-f2c1169bcfde", "scim_synchronized": false}, "group_ids": []}, "service_principal_delegation_chain": []}, "authorization_info": [], "metadata": {"email": "tpowell@hashicorp.com", "event_type": "hcp_id_auth_success", "ip": "73.252.181.35", "message": "Authenticated successfully", "timestamp": "2025-10-09 20:24:12 +0000 UTC", "user_id": "5f32f218-a0c0-4191-bd10-f2c1169bcfde"}, "operation_info": {"operation_id": ""}, "description": "Authenticated successfully", "action": "CREATE", "status_code": "OK"}, "subject": null}, {"id": "0e7bdf42-82d1-422c-9c34-ca0107593c76", "timestamp": "2025-10-08T06:01:56.587155304Z", "stream": {"organization_id": "11eab4a9-75f1-e0a5-8be1-0242ac110016", "project_id": "11eab4a9-760d-c9f2-adc9-0242ac11000a", "topic": "hashicorp.platform.audit"}, "resource": null, "control_plane_event": {"request_info": {"http_verb": "POST", "http_path": "/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster1/host-alive", "http_user_agent": "HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (ee02d1c)", "http_client_ip": "34.221.205.1"}, "authentication_info": {"principal": null, "service_principal_delegation_chain": []}, "authorization_info": [], "metadata": {"cluster_id": "vault-cluster1"}, "operation_info": {"operation_id": ""}, "description": "Host Manager Alive Requested", "action": "CREATE", "status_code": "OK"}, "subject": null}, {"id": "89634f56-97e0-4ac6-bf39-7dc90a3ab1a1", "timestamp": "2025-10-07T08:56:55.771365379Z", "stream": {"organization_id": "11eab4a9-75f1-e0a5-8be1-0242ac110016", "project_id": "11eab4a9-760d-c9f2-adc9-0242ac11000a", "topic": "hashicorp.platform.audit"}, "resource": null, "control_plane_event": {"request_info": {"http_verb": "POST", "http_path": "/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive", "http_user_agent": "HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (bfea313)", "http_client_ip": "35.90.87.232"}, "authentication_info": {"principal": null, "service_principal_delegation_chain": []}, "authorization_info": [], "metadata": {"cluster_id": "vault-cluster"}, "operation_info": {"operation_id": ""}, "description": "Host Manager Alive Requested", "action": "CREATE", "status_code": "OK"}, "subject": null}, {"id": "3ee2bab5-e951-4489-ae35-d3a052ab05c3", "timestamp": "2025-10-07T08:56:49.242102158Z", "stream": {"organization_id": "11eab4a9-75f1-e0a5-8be1-0242ac110016", "project_id": "11eab4a9-760d-c9f2-adc9-0242ac11000a", "topic": "hashicorp.platform.audit"}, "resource": null, "control_plane_event": {"request_info": {"http_verb": "POST", "http_path": "/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive", "http_user_agent": "HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (bfea313)", "http_client_ip": "16.144.10.31"}, "authentication_info": {"principal": null, "service_principal_delegation_chain": []}, "authorization_info": [], "metadata": {"cluster_id": "vault-cluster"}, "operation_info": {"operation_id": ""}, "description": "Host Manager Alive Requested", "action": "CREATE", "status_code": "OK"}, "subject": null}, {"id": "118d591d-5d43-496a-8cfd-f377861a82a3", "timestamp": "2025-10-07T08:56:48.074774296Z", "stream": {"organization_id": "11eab4a9-75f1-e0a5-8be1-0242ac110016", "project_id": "11eab4a9-760d-c9f2-adc9-0242ac11000a", "topic": "hashicorp.platform.audit"}, "resource": null, "control_plane_event": {"request_info": {"http_verb": "POST", "http_path": "/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive", "http_user_agent": "HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (bfea313)", "http_client_ip": "34.216.173.150"}, "authentication_info": {"principal": null, "service_principal_delegation_chain": []}, "authorization_info": [], "metadata": {"cluster_id": "vault-cluster"}, "operation_info": {"operation_id": ""}, "description": "Host Manager Alive Requested", "action": "CREATE", "status_code": "OK"}, "subject": null}, {"id": "490c67cd-67c2-4365-a3fe-55741bc09bf0", "timestamp": "2025-10-07T06:31:50.875751353Z", "stream": {"organization_id": "11eab4a9-75f1-e0a5-8be1-0242ac110016", "project_id": "11eab4a9-760d-c9f2-adc9-0242ac11000a", "topic": "hashicorp.platform.audit"}, "resource": null, "control_plane_event": {"request_info": {"http_verb": "POST", "http_path": "/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster-4/host-alive", "http_user_agent": "HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (bfea313)", "http_client_ip": "54.200.13.172"}, "authentication_info": {"principal": null, "service_principal_delegation_chain": []}, "authorization_info": [], "metadata": {"cluster_id": "vault-cluster-4"}, "operation_info": {"operation_id": ""}, "description": "Host Manager Alive Requested", "action": "CREATE", "status_code": "OK"}, "subject": null}]}, "next_page_token": "eyJ0aW1lc3RhbXAiOiIyMDI1LTEwLTA3VDA2OjMxOjUwLjg3NTc1MTM1M1oiLCJpZCI6IjQ5MGM2N2NkLTY3YzItNDM2NS1hM2ZlLTU1NzQxYmMwOWJmMCIsIm9mZnNldCI6MX0="}'}], 'isError': False}, 'id': 3}
2025-10-10 11:47:23,016 - mcp_server - INFO - Request data: stdio_main json: {"jsonrpc": "2.0", "result": {"content": [{"type": "text", "text": "{\"streams\": {\"entries\": [{\"id\": \"122f81e8-22e6-4904-93b9-66bc619eabfe\", \"timestamp\": \"2025-10-10T08:56:52.023953993Z\", \"stream\": {\"organization_id\": \"11eab4a9-75f1-e0a5-8be1-0242ac110016\", \"project_id\": \"11eab4a9-760d-c9f2-adc9-0242ac11000a\", \"topic\": \"hashicorp.platform.audit\"}, \"resource\": null, \"control_plane_event\": {\"request_info\": {\"http_verb\": \"POST\", \"http_path\": \"/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive\", \"http_user_agent\": \"HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (1f2925d)\", \"http_client_ip\": \"35.91.140.117\"}, \"authentication_info\": {\"principal\": null, \"service_principal_delegation_chain\": []}, \"authorization_info\": [], \"metadata\": {\"cluster_id\": \"vault-cluster\"}, \"operation_info\": {\"operation_id\": \"\"}, \"description\": \"Host Manager Alive Requested\", \"action\": \"CREATE\", \"status_code\": \"OK\"}, \"subject\": null}, {\"id\": \"02427d1f-9e48-4055-9eeb-1f938f6ca429\", \"timestamp\": \"2025-10-10T08:56:50.585409396Z\", \"stream\": {\"organization_id\": \"11eab4a9-75f1-e0a5-8be1-0242ac110016\", \"project_id\": \"11eab4a9-760d-c9f2-adc9-0242ac11000a\", \"topic\": \"hashicorp.platform.audit\"}, \"resource\": null, \"control_plane_event\": {\"request_info\": {\"http_verb\": \"POST\", \"http_path\": \"/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive\", \"http_user_agent\": \"HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (1f2925d)\", \"http_client_ip\": \"35.87.142.147\"}, \"authentication_info\": {\"principal\": null, \"service_principal_delegation_chain\": []}, \"authorization_info\": [], \"metadata\": {\"cluster_id\": \"vault-cluster\"}, \"operation_info\": {\"operation_id\": \"\"}, \"description\": \"Host Manager Alive Requested\", \"action\": \"CREATE\", \"status_code\": \"OK\"}, \"subject\": null}, {\"id\": \"69a76856-4cb0-4609-b574-01b4cdba84d6\", \"timestamp\": \"2025-10-10T08:56:48.565603242Z\", \"stream\": {\"organization_id\": \"11eab4a9-75f1-e0a5-8be1-0242ac110016\", \"project_id\": \"11eab4a9-760d-c9f2-adc9-0242ac11000a\", \"topic\": \"hashicorp.platform.audit\"}, \"resource\": null, \"control_plane_event\": {\"request_info\": {\"http_verb\": \"POST\", \"http_path\": \"/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive\", \"http_user_agent\": \"HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (1f2925d)\", \"http_client_ip\": \"54.187.49.218\"}, \"authentication_info\": {\"principal\": null, \"service_principal_delegation_chain\": []}, \"authorization_info\": [], \"metadata\": {\"cluster_id\": \"vault-cluster\"}, \"operation_info\": {\"operation_id\": \"\"}, \"description\": \"Host Manager Alive Requested\", \"action\": \"CREATE\", \"status_code\": \"OK\"}, \"subject\": null}, {\"id\": \"08813e54-bd3e-4e42-81a3-daadd2672e7e\", \"timestamp\": \"2025-10-10T06:31:50.900038725Z\", \"stream\": {\"organization_id\": \"11eab4a9-75f1-e0a5-8be1-0242ac110016\", \"project_id\": \"11eab4a9-760d-c9f2-adc9-0242ac11000a\", \"topic\": \"hashicorp.platform.audit\"}, \"resource\": null, \"control_plane_event\": {\"request_info\": {\"http_verb\": \"POST\", \"http_path\": \"/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster-4/host-alive\", \"http_user_agent\": \"HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (98d7292)\", \"http_client_ip\": \"54.188.11.180\"}, \"authentication_info\": {\"principal\": null, \"service_principal_delegation_chain\": []}, \"authorization_info\": [], \"metadata\": {\"cluster_id\": \"vault-cluster-4\"}, \"operation_info\": {\"operation_id\": \"\"}, \"description\": \"Host Manager Alive Requested\", \"action\": \"CREATE\", \"status_code\": \"OK\"}, \"subject\": null}, {\"id\": \"bd27928c-ae21-462e-be06-6630a49057d8\", \"timestamp\": \"2025-10-09T20:24:13.287295802Z\", \"stream\": {\"organization_id\": \"11eab4a9-75f1-e0a5-8be1-0242ac110016\", \"project_id\": \"\", \"topic\": \"hashicorp.platform.audit\"}, \"resource\": null, \"control_plane_event\": {\"request_info\": {\"http_verb\": \"GET\", \"http_path\": \"/consent/complete\", \"http_user_agent\": \"\", \"http_client_ip\": \"\"}, \"authentication_info\": {\"principal\": {\"id\": \"5f32f218-a0c0-4191-bd10-f2c1169bcfde\", \"type\": \"PRINCIPAL_TYPE_USER\", \"user\": {\"id\": \"5f32f218-a0c0-4191-bd10-f2c1169bcfde\", \"email\": \"tpowell@hashicorp.com\", \"full_name\": \"tpowell@hashicorp.com\", \"identity_type\": \"UNSET\", \"identity_types\": [], \"subject\": \"5f32f218-a0c0-4191-bd10-f2c1169bcfde\", \"scim_synchronized\": false}, \"group_ids\": []}, \"service_principal_delegation_chain\": []}, \"authorization_info\": [], \"metadata\": {\"email\": \"tpowell@hashicorp.com\", \"event_type\": \"hcp_id_auth_success\", \"ip\": \"73.252.181.35\", \"message\": \"Authenticated successfully\", \"timestamp\": \"2025-10-09 20:24:12 +0000 UTC\", \"user_id\": \"5f32f218-a0c0-4191-bd10-f2c1169bcfde\"}, \"operation_info\": {\"operation_id\": \"\"}, \"description\": \"Authenticated successfully\", \"action\": \"CREATE\", \"status_code\": \"OK\"}, \"subject\": null}, {\"id\": \"0e7bdf42-82d1-422c-9c34-ca0107593c76\", \"timestamp\": \"2025-10-08T06:01:56.587155304Z\", \"stream\": {\"organization_id\": \"11eab4a9-75f1-e0a5-8be1-0242ac110016\", \"project_id\": \"11eab4a9-760d-c9f2-adc9-0242ac11000a\", \"topic\": \"hashicorp.platform.audit\"}, \"resource\": null, \"control_plane_event\": {\"request_info\": {\"http_verb\": \"POST\", \"http_path\": \"/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster1/host-alive\", \"http_user_agent\": \"HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (ee02d1c)\", \"http_client_ip\": \"34.221.205.1\"}, \"authentication_info\": {\"principal\": null, \"service_principal_delegation_chain\": []}, \"authorization_info\": [], \"metadata\": {\"cluster_id\": \"vault-cluster1\"}, \"operation_info\": {\"operation_id\": \"\"}, \"description\": \"Host Manager Alive Requested\", \"action\": \"CREATE\", \"status_code\": \"OK\"}, \"subject\": null}, {\"id\": \"89634f56-97e0-4ac6-bf39-7dc90a3ab1a1\", \"timestamp\": \"2025-10-07T08:56:55.771365379Z\", \"stream\": {\"organization_id\": \"11eab4a9-75f1-e0a5-8be1-0242ac110016\", \"project_id\": \"11eab4a9-760d-c9f2-adc9-0242ac11000a\", \"topic\": \"hashicorp.platform.audit\"}, \"resource\": null, \"control_plane_event\": {\"request_info\": {\"http_verb\": \"POST\", \"http_path\": \"/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive\", \"http_user_agent\": \"HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (bfea313)\", \"http_client_ip\": \"35.90.87.232\"}, \"authentication_info\": {\"principal\": null, \"service_principal_delegation_chain\": []}, \"authorization_info\": [], \"metadata\": {\"cluster_id\": \"vault-cluster\"}, \"operation_info\": {\"operation_id\": \"\"}, \"description\": \"Host Manager Alive Requested\", \"action\": \"CREATE\", \"status_code\": \"OK\"}, \"subject\": null}, {\"id\": \"3ee2bab5-e951-4489-ae35-d3a052ab05c3\", \"timestamp\": \"2025-10-07T08:56:49.242102158Z\", \"stream\": {\"organization_id\": \"11eab4a9-75f1-e0a5-8be1-0242ac110016\", \"project_id\": \"11eab4a9-760d-c9f2-adc9-0242ac11000a\", \"topic\": \"hashicorp.platform.audit\"}, \"resource\": null, \"control_plane_event\": {\"request_info\": {\"http_verb\": \"POST\", \"http_path\": \"/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive\", \"http_user_agent\": \"HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (bfea313)\", \"http_client_ip\": \"16.144.10.31\"}, \"authentication_info\": {\"principal\": null, \"service_principal_delegation_chain\": []}, \"authorization_info\": [], \"metadata\": {\"cluster_id\": \"vault-cluster\"}, \"operation_info\": {\"operation_id\": \"\"}, \"description\": \"Host Manager Alive Requested\", \"action\": \"CREATE\", \"status_code\": \"OK\"}, \"subject\": null}, {\"id\": \"118d591d-5d43-496a-8cfd-f377861a82a3\", \"timestamp\": \"2025-10-07T08:56:48.074774296Z\", \"stream\": {\"organization_id\": \"11eab4a9-75f1-e0a5-8be1-0242ac110016\", \"project_id\": \"11eab4a9-760d-c9f2-adc9-0242ac11000a\", \"topic\": \"hashicorp.platform.audit\"}, \"resource\": null, \"control_plane_event\": {\"request_info\": {\"http_verb\": \"POST\", \"http_path\": \"/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive\", \"http_user_agent\": \"HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (bfea313)\", \"http_client_ip\": \"34.216.173.150\"}, \"authentication_info\": {\"principal\": null, \"service_principal_delegation_chain\": []}, \"authorization_info\": [], \"metadata\": {\"cluster_id\": \"vault-cluster\"}, \"operation_info\": {\"operation_id\": \"\"}, \"description\": \"Host Manager Alive Requested\", \"action\": \"CREATE\", \"status_code\": \"OK\"}, \"subject\": null}, {\"id\": \"490c67cd-67c2-4365-a3fe-55741bc09bf0\", \"timestamp\": \"2025-10-07T06:31:50.875751353Z\", \"stream\": {\"organization_id\": \"11eab4a9-75f1-e0a5-8be1-0242ac110016\", \"project_id\": \"11eab4a9-760d-c9f2-adc9-0242ac11000a\", \"topic\": \"hashicorp.platform.audit\"}, \"resource\": null, \"control_plane_event\": {\"request_info\": {\"http_verb\": \"POST\", \"http_path\": \"/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster-4/host-alive\", \"http_user_agent\": \"HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (bfea313)\", \"http_client_ip\": \"54.200.13.172\"}, \"authentication_info\": {\"principal\": null, \"service_principal_delegation_chain\": []}, \"authorization_info\": [], \"metadata\": {\"cluster_id\": \"vault-cluster-4\"}, \"operation_info\": {\"operation_id\": \"\"}, \"description\": \"Host Manager Alive Requested\", \"action\": \"CREATE\", \"status_code\": \"OK\"}, \"subject\": null}]}, \"next_page_token\": \"eyJ0aW1lc3RhbXAiOiIyMDI1LTEwLTA3VDA2OjMxOjUwLjg3NTc1MTM1M1oiLCJpZCI6IjQ5MGM2N2NkLTY3YzItNDM2NS1hM2ZlLTU1NzQxYmMwOWJmMCIsIm9mZnNldCI6MX0=\"}"}], "isError": false}, "id": 3}
2025-10-10 11:59:15,409 - mcp_server - INFO - Client call: {"method": "tools/call", "params": {"name": "search_logs", "arguments": {"organization_id": "11eab4a9-75f1-e0a5-8be1-0242ac110016", "end_time": "now", "topic": "hashicorp.platform.audit", "start_time": "15 days ago"}}, "jsonrpc": "2.0", "id": 4}
2025-10-10 11:59:21,244 - mcp_server - ERROR - An unexpected error occurred: 
Traceback (most recent call last):
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpx/_transports/default.py", line 101, in map_httpcore_exceptions
    yield
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpx/_transports/default.py", line 394, in handle_async_request
    resp = await self._pool.handle_async_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpcore/_async/connection_pool.py", line 256, in handle_async_request
    raise exc from None
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpcore/_async/connection_pool.py", line 236, in handle_async_request
    response = await connection.handle_async_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpcore/_async/connection.py", line 103, in handle_async_request
    return await self._connection.handle_async_request(request)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpcore/_async/http11.py", line 136, in handle_async_request
    raise exc
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpcore/_async/http11.py", line 106, in handle_async_request
    ) = await self._receive_response_headers(**kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpcore/_async/http11.py", line 177, in _receive_response_headers
    event = await self._receive_event(timeout=timeout)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpcore/_async/http11.py", line 217, in _receive_event
    data = await self._network_stream.read(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpcore/_backends/anyio.py", line 32, in read
    with map_exceptions(exc_map):
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/contextlib.py", line 158, in __exit__
    self.gen.throw(value)
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ReadTimeout

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/tpowell/Documents/workspace/hcp_mcp_server/main.py", line 174, in process_mcp_request
    result = await TOOL_MAP[tool_name](**arguments)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/Documents/workspace/hcp_mcp_server/hcp/audit_logs.py", line 81, in search_logs
    response = await client.post(
               ^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpx/_client.py", line 1859, in post
    return await self.request(
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpx/_client.py", line 1540, in request
    return await self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpx/_client.py", line 1629, in send
    response = await self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpx/_client.py", line 1657, in _send_handling_auth
    response = await self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpx/_client.py", line 1694, in _send_handling_redirects
    response = await self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpx/_client.py", line 1730, in _send_single_request
    response = await transport.handle_async_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpx/_transports/default.py", line 393, in handle_async_request
    with map_httpcore_exceptions():
         ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/contextlib.py", line 158, in __exit__
    self.gen.throw(value)
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpx/_transports/default.py", line 118, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ReadTimeout
2025-10-10 11:59:21,249 - mcp_server - INFO - Request data: stdio_main: {'jsonrpc': '2.0', 'error': {'code': -32000, 'message': 'Server error', 'data': 'An unexpected error occurred. See logs for details.'}, 'id': 4}
2025-10-10 11:59:21,249 - mcp_server - INFO - Request data: stdio_main json: {"jsonrpc": "2.0", "error": {"code": -32000, "message": "Server error", "data": "An unexpected error occurred. See logs for details."}, "id": 4}
2025-10-10 12:00:59,408 - mcp_server - INFO - Client call: {"method": "tools/call", "params": {"name": "search_logs", "arguments": {"end_time": "now", "topic": "hashicorp.platform.audit", "start_time": "8 days ago", "organization_id": "11eab4a9-75f1-e0a5-8be1-0242ac110016"}}, "jsonrpc": "2.0", "id": 5}
2025-10-10 12:01:05,241 - mcp_server - ERROR - An unexpected error occurred: 
Traceback (most recent call last):
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpx/_transports/default.py", line 101, in map_httpcore_exceptions
    yield
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpx/_transports/default.py", line 394, in handle_async_request
    resp = await self._pool.handle_async_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpcore/_async/connection_pool.py", line 256, in handle_async_request
    raise exc from None
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpcore/_async/connection_pool.py", line 236, in handle_async_request
    response = await connection.handle_async_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpcore/_async/connection.py", line 103, in handle_async_request
    return await self._connection.handle_async_request(request)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpcore/_async/http11.py", line 136, in handle_async_request
    raise exc
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpcore/_async/http11.py", line 106, in handle_async_request
    ) = await self._receive_response_headers(**kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpcore/_async/http11.py", line 177, in _receive_response_headers
    event = await self._receive_event(timeout=timeout)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpcore/_async/http11.py", line 217, in _receive_event
    data = await self._network_stream.read(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpcore/_backends/anyio.py", line 32, in read
    with map_exceptions(exc_map):
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/contextlib.py", line 158, in __exit__
    self.gen.throw(value)
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ReadTimeout

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/tpowell/Documents/workspace/hcp_mcp_server/main.py", line 174, in process_mcp_request
    result = await TOOL_MAP[tool_name](**arguments)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/Documents/workspace/hcp_mcp_server/hcp/audit_logs.py", line 81, in search_logs
    response = await client.post(
               ^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpx/_client.py", line 1859, in post
    return await self.request(
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpx/_client.py", line 1540, in request
    return await self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpx/_client.py", line 1629, in send
    response = await self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpx/_client.py", line 1657, in _send_handling_auth
    response = await self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpx/_client.py", line 1694, in _send_handling_redirects
    response = await self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpx/_client.py", line 1730, in _send_single_request
    response = await transport.handle_async_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpx/_transports/default.py", line 393, in handle_async_request
    with map_httpcore_exceptions():
         ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/contextlib.py", line 158, in __exit__
    self.gen.throw(value)
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpx/_transports/default.py", line 118, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ReadTimeout
2025-10-10 12:01:05,244 - mcp_server - INFO - Request data: stdio_main: {'jsonrpc': '2.0', 'error': {'code': -32000, 'message': 'Server error', 'data': 'An unexpected error occurred. See logs for details.'}, 'id': 5}
2025-10-10 12:01:05,244 - mcp_server - INFO - Request data: stdio_main json: {"jsonrpc": "2.0", "error": {"code": -32000, "message": "Server error", "data": "An unexpected error occurred. See logs for details."}, "id": 5}
2025-10-10 15:45:16,271 - mcp_server - INFO - Client call: {"method": "tools/call", "params": {"name": "search_logs", "arguments": {"organization_id": "11eab4a9-75f1-e0a5-8be1-0242ac110016", "end_time": "now", "topic": "hashicorp.platform.audit", "start_time": "4 days ago"}}, "jsonrpc": "2.0", "id": 6}
2025-10-10 15:45:20,092 - mcp_server - INFO - Tool request data: {'streams': {'entries': [{'id': '122f81e8-22e6-4904-93b9-66bc619eabfe', 'timestamp': '2025-10-10T08:56:52.023953993Z', 'stream': {'organization_id': '11eab4a9-75f1-e0a5-8be1-0242ac110016', 'project_id': '11eab4a9-760d-c9f2-adc9-0242ac11000a', 'topic': 'hashicorp.platform.audit'}, 'resource': None, 'control_plane_event': {'request_info': {'http_verb': 'POST', 'http_path': '/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive', 'http_user_agent': 'HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (1f2925d)', 'http_client_ip': '35.91.140.117'}, 'authentication_info': {'principal': None, 'service_principal_delegation_chain': []}, 'authorization_info': [], 'metadata': {'cluster_id': 'vault-cluster'}, 'operation_info': {'operation_id': ''}, 'description': 'Host Manager Alive Requested', 'action': 'CREATE', 'status_code': 'OK'}, 'subject': None}, {'id': '02427d1f-9e48-4055-9eeb-1f938f6ca429', 'timestamp': '2025-10-10T08:56:50.585409396Z', 'stream': {'organization_id': '11eab4a9-75f1-e0a5-8be1-0242ac110016', 'project_id': '11eab4a9-760d-c9f2-adc9-0242ac11000a', 'topic': 'hashicorp.platform.audit'}, 'resource': None, 'control_plane_event': {'request_info': {'http_verb': 'POST', 'http_path': '/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive', 'http_user_agent': 'HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (1f2925d)', 'http_client_ip': '35.87.142.147'}, 'authentication_info': {'principal': None, 'service_principal_delegation_chain': []}, 'authorization_info': [], 'metadata': {'cluster_id': 'vault-cluster'}, 'operation_info': {'operation_id': ''}, 'description': 'Host Manager Alive Requested', 'action': 'CREATE', 'status_code': 'OK'}, 'subject': None}, {'id': '69a76856-4cb0-4609-b574-01b4cdba84d6', 'timestamp': '2025-10-10T08:56:48.565603242Z', 'stream': {'organization_id': '11eab4a9-75f1-e0a5-8be1-0242ac110016', 'project_id': '11eab4a9-760d-c9f2-adc9-0242ac11000a', 'topic': 'hashicorp.platform.audit'}, 'resource': None, 'control_plane_event': {'request_info': {'http_verb': 'POST', 'http_path': '/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive', 'http_user_agent': 'HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (1f2925d)', 'http_client_ip': '54.187.49.218'}, 'authentication_info': {'principal': None, 'service_principal_delegation_chain': []}, 'authorization_info': [], 'metadata': {'cluster_id': 'vault-cluster'}, 'operation_info': {'operation_id': ''}, 'description': 'Host Manager Alive Requested', 'action': 'CREATE', 'status_code': 'OK'}, 'subject': None}, {'id': '08813e54-bd3e-4e42-81a3-daadd2672e7e', 'timestamp': '2025-10-10T06:31:50.900038725Z', 'stream': {'organization_id': '11eab4a9-75f1-e0a5-8be1-0242ac110016', 'project_id': '11eab4a9-760d-c9f2-adc9-0242ac11000a', 'topic': 'hashicorp.platform.audit'}, 'resource': None, 'control_plane_event': {'request_info': {'http_verb': 'POST', 'http_path': '/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster-4/host-alive', 'http_user_agent': 'HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (98d7292)', 'http_client_ip': '54.188.11.180'}, 'authentication_info': {'principal': None, 'service_principal_delegation_chain': []}, 'authorization_info': [], 'metadata': {'cluster_id': 'vault-cluster-4'}, 'operation_info': {'operation_id': ''}, 'description': 'Host Manager Alive Requested', 'action': 'CREATE', 'status_code': 'OK'}, 'subject': None}, {'id': 'bd27928c-ae21-462e-be06-6630a49057d8', 'timestamp': '2025-10-09T20:24:13.287295802Z', 'stream': {'organization_id': '11eab4a9-75f1-e0a5-8be1-0242ac110016', 'project_id': '', 'topic': 'hashicorp.platform.audit'}, 'resource': None, 'control_plane_event': {'request_info': {'http_verb': 'GET', 'http_path': '/consent/complete', 'http_user_agent': '', 'http_client_ip': ''}, 'authentication_info': {'principal': {'id': '5f32f218-a0c0-4191-bd10-f2c1169bcfde', 'type': 'PRINCIPAL_TYPE_USER', 'user': {'id': '5f32f218-a0c0-4191-bd10-f2c1169bcfde', 'email': 'tpowell@hashicorp.com', 'full_name': 'tpowell@hashicorp.com', 'identity_type': 'UNSET', 'identity_types': [], 'subject': '5f32f218-a0c0-4191-bd10-f2c1169bcfde', 'scim_synchronized': False}, 'group_ids': []}, 'service_principal_delegation_chain': []}, 'authorization_info': [], 'metadata': {'email': 'tpowell@hashicorp.com', 'event_type': 'hcp_id_auth_success', 'ip': '73.252.181.35', 'message': 'Authenticated successfully', 'timestamp': '2025-10-09 20:24:12 +0000 UTC', 'user_id': '5f32f218-a0c0-4191-bd10-f2c1169bcfde'}, 'operation_info': {'operation_id': ''}, 'description': 'Authenticated successfully', 'action': 'CREATE', 'status_code': 'OK'}, 'subject': None}, {'id': '0e7bdf42-82d1-422c-9c34-ca0107593c76', 'timestamp': '2025-10-08T06:01:56.587155304Z', 'stream': {'organization_id': '11eab4a9-75f1-e0a5-8be1-0242ac110016', 'project_id': '11eab4a9-760d-c9f2-adc9-0242ac11000a', 'topic': 'hashicorp.platform.audit'}, 'resource': None, 'control_plane_event': {'request_info': {'http_verb': 'POST', 'http_path': '/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster1/host-alive', 'http_user_agent': 'HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (ee02d1c)', 'http_client_ip': '34.221.205.1'}, 'authentication_info': {'principal': None, 'service_principal_delegation_chain': []}, 'authorization_info': [], 'metadata': {'cluster_id': 'vault-cluster1'}, 'operation_info': {'operation_id': ''}, 'description': 'Host Manager Alive Requested', 'action': 'CREATE', 'status_code': 'OK'}, 'subject': None}, {'id': '89634f56-97e0-4ac6-bf39-7dc90a3ab1a1', 'timestamp': '2025-10-07T08:56:55.771365379Z', 'stream': {'organization_id': '11eab4a9-75f1-e0a5-8be1-0242ac110016', 'project_id': '11eab4a9-760d-c9f2-adc9-0242ac11000a', 'topic': 'hashicorp.platform.audit'}, 'resource': None, 'control_plane_event': {'request_info': {'http_verb': 'POST', 'http_path': '/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive', 'http_user_agent': 'HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (bfea313)', 'http_client_ip': '35.90.87.232'}, 'authentication_info': {'principal': None, 'service_principal_delegation_chain': []}, 'authorization_info': [], 'metadata': {'cluster_id': 'vault-cluster'}, 'operation_info': {'operation_id': ''}, 'description': 'Host Manager Alive Requested', 'action': 'CREATE', 'status_code': 'OK'}, 'subject': None}, {'id': '3ee2bab5-e951-4489-ae35-d3a052ab05c3', 'timestamp': '2025-10-07T08:56:49.242102158Z', 'stream': {'organization_id': '11eab4a9-75f1-e0a5-8be1-0242ac110016', 'project_id': '11eab4a9-760d-c9f2-adc9-0242ac11000a', 'topic': 'hashicorp.platform.audit'}, 'resource': None, 'control_plane_event': {'request_info': {'http_verb': 'POST', 'http_path': '/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive', 'http_user_agent': 'HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (bfea313)', 'http_client_ip': '16.144.10.31'}, 'authentication_info': {'principal': None, 'service_principal_delegation_chain': []}, 'authorization_info': [], 'metadata': {'cluster_id': 'vault-cluster'}, 'operation_info': {'operation_id': ''}, 'description': 'Host Manager Alive Requested', 'action': 'CREATE', 'status_code': 'OK'}, 'subject': None}, {'id': '118d591d-5d43-496a-8cfd-f377861a82a3', 'timestamp': '2025-10-07T08:56:48.074774296Z', 'stream': {'organization_id': '11eab4a9-75f1-e0a5-8be1-0242ac110016', 'project_id': '11eab4a9-760d-c9f2-adc9-0242ac11000a', 'topic': 'hashicorp.platform.audit'}, 'resource': None, 'control_plane_event': {'request_info': {'http_verb': 'POST', 'http_path': '/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive', 'http_user_agent': 'HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (bfea313)', 'http_client_ip': '34.216.173.150'}, 'authentication_info': {'principal': None, 'service_principal_delegation_chain': []}, 'authorization_info': [], 'metadata': {'cluster_id': 'vault-cluster'}, 'operation_info': {'operation_id': ''}, 'description': 'Host Manager Alive Requested', 'action': 'CREATE', 'status_code': 'OK'}, 'subject': None}, {'id': '490c67cd-67c2-4365-a3fe-55741bc09bf0', 'timestamp': '2025-10-07T06:31:50.875751353Z', 'stream': {'organization_id': '11eab4a9-75f1-e0a5-8be1-0242ac110016', 'project_id': '11eab4a9-760d-c9f2-adc9-0242ac11000a', 'topic': 'hashicorp.platform.audit'}, 'resource': None, 'control_plane_event': {'request_info': {'http_verb': 'POST', 'http_path': '/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster-4/host-alive', 'http_user_agent': 'HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (bfea313)', 'http_client_ip': '54.200.13.172'}, 'authentication_info': {'principal': None, 'service_principal_delegation_chain': []}, 'authorization_info': [], 'metadata': {'cluster_id': 'vault-cluster-4'}, 'operation_info': {'operation_id': ''}, 'description': 'Host Manager Alive Requested', 'action': 'CREATE', 'status_code': 'OK'}, 'subject': None}]}, 'next_page_token': 'eyJ0aW1lc3RhbXAiOiIyMDI1LTEwLTA3VDA2OjMxOjUwLjg3NTc1MTM1M1oiLCJpZCI6IjQ5MGM2N2NkLTY3YzItNDM2NS1hM2ZlLTU1NzQxYmMwOWJmMCIsIm9mZnNldCI6MX0='}
2025-10-10 15:45:20,093 - mcp_server - INFO - Request data: stdio_main: {'jsonrpc': '2.0', 'result': {'content': [{'type': 'text', 'text': '{"streams": {"entries": [{"id": "122f81e8-22e6-4904-93b9-66bc619eabfe", "timestamp": "2025-10-10T08:56:52.023953993Z", "stream": {"organization_id": "11eab4a9-75f1-e0a5-8be1-0242ac110016", "project_id": "11eab4a9-760d-c9f2-adc9-0242ac11000a", "topic": "hashicorp.platform.audit"}, "resource": null, "control_plane_event": {"request_info": {"http_verb": "POST", "http_path": "/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive", "http_user_agent": "HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (1f2925d)", "http_client_ip": "35.91.140.117"}, "authentication_info": {"principal": null, "service_principal_delegation_chain": []}, "authorization_info": [], "metadata": {"cluster_id": "vault-cluster"}, "operation_info": {"operation_id": ""}, "description": "Host Manager Alive Requested", "action": "CREATE", "status_code": "OK"}, "subject": null}, {"id": "02427d1f-9e48-4055-9eeb-1f938f6ca429", "timestamp": "2025-10-10T08:56:50.585409396Z", "stream": {"organization_id": "11eab4a9-75f1-e0a5-8be1-0242ac110016", "project_id": "11eab4a9-760d-c9f2-adc9-0242ac11000a", "topic": "hashicorp.platform.audit"}, "resource": null, "control_plane_event": {"request_info": {"http_verb": "POST", "http_path": "/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive", "http_user_agent": "HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (1f2925d)", "http_client_ip": "35.87.142.147"}, "authentication_info": {"principal": null, "service_principal_delegation_chain": []}, "authorization_info": [], "metadata": {"cluster_id": "vault-cluster"}, "operation_info": {"operation_id": ""}, "description": "Host Manager Alive Requested", "action": "CREATE", "status_code": "OK"}, "subject": null}, {"id": "69a76856-4cb0-4609-b574-01b4cdba84d6", "timestamp": "2025-10-10T08:56:48.565603242Z", "stream": {"organization_id": "11eab4a9-75f1-e0a5-8be1-0242ac110016", "project_id": "11eab4a9-760d-c9f2-adc9-0242ac11000a", "topic": "hashicorp.platform.audit"}, "resource": null, "control_plane_event": {"request_info": {"http_verb": "POST", "http_path": "/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive", "http_user_agent": "HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (1f2925d)", "http_client_ip": "54.187.49.218"}, "authentication_info": {"principal": null, "service_principal_delegation_chain": []}, "authorization_info": [], "metadata": {"cluster_id": "vault-cluster"}, "operation_info": {"operation_id": ""}, "description": "Host Manager Alive Requested", "action": "CREATE", "status_code": "OK"}, "subject": null}, {"id": "08813e54-bd3e-4e42-81a3-daadd2672e7e", "timestamp": "2025-10-10T06:31:50.900038725Z", "stream": {"organization_id": "11eab4a9-75f1-e0a5-8be1-0242ac110016", "project_id": "11eab4a9-760d-c9f2-adc9-0242ac11000a", "topic": "hashicorp.platform.audit"}, "resource": null, "control_plane_event": {"request_info": {"http_verb": "POST", "http_path": "/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster-4/host-alive", "http_user_agent": "HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (98d7292)", "http_client_ip": "54.188.11.180"}, "authentication_info": {"principal": null, "service_principal_delegation_chain": []}, "authorization_info": [], "metadata": {"cluster_id": "vault-cluster-4"}, "operation_info": {"operation_id": ""}, "description": "Host Manager Alive Requested", "action": "CREATE", "status_code": "OK"}, "subject": null}, {"id": "bd27928c-ae21-462e-be06-6630a49057d8", "timestamp": "2025-10-09T20:24:13.287295802Z", "stream": {"organization_id": "11eab4a9-75f1-e0a5-8be1-0242ac110016", "project_id": "", "topic": "hashicorp.platform.audit"}, "resource": null, "control_plane_event": {"request_info": {"http_verb": "GET", "http_path": "/consent/complete", "http_user_agent": "", "http_client_ip": ""}, "authentication_info": {"principal": {"id": "5f32f218-a0c0-4191-bd10-f2c1169bcfde", "type": "PRINCIPAL_TYPE_USER", "user": {"id": "5f32f218-a0c0-4191-bd10-f2c1169bcfde", "email": "tpowell@hashicorp.com", "full_name": "tpowell@hashicorp.com", "identity_type": "UNSET", "identity_types": [], "subject": "5f32f218-a0c0-4191-bd10-f2c1169bcfde", "scim_synchronized": false}, "group_ids": []}, "service_principal_delegation_chain": []}, "authorization_info": [], "metadata": {"email": "tpowell@hashicorp.com", "event_type": "hcp_id_auth_success", "ip": "73.252.181.35", "message": "Authenticated successfully", "timestamp": "2025-10-09 20:24:12 +0000 UTC", "user_id": "5f32f218-a0c0-4191-bd10-f2c1169bcfde"}, "operation_info": {"operation_id": ""}, "description": "Authenticated successfully", "action": "CREATE", "status_code": "OK"}, "subject": null}, {"id": "0e7bdf42-82d1-422c-9c34-ca0107593c76", "timestamp": "2025-10-08T06:01:56.587155304Z", "stream": {"organization_id": "11eab4a9-75f1-e0a5-8be1-0242ac110016", "project_id": "11eab4a9-760d-c9f2-adc9-0242ac11000a", "topic": "hashicorp.platform.audit"}, "resource": null, "control_plane_event": {"request_info": {"http_verb": "POST", "http_path": "/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster1/host-alive", "http_user_agent": "HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (ee02d1c)", "http_client_ip": "34.221.205.1"}, "authentication_info": {"principal": null, "service_principal_delegation_chain": []}, "authorization_info": [], "metadata": {"cluster_id": "vault-cluster1"}, "operation_info": {"operation_id": ""}, "description": "Host Manager Alive Requested", "action": "CREATE", "status_code": "OK"}, "subject": null}, {"id": "89634f56-97e0-4ac6-bf39-7dc90a3ab1a1", "timestamp": "2025-10-07T08:56:55.771365379Z", "stream": {"organization_id": "11eab4a9-75f1-e0a5-8be1-0242ac110016", "project_id": "11eab4a9-760d-c9f2-adc9-0242ac11000a", "topic": "hashicorp.platform.audit"}, "resource": null, "control_plane_event": {"request_info": {"http_verb": "POST", "http_path": "/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive", "http_user_agent": "HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (bfea313)", "http_client_ip": "35.90.87.232"}, "authentication_info": {"principal": null, "service_principal_delegation_chain": []}, "authorization_info": [], "metadata": {"cluster_id": "vault-cluster"}, "operation_info": {"operation_id": ""}, "description": "Host Manager Alive Requested", "action": "CREATE", "status_code": "OK"}, "subject": null}, {"id": "3ee2bab5-e951-4489-ae35-d3a052ab05c3", "timestamp": "2025-10-07T08:56:49.242102158Z", "stream": {"organization_id": "11eab4a9-75f1-e0a5-8be1-0242ac110016", "project_id": "11eab4a9-760d-c9f2-adc9-0242ac11000a", "topic": "hashicorp.platform.audit"}, "resource": null, "control_plane_event": {"request_info": {"http_verb": "POST", "http_path": "/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive", "http_user_agent": "HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (bfea313)", "http_client_ip": "16.144.10.31"}, "authentication_info": {"principal": null, "service_principal_delegation_chain": []}, "authorization_info": [], "metadata": {"cluster_id": "vault-cluster"}, "operation_info": {"operation_id": ""}, "description": "Host Manager Alive Requested", "action": "CREATE", "status_code": "OK"}, "subject": null}, {"id": "118d591d-5d43-496a-8cfd-f377861a82a3", "timestamp": "2025-10-07T08:56:48.074774296Z", "stream": {"organization_id": "11eab4a9-75f1-e0a5-8be1-0242ac110016", "project_id": "11eab4a9-760d-c9f2-adc9-0242ac11000a", "topic": "hashicorp.platform.audit"}, "resource": null, "control_plane_event": {"request_info": {"http_verb": "POST", "http_path": "/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive", "http_user_agent": "HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (bfea313)", "http_client_ip": "34.216.173.150"}, "authentication_info": {"principal": null, "service_principal_delegation_chain": []}, "authorization_info": [], "metadata": {"cluster_id": "vault-cluster"}, "operation_info": {"operation_id": ""}, "description": "Host Manager Alive Requested", "action": "CREATE", "status_code": "OK"}, "subject": null}, {"id": "490c67cd-67c2-4365-a3fe-55741bc09bf0", "timestamp": "2025-10-07T06:31:50.875751353Z", "stream": {"organization_id": "11eab4a9-75f1-e0a5-8be1-0242ac110016", "project_id": "11eab4a9-760d-c9f2-adc9-0242ac11000a", "topic": "hashicorp.platform.audit"}, "resource": null, "control_plane_event": {"request_info": {"http_verb": "POST", "http_path": "/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster-4/host-alive", "http_user_agent": "HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (bfea313)", "http_client_ip": "54.200.13.172"}, "authentication_info": {"principal": null, "service_principal_delegation_chain": []}, "authorization_info": [], "metadata": {"cluster_id": "vault-cluster-4"}, "operation_info": {"operation_id": ""}, "description": "Host Manager Alive Requested", "action": "CREATE", "status_code": "OK"}, "subject": null}]}, "next_page_token": "eyJ0aW1lc3RhbXAiOiIyMDI1LTEwLTA3VDA2OjMxOjUwLjg3NTc1MTM1M1oiLCJpZCI6IjQ5MGM2N2NkLTY3YzItNDM2NS1hM2ZlLTU1NzQxYmMwOWJmMCIsIm9mZnNldCI6MX0="}'}], 'isError': False}, 'id': 6}
2025-10-10 15:45:20,093 - mcp_server - INFO - Request data: stdio_main json: {"jsonrpc": "2.0", "result": {"content": [{"type": "text", "text": "{\"streams\": {\"entries\": [{\"id\": \"122f81e8-22e6-4904-93b9-66bc619eabfe\", \"timestamp\": \"2025-10-10T08:56:52.023953993Z\", \"stream\": {\"organization_id\": \"11eab4a9-75f1-e0a5-8be1-0242ac110016\", \"project_id\": \"11eab4a9-760d-c9f2-adc9-0242ac11000a\", \"topic\": \"hashicorp.platform.audit\"}, \"resource\": null, \"control_plane_event\": {\"request_info\": {\"http_verb\": \"POST\", \"http_path\": \"/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive\", \"http_user_agent\": \"HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (1f2925d)\", \"http_client_ip\": \"35.91.140.117\"}, \"authentication_info\": {\"principal\": null, \"service_principal_delegation_chain\": []}, \"authorization_info\": [], \"metadata\": {\"cluster_id\": \"vault-cluster\"}, \"operation_info\": {\"operation_id\": \"\"}, \"description\": \"Host Manager Alive Requested\", \"action\": \"CREATE\", \"status_code\": \"OK\"}, \"subject\": null}, {\"id\": \"02427d1f-9e48-4055-9eeb-1f938f6ca429\", \"timestamp\": \"2025-10-10T08:56:50.585409396Z\", \"stream\": {\"organization_id\": \"11eab4a9-75f1-e0a5-8be1-0242ac110016\", \"project_id\": \"11eab4a9-760d-c9f2-adc9-0242ac11000a\", \"topic\": \"hashicorp.platform.audit\"}, \"resource\": null, \"control_plane_event\": {\"request_info\": {\"http_verb\": \"POST\", \"http_path\": \"/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive\", \"http_user_agent\": \"HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (1f2925d)\", \"http_client_ip\": \"35.87.142.147\"}, \"authentication_info\": {\"principal\": null, \"service_principal_delegation_chain\": []}, \"authorization_info\": [], \"metadata\": {\"cluster_id\": \"vault-cluster\"}, \"operation_info\": {\"operation_id\": \"\"}, \"description\": \"Host Manager Alive Requested\", \"action\": \"CREATE\", \"status_code\": \"OK\"}, \"subject\": null}, {\"id\": \"69a76856-4cb0-4609-b574-01b4cdba84d6\", \"timestamp\": \"2025-10-10T08:56:48.565603242Z\", \"stream\": {\"organization_id\": \"11eab4a9-75f1-e0a5-8be1-0242ac110016\", \"project_id\": \"11eab4a9-760d-c9f2-adc9-0242ac11000a\", \"topic\": \"hashicorp.platform.audit\"}, \"resource\": null, \"control_plane_event\": {\"request_info\": {\"http_verb\": \"POST\", \"http_path\": \"/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive\", \"http_user_agent\": \"HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (1f2925d)\", \"http_client_ip\": \"54.187.49.218\"}, \"authentication_info\": {\"principal\": null, \"service_principal_delegation_chain\": []}, \"authorization_info\": [], \"metadata\": {\"cluster_id\": \"vault-cluster\"}, \"operation_info\": {\"operation_id\": \"\"}, \"description\": \"Host Manager Alive Requested\", \"action\": \"CREATE\", \"status_code\": \"OK\"}, \"subject\": null}, {\"id\": \"08813e54-bd3e-4e42-81a3-daadd2672e7e\", \"timestamp\": \"2025-10-10T06:31:50.900038725Z\", \"stream\": {\"organization_id\": \"11eab4a9-75f1-e0a5-8be1-0242ac110016\", \"project_id\": \"11eab4a9-760d-c9f2-adc9-0242ac11000a\", \"topic\": \"hashicorp.platform.audit\"}, \"resource\": null, \"control_plane_event\": {\"request_info\": {\"http_verb\": \"POST\", \"http_path\": \"/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster-4/host-alive\", \"http_user_agent\": \"HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (98d7292)\", \"http_client_ip\": \"54.188.11.180\"}, \"authentication_info\": {\"principal\": null, \"service_principal_delegation_chain\": []}, \"authorization_info\": [], \"metadata\": {\"cluster_id\": \"vault-cluster-4\"}, \"operation_info\": {\"operation_id\": \"\"}, \"description\": \"Host Manager Alive Requested\", \"action\": \"CREATE\", \"status_code\": \"OK\"}, \"subject\": null}, {\"id\": \"bd27928c-ae21-462e-be06-6630a49057d8\", \"timestamp\": \"2025-10-09T20:24:13.287295802Z\", \"stream\": {\"organization_id\": \"11eab4a9-75f1-e0a5-8be1-0242ac110016\", \"project_id\": \"\", \"topic\": \"hashicorp.platform.audit\"}, \"resource\": null, \"control_plane_event\": {\"request_info\": {\"http_verb\": \"GET\", \"http_path\": \"/consent/complete\", \"http_user_agent\": \"\", \"http_client_ip\": \"\"}, \"authentication_info\": {\"principal\": {\"id\": \"5f32f218-a0c0-4191-bd10-f2c1169bcfde\", \"type\": \"PRINCIPAL_TYPE_USER\", \"user\": {\"id\": \"5f32f218-a0c0-4191-bd10-f2c1169bcfde\", \"email\": \"tpowell@hashicorp.com\", \"full_name\": \"tpowell@hashicorp.com\", \"identity_type\": \"UNSET\", \"identity_types\": [], \"subject\": \"5f32f218-a0c0-4191-bd10-f2c1169bcfde\", \"scim_synchronized\": false}, \"group_ids\": []}, \"service_principal_delegation_chain\": []}, \"authorization_info\": [], \"metadata\": {\"email\": \"tpowell@hashicorp.com\", \"event_type\": \"hcp_id_auth_success\", \"ip\": \"73.252.181.35\", \"message\": \"Authenticated successfully\", \"timestamp\": \"2025-10-09 20:24:12 +0000 UTC\", \"user_id\": \"5f32f218-a0c0-4191-bd10-f2c1169bcfde\"}, \"operation_info\": {\"operation_id\": \"\"}, \"description\": \"Authenticated successfully\", \"action\": \"CREATE\", \"status_code\": \"OK\"}, \"subject\": null}, {\"id\": \"0e7bdf42-82d1-422c-9c34-ca0107593c76\", \"timestamp\": \"2025-10-08T06:01:56.587155304Z\", \"stream\": {\"organization_id\": \"11eab4a9-75f1-e0a5-8be1-0242ac110016\", \"project_id\": \"11eab4a9-760d-c9f2-adc9-0242ac11000a\", \"topic\": \"hashicorp.platform.audit\"}, \"resource\": null, \"control_plane_event\": {\"request_info\": {\"http_verb\": \"POST\", \"http_path\": \"/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster1/host-alive\", \"http_user_agent\": \"HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (ee02d1c)\", \"http_client_ip\": \"34.221.205.1\"}, \"authentication_info\": {\"principal\": null, \"service_principal_delegation_chain\": []}, \"authorization_info\": [], \"metadata\": {\"cluster_id\": \"vault-cluster1\"}, \"operation_info\": {\"operation_id\": \"\"}, \"description\": \"Host Manager Alive Requested\", \"action\": \"CREATE\", \"status_code\": \"OK\"}, \"subject\": null}, {\"id\": \"89634f56-97e0-4ac6-bf39-7dc90a3ab1a1\", \"timestamp\": \"2025-10-07T08:56:55.771365379Z\", \"stream\": {\"organization_id\": \"11eab4a9-75f1-e0a5-8be1-0242ac110016\", \"project_id\": \"11eab4a9-760d-c9f2-adc9-0242ac11000a\", \"topic\": \"hashicorp.platform.audit\"}, \"resource\": null, \"control_plane_event\": {\"request_info\": {\"http_verb\": \"POST\", \"http_path\": \"/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive\", \"http_user_agent\": \"HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (bfea313)\", \"http_client_ip\": \"35.90.87.232\"}, \"authentication_info\": {\"principal\": null, \"service_principal_delegation_chain\": []}, \"authorization_info\": [], \"metadata\": {\"cluster_id\": \"vault-cluster\"}, \"operation_info\": {\"operation_id\": \"\"}, \"description\": \"Host Manager Alive Requested\", \"action\": \"CREATE\", \"status_code\": \"OK\"}, \"subject\": null}, {\"id\": \"3ee2bab5-e951-4489-ae35-d3a052ab05c3\", \"timestamp\": \"2025-10-07T08:56:49.242102158Z\", \"stream\": {\"organization_id\": \"11eab4a9-75f1-e0a5-8be1-0242ac110016\", \"project_id\": \"11eab4a9-760d-c9f2-adc9-0242ac11000a\", \"topic\": \"hashicorp.platform.audit\"}, \"resource\": null, \"control_plane_event\": {\"request_info\": {\"http_verb\": \"POST\", \"http_path\": \"/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive\", \"http_user_agent\": \"HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (bfea313)\", \"http_client_ip\": \"16.144.10.31\"}, \"authentication_info\": {\"principal\": null, \"service_principal_delegation_chain\": []}, \"authorization_info\": [], \"metadata\": {\"cluster_id\": \"vault-cluster\"}, \"operation_info\": {\"operation_id\": \"\"}, \"description\": \"Host Manager Alive Requested\", \"action\": \"CREATE\", \"status_code\": \"OK\"}, \"subject\": null}, {\"id\": \"118d591d-5d43-496a-8cfd-f377861a82a3\", \"timestamp\": \"2025-10-07T08:56:48.074774296Z\", \"stream\": {\"organization_id\": \"11eab4a9-75f1-e0a5-8be1-0242ac110016\", \"project_id\": \"11eab4a9-760d-c9f2-adc9-0242ac11000a\", \"topic\": \"hashicorp.platform.audit\"}, \"resource\": null, \"control_plane_event\": {\"request_info\": {\"http_verb\": \"POST\", \"http_path\": \"/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive\", \"http_user_agent\": \"HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (bfea313)\", \"http_client_ip\": \"34.216.173.150\"}, \"authentication_info\": {\"principal\": null, \"service_principal_delegation_chain\": []}, \"authorization_info\": [], \"metadata\": {\"cluster_id\": \"vault-cluster\"}, \"operation_info\": {\"operation_id\": \"\"}, \"description\": \"Host Manager Alive Requested\", \"action\": \"CREATE\", \"status_code\": \"OK\"}, \"subject\": null}, {\"id\": \"490c67cd-67c2-4365-a3fe-55741bc09bf0\", \"timestamp\": \"2025-10-07T06:31:50.875751353Z\", \"stream\": {\"organization_id\": \"11eab4a9-75f1-e0a5-8be1-0242ac110016\", \"project_id\": \"11eab4a9-760d-c9f2-adc9-0242ac11000a\", \"topic\": \"hashicorp.platform.audit\"}, \"resource\": null, \"control_plane_event\": {\"request_info\": {\"http_verb\": \"POST\", \"http_path\": \"/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster-4/host-alive\", \"http_user_agent\": \"HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (bfea313)\", \"http_client_ip\": \"54.200.13.172\"}, \"authentication_info\": {\"principal\": null, \"service_principal_delegation_chain\": []}, \"authorization_info\": [], \"metadata\": {\"cluster_id\": \"vault-cluster-4\"}, \"operation_info\": {\"operation_id\": \"\"}, \"description\": \"Host Manager Alive Requested\", \"action\": \"CREATE\", \"status_code\": \"OK\"}, \"subject\": null}]}, \"next_page_token\": \"eyJ0aW1lc3RhbXAiOiIyMDI1LTEwLTA3VDA2OjMxOjUwLjg3NTc1MTM1M1oiLCJpZCI6IjQ5MGM2N2NkLTY3YzItNDM2NS1hM2ZlLTU1NzQxYmMwOWJmMCIsIm9mZnNldCI6MX0=\"}"}], "isError": false}, "id": 6}
2025-10-10 15:47:00,796 - mcp_server - INFO - Received request: {"method": "initialize", "params": {"protocolVersion": "2025-06-18", "capabilities": {"roots": {}}, "clientInfo": {"name": "gemini-cli-mcp-client-HCP", "version": "0.0.1"}}, "jsonrpc": "2.0", "id": 0}
2025-10-10 15:47:00,796 - mcp_server - INFO - Request data: stdio_main: {'jsonrpc': '2.0', 'result': {'protocolVersion': '2024-11-05', 'serverInfo': {'name': 'HCP', 'version': '0.0.1'}, 'capabilities': {'tools': {'listChanged': True}, 'prompts': {'listChanged': True}, 'resources': {'listChanged': True}}}, 'id': 0}
2025-10-10 15:47:00,797 - mcp_server - INFO - Request data: stdio_main json: {"jsonrpc": "2.0", "result": {"protocolVersion": "2024-11-05", "serverInfo": {"name": "HCP", "version": "0.0.1"}, "capabilities": {"tools": {"listChanged": true}, "prompts": {"listChanged": true}, "resources": {"listChanged": true}}}, "id": 0}
2025-10-10 15:47:00,797 - mcp_server - INFO - Received request: {"method": "notifications/initialized", "jsonrpc": "2.0"}
2025-10-10 15:47:00,797 - mcp_server - INFO - Client initialized.
2025-10-10 15:47:00,797 - mcp_server - INFO - Received request: {"method": "prompts/list", "params": {}, "jsonrpc": "2.0", "id": 1}
2025-10-10 15:47:00,797 - mcp_server - INFO - Request data: stdio_main: {'jsonrpc': '2.0', 'result': {'prompts': [{'name': 'list_projects', 'title': 'List Projects', 'description': 'Lists all HCP projects for a given organization.', 'arguments': [{'name': 'organization_id', 'description': 'The ID of the organization.', 'required': True}]}, {'name': 'get_project', 'title': 'Get Project', 'description': 'Gets an HCP project by its ID.', 'arguments': [{'name': 'project_id', 'description': 'The ID of the project.', 'required': True}]}, {'name': 'delete_project', 'title': 'Delete Project', 'description': 'Deletes an HCP project by its ID.', 'arguments': [{'name': 'project_id', 'description': 'The ID of the project.', 'required': True}]}, {'name': 'create_project', 'title': 'Create Project', 'description': 'Creates a new HCP project.', 'arguments': [{'name': 'name', 'description': 'The name of the new project.', 'required': True}, {'name': 'organization_id', 'description': 'The ID of the organization.', 'required': True}]}, {'name': 'update_project', 'title': 'Update Project', 'description': 'Updates an HCP project.', 'arguments': [{'name': 'project_id', 'description': 'The ID of the project.', 'required': True}, {'name': 'name', 'description': 'The new name for the project.', 'required': True}, {'name': 'organization_id', 'description': 'The ID of the organization.', 'required': True}]}, {'name': 'get_organization', 'title': 'Get Organization', 'description': 'Gets an HCP organization by its ID.', 'arguments': [{'name': 'organization_id', 'description': 'The ID of the organization.', 'required': True}]}, {'name': 'list_organizations', 'title': 'List Organizations', 'description': 'Lists all HCP organizations.', 'arguments': None}, {'name': 'update_organization', 'title': 'Update Organization', 'description': 'Updates an HCP organization.', 'arguments': [{'name': 'organization_id', 'description': 'The ID of the organization.', 'required': True}, {'name': 'name', 'description': 'The new name for the organization.', 'required': True}]}, {'name': 'list_secrets', 'title': 'List Secrets', 'description': 'Lists all secrets for a given application.', 'arguments': [{'name': 'project_id', 'description': 'The ID of the project.', 'required': True}, {'name': 'app_name', 'description': 'The name of the application.', 'required': True}]}, {'name': 'get_secret', 'title': 'Get Secret', 'description': 'Gets a secret by its name.', 'arguments': [{'name': 'secret_name', 'description': 'The name of the secret.', 'required': True}, {'name': 'project_id', 'description': 'The ID of the project.', 'required': True}, {'name': 'app_name', 'description': 'The name of the application.', 'required': True}]}, {'name': 'delete_secret', 'title': 'Delete Secret', 'description': 'Deletes a secret by its name.', 'arguments': [{'name': 'secret_name', 'description': 'The name of the secret.', 'required': True}, {'name': 'project_id', 'description': 'The ID of the project.', 'required': True}, {'name': 'app_name', 'description': 'The name of the application.', 'required': True}]}, {'name': 'create_secret', 'title': 'Create Secret', 'description': 'Creates a new secret.', 'arguments': [{'name': 'secret_name', 'description': 'The name of the new secret.', 'required': True}, {'name': 'secret_value', 'description': 'The value of the new secret.', 'required': True}, {'name': 'project_id', 'description': 'The ID of the project.', 'required': True}, {'name': 'app_name', 'description': 'The name of the application.', 'required': True}]}, {'name': 'find_project_and_list_secrets', 'title': 'Find Project and List Secrets', 'description': 'Finds a project by name and lists its secrets.', 'arguments': [{'name': 'project_name', 'description': 'The name of the project.', 'required': True}, {'name': 'organization_id', 'description': 'The ID of the organization.', 'required': True}, {'name': 'app_name', 'description': 'The name of the application.', 'required': True}]}, {'name': 'list_resources', 'title': 'List Resources', 'description': 'Lists all resources in a project.', 'arguments': [{'name': 'project_id', 'description': 'The ID of the project.', 'required': True}]}, {'name': 'search_logs', 'title': 'Search Logs', 'description': 'Searches for audit logs in an organization using LogQL. The LLM should determine the best topic to use based on the user\'s query, or default to \'hashicorp.platform.audit\' if the user is not specific. For advanced filtering, use the `query` parameter with LogQL syntax. To filter on specific JSON fields in the log entries, use the `| json` parser in your query. For example: `query=\'| json | control_plane_event_action="CREATE"\'`', 'arguments': [{'name': 'organization_id', 'description': 'The ID of the organization.', 'required': True}, {'name': 'query', 'description': 'The LogQL query string for advanced filtering. Can be combined with `project_id` and `topic`. Example: \'| json | resource_uuid="some-uuid"\'', 'required': False}, {'name': 'project_id', 'description': 'A project ID to filter by.', 'required': False}, {'name': 'topic', 'description': "A log topic to search. Example topics: 'hashicorp.platform.audit', 'hashicorp.packer.registry.audit', 'hashicorp.boundary.cluster.audit', 'hashicorp.consul.cluster.audit'", 'required': True}, {'name': 'start_time', 'description': "The start time for the search. Accepts formats like '24 hours ago', 'yesterday at 5pm', or 'Oct 1, 2025'.", 'required': True}, {'name': 'end_time', 'description': "The end time for the search. Accepts formats like 'now', 'today', or 'Oct 3, 2025'.", 'required': True}]}]}, 'id': 1}
2025-10-10 15:47:00,797 - mcp_server - INFO - Request data: stdio_main json: {"jsonrpc": "2.0", "result": {"prompts": [{"name": "list_projects", "title": "List Projects", "description": "Lists all HCP projects for a given organization.", "arguments": [{"name": "organization_id", "description": "The ID of the organization.", "required": true}]}, {"name": "get_project", "title": "Get Project", "description": "Gets an HCP project by its ID.", "arguments": [{"name": "project_id", "description": "The ID of the project.", "required": true}]}, {"name": "delete_project", "title": "Delete Project", "description": "Deletes an HCP project by its ID.", "arguments": [{"name": "project_id", "description": "The ID of the project.", "required": true}]}, {"name": "create_project", "title": "Create Project", "description": "Creates a new HCP project.", "arguments": [{"name": "name", "description": "The name of the new project.", "required": true}, {"name": "organization_id", "description": "The ID of the organization.", "required": true}]}, {"name": "update_project", "title": "Update Project", "description": "Updates an HCP project.", "arguments": [{"name": "project_id", "description": "The ID of the project.", "required": true}, {"name": "name", "description": "The new name for the project.", "required": true}, {"name": "organization_id", "description": "The ID of the organization.", "required": true}]}, {"name": "get_organization", "title": "Get Organization", "description": "Gets an HCP organization by its ID.", "arguments": [{"name": "organization_id", "description": "The ID of the organization.", "required": true}]}, {"name": "list_organizations", "title": "List Organizations", "description": "Lists all HCP organizations.", "arguments": null}, {"name": "update_organization", "title": "Update Organization", "description": "Updates an HCP organization.", "arguments": [{"name": "organization_id", "description": "The ID of the organization.", "required": true}, {"name": "name", "description": "The new name for the organization.", "required": true}]}, {"name": "list_secrets", "title": "List Secrets", "description": "Lists all secrets for a given application.", "arguments": [{"name": "project_id", "description": "The ID of the project.", "required": true}, {"name": "app_name", "description": "The name of the application.", "required": true}]}, {"name": "get_secret", "title": "Get Secret", "description": "Gets a secret by its name.", "arguments": [{"name": "secret_name", "description": "The name of the secret.", "required": true}, {"name": "project_id", "description": "The ID of the project.", "required": true}, {"name": "app_name", "description": "The name of the application.", "required": true}]}, {"name": "delete_secret", "title": "Delete Secret", "description": "Deletes a secret by its name.", "arguments": [{"name": "secret_name", "description": "The name of the secret.", "required": true}, {"name": "project_id", "description": "The ID of the project.", "required": true}, {"name": "app_name", "description": "The name of the application.", "required": true}]}, {"name": "create_secret", "title": "Create Secret", "description": "Creates a new secret.", "arguments": [{"name": "secret_name", "description": "The name of the new secret.", "required": true}, {"name": "secret_value", "description": "The value of the new secret.", "required": true}, {"name": "project_id", "description": "The ID of the project.", "required": true}, {"name": "app_name", "description": "The name of the application.", "required": true}]}, {"name": "find_project_and_list_secrets", "title": "Find Project and List Secrets", "description": "Finds a project by name and lists its secrets.", "arguments": [{"name": "project_name", "description": "The name of the project.", "required": true}, {"name": "organization_id", "description": "The ID of the organization.", "required": true}, {"name": "app_name", "description": "The name of the application.", "required": true}]}, {"name": "list_resources", "title": "List Resources", "description": "Lists all resources in a project.", "arguments": [{"name": "project_id", "description": "The ID of the project.", "required": true}]}, {"name": "search_logs", "title": "Search Logs", "description": "Searches for audit logs in an organization using LogQL. The LLM should determine the best topic to use based on the user's query, or default to 'hashicorp.platform.audit' if the user is not specific. For advanced filtering, use the `query` parameter with LogQL syntax. To filter on specific JSON fields in the log entries, use the `| json` parser in your query. For example: `query='| json | control_plane_event_action=\"CREATE\"'`", "arguments": [{"name": "organization_id", "description": "The ID of the organization.", "required": true}, {"name": "query", "description": "The LogQL query string for advanced filtering. Can be combined with `project_id` and `topic`. Example: '| json | resource_uuid=\"some-uuid\"'", "required": false}, {"name": "project_id", "description": "A project ID to filter by.", "required": false}, {"name": "topic", "description": "A log topic to search. Example topics: 'hashicorp.platform.audit', 'hashicorp.packer.registry.audit', 'hashicorp.boundary.cluster.audit', 'hashicorp.consul.cluster.audit'", "required": true}, {"name": "start_time", "description": "The start time for the search. Accepts formats like '24 hours ago', 'yesterday at 5pm', or 'Oct 1, 2025'.", "required": true}, {"name": "end_time", "description": "The end time for the search. Accepts formats like 'now', 'today', or 'Oct 3, 2025'.", "required": true}]}]}, "id": 1}
2025-10-10 15:47:00,798 - mcp_server - INFO - Received request: {"method": "tools/list", "params": {}, "jsonrpc": "2.0", "id": 2}
2025-10-10 15:47:00,798 - mcp_server - INFO - Request data: stdio_main: {'jsonrpc': '2.0', 'result': {'tools': [{'name': 'list_projects', 'description': 'Lists all HCP projects for a given organization.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}}, 'required': ['organization_id']}}, {'name': 'get_project', 'description': 'Gets an HCP project by its ID.', 'inputSchema': {'type': 'object', 'properties': {'project_id': {'type': 'string', 'description': 'The ID of the project.'}}, 'required': ['project_id']}}, {'name': 'delete_project', 'description': 'Deletes an HCP project by its ID.', 'inputSchema': {'type': 'object', 'properties': {'project_id': {'type': 'string', 'description': 'The ID of the project.'}}, 'required': ['project_id']}}, {'name': 'create_project', 'description': 'Creates a new HCP project.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'name': {'type': 'string', 'description': 'The name of the new project.'}}, 'required': ['organization_id', 'name']}}, {'name': 'update_project', 'description': 'Updates an HCP project.', 'inputSchema': {'type': 'object', 'properties': {'project_id': {'type': 'string', 'description': 'The ID of the project.'}, 'name': {'type': 'string', 'description': 'The new name of the project.'}}, 'required': ['project_id', 'name']}}, {'name': 'get_organization', 'description': 'Gets an HCP organization by its ID.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}}, 'required': ['organization_id']}}, {'name': 'list_organizations', 'description': 'Lists all HCP organizations.', 'inputSchema': {'type': 'object', 'properties': {}}}, {'name': 'update_organization', 'description': 'Updates an HCP organization.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'name': {'type': 'string', 'description': 'The new name of the organization.'}}, 'required': ['organization_id', 'name']}}, {'name': 'search_principals', 'description': 'Searches for principals in an organization.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'filter_str': {'type': 'string', 'description': 'The filter string to use for the search.'}}, 'required': ['organization_id']}}, {'name': 'get_principals', 'description': 'Gets principals by their IDs.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'principal_ids': {'type': 'array', 'items': {'type': 'string'}, 'description': 'The IDs of the principals to get.'}}, 'required': ['organization_id', 'principal_ids']}}, {'name': 'delete_service_principal', 'description': 'Deletes a service principal by its ID.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'principal_id': {'type': 'string', 'description': 'The ID of the service principal.'}}, 'required': ['organization_id', 'principal_id']}}, {'name': 'create_service_principal', 'description': 'Creates a new service principal.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'name': {'type': 'string', 'description': 'The name of the new service principal.'}}, 'required': ['organization_id', 'name']}}, {'name': 'update_service_principal', 'description': 'Updates a service principal.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'principal_id': {'type': 'string', 'description': 'The ID of the service principal.'}, 'name': {'type': 'string', 'description': 'The new name of the service principal.'}}, 'required': ['organization_id', 'principal_id', 'name']}}, {'name': 'list_secrets', 'description': 'Lists all secrets for a given application.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'project_id': {'type': 'string', 'description': 'The ID of the project.'}, 'app_name': {'type': 'string', 'description': 'The name of the application.'}}, 'required': ['organization_id', 'project_id', 'app_name']}}, {'name': 'get_secret', 'description': 'Gets a secret by its name.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'project_id': {'type': 'string', 'description': 'The ID of the project.'}, 'app_name': {'type': 'string', 'description': 'The name of the application.'}, 'secret_name': {'type': 'string', 'description': 'The name of the secret.'}}, 'required': ['organization_id', 'project_id', 'app_name', 'secret_name']}}, {'name': 'delete_secret', 'description': 'Deletes a secret by its name.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'project_id': {'type': 'string', 'description': 'The ID of the project.'}, 'app_name': {'type': 'string', 'description': 'The name of the application.'}, 'secret_name': {'type': 'string', 'description': 'The name of the secret.'}}, 'required': ['organization_id', 'project_id', 'app_name', 'secret_name']}}, {'name': 'create_secret', 'description': 'Creates a new secret.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'project_id': {'type': 'string', 'description': 'The ID of the project.'}, 'app_name': {'type': 'string', 'description': 'The name of the application.'}, 'secret_name': {'type': 'string', 'description': 'The name of the new secret.'}, 'secret_value': {'type': 'string', 'description': 'The value of the new secret.'}}, 'required': ['organization_id', 'project_id', 'app_name', 'secret_name', 'secret_value']}}, {'name': 'find_project_by_name', 'description': 'Finds a project by its name.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'name': {'type': 'string', 'description': 'The name of the project.'}}, 'required': ['organization_id', 'name']}}, {'name': 'find_user_by_email', 'description': 'Finds a user by their email.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'email': {'type': 'string', 'description': 'The email of the user.'}}, 'required': ['organization_id', 'email']}}, {'name': 'find_organization_by_name', 'description': 'Finds an organization by its name.', 'inputSchema': {'type': 'object', 'properties': {'name': {'type': 'string', 'description': 'The name of the organization.'}}, 'required': ['name']}}, {'name': 'list_resources', 'description': 'Lists all resources in a project.', 'inputSchema': {'type': 'object', 'properties': {'project_id': {'type': 'string', 'description': 'The ID of the project.'}}, 'required': ['project_id']}}, {'name': 'search_logs', 'description': 'Searches for audit logs in an organization using LogQL. At least one of `query`, `project_id`, or `topic` must be provided. For advanced filtering, use the `query` parameter with LogQL syntax. To filter on specific JSON fields in the log entries, use the `| json` parser in your query. For example: `query=\'| json | control_plane_event_action="CREATE"\'`', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'query': {'type': 'string', 'description': 'The LogQL query string for advanced filtering. Can be combined with `project_id` and `topic`. Example: \'| json | resource_uuid="some-uuid"\''}, 'project_id': {'type': 'string', 'description': 'A project ID to filter by.'}, 'topic': {'type': 'string', 'description': "A log topic to search. Example topics: 'hashicorp.platform.audit', 'hashicorp.packer.registry.audit', 'hashicorp.boundary.cluster.audit', 'hashicorp.consul.cluster.audit'"}, 'start_time': {'type': 'string', 'description': "The start time for the search. Accepts formats like '24 hours ago', 'yesterday at 5pm', or 'Oct 1, 2025'."}, 'end_time': {'type': 'string', 'description': "The end time for the search. Accepts formats like 'now', 'today', or 'Oct 3, 2025'."}}, 'required': ['organization_id', 'start_time', 'end_time']}}]}, 'id': 2}
2025-10-10 15:47:00,798 - mcp_server - INFO - Request data: stdio_main json: {"jsonrpc": "2.0", "result": {"tools": [{"name": "list_projects", "description": "Lists all HCP projects for a given organization.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}}, "required": ["organization_id"]}}, {"name": "get_project", "description": "Gets an HCP project by its ID.", "inputSchema": {"type": "object", "properties": {"project_id": {"type": "string", "description": "The ID of the project."}}, "required": ["project_id"]}}, {"name": "delete_project", "description": "Deletes an HCP project by its ID.", "inputSchema": {"type": "object", "properties": {"project_id": {"type": "string", "description": "The ID of the project."}}, "required": ["project_id"]}}, {"name": "create_project", "description": "Creates a new HCP project.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "name": {"type": "string", "description": "The name of the new project."}}, "required": ["organization_id", "name"]}}, {"name": "update_project", "description": "Updates an HCP project.", "inputSchema": {"type": "object", "properties": {"project_id": {"type": "string", "description": "The ID of the project."}, "name": {"type": "string", "description": "The new name of the project."}}, "required": ["project_id", "name"]}}, {"name": "get_organization", "description": "Gets an HCP organization by its ID.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}}, "required": ["organization_id"]}}, {"name": "list_organizations", "description": "Lists all HCP organizations.", "inputSchema": {"type": "object", "properties": {}}}, {"name": "update_organization", "description": "Updates an HCP organization.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "name": {"type": "string", "description": "The new name of the organization."}}, "required": ["organization_id", "name"]}}, {"name": "search_principals", "description": "Searches for principals in an organization.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "filter_str": {"type": "string", "description": "The filter string to use for the search."}}, "required": ["organization_id"]}}, {"name": "get_principals", "description": "Gets principals by their IDs.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "principal_ids": {"type": "array", "items": {"type": "string"}, "description": "The IDs of the principals to get."}}, "required": ["organization_id", "principal_ids"]}}, {"name": "delete_service_principal", "description": "Deletes a service principal by its ID.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "principal_id": {"type": "string", "description": "The ID of the service principal."}}, "required": ["organization_id", "principal_id"]}}, {"name": "create_service_principal", "description": "Creates a new service principal.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "name": {"type": "string", "description": "The name of the new service principal."}}, "required": ["organization_id", "name"]}}, {"name": "update_service_principal", "description": "Updates a service principal.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "principal_id": {"type": "string", "description": "The ID of the service principal."}, "name": {"type": "string", "description": "The new name of the service principal."}}, "required": ["organization_id", "principal_id", "name"]}}, {"name": "list_secrets", "description": "Lists all secrets for a given application.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "project_id": {"type": "string", "description": "The ID of the project."}, "app_name": {"type": "string", "description": "The name of the application."}}, "required": ["organization_id", "project_id", "app_name"]}}, {"name": "get_secret", "description": "Gets a secret by its name.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "project_id": {"type": "string", "description": "The ID of the project."}, "app_name": {"type": "string", "description": "The name of the application."}, "secret_name": {"type": "string", "description": "The name of the secret."}}, "required": ["organization_id", "project_id", "app_name", "secret_name"]}}, {"name": "delete_secret", "description": "Deletes a secret by its name.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "project_id": {"type": "string", "description": "The ID of the project."}, "app_name": {"type": "string", "description": "The name of the application."}, "secret_name": {"type": "string", "description": "The name of the secret."}}, "required": ["organization_id", "project_id", "app_name", "secret_name"]}}, {"name": "create_secret", "description": "Creates a new secret.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "project_id": {"type": "string", "description": "The ID of the project."}, "app_name": {"type": "string", "description": "The name of the application."}, "secret_name": {"type": "string", "description": "The name of the new secret."}, "secret_value": {"type": "string", "description": "The value of the new secret."}}, "required": ["organization_id", "project_id", "app_name", "secret_name", "secret_value"]}}, {"name": "find_project_by_name", "description": "Finds a project by its name.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "name": {"type": "string", "description": "The name of the project."}}, "required": ["organization_id", "name"]}}, {"name": "find_user_by_email", "description": "Finds a user by their email.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "email": {"type": "string", "description": "The email of the user."}}, "required": ["organization_id", "email"]}}, {"name": "find_organization_by_name", "description": "Finds an organization by its name.", "inputSchema": {"type": "object", "properties": {"name": {"type": "string", "description": "The name of the organization."}}, "required": ["name"]}}, {"name": "list_resources", "description": "Lists all resources in a project.", "inputSchema": {"type": "object", "properties": {"project_id": {"type": "string", "description": "The ID of the project."}}, "required": ["project_id"]}}, {"name": "search_logs", "description": "Searches for audit logs in an organization using LogQL. At least one of `query`, `project_id`, or `topic` must be provided. For advanced filtering, use the `query` parameter with LogQL syntax. To filter on specific JSON fields in the log entries, use the `| json` parser in your query. For example: `query='| json | control_plane_event_action=\"CREATE\"'`", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "query": {"type": "string", "description": "The LogQL query string for advanced filtering. Can be combined with `project_id` and `topic`. Example: '| json | resource_uuid=\"some-uuid\"'"}, "project_id": {"type": "string", "description": "A project ID to filter by."}, "topic": {"type": "string", "description": "A log topic to search. Example topics: 'hashicorp.platform.audit', 'hashicorp.packer.registry.audit', 'hashicorp.boundary.cluster.audit', 'hashicorp.consul.cluster.audit'"}, "start_time": {"type": "string", "description": "The start time for the search. Accepts formats like '24 hours ago', 'yesterday at 5pm', or 'Oct 1, 2025'."}, "end_time": {"type": "string", "description": "The end time for the search. Accepts formats like 'now', 'today', or 'Oct 3, 2025'."}}, "required": ["organization_id", "start_time", "end_time"]}}]}, "id": 2}
2025-10-10 15:47:26,125 - mcp_server - INFO - Client call: {"method": "tools/call", "params": {"name": "search_logs", "arguments": {"start_time": "6 days ago", "end_time": "now", "organization_id": "11eab4a9-75f1-e0a5-8be1-0242ac110016", "topic": "hashicorp.platform.audit"}}, "jsonrpc": "2.0", "id": 3}
2025-10-10 15:47:30,906 - mcp_server - INFO - Tool request data: {'streams': {'entries': [{'id': '122f81e8-22e6-4904-93b9-66bc619eabfe', 'timestamp': '2025-10-10T08:56:52.023953993Z', 'stream': {'organization_id': '11eab4a9-75f1-e0a5-8be1-0242ac110016', 'project_id': '11eab4a9-760d-c9f2-adc9-0242ac11000a', 'topic': 'hashicorp.platform.audit'}, 'resource': None, 'control_plane_event': {'request_info': {'http_verb': 'POST', 'http_path': '/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive', 'http_user_agent': 'HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (1f2925d)', 'http_client_ip': '35.91.140.117'}, 'authentication_info': {'principal': None, 'service_principal_delegation_chain': []}, 'authorization_info': [], 'metadata': {'cluster_id': 'vault-cluster'}, 'operation_info': {'operation_id': ''}, 'description': 'Host Manager Alive Requested', 'action': 'CREATE', 'status_code': 'OK'}, 'subject': None}, {'id': '02427d1f-9e48-4055-9eeb-1f938f6ca429', 'timestamp': '2025-10-10T08:56:50.585409396Z', 'stream': {'organization_id': '11eab4a9-75f1-e0a5-8be1-0242ac110016', 'project_id': '11eab4a9-760d-c9f2-adc9-0242ac11000a', 'topic': 'hashicorp.platform.audit'}, 'resource': None, 'control_plane_event': {'request_info': {'http_verb': 'POST', 'http_path': '/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive', 'http_user_agent': 'HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (1f2925d)', 'http_client_ip': '35.87.142.147'}, 'authentication_info': {'principal': None, 'service_principal_delegation_chain': []}, 'authorization_info': [], 'metadata': {'cluster_id': 'vault-cluster'}, 'operation_info': {'operation_id': ''}, 'description': 'Host Manager Alive Requested', 'action': 'CREATE', 'status_code': 'OK'}, 'subject': None}, {'id': '69a76856-4cb0-4609-b574-01b4cdba84d6', 'timestamp': '2025-10-10T08:56:48.565603242Z', 'stream': {'organization_id': '11eab4a9-75f1-e0a5-8be1-0242ac110016', 'project_id': '11eab4a9-760d-c9f2-adc9-0242ac11000a', 'topic': 'hashicorp.platform.audit'}, 'resource': None, 'control_plane_event': {'request_info': {'http_verb': 'POST', 'http_path': '/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive', 'http_user_agent': 'HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (1f2925d)', 'http_client_ip': '54.187.49.218'}, 'authentication_info': {'principal': None, 'service_principal_delegation_chain': []}, 'authorization_info': [], 'metadata': {'cluster_id': 'vault-cluster'}, 'operation_info': {'operation_id': ''}, 'description': 'Host Manager Alive Requested', 'action': 'CREATE', 'status_code': 'OK'}, 'subject': None}, {'id': '08813e54-bd3e-4e42-81a3-daadd2672e7e', 'timestamp': '2025-10-10T06:31:50.900038725Z', 'stream': {'organization_id': '11eab4a9-75f1-e0a5-8be1-0242ac110016', 'project_id': '11eab4a9-760d-c9f2-adc9-0242ac11000a', 'topic': 'hashicorp.platform.audit'}, 'resource': None, 'control_plane_event': {'request_info': {'http_verb': 'POST', 'http_path': '/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster-4/host-alive', 'http_user_agent': 'HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (98d7292)', 'http_client_ip': '54.188.11.180'}, 'authentication_info': {'principal': None, 'service_principal_delegation_chain': []}, 'authorization_info': [], 'metadata': {'cluster_id': 'vault-cluster-4'}, 'operation_info': {'operation_id': ''}, 'description': 'Host Manager Alive Requested', 'action': 'CREATE', 'status_code': 'OK'}, 'subject': None}, {'id': 'bd27928c-ae21-462e-be06-6630a49057d8', 'timestamp': '2025-10-09T20:24:13.287295802Z', 'stream': {'organization_id': '11eab4a9-75f1-e0a5-8be1-0242ac110016', 'project_id': '', 'topic': 'hashicorp.platform.audit'}, 'resource': None, 'control_plane_event': {'request_info': {'http_verb': 'GET', 'http_path': '/consent/complete', 'http_user_agent': '', 'http_client_ip': ''}, 'authentication_info': {'principal': {'id': '5f32f218-a0c0-4191-bd10-f2c1169bcfde', 'type': 'PRINCIPAL_TYPE_USER', 'user': {'id': '5f32f218-a0c0-4191-bd10-f2c1169bcfde', 'email': 'tpowell@hashicorp.com', 'full_name': 'tpowell@hashicorp.com', 'identity_type': 'UNSET', 'identity_types': [], 'subject': '5f32f218-a0c0-4191-bd10-f2c1169bcfde', 'scim_synchronized': False}, 'group_ids': []}, 'service_principal_delegation_chain': []}, 'authorization_info': [], 'metadata': {'email': 'tpowell@hashicorp.com', 'event_type': 'hcp_id_auth_success', 'ip': '73.252.181.35', 'message': 'Authenticated successfully', 'timestamp': '2025-10-09 20:24:12 +0000 UTC', 'user_id': '5f32f218-a0c0-4191-bd10-f2c1169bcfde'}, 'operation_info': {'operation_id': ''}, 'description': 'Authenticated successfully', 'action': 'CREATE', 'status_code': 'OK'}, 'subject': None}, {'id': '0e7bdf42-82d1-422c-9c34-ca0107593c76', 'timestamp': '2025-10-08T06:01:56.587155304Z', 'stream': {'organization_id': '11eab4a9-75f1-e0a5-8be1-0242ac110016', 'project_id': '11eab4a9-760d-c9f2-adc9-0242ac11000a', 'topic': 'hashicorp.platform.audit'}, 'resource': None, 'control_plane_event': {'request_info': {'http_verb': 'POST', 'http_path': '/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster1/host-alive', 'http_user_agent': 'HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (ee02d1c)', 'http_client_ip': '34.221.205.1'}, 'authentication_info': {'principal': None, 'service_principal_delegation_chain': []}, 'authorization_info': [], 'metadata': {'cluster_id': 'vault-cluster1'}, 'operation_info': {'operation_id': ''}, 'description': 'Host Manager Alive Requested', 'action': 'CREATE', 'status_code': 'OK'}, 'subject': None}, {'id': '89634f56-97e0-4ac6-bf39-7dc90a3ab1a1', 'timestamp': '2025-10-07T08:56:55.771365379Z', 'stream': {'organization_id': '11eab4a9-75f1-e0a5-8be1-0242ac110016', 'project_id': '11eab4a9-760d-c9f2-adc9-0242ac11000a', 'topic': 'hashicorp.platform.audit'}, 'resource': None, 'control_plane_event': {'request_info': {'http_verb': 'POST', 'http_path': '/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive', 'http_user_agent': 'HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (bfea313)', 'http_client_ip': '35.90.87.232'}, 'authentication_info': {'principal': None, 'service_principal_delegation_chain': []}, 'authorization_info': [], 'metadata': {'cluster_id': 'vault-cluster'}, 'operation_info': {'operation_id': ''}, 'description': 'Host Manager Alive Requested', 'action': 'CREATE', 'status_code': 'OK'}, 'subject': None}, {'id': '3ee2bab5-e951-4489-ae35-d3a052ab05c3', 'timestamp': '2025-10-07T08:56:49.242102158Z', 'stream': {'organization_id': '11eab4a9-75f1-e0a5-8be1-0242ac110016', 'project_id': '11eab4a9-760d-c9f2-adc9-0242ac11000a', 'topic': 'hashicorp.platform.audit'}, 'resource': None, 'control_plane_event': {'request_info': {'http_verb': 'POST', 'http_path': '/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive', 'http_user_agent': 'HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (bfea313)', 'http_client_ip': '16.144.10.31'}, 'authentication_info': {'principal': None, 'service_principal_delegation_chain': []}, 'authorization_info': [], 'metadata': {'cluster_id': 'vault-cluster'}, 'operation_info': {'operation_id': ''}, 'description': 'Host Manager Alive Requested', 'action': 'CREATE', 'status_code': 'OK'}, 'subject': None}, {'id': '118d591d-5d43-496a-8cfd-f377861a82a3', 'timestamp': '2025-10-07T08:56:48.074774296Z', 'stream': {'organization_id': '11eab4a9-75f1-e0a5-8be1-0242ac110016', 'project_id': '11eab4a9-760d-c9f2-adc9-0242ac11000a', 'topic': 'hashicorp.platform.audit'}, 'resource': None, 'control_plane_event': {'request_info': {'http_verb': 'POST', 'http_path': '/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive', 'http_user_agent': 'HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (bfea313)', 'http_client_ip': '34.216.173.150'}, 'authentication_info': {'principal': None, 'service_principal_delegation_chain': []}, 'authorization_info': [], 'metadata': {'cluster_id': 'vault-cluster'}, 'operation_info': {'operation_id': ''}, 'description': 'Host Manager Alive Requested', 'action': 'CREATE', 'status_code': 'OK'}, 'subject': None}, {'id': '490c67cd-67c2-4365-a3fe-55741bc09bf0', 'timestamp': '2025-10-07T06:31:50.875751353Z', 'stream': {'organization_id': '11eab4a9-75f1-e0a5-8be1-0242ac110016', 'project_id': '11eab4a9-760d-c9f2-adc9-0242ac11000a', 'topic': 'hashicorp.platform.audit'}, 'resource': None, 'control_plane_event': {'request_info': {'http_verb': 'POST', 'http_path': '/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster-4/host-alive', 'http_user_agent': 'HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (bfea313)', 'http_client_ip': '54.200.13.172'}, 'authentication_info': {'principal': None, 'service_principal_delegation_chain': []}, 'authorization_info': [], 'metadata': {'cluster_id': 'vault-cluster-4'}, 'operation_info': {'operation_id': ''}, 'description': 'Host Manager Alive Requested', 'action': 'CREATE', 'status_code': 'OK'}, 'subject': None}, {'id': 'a92d7f8b-7215-4786-9cf5-4bb202aff413', 'timestamp': '2025-10-05T06:02:20.403589332Z', 'stream': {'organization_id': '11eab4a9-75f1-e0a5-8be1-0242ac110016', 'project_id': '11eab4a9-760d-c9f2-adc9-0242ac11000a', 'topic': 'hashicorp.platform.audit'}, 'resource': None, 'control_plane_event': {'request_info': {'http_verb': 'POST', 'http_path': '/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster1/host-alive', 'http_user_agent': 'HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (bfea313)', 'http_client_ip': '54.245.73.167'}, 'authentication_info': {'principal': None, 'service_principal_delegation_chain': []}, 'authorization_info': [], 'metadata': {'cluster_id': 'vault-cluster1'}, 'operation_info': {'operation_id': ''}, 'description': 'Host Manager Alive Requested', 'action': 'CREATE', 'status_code': 'OK'}, 'subject': None}]}, 'next_page_token': 'eyJ0aW1lc3RhbXAiOiIyMDI1LTEwLTA1VDA2OjAyOjIwLjQwMzU4OTMzMloiLCJpZCI6ImE5MmQ3ZjhiLTcyMTUtNDc4Ni05Y2Y1LTRiYjIwMmFmZjQxMyIsIm9mZnNldCI6MX0='}
2025-10-10 15:47:30,907 - mcp_server - INFO - Request data: stdio_main: {'jsonrpc': '2.0', 'result': {'content': [{'type': 'text', 'text': '{"streams": {"entries": [{"id": "122f81e8-22e6-4904-93b9-66bc619eabfe", "timestamp": "2025-10-10T08:56:52.023953993Z", "stream": {"organization_id": "11eab4a9-75f1-e0a5-8be1-0242ac110016", "project_id": "11eab4a9-760d-c9f2-adc9-0242ac11000a", "topic": "hashicorp.platform.audit"}, "resource": null, "control_plane_event": {"request_info": {"http_verb": "POST", "http_path": "/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive", "http_user_agent": "HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (1f2925d)", "http_client_ip": "35.91.140.117"}, "authentication_info": {"principal": null, "service_principal_delegation_chain": []}, "authorization_info": [], "metadata": {"cluster_id": "vault-cluster"}, "operation_info": {"operation_id": ""}, "description": "Host Manager Alive Requested", "action": "CREATE", "status_code": "OK"}, "subject": null}, {"id": "02427d1f-9e48-4055-9eeb-1f938f6ca429", "timestamp": "2025-10-10T08:56:50.585409396Z", "stream": {"organization_id": "11eab4a9-75f1-e0a5-8be1-0242ac110016", "project_id": "11eab4a9-760d-c9f2-adc9-0242ac11000a", "topic": "hashicorp.platform.audit"}, "resource": null, "control_plane_event": {"request_info": {"http_verb": "POST", "http_path": "/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive", "http_user_agent": "HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (1f2925d)", "http_client_ip": "35.87.142.147"}, "authentication_info": {"principal": null, "service_principal_delegation_chain": []}, "authorization_info": [], "metadata": {"cluster_id": "vault-cluster"}, "operation_info": {"operation_id": ""}, "description": "Host Manager Alive Requested", "action": "CREATE", "status_code": "OK"}, "subject": null}, {"id": "69a76856-4cb0-4609-b574-01b4cdba84d6", "timestamp": "2025-10-10T08:56:48.565603242Z", "stream": {"organization_id": "11eab4a9-75f1-e0a5-8be1-0242ac110016", "project_id": "11eab4a9-760d-c9f2-adc9-0242ac11000a", "topic": "hashicorp.platform.audit"}, "resource": null, "control_plane_event": {"request_info": {"http_verb": "POST", "http_path": "/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive", "http_user_agent": "HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (1f2925d)", "http_client_ip": "54.187.49.218"}, "authentication_info": {"principal": null, "service_principal_delegation_chain": []}, "authorization_info": [], "metadata": {"cluster_id": "vault-cluster"}, "operation_info": {"operation_id": ""}, "description": "Host Manager Alive Requested", "action": "CREATE", "status_code": "OK"}, "subject": null}, {"id": "08813e54-bd3e-4e42-81a3-daadd2672e7e", "timestamp": "2025-10-10T06:31:50.900038725Z", "stream": {"organization_id": "11eab4a9-75f1-e0a5-8be1-0242ac110016", "project_id": "11eab4a9-760d-c9f2-adc9-0242ac11000a", "topic": "hashicorp.platform.audit"}, "resource": null, "control_plane_event": {"request_info": {"http_verb": "POST", "http_path": "/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster-4/host-alive", "http_user_agent": "HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (98d7292)", "http_client_ip": "54.188.11.180"}, "authentication_info": {"principal": null, "service_principal_delegation_chain": []}, "authorization_info": [], "metadata": {"cluster_id": "vault-cluster-4"}, "operation_info": {"operation_id": ""}, "description": "Host Manager Alive Requested", "action": "CREATE", "status_code": "OK"}, "subject": null}, {"id": "bd27928c-ae21-462e-be06-6630a49057d8", "timestamp": "2025-10-09T20:24:13.287295802Z", "stream": {"organization_id": "11eab4a9-75f1-e0a5-8be1-0242ac110016", "project_id": "", "topic": "hashicorp.platform.audit"}, "resource": null, "control_plane_event": {"request_info": {"http_verb": "GET", "http_path": "/consent/complete", "http_user_agent": "", "http_client_ip": ""}, "authentication_info": {"principal": {"id": "5f32f218-a0c0-4191-bd10-f2c1169bcfde", "type": "PRINCIPAL_TYPE_USER", "user": {"id": "5f32f218-a0c0-4191-bd10-f2c1169bcfde", "email": "tpowell@hashicorp.com", "full_name": "tpowell@hashicorp.com", "identity_type": "UNSET", "identity_types": [], "subject": "5f32f218-a0c0-4191-bd10-f2c1169bcfde", "scim_synchronized": false}, "group_ids": []}, "service_principal_delegation_chain": []}, "authorization_info": [], "metadata": {"email": "tpowell@hashicorp.com", "event_type": "hcp_id_auth_success", "ip": "73.252.181.35", "message": "Authenticated successfully", "timestamp": "2025-10-09 20:24:12 +0000 UTC", "user_id": "5f32f218-a0c0-4191-bd10-f2c1169bcfde"}, "operation_info": {"operation_id": ""}, "description": "Authenticated successfully", "action": "CREATE", "status_code": "OK"}, "subject": null}, {"id": "0e7bdf42-82d1-422c-9c34-ca0107593c76", "timestamp": "2025-10-08T06:01:56.587155304Z", "stream": {"organization_id": "11eab4a9-75f1-e0a5-8be1-0242ac110016", "project_id": "11eab4a9-760d-c9f2-adc9-0242ac11000a", "topic": "hashicorp.platform.audit"}, "resource": null, "control_plane_event": {"request_info": {"http_verb": "POST", "http_path": "/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster1/host-alive", "http_user_agent": "HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (ee02d1c)", "http_client_ip": "34.221.205.1"}, "authentication_info": {"principal": null, "service_principal_delegation_chain": []}, "authorization_info": [], "metadata": {"cluster_id": "vault-cluster1"}, "operation_info": {"operation_id": ""}, "description": "Host Manager Alive Requested", "action": "CREATE", "status_code": "OK"}, "subject": null}, {"id": "89634f56-97e0-4ac6-bf39-7dc90a3ab1a1", "timestamp": "2025-10-07T08:56:55.771365379Z", "stream": {"organization_id": "11eab4a9-75f1-e0a5-8be1-0242ac110016", "project_id": "11eab4a9-760d-c9f2-adc9-0242ac11000a", "topic": "hashicorp.platform.audit"}, "resource": null, "control_plane_event": {"request_info": {"http_verb": "POST", "http_path": "/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive", "http_user_agent": "HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (bfea313)", "http_client_ip": "35.90.87.232"}, "authentication_info": {"principal": null, "service_principal_delegation_chain": []}, "authorization_info": [], "metadata": {"cluster_id": "vault-cluster"}, "operation_info": {"operation_id": ""}, "description": "Host Manager Alive Requested", "action": "CREATE", "status_code": "OK"}, "subject": null}, {"id": "3ee2bab5-e951-4489-ae35-d3a052ab05c3", "timestamp": "2025-10-07T08:56:49.242102158Z", "stream": {"organization_id": "11eab4a9-75f1-e0a5-8be1-0242ac110016", "project_id": "11eab4a9-760d-c9f2-adc9-0242ac11000a", "topic": "hashicorp.platform.audit"}, "resource": null, "control_plane_event": {"request_info": {"http_verb": "POST", "http_path": "/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive", "http_user_agent": "HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (bfea313)", "http_client_ip": "16.144.10.31"}, "authentication_info": {"principal": null, "service_principal_delegation_chain": []}, "authorization_info": [], "metadata": {"cluster_id": "vault-cluster"}, "operation_info": {"operation_id": ""}, "description": "Host Manager Alive Requested", "action": "CREATE", "status_code": "OK"}, "subject": null}, {"id": "118d591d-5d43-496a-8cfd-f377861a82a3", "timestamp": "2025-10-07T08:56:48.074774296Z", "stream": {"organization_id": "11eab4a9-75f1-e0a5-8be1-0242ac110016", "project_id": "11eab4a9-760d-c9f2-adc9-0242ac11000a", "topic": "hashicorp.platform.audit"}, "resource": null, "control_plane_event": {"request_info": {"http_verb": "POST", "http_path": "/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive", "http_user_agent": "HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (bfea313)", "http_client_ip": "34.216.173.150"}, "authentication_info": {"principal": null, "service_principal_delegation_chain": []}, "authorization_info": [], "metadata": {"cluster_id": "vault-cluster"}, "operation_info": {"operation_id": ""}, "description": "Host Manager Alive Requested", "action": "CREATE", "status_code": "OK"}, "subject": null}, {"id": "490c67cd-67c2-4365-a3fe-55741bc09bf0", "timestamp": "2025-10-07T06:31:50.875751353Z", "stream": {"organization_id": "11eab4a9-75f1-e0a5-8be1-0242ac110016", "project_id": "11eab4a9-760d-c9f2-adc9-0242ac11000a", "topic": "hashicorp.platform.audit"}, "resource": null, "control_plane_event": {"request_info": {"http_verb": "POST", "http_path": "/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster-4/host-alive", "http_user_agent": "HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (bfea313)", "http_client_ip": "54.200.13.172"}, "authentication_info": {"principal": null, "service_principal_delegation_chain": []}, "authorization_info": [], "metadata": {"cluster_id": "vault-cluster-4"}, "operation_info": {"operation_id": ""}, "description": "Host Manager Alive Requested", "action": "CREATE", "status_code": "OK"}, "subject": null}, {"id": "a92d7f8b-7215-4786-9cf5-4bb202aff413", "timestamp": "2025-10-05T06:02:20.403589332Z", "stream": {"organization_id": "11eab4a9-75f1-e0a5-8be1-0242ac110016", "project_id": "11eab4a9-760d-c9f2-adc9-0242ac11000a", "topic": "hashicorp.platform.audit"}, "resource": null, "control_plane_event": {"request_info": {"http_verb": "POST", "http_path": "/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster1/host-alive", "http_user_agent": "HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (bfea313)", "http_client_ip": "54.245.73.167"}, "authentication_info": {"principal": null, "service_principal_delegation_chain": []}, "authorization_info": [], "metadata": {"cluster_id": "vault-cluster1"}, "operation_info": {"operation_id": ""}, "description": "Host Manager Alive Requested", "action": "CREATE", "status_code": "OK"}, "subject": null}]}, "next_page_token": "eyJ0aW1lc3RhbXAiOiIyMDI1LTEwLTA1VDA2OjAyOjIwLjQwMzU4OTMzMloiLCJpZCI6ImE5MmQ3ZjhiLTcyMTUtNDc4Ni05Y2Y1LTRiYjIwMmFmZjQxMyIsIm9mZnNldCI6MX0="}'}], 'isError': False}, 'id': 3}
2025-10-10 15:47:30,907 - mcp_server - INFO - Request data: stdio_main json: {"jsonrpc": "2.0", "result": {"content": [{"type": "text", "text": "{\"streams\": {\"entries\": [{\"id\": \"122f81e8-22e6-4904-93b9-66bc619eabfe\", \"timestamp\": \"2025-10-10T08:56:52.023953993Z\", \"stream\": {\"organization_id\": \"11eab4a9-75f1-e0a5-8be1-0242ac110016\", \"project_id\": \"11eab4a9-760d-c9f2-adc9-0242ac11000a\", \"topic\": \"hashicorp.platform.audit\"}, \"resource\": null, \"control_plane_event\": {\"request_info\": {\"http_verb\": \"POST\", \"http_path\": \"/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive\", \"http_user_agent\": \"HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (1f2925d)\", \"http_client_ip\": \"35.91.140.117\"}, \"authentication_info\": {\"principal\": null, \"service_principal_delegation_chain\": []}, \"authorization_info\": [], \"metadata\": {\"cluster_id\": \"vault-cluster\"}, \"operation_info\": {\"operation_id\": \"\"}, \"description\": \"Host Manager Alive Requested\", \"action\": \"CREATE\", \"status_code\": \"OK\"}, \"subject\": null}, {\"id\": \"02427d1f-9e48-4055-9eeb-1f938f6ca429\", \"timestamp\": \"2025-10-10T08:56:50.585409396Z\", \"stream\": {\"organization_id\": \"11eab4a9-75f1-e0a5-8be1-0242ac110016\", \"project_id\": \"11eab4a9-760d-c9f2-adc9-0242ac11000a\", \"topic\": \"hashicorp.platform.audit\"}, \"resource\": null, \"control_plane_event\": {\"request_info\": {\"http_verb\": \"POST\", \"http_path\": \"/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive\", \"http_user_agent\": \"HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (1f2925d)\", \"http_client_ip\": \"35.87.142.147\"}, \"authentication_info\": {\"principal\": null, \"service_principal_delegation_chain\": []}, \"authorization_info\": [], \"metadata\": {\"cluster_id\": \"vault-cluster\"}, \"operation_info\": {\"operation_id\": \"\"}, \"description\": \"Host Manager Alive Requested\", \"action\": \"CREATE\", \"status_code\": \"OK\"}, \"subject\": null}, {\"id\": \"69a76856-4cb0-4609-b574-01b4cdba84d6\", \"timestamp\": \"2025-10-10T08:56:48.565603242Z\", \"stream\": {\"organization_id\": \"11eab4a9-75f1-e0a5-8be1-0242ac110016\", \"project_id\": \"11eab4a9-760d-c9f2-adc9-0242ac11000a\", \"topic\": \"hashicorp.platform.audit\"}, \"resource\": null, \"control_plane_event\": {\"request_info\": {\"http_verb\": \"POST\", \"http_path\": \"/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive\", \"http_user_agent\": \"HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (1f2925d)\", \"http_client_ip\": \"54.187.49.218\"}, \"authentication_info\": {\"principal\": null, \"service_principal_delegation_chain\": []}, \"authorization_info\": [], \"metadata\": {\"cluster_id\": \"vault-cluster\"}, \"operation_info\": {\"operation_id\": \"\"}, \"description\": \"Host Manager Alive Requested\", \"action\": \"CREATE\", \"status_code\": \"OK\"}, \"subject\": null}, {\"id\": \"08813e54-bd3e-4e42-81a3-daadd2672e7e\", \"timestamp\": \"2025-10-10T06:31:50.900038725Z\", \"stream\": {\"organization_id\": \"11eab4a9-75f1-e0a5-8be1-0242ac110016\", \"project_id\": \"11eab4a9-760d-c9f2-adc9-0242ac11000a\", \"topic\": \"hashicorp.platform.audit\"}, \"resource\": null, \"control_plane_event\": {\"request_info\": {\"http_verb\": \"POST\", \"http_path\": \"/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster-4/host-alive\", \"http_user_agent\": \"HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (98d7292)\", \"http_client_ip\": \"54.188.11.180\"}, \"authentication_info\": {\"principal\": null, \"service_principal_delegation_chain\": []}, \"authorization_info\": [], \"metadata\": {\"cluster_id\": \"vault-cluster-4\"}, \"operation_info\": {\"operation_id\": \"\"}, \"description\": \"Host Manager Alive Requested\", \"action\": \"CREATE\", \"status_code\": \"OK\"}, \"subject\": null}, {\"id\": \"bd27928c-ae21-462e-be06-6630a49057d8\", \"timestamp\": \"2025-10-09T20:24:13.287295802Z\", \"stream\": {\"organization_id\": \"11eab4a9-75f1-e0a5-8be1-0242ac110016\", \"project_id\": \"\", \"topic\": \"hashicorp.platform.audit\"}, \"resource\": null, \"control_plane_event\": {\"request_info\": {\"http_verb\": \"GET\", \"http_path\": \"/consent/complete\", \"http_user_agent\": \"\", \"http_client_ip\": \"\"}, \"authentication_info\": {\"principal\": {\"id\": \"5f32f218-a0c0-4191-bd10-f2c1169bcfde\", \"type\": \"PRINCIPAL_TYPE_USER\", \"user\": {\"id\": \"5f32f218-a0c0-4191-bd10-f2c1169bcfde\", \"email\": \"tpowell@hashicorp.com\", \"full_name\": \"tpowell@hashicorp.com\", \"identity_type\": \"UNSET\", \"identity_types\": [], \"subject\": \"5f32f218-a0c0-4191-bd10-f2c1169bcfde\", \"scim_synchronized\": false}, \"group_ids\": []}, \"service_principal_delegation_chain\": []}, \"authorization_info\": [], \"metadata\": {\"email\": \"tpowell@hashicorp.com\", \"event_type\": \"hcp_id_auth_success\", \"ip\": \"73.252.181.35\", \"message\": \"Authenticated successfully\", \"timestamp\": \"2025-10-09 20:24:12 +0000 UTC\", \"user_id\": \"5f32f218-a0c0-4191-bd10-f2c1169bcfde\"}, \"operation_info\": {\"operation_id\": \"\"}, \"description\": \"Authenticated successfully\", \"action\": \"CREATE\", \"status_code\": \"OK\"}, \"subject\": null}, {\"id\": \"0e7bdf42-82d1-422c-9c34-ca0107593c76\", \"timestamp\": \"2025-10-08T06:01:56.587155304Z\", \"stream\": {\"organization_id\": \"11eab4a9-75f1-e0a5-8be1-0242ac110016\", \"project_id\": \"11eab4a9-760d-c9f2-adc9-0242ac11000a\", \"topic\": \"hashicorp.platform.audit\"}, \"resource\": null, \"control_plane_event\": {\"request_info\": {\"http_verb\": \"POST\", \"http_path\": \"/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster1/host-alive\", \"http_user_agent\": \"HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (ee02d1c)\", \"http_client_ip\": \"34.221.205.1\"}, \"authentication_info\": {\"principal\": null, \"service_principal_delegation_chain\": []}, \"authorization_info\": [], \"metadata\": {\"cluster_id\": \"vault-cluster1\"}, \"operation_info\": {\"operation_id\": \"\"}, \"description\": \"Host Manager Alive Requested\", \"action\": \"CREATE\", \"status_code\": \"OK\"}, \"subject\": null}, {\"id\": \"89634f56-97e0-4ac6-bf39-7dc90a3ab1a1\", \"timestamp\": \"2025-10-07T08:56:55.771365379Z\", \"stream\": {\"organization_id\": \"11eab4a9-75f1-e0a5-8be1-0242ac110016\", \"project_id\": \"11eab4a9-760d-c9f2-adc9-0242ac11000a\", \"topic\": \"hashicorp.platform.audit\"}, \"resource\": null, \"control_plane_event\": {\"request_info\": {\"http_verb\": \"POST\", \"http_path\": \"/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive\", \"http_user_agent\": \"HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (bfea313)\", \"http_client_ip\": \"35.90.87.232\"}, \"authentication_info\": {\"principal\": null, \"service_principal_delegation_chain\": []}, \"authorization_info\": [], \"metadata\": {\"cluster_id\": \"vault-cluster\"}, \"operation_info\": {\"operation_id\": \"\"}, \"description\": \"Host Manager Alive Requested\", \"action\": \"CREATE\", \"status_code\": \"OK\"}, \"subject\": null}, {\"id\": \"3ee2bab5-e951-4489-ae35-d3a052ab05c3\", \"timestamp\": \"2025-10-07T08:56:49.242102158Z\", \"stream\": {\"organization_id\": \"11eab4a9-75f1-e0a5-8be1-0242ac110016\", \"project_id\": \"11eab4a9-760d-c9f2-adc9-0242ac11000a\", \"topic\": \"hashicorp.platform.audit\"}, \"resource\": null, \"control_plane_event\": {\"request_info\": {\"http_verb\": \"POST\", \"http_path\": \"/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive\", \"http_user_agent\": \"HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (bfea313)\", \"http_client_ip\": \"16.144.10.31\"}, \"authentication_info\": {\"principal\": null, \"service_principal_delegation_chain\": []}, \"authorization_info\": [], \"metadata\": {\"cluster_id\": \"vault-cluster\"}, \"operation_info\": {\"operation_id\": \"\"}, \"description\": \"Host Manager Alive Requested\", \"action\": \"CREATE\", \"status_code\": \"OK\"}, \"subject\": null}, {\"id\": \"118d591d-5d43-496a-8cfd-f377861a82a3\", \"timestamp\": \"2025-10-07T08:56:48.074774296Z\", \"stream\": {\"organization_id\": \"11eab4a9-75f1-e0a5-8be1-0242ac110016\", \"project_id\": \"11eab4a9-760d-c9f2-adc9-0242ac11000a\", \"topic\": \"hashicorp.platform.audit\"}, \"resource\": null, \"control_plane_event\": {\"request_info\": {\"http_verb\": \"POST\", \"http_path\": \"/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive\", \"http_user_agent\": \"HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (bfea313)\", \"http_client_ip\": \"34.216.173.150\"}, \"authentication_info\": {\"principal\": null, \"service_principal_delegation_chain\": []}, \"authorization_info\": [], \"metadata\": {\"cluster_id\": \"vault-cluster\"}, \"operation_info\": {\"operation_id\": \"\"}, \"description\": \"Host Manager Alive Requested\", \"action\": \"CREATE\", \"status_code\": \"OK\"}, \"subject\": null}, {\"id\": \"490c67cd-67c2-4365-a3fe-55741bc09bf0\", \"timestamp\": \"2025-10-07T06:31:50.875751353Z\", \"stream\": {\"organization_id\": \"11eab4a9-75f1-e0a5-8be1-0242ac110016\", \"project_id\": \"11eab4a9-760d-c9f2-adc9-0242ac11000a\", \"topic\": \"hashicorp.platform.audit\"}, \"resource\": null, \"control_plane_event\": {\"request_info\": {\"http_verb\": \"POST\", \"http_path\": \"/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster-4/host-alive\", \"http_user_agent\": \"HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (bfea313)\", \"http_client_ip\": \"54.200.13.172\"}, \"authentication_info\": {\"principal\": null, \"service_principal_delegation_chain\": []}, \"authorization_info\": [], \"metadata\": {\"cluster_id\": \"vault-cluster-4\"}, \"operation_info\": {\"operation_id\": \"\"}, \"description\": \"Host Manager Alive Requested\", \"action\": \"CREATE\", \"status_code\": \"OK\"}, \"subject\": null}, {\"id\": \"a92d7f8b-7215-4786-9cf5-4bb202aff413\", \"timestamp\": \"2025-10-05T06:02:20.403589332Z\", \"stream\": {\"organization_id\": \"11eab4a9-75f1-e0a5-8be1-0242ac110016\", \"project_id\": \"11eab4a9-760d-c9f2-adc9-0242ac11000a\", \"topic\": \"hashicorp.platform.audit\"}, \"resource\": null, \"control_plane_event\": {\"request_info\": {\"http_verb\": \"POST\", \"http_path\": \"/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster1/host-alive\", \"http_user_agent\": \"HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (bfea313)\", \"http_client_ip\": \"54.245.73.167\"}, \"authentication_info\": {\"principal\": null, \"service_principal_delegation_chain\": []}, \"authorization_info\": [], \"metadata\": {\"cluster_id\": \"vault-cluster1\"}, \"operation_info\": {\"operation_id\": \"\"}, \"description\": \"Host Manager Alive Requested\", \"action\": \"CREATE\", \"status_code\": \"OK\"}, \"subject\": null}]}, \"next_page_token\": \"eyJ0aW1lc3RhbXAiOiIyMDI1LTEwLTA1VDA2OjAyOjIwLjQwMzU4OTMzMloiLCJpZCI6ImE5MmQ3ZjhiLTcyMTUtNDc4Ni05Y2Y1LTRiYjIwMmFmZjQxMyIsIm9mZnNldCI6MX0=\"}"}], "isError": false}, "id": 3}
2025-10-10 15:49:04,099 - mcp_server - INFO - Received request: {"method": "initialize", "params": {"protocolVersion": "2025-06-18", "capabilities": {"roots": {}}, "clientInfo": {"name": "gemini-cli-mcp-client-HCP", "version": "0.0.1"}}, "jsonrpc": "2.0", "id": 0}
2025-10-10 15:49:04,099 - mcp_server - INFO - Request data: stdio_main: {'jsonrpc': '2.0', 'result': {'protocolVersion': '2024-11-05', 'serverInfo': {'name': 'HCP', 'version': '0.0.1'}, 'capabilities': {'tools': {'listChanged': True}, 'prompts': {'listChanged': True}, 'resources': {'listChanged': True}}}, 'id': 0}
2025-10-10 15:49:04,099 - mcp_server - INFO - Request data: stdio_main json: {"jsonrpc": "2.0", "result": {"protocolVersion": "2024-11-05", "serverInfo": {"name": "HCP", "version": "0.0.1"}, "capabilities": {"tools": {"listChanged": true}, "prompts": {"listChanged": true}, "resources": {"listChanged": true}}}, "id": 0}
2025-10-10 15:49:04,099 - mcp_server - INFO - Received request: {"method": "notifications/initialized", "jsonrpc": "2.0"}
2025-10-10 15:49:04,099 - mcp_server - INFO - Client initialized.
2025-10-10 15:49:04,099 - mcp_server - INFO - Received request: {"method": "prompts/list", "params": {}, "jsonrpc": "2.0", "id": 1}
2025-10-10 15:49:04,099 - mcp_server - INFO - Request data: stdio_main: {'jsonrpc': '2.0', 'result': {'prompts': [{'name': 'list_projects', 'title': 'List Projects', 'description': 'Lists all HCP projects for a given organization.', 'arguments': [{'name': 'organization_id', 'description': 'The ID of the organization.', 'required': True}]}, {'name': 'get_project', 'title': 'Get Project', 'description': 'Gets an HCP project by its ID.', 'arguments': [{'name': 'project_id', 'description': 'The ID of the project.', 'required': True}]}, {'name': 'delete_project', 'title': 'Delete Project', 'description': 'Deletes an HCP project by its ID.', 'arguments': [{'name': 'project_id', 'description': 'The ID of the project.', 'required': True}]}, {'name': 'create_project', 'title': 'Create Project', 'description': 'Creates a new HCP project.', 'arguments': [{'name': 'name', 'description': 'The name of the new project.', 'required': True}, {'name': 'organization_id', 'description': 'The ID of the organization.', 'required': True}]}, {'name': 'update_project', 'title': 'Update Project', 'description': 'Updates an HCP project.', 'arguments': [{'name': 'project_id', 'description': 'The ID of the project.', 'required': True}, {'name': 'name', 'description': 'The new name for the project.', 'required': True}, {'name': 'organization_id', 'description': 'The ID of the organization.', 'required': True}]}, {'name': 'get_organization', 'title': 'Get Organization', 'description': 'Gets an HCP organization by its ID.', 'arguments': [{'name': 'organization_id', 'description': 'The ID of the organization.', 'required': True}]}, {'name': 'list_organizations', 'title': 'List Organizations', 'description': 'Lists all HCP organizations.', 'arguments': None}, {'name': 'update_organization', 'title': 'Update Organization', 'description': 'Updates an HCP organization.', 'arguments': [{'name': 'organization_id', 'description': 'The ID of the organization.', 'required': True}, {'name': 'name', 'description': 'The new name for the organization.', 'required': True}]}, {'name': 'list_secrets', 'title': 'List Secrets', 'description': 'Lists all secrets for a given application.', 'arguments': [{'name': 'project_id', 'description': 'The ID of the project.', 'required': True}, {'name': 'app_name', 'description': 'The name of the application.', 'required': True}]}, {'name': 'get_secret', 'title': 'Get Secret', 'description': 'Gets a secret by its name.', 'arguments': [{'name': 'secret_name', 'description': 'The name of the secret.', 'required': True}, {'name': 'project_id', 'description': 'The ID of the project.', 'required': True}, {'name': 'app_name', 'description': 'The name of the application.', 'required': True}]}, {'name': 'delete_secret', 'title': 'Delete Secret', 'description': 'Deletes a secret by its name.', 'arguments': [{'name': 'secret_name', 'description': 'The name of the secret.', 'required': True}, {'name': 'project_id', 'description': 'The ID of the project.', 'required': True}, {'name': 'app_name', 'description': 'The name of the application.', 'required': True}]}, {'name': 'create_secret', 'title': 'Create Secret', 'description': 'Creates a new secret.', 'arguments': [{'name': 'secret_name', 'description': 'The name of the new secret.', 'required': True}, {'name': 'secret_value', 'description': 'The value of the new secret.', 'required': True}, {'name': 'project_id', 'description': 'The ID of the project.', 'required': True}, {'name': 'app_name', 'description': 'The name of the application.', 'required': True}]}, {'name': 'find_project_and_list_secrets', 'title': 'Find Project and List Secrets', 'description': 'Finds a project by name and lists its secrets.', 'arguments': [{'name': 'project_name', 'description': 'The name of the project.', 'required': True}, {'name': 'organization_id', 'description': 'The ID of the organization.', 'required': True}, {'name': 'app_name', 'description': 'The name of the application.', 'required': True}]}, {'name': 'list_resources', 'title': 'List Resources', 'description': 'Lists all resources in a project.', 'arguments': [{'name': 'project_id', 'description': 'The ID of the project.', 'required': True}]}, {'name': 'search_logs', 'title': 'Search Logs', 'description': 'Searches for audit logs in an organization using LogQL. The LLM should determine the best topic to use based on the user\'s query, or default to \'hashicorp.platform.audit\' if the user is not specific. For advanced filtering, use the `query` parameter with LogQL syntax. To filter on specific JSON fields in the log entries, use the `| json` parser in your query. For example: `query=\'| json | control_plane_event_action="CREATE"\'`', 'arguments': [{'name': 'organization_id', 'description': 'The ID of the organization.', 'required': True}, {'name': 'query', 'description': 'The LogQL query string for advanced filtering. Can be combined with `project_id` and `topic`. Example: \'| json | resource_uuid="some-uuid"\'', 'required': False}, {'name': 'project_id', 'description': 'A project ID to filter by.', 'required': False}, {'name': 'topic', 'description': "A log topic to search. Example topics: 'hashicorp.platform.audit', 'hashicorp.packer.registry.audit', 'hashicorp.boundary.cluster.audit', 'hashicorp.consul.cluster.audit'", 'required': True}, {'name': 'start_time', 'description': "The start time for the search. Accepts formats like '24 hours ago', 'yesterday at 5pm', or 'Oct 1, 2025'.", 'required': True}, {'name': 'end_time', 'description': "The end time for the search. Accepts formats like 'now', 'today', or 'Oct 3, 2025'.", 'required': True}]}]}, 'id': 1}
2025-10-10 15:49:04,099 - mcp_server - INFO - Request data: stdio_main json: {"jsonrpc": "2.0", "result": {"prompts": [{"name": "list_projects", "title": "List Projects", "description": "Lists all HCP projects for a given organization.", "arguments": [{"name": "organization_id", "description": "The ID of the organization.", "required": true}]}, {"name": "get_project", "title": "Get Project", "description": "Gets an HCP project by its ID.", "arguments": [{"name": "project_id", "description": "The ID of the project.", "required": true}]}, {"name": "delete_project", "title": "Delete Project", "description": "Deletes an HCP project by its ID.", "arguments": [{"name": "project_id", "description": "The ID of the project.", "required": true}]}, {"name": "create_project", "title": "Create Project", "description": "Creates a new HCP project.", "arguments": [{"name": "name", "description": "The name of the new project.", "required": true}, {"name": "organization_id", "description": "The ID of the organization.", "required": true}]}, {"name": "update_project", "title": "Update Project", "description": "Updates an HCP project.", "arguments": [{"name": "project_id", "description": "The ID of the project.", "required": true}, {"name": "name", "description": "The new name for the project.", "required": true}, {"name": "organization_id", "description": "The ID of the organization.", "required": true}]}, {"name": "get_organization", "title": "Get Organization", "description": "Gets an HCP organization by its ID.", "arguments": [{"name": "organization_id", "description": "The ID of the organization.", "required": true}]}, {"name": "list_organizations", "title": "List Organizations", "description": "Lists all HCP organizations.", "arguments": null}, {"name": "update_organization", "title": "Update Organization", "description": "Updates an HCP organization.", "arguments": [{"name": "organization_id", "description": "The ID of the organization.", "required": true}, {"name": "name", "description": "The new name for the organization.", "required": true}]}, {"name": "list_secrets", "title": "List Secrets", "description": "Lists all secrets for a given application.", "arguments": [{"name": "project_id", "description": "The ID of the project.", "required": true}, {"name": "app_name", "description": "The name of the application.", "required": true}]}, {"name": "get_secret", "title": "Get Secret", "description": "Gets a secret by its name.", "arguments": [{"name": "secret_name", "description": "The name of the secret.", "required": true}, {"name": "project_id", "description": "The ID of the project.", "required": true}, {"name": "app_name", "description": "The name of the application.", "required": true}]}, {"name": "delete_secret", "title": "Delete Secret", "description": "Deletes a secret by its name.", "arguments": [{"name": "secret_name", "description": "The name of the secret.", "required": true}, {"name": "project_id", "description": "The ID of the project.", "required": true}, {"name": "app_name", "description": "The name of the application.", "required": true}]}, {"name": "create_secret", "title": "Create Secret", "description": "Creates a new secret.", "arguments": [{"name": "secret_name", "description": "The name of the new secret.", "required": true}, {"name": "secret_value", "description": "The value of the new secret.", "required": true}, {"name": "project_id", "description": "The ID of the project.", "required": true}, {"name": "app_name", "description": "The name of the application.", "required": true}]}, {"name": "find_project_and_list_secrets", "title": "Find Project and List Secrets", "description": "Finds a project by name and lists its secrets.", "arguments": [{"name": "project_name", "description": "The name of the project.", "required": true}, {"name": "organization_id", "description": "The ID of the organization.", "required": true}, {"name": "app_name", "description": "The name of the application.", "required": true}]}, {"name": "list_resources", "title": "List Resources", "description": "Lists all resources in a project.", "arguments": [{"name": "project_id", "description": "The ID of the project.", "required": true}]}, {"name": "search_logs", "title": "Search Logs", "description": "Searches for audit logs in an organization using LogQL. The LLM should determine the best topic to use based on the user's query, or default to 'hashicorp.platform.audit' if the user is not specific. For advanced filtering, use the `query` parameter with LogQL syntax. To filter on specific JSON fields in the log entries, use the `| json` parser in your query. For example: `query='| json | control_plane_event_action=\"CREATE\"'`", "arguments": [{"name": "organization_id", "description": "The ID of the organization.", "required": true}, {"name": "query", "description": "The LogQL query string for advanced filtering. Can be combined with `project_id` and `topic`. Example: '| json | resource_uuid=\"some-uuid\"'", "required": false}, {"name": "project_id", "description": "A project ID to filter by.", "required": false}, {"name": "topic", "description": "A log topic to search. Example topics: 'hashicorp.platform.audit', 'hashicorp.packer.registry.audit', 'hashicorp.boundary.cluster.audit', 'hashicorp.consul.cluster.audit'", "required": true}, {"name": "start_time", "description": "The start time for the search. Accepts formats like '24 hours ago', 'yesterday at 5pm', or 'Oct 1, 2025'.", "required": true}, {"name": "end_time", "description": "The end time for the search. Accepts formats like 'now', 'today', or 'Oct 3, 2025'.", "required": true}]}]}, "id": 1}
2025-10-10 15:49:04,100 - mcp_server - INFO - Received request: {"method": "tools/list", "params": {}, "jsonrpc": "2.0", "id": 2}
2025-10-10 15:49:04,100 - mcp_server - INFO - Request data: stdio_main: {'jsonrpc': '2.0', 'result': {'tools': [{'name': 'list_projects', 'description': 'Lists all HCP projects for a given organization.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}}, 'required': ['organization_id']}}, {'name': 'get_project', 'description': 'Gets an HCP project by its ID.', 'inputSchema': {'type': 'object', 'properties': {'project_id': {'type': 'string', 'description': 'The ID of the project.'}}, 'required': ['project_id']}}, {'name': 'delete_project', 'description': 'Deletes an HCP project by its ID.', 'inputSchema': {'type': 'object', 'properties': {'project_id': {'type': 'string', 'description': 'The ID of the project.'}}, 'required': ['project_id']}}, {'name': 'create_project', 'description': 'Creates a new HCP project.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'name': {'type': 'string', 'description': 'The name of the new project.'}}, 'required': ['organization_id', 'name']}}, {'name': 'update_project', 'description': 'Updates an HCP project.', 'inputSchema': {'type': 'object', 'properties': {'project_id': {'type': 'string', 'description': 'The ID of the project.'}, 'name': {'type': 'string', 'description': 'The new name of the project.'}}, 'required': ['project_id', 'name']}}, {'name': 'get_organization', 'description': 'Gets an HCP organization by its ID.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}}, 'required': ['organization_id']}}, {'name': 'list_organizations', 'description': 'Lists all HCP organizations.', 'inputSchema': {'type': 'object', 'properties': {}}}, {'name': 'update_organization', 'description': 'Updates an HCP organization.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'name': {'type': 'string', 'description': 'The new name of the organization.'}}, 'required': ['organization_id', 'name']}}, {'name': 'search_principals', 'description': 'Searches for principals in an organization.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'filter_str': {'type': 'string', 'description': 'The filter string to use for the search.'}}, 'required': ['organization_id']}}, {'name': 'get_principals', 'description': 'Gets principals by their IDs.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'principal_ids': {'type': 'array', 'items': {'type': 'string'}, 'description': 'The IDs of the principals to get.'}}, 'required': ['organization_id', 'principal_ids']}}, {'name': 'delete_service_principal', 'description': 'Deletes a service principal by its ID.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'principal_id': {'type': 'string', 'description': 'The ID of the service principal.'}}, 'required': ['organization_id', 'principal_id']}}, {'name': 'create_service_principal', 'description': 'Creates a new service principal.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'name': {'type': 'string', 'description': 'The name of the new service principal.'}}, 'required': ['organization_id', 'name']}}, {'name': 'update_service_principal', 'description': 'Updates a service principal.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'principal_id': {'type': 'string', 'description': 'The ID of the service principal.'}, 'name': {'type': 'string', 'description': 'The new name of the service principal.'}}, 'required': ['organization_id', 'principal_id', 'name']}}, {'name': 'list_secrets', 'description': 'Lists all secrets for a given application.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'project_id': {'type': 'string', 'description': 'The ID of the project.'}, 'app_name': {'type': 'string', 'description': 'The name of the application.'}}, 'required': ['organization_id', 'project_id', 'app_name']}}, {'name': 'get_secret', 'description': 'Gets a secret by its name.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'project_id': {'type': 'string', 'description': 'The ID of the project.'}, 'app_name': {'type': 'string', 'description': 'The name of the application.'}, 'secret_name': {'type': 'string', 'description': 'The name of the secret.'}}, 'required': ['organization_id', 'project_id', 'app_name', 'secret_name']}}, {'name': 'delete_secret', 'description': 'Deletes a secret by its name.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'project_id': {'type': 'string', 'description': 'The ID of the project.'}, 'app_name': {'type': 'string', 'description': 'The name of the application.'}, 'secret_name': {'type': 'string', 'description': 'The name of the secret.'}}, 'required': ['organization_id', 'project_id', 'app_name', 'secret_name']}}, {'name': 'create_secret', 'description': 'Creates a new secret.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'project_id': {'type': 'string', 'description': 'The ID of the project.'}, 'app_name': {'type': 'string', 'description': 'The name of the application.'}, 'secret_name': {'type': 'string', 'description': 'The name of the new secret.'}, 'secret_value': {'type': 'string', 'description': 'The value of the new secret.'}}, 'required': ['organization_id', 'project_id', 'app_name', 'secret_name', 'secret_value']}}, {'name': 'find_project_by_name', 'description': 'Finds a project by its name.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'name': {'type': 'string', 'description': 'The name of the project.'}}, 'required': ['organization_id', 'name']}}, {'name': 'find_user_by_email', 'description': 'Finds a user by their email.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'email': {'type': 'string', 'description': 'The email of the user.'}}, 'required': ['organization_id', 'email']}}, {'name': 'find_organization_by_name', 'description': 'Finds an organization by its name.', 'inputSchema': {'type': 'object', 'properties': {'name': {'type': 'string', 'description': 'The name of the organization.'}}, 'required': ['name']}}, {'name': 'list_resources', 'description': 'Lists all resources in a project.', 'inputSchema': {'type': 'object', 'properties': {'project_id': {'type': 'string', 'description': 'The ID of the project.'}}, 'required': ['project_id']}}, {'name': 'search_logs', 'description': 'Searches for audit logs in an organization using LogQL. At least one of `query`, `project_id`, or `topic` must be provided. For advanced filtering, use the `query` parameter with LogQL syntax. To filter on specific JSON fields in the log entries, use the `| json` parser in your query. For example: `query=\'| json | control_plane_event_action="CREATE"\'`', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'query': {'type': 'string', 'description': 'The LogQL query string for advanced filtering. Can be combined with `project_id` and `topic`. Example: \'| json | resource_uuid="some-uuid"\''}, 'project_id': {'type': 'string', 'description': 'A project ID to filter by.'}, 'topic': {'type': 'string', 'description': "A log topic to search. Example topics: 'hashicorp.platform.audit', 'hashicorp.packer.registry.audit', 'hashicorp.boundary.cluster.audit', 'hashicorp.consul.cluster.audit'"}, 'start_time': {'type': 'string', 'description': "The start time for the search. Accepts formats like '24 hours ago', 'yesterday at 5pm', or 'Oct 1, 2025'."}, 'end_time': {'type': 'string', 'description': "The end time for the search. Accepts formats like 'now', 'today', or 'Oct 3, 2025'."}}, 'required': ['organization_id', 'start_time', 'end_time']}}]}, 'id': 2}
2025-10-10 15:49:04,100 - mcp_server - INFO - Request data: stdio_main json: {"jsonrpc": "2.0", "result": {"tools": [{"name": "list_projects", "description": "Lists all HCP projects for a given organization.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}}, "required": ["organization_id"]}}, {"name": "get_project", "description": "Gets an HCP project by its ID.", "inputSchema": {"type": "object", "properties": {"project_id": {"type": "string", "description": "The ID of the project."}}, "required": ["project_id"]}}, {"name": "delete_project", "description": "Deletes an HCP project by its ID.", "inputSchema": {"type": "object", "properties": {"project_id": {"type": "string", "description": "The ID of the project."}}, "required": ["project_id"]}}, {"name": "create_project", "description": "Creates a new HCP project.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "name": {"type": "string", "description": "The name of the new project."}}, "required": ["organization_id", "name"]}}, {"name": "update_project", "description": "Updates an HCP project.", "inputSchema": {"type": "object", "properties": {"project_id": {"type": "string", "description": "The ID of the project."}, "name": {"type": "string", "description": "The new name of the project."}}, "required": ["project_id", "name"]}}, {"name": "get_organization", "description": "Gets an HCP organization by its ID.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}}, "required": ["organization_id"]}}, {"name": "list_organizations", "description": "Lists all HCP organizations.", "inputSchema": {"type": "object", "properties": {}}}, {"name": "update_organization", "description": "Updates an HCP organization.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "name": {"type": "string", "description": "The new name of the organization."}}, "required": ["organization_id", "name"]}}, {"name": "search_principals", "description": "Searches for principals in an organization.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "filter_str": {"type": "string", "description": "The filter string to use for the search."}}, "required": ["organization_id"]}}, {"name": "get_principals", "description": "Gets principals by their IDs.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "principal_ids": {"type": "array", "items": {"type": "string"}, "description": "The IDs of the principals to get."}}, "required": ["organization_id", "principal_ids"]}}, {"name": "delete_service_principal", "description": "Deletes a service principal by its ID.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "principal_id": {"type": "string", "description": "The ID of the service principal."}}, "required": ["organization_id", "principal_id"]}}, {"name": "create_service_principal", "description": "Creates a new service principal.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "name": {"type": "string", "description": "The name of the new service principal."}}, "required": ["organization_id", "name"]}}, {"name": "update_service_principal", "description": "Updates a service principal.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "principal_id": {"type": "string", "description": "The ID of the service principal."}, "name": {"type": "string", "description": "The new name of the service principal."}}, "required": ["organization_id", "principal_id", "name"]}}, {"name": "list_secrets", "description": "Lists all secrets for a given application.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "project_id": {"type": "string", "description": "The ID of the project."}, "app_name": {"type": "string", "description": "The name of the application."}}, "required": ["organization_id", "project_id", "app_name"]}}, {"name": "get_secret", "description": "Gets a secret by its name.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "project_id": {"type": "string", "description": "The ID of the project."}, "app_name": {"type": "string", "description": "The name of the application."}, "secret_name": {"type": "string", "description": "The name of the secret."}}, "required": ["organization_id", "project_id", "app_name", "secret_name"]}}, {"name": "delete_secret", "description": "Deletes a secret by its name.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "project_id": {"type": "string", "description": "The ID of the project."}, "app_name": {"type": "string", "description": "The name of the application."}, "secret_name": {"type": "string", "description": "The name of the secret."}}, "required": ["organization_id", "project_id", "app_name", "secret_name"]}}, {"name": "create_secret", "description": "Creates a new secret.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "project_id": {"type": "string", "description": "The ID of the project."}, "app_name": {"type": "string", "description": "The name of the application."}, "secret_name": {"type": "string", "description": "The name of the new secret."}, "secret_value": {"type": "string", "description": "The value of the new secret."}}, "required": ["organization_id", "project_id", "app_name", "secret_name", "secret_value"]}}, {"name": "find_project_by_name", "description": "Finds a project by its name.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "name": {"type": "string", "description": "The name of the project."}}, "required": ["organization_id", "name"]}}, {"name": "find_user_by_email", "description": "Finds a user by their email.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "email": {"type": "string", "description": "The email of the user."}}, "required": ["organization_id", "email"]}}, {"name": "find_organization_by_name", "description": "Finds an organization by its name.", "inputSchema": {"type": "object", "properties": {"name": {"type": "string", "description": "The name of the organization."}}, "required": ["name"]}}, {"name": "list_resources", "description": "Lists all resources in a project.", "inputSchema": {"type": "object", "properties": {"project_id": {"type": "string", "description": "The ID of the project."}}, "required": ["project_id"]}}, {"name": "search_logs", "description": "Searches for audit logs in an organization using LogQL. At least one of `query`, `project_id`, or `topic` must be provided. For advanced filtering, use the `query` parameter with LogQL syntax. To filter on specific JSON fields in the log entries, use the `| json` parser in your query. For example: `query='| json | control_plane_event_action=\"CREATE\"'`", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "query": {"type": "string", "description": "The LogQL query string for advanced filtering. Can be combined with `project_id` and `topic`. Example: '| json | resource_uuid=\"some-uuid\"'"}, "project_id": {"type": "string", "description": "A project ID to filter by."}, "topic": {"type": "string", "description": "A log topic to search. Example topics: 'hashicorp.platform.audit', 'hashicorp.packer.registry.audit', 'hashicorp.boundary.cluster.audit', 'hashicorp.consul.cluster.audit'"}, "start_time": {"type": "string", "description": "The start time for the search. Accepts formats like '24 hours ago', 'yesterday at 5pm', or 'Oct 1, 2025'."}, "end_time": {"type": "string", "description": "The end time for the search. Accepts formats like 'now', 'today', or 'Oct 3, 2025'."}}, "required": ["organization_id", "start_time", "end_time"]}}]}, "id": 2}
2025-10-10 15:49:51,340 - mcp_server - INFO - Client call: {"method": "tools/call", "params": {"name": "search_logs", "arguments": {"topic": "hashicorp.platform.audit", "organization_id": "11eab4a9-75f1-e0a5-8be1-0242ac110016", "start_time": "8 days ago", "end_time": "now"}}, "jsonrpc": "2.0", "id": 3}
2025-10-10 15:49:57,371 - mcp_server - ERROR - An unexpected error occurred: 
Traceback (most recent call last):
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpx/_transports/default.py", line 101, in map_httpcore_exceptions
    yield
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpx/_transports/default.py", line 394, in handle_async_request
    resp = await self._pool.handle_async_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpcore/_async/connection_pool.py", line 256, in handle_async_request
    raise exc from None
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpcore/_async/connection_pool.py", line 236, in handle_async_request
    response = await connection.handle_async_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpcore/_async/connection.py", line 103, in handle_async_request
    return await self._connection.handle_async_request(request)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpcore/_async/http11.py", line 136, in handle_async_request
    raise exc
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpcore/_async/http11.py", line 106, in handle_async_request
    ) = await self._receive_response_headers(**kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpcore/_async/http11.py", line 177, in _receive_response_headers
    event = await self._receive_event(timeout=timeout)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpcore/_async/http11.py", line 217, in _receive_event
    data = await self._network_stream.read(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpcore/_backends/anyio.py", line 32, in read
    with map_exceptions(exc_map):
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/contextlib.py", line 158, in __exit__
    self.gen.throw(value)
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ReadTimeout

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/tpowell/Documents/workspace/hcp_mcp_server/main.py", line 174, in process_mcp_request
    result = await TOOL_MAP[tool_name](**arguments)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/Documents/workspace/hcp_mcp_server/hcp/audit_logs.py", line 81, in search_logs
    response = await client.post(
               ^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpx/_client.py", line 1859, in post
    return await self.request(
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpx/_client.py", line 1540, in request
    return await self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpx/_client.py", line 1629, in send
    response = await self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpx/_client.py", line 1657, in _send_handling_auth
    response = await self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpx/_client.py", line 1694, in _send_handling_redirects
    response = await self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpx/_client.py", line 1730, in _send_single_request
    response = await transport.handle_async_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpx/_transports/default.py", line 393, in handle_async_request
    with map_httpcore_exceptions():
         ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/contextlib.py", line 158, in __exit__
    self.gen.throw(value)
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpx/_transports/default.py", line 118, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ReadTimeout
2025-10-10 15:49:57,384 - mcp_server - INFO - Request data: stdio_main: {'jsonrpc': '2.0', 'error': {'code': -32000, 'message': 'Server error', 'data': 'An unexpected error occurred. See logs for details.'}, 'id': 3}
2025-10-10 15:49:57,384 - mcp_server - INFO - Request data: stdio_main json: {"jsonrpc": "2.0", "error": {"code": -32000, "message": "Server error", "data": "An unexpected error occurred. See logs for details."}, "id": 3}
2025-10-10 15:59:48,154 - mcp_server - INFO - Received request: {"method": "initialize", "params": {"protocolVersion": "2025-06-18", "capabilities": {"roots": {}}, "clientInfo": {"name": "gemini-cli-mcp-client-HCP", "version": "0.0.1"}}, "jsonrpc": "2.0", "id": 0}
2025-10-10 15:59:48,154 - mcp_server - INFO - Request data: stdio_main: {'jsonrpc': '2.0', 'result': {'protocolVersion': '2024-11-05', 'serverInfo': {'name': 'HCP', 'version': '0.0.1'}, 'capabilities': {'tools': {'listChanged': True}, 'prompts': {'listChanged': True}, 'resources': {'listChanged': True}}}, 'id': 0}
2025-10-10 15:59:48,154 - mcp_server - INFO - Request data: stdio_main json: {"jsonrpc": "2.0", "result": {"protocolVersion": "2024-11-05", "serverInfo": {"name": "HCP", "version": "0.0.1"}, "capabilities": {"tools": {"listChanged": true}, "prompts": {"listChanged": true}, "resources": {"listChanged": true}}}, "id": 0}
2025-10-10 15:59:48,154 - mcp_server - INFO - Received request: {"method": "notifications/initialized", "jsonrpc": "2.0"}
2025-10-10 15:59:48,154 - mcp_server - INFO - Client initialized.
2025-10-10 15:59:48,154 - mcp_server - INFO - Received request: {"method": "prompts/list", "params": {}, "jsonrpc": "2.0", "id": 1}
2025-10-10 15:59:48,155 - mcp_server - INFO - Request data: stdio_main: {'jsonrpc': '2.0', 'result': {'prompts': [{'name': 'list_projects', 'title': 'List Projects', 'description': 'Lists all HCP projects for a given organization.', 'arguments': [{'name': 'organization_id', 'description': 'The ID of the organization.', 'required': True}]}, {'name': 'get_project', 'title': 'Get Project', 'description': 'Gets an HCP project by its ID.', 'arguments': [{'name': 'project_id', 'description': 'The ID of the project.', 'required': True}]}, {'name': 'delete_project', 'title': 'Delete Project', 'description': 'Deletes an HCP project by its ID.', 'arguments': [{'name': 'project_id', 'description': 'The ID of the project.', 'required': True}]}, {'name': 'create_project', 'title': 'Create Project', 'description': 'Creates a new HCP project.', 'arguments': [{'name': 'name', 'description': 'The name of the new project.', 'required': True}, {'name': 'organization_id', 'description': 'The ID of the organization.', 'required': True}]}, {'name': 'update_project', 'title': 'Update Project', 'description': 'Updates an HCP project.', 'arguments': [{'name': 'project_id', 'description': 'The ID of the project.', 'required': True}, {'name': 'name', 'description': 'The new name for the project.', 'required': True}, {'name': 'organization_id', 'description': 'The ID of the organization.', 'required': True}]}, {'name': 'get_organization', 'title': 'Get Organization', 'description': 'Gets an HCP organization by its ID.', 'arguments': [{'name': 'organization_id', 'description': 'The ID of the organization.', 'required': True}]}, {'name': 'list_organizations', 'title': 'List Organizations', 'description': 'Lists all HCP organizations.', 'arguments': None}, {'name': 'update_organization', 'title': 'Update Organization', 'description': 'Updates an HCP organization.', 'arguments': [{'name': 'organization_id', 'description': 'The ID of the organization.', 'required': True}, {'name': 'name', 'description': 'The new name for the organization.', 'required': True}]}, {'name': 'list_secrets', 'title': 'List Secrets', 'description': 'Lists all secrets for a given application.', 'arguments': [{'name': 'project_id', 'description': 'The ID of the project.', 'required': True}, {'name': 'app_name', 'description': 'The name of the application.', 'required': True}]}, {'name': 'get_secret', 'title': 'Get Secret', 'description': 'Gets a secret by its name.', 'arguments': [{'name': 'secret_name', 'description': 'The name of the secret.', 'required': True}, {'name': 'project_id', 'description': 'The ID of the project.', 'required': True}, {'name': 'app_name', 'description': 'The name of the application.', 'required': True}]}, {'name': 'delete_secret', 'title': 'Delete Secret', 'description': 'Deletes a secret by its name.', 'arguments': [{'name': 'secret_name', 'description': 'The name of the secret.', 'required': True}, {'name': 'project_id', 'description': 'The ID of the project.', 'required': True}, {'name': 'app_name', 'description': 'The name of the application.', 'required': True}]}, {'name': 'create_secret', 'title': 'Create Secret', 'description': 'Creates a new secret.', 'arguments': [{'name': 'secret_name', 'description': 'The name of the new secret.', 'required': True}, {'name': 'secret_value', 'description': 'The value of the new secret.', 'required': True}, {'name': 'project_id', 'description': 'The ID of the project.', 'required': True}, {'name': 'app_name', 'description': 'The name of the application.', 'required': True}]}, {'name': 'find_project_and_list_secrets', 'title': 'Find Project and List Secrets', 'description': 'Finds a project by name and lists its secrets.', 'arguments': [{'name': 'project_name', 'description': 'The name of the project.', 'required': True}, {'name': 'organization_id', 'description': 'The ID of the organization.', 'required': True}, {'name': 'app_name', 'description': 'The name of the application.', 'required': True}]}, {'name': 'list_resources', 'title': 'List Resources', 'description': 'Lists all resources in a project.', 'arguments': [{'name': 'project_id', 'description': 'The ID of the project.', 'required': True}]}, {'name': 'search_logs', 'title': 'Search Logs', 'description': 'Searches for audit logs in an organization using LogQL. The LLM should determine the best topic to use based on the user\'s query, or default to \'hashicorp.platform.audit\' if the user is not specific. For advanced filtering, use the `query` parameter with LogQL syntax. To filter on specific JSON fields in the log entries, use the `| json` parser in your query. For example: `query=\'| json | control_plane_event_action="CREATE"\'`', 'arguments': [{'name': 'organization_id', 'description': 'The ID of the organization.', 'required': True}, {'name': 'query', 'description': 'The LogQL query string for advanced filtering. Can be combined with `project_id` and `topic`. Example: \'| json | resource_uuid="some-uuid"\'', 'required': False}, {'name': 'project_id', 'description': 'A project ID to filter by.', 'required': False}, {'name': 'topic', 'description': "A log topic to search. Example topics: 'hashicorp.platform.audit', 'hashicorp.packer.registry.audit', 'hashicorp.boundary.cluster.audit', 'hashicorp.consul.cluster.audit'", 'required': True}, {'name': 'start_time', 'description': "The start time for the search. Accepts formats like '24 hours ago', 'yesterday at 5pm', or 'Oct 1, 2025'.", 'required': True}, {'name': 'end_time', 'description': "The end time for the search. Accepts formats like 'now', 'today', or 'Oct 3, 2025'.", 'required': True}]}]}, 'id': 1}
2025-10-10 15:59:48,155 - mcp_server - INFO - Request data: stdio_main json: {"jsonrpc": "2.0", "result": {"prompts": [{"name": "list_projects", "title": "List Projects", "description": "Lists all HCP projects for a given organization.", "arguments": [{"name": "organization_id", "description": "The ID of the organization.", "required": true}]}, {"name": "get_project", "title": "Get Project", "description": "Gets an HCP project by its ID.", "arguments": [{"name": "project_id", "description": "The ID of the project.", "required": true}]}, {"name": "delete_project", "title": "Delete Project", "description": "Deletes an HCP project by its ID.", "arguments": [{"name": "project_id", "description": "The ID of the project.", "required": true}]}, {"name": "create_project", "title": "Create Project", "description": "Creates a new HCP project.", "arguments": [{"name": "name", "description": "The name of the new project.", "required": true}, {"name": "organization_id", "description": "The ID of the organization.", "required": true}]}, {"name": "update_project", "title": "Update Project", "description": "Updates an HCP project.", "arguments": [{"name": "project_id", "description": "The ID of the project.", "required": true}, {"name": "name", "description": "The new name for the project.", "required": true}, {"name": "organization_id", "description": "The ID of the organization.", "required": true}]}, {"name": "get_organization", "title": "Get Organization", "description": "Gets an HCP organization by its ID.", "arguments": [{"name": "organization_id", "description": "The ID of the organization.", "required": true}]}, {"name": "list_organizations", "title": "List Organizations", "description": "Lists all HCP organizations.", "arguments": null}, {"name": "update_organization", "title": "Update Organization", "description": "Updates an HCP organization.", "arguments": [{"name": "organization_id", "description": "The ID of the organization.", "required": true}, {"name": "name", "description": "The new name for the organization.", "required": true}]}, {"name": "list_secrets", "title": "List Secrets", "description": "Lists all secrets for a given application.", "arguments": [{"name": "project_id", "description": "The ID of the project.", "required": true}, {"name": "app_name", "description": "The name of the application.", "required": true}]}, {"name": "get_secret", "title": "Get Secret", "description": "Gets a secret by its name.", "arguments": [{"name": "secret_name", "description": "The name of the secret.", "required": true}, {"name": "project_id", "description": "The ID of the project.", "required": true}, {"name": "app_name", "description": "The name of the application.", "required": true}]}, {"name": "delete_secret", "title": "Delete Secret", "description": "Deletes a secret by its name.", "arguments": [{"name": "secret_name", "description": "The name of the secret.", "required": true}, {"name": "project_id", "description": "The ID of the project.", "required": true}, {"name": "app_name", "description": "The name of the application.", "required": true}]}, {"name": "create_secret", "title": "Create Secret", "description": "Creates a new secret.", "arguments": [{"name": "secret_name", "description": "The name of the new secret.", "required": true}, {"name": "secret_value", "description": "The value of the new secret.", "required": true}, {"name": "project_id", "description": "The ID of the project.", "required": true}, {"name": "app_name", "description": "The name of the application.", "required": true}]}, {"name": "find_project_and_list_secrets", "title": "Find Project and List Secrets", "description": "Finds a project by name and lists its secrets.", "arguments": [{"name": "project_name", "description": "The name of the project.", "required": true}, {"name": "organization_id", "description": "The ID of the organization.", "required": true}, {"name": "app_name", "description": "The name of the application.", "required": true}]}, {"name": "list_resources", "title": "List Resources", "description": "Lists all resources in a project.", "arguments": [{"name": "project_id", "description": "The ID of the project.", "required": true}]}, {"name": "search_logs", "title": "Search Logs", "description": "Searches for audit logs in an organization using LogQL. The LLM should determine the best topic to use based on the user's query, or default to 'hashicorp.platform.audit' if the user is not specific. For advanced filtering, use the `query` parameter with LogQL syntax. To filter on specific JSON fields in the log entries, use the `| json` parser in your query. For example: `query='| json | control_plane_event_action=\"CREATE\"'`", "arguments": [{"name": "organization_id", "description": "The ID of the organization.", "required": true}, {"name": "query", "description": "The LogQL query string for advanced filtering. Can be combined with `project_id` and `topic`. Example: '| json | resource_uuid=\"some-uuid\"'", "required": false}, {"name": "project_id", "description": "A project ID to filter by.", "required": false}, {"name": "topic", "description": "A log topic to search. Example topics: 'hashicorp.platform.audit', 'hashicorp.packer.registry.audit', 'hashicorp.boundary.cluster.audit', 'hashicorp.consul.cluster.audit'", "required": true}, {"name": "start_time", "description": "The start time for the search. Accepts formats like '24 hours ago', 'yesterday at 5pm', or 'Oct 1, 2025'.", "required": true}, {"name": "end_time", "description": "The end time for the search. Accepts formats like 'now', 'today', or 'Oct 3, 2025'.", "required": true}]}]}, "id": 1}
2025-10-10 15:59:48,155 - mcp_server - INFO - Received request: {"method": "tools/list", "params": {}, "jsonrpc": "2.0", "id": 2}
2025-10-10 15:59:48,155 - mcp_server - INFO - Request data: stdio_main: {'jsonrpc': '2.0', 'result': {'tools': [{'name': 'list_projects', 'description': 'Lists all HCP projects for a given organization.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}}, 'required': ['organization_id']}}, {'name': 'get_project', 'description': 'Gets an HCP project by its ID.', 'inputSchema': {'type': 'object', 'properties': {'project_id': {'type': 'string', 'description': 'The ID of the project.'}}, 'required': ['project_id']}}, {'name': 'delete_project', 'description': 'Deletes an HCP project by its ID.', 'inputSchema': {'type': 'object', 'properties': {'project_id': {'type': 'string', 'description': 'The ID of the project.'}}, 'required': ['project_id']}}, {'name': 'create_project', 'description': 'Creates a new HCP project.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'name': {'type': 'string', 'description': 'The name of the new project.'}}, 'required': ['organization_id', 'name']}}, {'name': 'update_project', 'description': 'Updates an HCP project.', 'inputSchema': {'type': 'object', 'properties': {'project_id': {'type': 'string', 'description': 'The ID of the project.'}, 'name': {'type': 'string', 'description': 'The new name of the project.'}}, 'required': ['project_id', 'name']}}, {'name': 'get_organization', 'description': 'Gets an HCP organization by its ID.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}}, 'required': ['organization_id']}}, {'name': 'list_organizations', 'description': 'Lists all HCP organizations.', 'inputSchema': {'type': 'object', 'properties': {}}}, {'name': 'update_organization', 'description': 'Updates an HCP organization.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'name': {'type': 'string', 'description': 'The new name of the organization.'}}, 'required': ['organization_id', 'name']}}, {'name': 'search_principals', 'description': 'Searches for principals in an organization.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'filter_str': {'type': 'string', 'description': 'The filter string to use for the search.'}}, 'required': ['organization_id']}}, {'name': 'get_principals', 'description': 'Gets principals by their IDs.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'principal_ids': {'type': 'array', 'items': {'type': 'string'}, 'description': 'The IDs of the principals to get.'}}, 'required': ['organization_id', 'principal_ids']}}, {'name': 'delete_service_principal', 'description': 'Deletes a service principal by its ID.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'principal_id': {'type': 'string', 'description': 'The ID of the service principal.'}}, 'required': ['organization_id', 'principal_id']}}, {'name': 'create_service_principal', 'description': 'Creates a new service principal.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'name': {'type': 'string', 'description': 'The name of the new service principal.'}}, 'required': ['organization_id', 'name']}}, {'name': 'update_service_principal', 'description': 'Updates a service principal.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'principal_id': {'type': 'string', 'description': 'The ID of the service principal.'}, 'name': {'type': 'string', 'description': 'The new name of the service principal.'}}, 'required': ['organization_id', 'principal_id', 'name']}}, {'name': 'list_secrets', 'description': 'Lists all secrets for a given application.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'project_id': {'type': 'string', 'description': 'The ID of the project.'}, 'app_name': {'type': 'string', 'description': 'The name of the application.'}}, 'required': ['organization_id', 'project_id', 'app_name']}}, {'name': 'get_secret', 'description': 'Gets a secret by its name.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'project_id': {'type': 'string', 'description': 'The ID of the project.'}, 'app_name': {'type': 'string', 'description': 'The name of the application.'}, 'secret_name': {'type': 'string', 'description': 'The name of the secret.'}}, 'required': ['organization_id', 'project_id', 'app_name', 'secret_name']}}, {'name': 'delete_secret', 'description': 'Deletes a secret by its name.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'project_id': {'type': 'string', 'description': 'The ID of the project.'}, 'app_name': {'type': 'string', 'description': 'The name of the application.'}, 'secret_name': {'type': 'string', 'description': 'The name of the secret.'}}, 'required': ['organization_id', 'project_id', 'app_name', 'secret_name']}}, {'name': 'create_secret', 'description': 'Creates a new secret.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'project_id': {'type': 'string', 'description': 'The ID of the project.'}, 'app_name': {'type': 'string', 'description': 'The name of the application.'}, 'secret_name': {'type': 'string', 'description': 'The name of the new secret.'}, 'secret_value': {'type': 'string', 'description': 'The value of the new secret.'}}, 'required': ['organization_id', 'project_id', 'app_name', 'secret_name', 'secret_value']}}, {'name': 'find_project_by_name', 'description': 'Finds a project by its name.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'name': {'type': 'string', 'description': 'The name of the project.'}}, 'required': ['organization_id', 'name']}}, {'name': 'find_user_by_email', 'description': 'Finds a user by their email.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'email': {'type': 'string', 'description': 'The email of the user.'}}, 'required': ['organization_id', 'email']}}, {'name': 'find_organization_by_name', 'description': 'Finds an organization by its name.', 'inputSchema': {'type': 'object', 'properties': {'name': {'type': 'string', 'description': 'The name of the organization.'}}, 'required': ['name']}}, {'name': 'list_resources', 'description': 'Lists all resources in a project.', 'inputSchema': {'type': 'object', 'properties': {'project_id': {'type': 'string', 'description': 'The ID of the project.'}}, 'required': ['project_id']}}, {'name': 'search_logs', 'description': 'Searches for audit logs in an organization using LogQL. At least one of `query`, `project_id`, or `topic` must be provided. For advanced filtering, use the `query` parameter with LogQL syntax. To filter on specific JSON fields in the log entries, use the `| json` parser in your query. For example: `query=\'| json | control_plane_event_action="CREATE"\'`', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'query': {'type': 'string', 'description': 'The LogQL query string for advanced filtering. Can be combined with `project_id` and `topic`. Example: \'| json | resource_uuid="some-uuid"\''}, 'project_id': {'type': 'string', 'description': 'A project ID to filter by.'}, 'topic': {'type': 'string', 'description': "A log topic to search. Example topics: 'hashicorp.platform.audit', 'hashicorp.packer.registry.audit', 'hashicorp.boundary.cluster.audit', 'hashicorp.consul.cluster.audit'"}, 'start_time': {'type': 'string', 'description': "The start time for the search. Accepts formats like '24 hours ago', 'yesterday at 5pm', or 'Oct 1, 2025'."}, 'end_time': {'type': 'string', 'description': "The end time for the search. Accepts formats like 'now', 'today', or 'Oct 3, 2025'."}}, 'required': ['organization_id', 'start_time', 'end_time']}}]}, 'id': 2}
2025-10-10 15:59:48,155 - mcp_server - INFO - Request data: stdio_main json: {"jsonrpc": "2.0", "result": {"tools": [{"name": "list_projects", "description": "Lists all HCP projects for a given organization.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}}, "required": ["organization_id"]}}, {"name": "get_project", "description": "Gets an HCP project by its ID.", "inputSchema": {"type": "object", "properties": {"project_id": {"type": "string", "description": "The ID of the project."}}, "required": ["project_id"]}}, {"name": "delete_project", "description": "Deletes an HCP project by its ID.", "inputSchema": {"type": "object", "properties": {"project_id": {"type": "string", "description": "The ID of the project."}}, "required": ["project_id"]}}, {"name": "create_project", "description": "Creates a new HCP project.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "name": {"type": "string", "description": "The name of the new project."}}, "required": ["organization_id", "name"]}}, {"name": "update_project", "description": "Updates an HCP project.", "inputSchema": {"type": "object", "properties": {"project_id": {"type": "string", "description": "The ID of the project."}, "name": {"type": "string", "description": "The new name of the project."}}, "required": ["project_id", "name"]}}, {"name": "get_organization", "description": "Gets an HCP organization by its ID.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}}, "required": ["organization_id"]}}, {"name": "list_organizations", "description": "Lists all HCP organizations.", "inputSchema": {"type": "object", "properties": {}}}, {"name": "update_organization", "description": "Updates an HCP organization.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "name": {"type": "string", "description": "The new name of the organization."}}, "required": ["organization_id", "name"]}}, {"name": "search_principals", "description": "Searches for principals in an organization.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "filter_str": {"type": "string", "description": "The filter string to use for the search."}}, "required": ["organization_id"]}}, {"name": "get_principals", "description": "Gets principals by their IDs.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "principal_ids": {"type": "array", "items": {"type": "string"}, "description": "The IDs of the principals to get."}}, "required": ["organization_id", "principal_ids"]}}, {"name": "delete_service_principal", "description": "Deletes a service principal by its ID.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "principal_id": {"type": "string", "description": "The ID of the service principal."}}, "required": ["organization_id", "principal_id"]}}, {"name": "create_service_principal", "description": "Creates a new service principal.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "name": {"type": "string", "description": "The name of the new service principal."}}, "required": ["organization_id", "name"]}}, {"name": "update_service_principal", "description": "Updates a service principal.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "principal_id": {"type": "string", "description": "The ID of the service principal."}, "name": {"type": "string", "description": "The new name of the service principal."}}, "required": ["organization_id", "principal_id", "name"]}}, {"name": "list_secrets", "description": "Lists all secrets for a given application.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "project_id": {"type": "string", "description": "The ID of the project."}, "app_name": {"type": "string", "description": "The name of the application."}}, "required": ["organization_id", "project_id", "app_name"]}}, {"name": "get_secret", "description": "Gets a secret by its name.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "project_id": {"type": "string", "description": "The ID of the project."}, "app_name": {"type": "string", "description": "The name of the application."}, "secret_name": {"type": "string", "description": "The name of the secret."}}, "required": ["organization_id", "project_id", "app_name", "secret_name"]}}, {"name": "delete_secret", "description": "Deletes a secret by its name.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "project_id": {"type": "string", "description": "The ID of the project."}, "app_name": {"type": "string", "description": "The name of the application."}, "secret_name": {"type": "string", "description": "The name of the secret."}}, "required": ["organization_id", "project_id", "app_name", "secret_name"]}}, {"name": "create_secret", "description": "Creates a new secret.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "project_id": {"type": "string", "description": "The ID of the project."}, "app_name": {"type": "string", "description": "The name of the application."}, "secret_name": {"type": "string", "description": "The name of the new secret."}, "secret_value": {"type": "string", "description": "The value of the new secret."}}, "required": ["organization_id", "project_id", "app_name", "secret_name", "secret_value"]}}, {"name": "find_project_by_name", "description": "Finds a project by its name.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "name": {"type": "string", "description": "The name of the project."}}, "required": ["organization_id", "name"]}}, {"name": "find_user_by_email", "description": "Finds a user by their email.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "email": {"type": "string", "description": "The email of the user."}}, "required": ["organization_id", "email"]}}, {"name": "find_organization_by_name", "description": "Finds an organization by its name.", "inputSchema": {"type": "object", "properties": {"name": {"type": "string", "description": "The name of the organization."}}, "required": ["name"]}}, {"name": "list_resources", "description": "Lists all resources in a project.", "inputSchema": {"type": "object", "properties": {"project_id": {"type": "string", "description": "The ID of the project."}}, "required": ["project_id"]}}, {"name": "search_logs", "description": "Searches for audit logs in an organization using LogQL. At least one of `query`, `project_id`, or `topic` must be provided. For advanced filtering, use the `query` parameter with LogQL syntax. To filter on specific JSON fields in the log entries, use the `| json` parser in your query. For example: `query='| json | control_plane_event_action=\"CREATE\"'`", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "query": {"type": "string", "description": "The LogQL query string for advanced filtering. Can be combined with `project_id` and `topic`. Example: '| json | resource_uuid=\"some-uuid\"'"}, "project_id": {"type": "string", "description": "A project ID to filter by."}, "topic": {"type": "string", "description": "A log topic to search. Example topics: 'hashicorp.platform.audit', 'hashicorp.packer.registry.audit', 'hashicorp.boundary.cluster.audit', 'hashicorp.consul.cluster.audit'"}, "start_time": {"type": "string", "description": "The start time for the search. Accepts formats like '24 hours ago', 'yesterday at 5pm', or 'Oct 1, 2025'."}, "end_time": {"type": "string", "description": "The end time for the search. Accepts formats like 'now', 'today', or 'Oct 3, 2025'."}}, "required": ["organization_id", "start_time", "end_time"]}}]}, "id": 2}
2025-10-10 16:00:13,777 - mcp_server - INFO - Client call: {"method": "tools/call", "params": {"name": "search_logs", "arguments": {"organization_id": "11eab4a9-75f1-e0a5-8be1-0242ac110016", "start_time": "8 days ago", "topic": "hashicorp.platform.audit", "end_time": "now"}}, "jsonrpc": "2.0", "id": 3}
2025-10-10 16:00:19,808 - mcp_server - ERROR - An unexpected error occurred: 
Traceback (most recent call last):
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpx/_transports/default.py", line 101, in map_httpcore_exceptions
    yield
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpx/_transports/default.py", line 394, in handle_async_request
    resp = await self._pool.handle_async_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpcore/_async/connection_pool.py", line 256, in handle_async_request
    raise exc from None
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpcore/_async/connection_pool.py", line 236, in handle_async_request
    response = await connection.handle_async_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpcore/_async/connection.py", line 103, in handle_async_request
    return await self._connection.handle_async_request(request)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpcore/_async/http11.py", line 136, in handle_async_request
    raise exc
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpcore/_async/http11.py", line 106, in handle_async_request
    ) = await self._receive_response_headers(**kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpcore/_async/http11.py", line 177, in _receive_response_headers
    event = await self._receive_event(timeout=timeout)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpcore/_async/http11.py", line 217, in _receive_event
    data = await self._network_stream.read(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpcore/_backends/anyio.py", line 32, in read
    with map_exceptions(exc_map):
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/contextlib.py", line 158, in __exit__
    self.gen.throw(value)
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ReadTimeout

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/tpowell/Documents/workspace/hcp_mcp_server/main.py", line 174, in process_mcp_request
    result = await TOOL_MAP[tool_name](**arguments)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/Documents/workspace/hcp_mcp_server/hcp/audit_logs.py", line 81, in search_logs
    response = await client.post(
               ^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpx/_client.py", line 1859, in post
    return await self.request(
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpx/_client.py", line 1540, in request
    return await self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpx/_client.py", line 1629, in send
    response = await self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpx/_client.py", line 1657, in _send_handling_auth
    response = await self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpx/_client.py", line 1694, in _send_handling_redirects
    response = await self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpx/_client.py", line 1730, in _send_single_request
    response = await transport.handle_async_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpx/_transports/default.py", line 393, in handle_async_request
    with map_httpcore_exceptions():
         ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/contextlib.py", line 158, in __exit__
    self.gen.throw(value)
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpx/_transports/default.py", line 118, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ReadTimeout
2025-10-10 16:00:19,819 - mcp_server - INFO - Request data: stdio_main: {'jsonrpc': '2.0', 'error': {'code': -32000, 'message': 'Server error', 'data': 'An unexpected error occurred. See logs for details.'}, 'id': 3}
2025-10-10 16:00:19,819 - mcp_server - INFO - Request data: stdio_main json: {"jsonrpc": "2.0", "error": {"code": -32000, "message": "Server error", "data": "An unexpected error occurred. See logs for details."}, "id": 3}
2025-10-11 10:54:35,893 - mcp_server - INFO - Received request: {"method": "initialize", "params": {"protocolVersion": "2025-06-18", "capabilities": {"roots": {}}, "clientInfo": {"name": "gemini-cli-mcp-client-HCP", "version": "0.0.1"}}, "jsonrpc": "2.0", "id": 0}
2025-10-11 10:54:35,893 - mcp_server - INFO - Request data: stdio_main: {'jsonrpc': '2.0', 'result': {'protocolVersion': '2024-11-05', 'serverInfo': {'name': 'HCP', 'version': '0.0.1'}, 'capabilities': {'tools': {'listChanged': True}, 'prompts': {'listChanged': True}, 'resources': {'listChanged': True}}}, 'id': 0}
2025-10-11 10:54:35,893 - mcp_server - INFO - Request data: stdio_main json: {"jsonrpc": "2.0", "result": {"protocolVersion": "2024-11-05", "serverInfo": {"name": "HCP", "version": "0.0.1"}, "capabilities": {"tools": {"listChanged": true}, "prompts": {"listChanged": true}, "resources": {"listChanged": true}}}, "id": 0}
2025-10-11 10:54:35,894 - mcp_server - INFO - Received request: {"method": "notifications/initialized", "jsonrpc": "2.0"}
2025-10-11 10:54:35,894 - mcp_server - INFO - Client initialized.
2025-10-11 10:54:35,894 - mcp_server - INFO - Received request: {"method": "prompts/list", "params": {}, "jsonrpc": "2.0", "id": 1}
2025-10-11 10:54:35,894 - mcp_server - INFO - Request data: stdio_main: {'jsonrpc': '2.0', 'result': {'prompts': [{'name': 'list_projects', 'title': 'List Projects', 'description': 'Lists all HCP projects for a given organization.', 'arguments': [{'name': 'organization_id', 'description': 'The ID of the organization.', 'required': True}]}, {'name': 'get_project', 'title': 'Get Project', 'description': 'Gets an HCP project by its ID.', 'arguments': [{'name': 'project_id', 'description': 'The ID of the project.', 'required': True}]}, {'name': 'delete_project', 'title': 'Delete Project', 'description': 'Deletes an HCP project by its ID.', 'arguments': [{'name': 'project_id', 'description': 'The ID of the project.', 'required': True}]}, {'name': 'create_project', 'title': 'Create Project', 'description': 'Creates a new HCP project.', 'arguments': [{'name': 'name', 'description': 'The name of the new project.', 'required': True}, {'name': 'organization_id', 'description': 'The ID of the organization.', 'required': True}]}, {'name': 'update_project', 'title': 'Update Project', 'description': 'Updates an HCP project.', 'arguments': [{'name': 'project_id', 'description': 'The ID of the project.', 'required': True}, {'name': 'name', 'description': 'The new name for the project.', 'required': True}, {'name': 'organization_id', 'description': 'The ID of the organization.', 'required': True}]}, {'name': 'get_organization', 'title': 'Get Organization', 'description': 'Gets an HCP organization by its ID.', 'arguments': [{'name': 'organization_id', 'description': 'The ID of the organization.', 'required': True}]}, {'name': 'list_organizations', 'title': 'List Organizations', 'description': 'Lists all HCP organizations.', 'arguments': None}, {'name': 'update_organization', 'title': 'Update Organization', 'description': 'Updates an HCP organization.', 'arguments': [{'name': 'organization_id', 'description': 'The ID of the organization.', 'required': True}, {'name': 'name', 'description': 'The new name for the organization.', 'required': True}]}, {'name': 'list_secrets', 'title': 'List Secrets', 'description': 'Lists all secrets for a given application.', 'arguments': [{'name': 'project_id', 'description': 'The ID of the project.', 'required': True}, {'name': 'app_name', 'description': 'The name of the application.', 'required': True}]}, {'name': 'get_secret', 'title': 'Get Secret', 'description': 'Gets a secret by its name.', 'arguments': [{'name': 'secret_name', 'description': 'The name of the secret.', 'required': True}, {'name': 'project_id', 'description': 'The ID of the project.', 'required': True}, {'name': 'app_name', 'description': 'The name of the application.', 'required': True}]}, {'name': 'delete_secret', 'title': 'Delete Secret', 'description': 'Deletes a secret by its name.', 'arguments': [{'name': 'secret_name', 'description': 'The name of the secret.', 'required': True}, {'name': 'project_id', 'description': 'The ID of the project.', 'required': True}, {'name': 'app_name', 'description': 'The name of the application.', 'required': True}]}, {'name': 'create_secret', 'title': 'Create Secret', 'description': 'Creates a new secret.', 'arguments': [{'name': 'secret_name', 'description': 'The name of the new secret.', 'required': True}, {'name': 'secret_value', 'description': 'The value of the new secret.', 'required': True}, {'name': 'project_id', 'description': 'The ID of the project.', 'required': True}, {'name': 'app_name', 'description': 'The name of the application.', 'required': True}]}, {'name': 'find_project_and_list_secrets', 'title': 'Find Project and List Secrets', 'description': 'Finds a project by name and lists its secrets.', 'arguments': [{'name': 'project_name', 'description': 'The name of the project.', 'required': True}, {'name': 'organization_id', 'description': 'The ID of the organization.', 'required': True}, {'name': 'app_name', 'description': 'The name of the application.', 'required': True}]}, {'name': 'list_resources', 'title': 'List Resources', 'description': 'Lists all resources in a project.', 'arguments': [{'name': 'project_id', 'description': 'The ID of the project.', 'required': True}]}, {'name': 'search_logs', 'title': 'Search Logs', 'description': 'Searches for audit logs in an organization using LogQL. The LLM should determine the best topic to use based on the user\'s query, or default to \'hashicorp.platform.audit\' if the user is not specific. For advanced filtering, use the `query` parameter with LogQL syntax. To filter on specific JSON fields in the log entries, use the `| json` parser in your query. For example: `query=\'| json | control_plane_event_action="CREATE"\'`', 'arguments': [{'name': 'organization_id', 'description': 'The ID of the organization.', 'required': True}, {'name': 'query', 'description': 'The LogQL query string for advanced filtering. Can be combined with `project_id` and `topic`. Example: \'| json | resource_uuid="some-uuid"\'', 'required': False}, {'name': 'project_id', 'description': 'A project ID to filter by.', 'required': False}, {'name': 'topic', 'description': "A log topic to search. Example topics: 'hashicorp.platform.audit', 'hashicorp.packer.registry.audit', 'hashicorp.boundary.cluster.audit', 'hashicorp.consul.cluster.audit'", 'required': True}, {'name': 'start_time', 'description': "The start time for the search. Accepts formats like '24 hours ago', 'yesterday at 5pm', or 'Oct 1, 2025'.", 'required': True}, {'name': 'end_time', 'description': "The end time for the search. Accepts formats like 'now', 'today', or 'Oct 3, 2025'.", 'required': True}]}]}, 'id': 1}
2025-10-11 10:54:35,894 - mcp_server - INFO - Request data: stdio_main json: {"jsonrpc": "2.0", "result": {"prompts": [{"name": "list_projects", "title": "List Projects", "description": "Lists all HCP projects for a given organization.", "arguments": [{"name": "organization_id", "description": "The ID of the organization.", "required": true}]}, {"name": "get_project", "title": "Get Project", "description": "Gets an HCP project by its ID.", "arguments": [{"name": "project_id", "description": "The ID of the project.", "required": true}]}, {"name": "delete_project", "title": "Delete Project", "description": "Deletes an HCP project by its ID.", "arguments": [{"name": "project_id", "description": "The ID of the project.", "required": true}]}, {"name": "create_project", "title": "Create Project", "description": "Creates a new HCP project.", "arguments": [{"name": "name", "description": "The name of the new project.", "required": true}, {"name": "organization_id", "description": "The ID of the organization.", "required": true}]}, {"name": "update_project", "title": "Update Project", "description": "Updates an HCP project.", "arguments": [{"name": "project_id", "description": "The ID of the project.", "required": true}, {"name": "name", "description": "The new name for the project.", "required": true}, {"name": "organization_id", "description": "The ID of the organization.", "required": true}]}, {"name": "get_organization", "title": "Get Organization", "description": "Gets an HCP organization by its ID.", "arguments": [{"name": "organization_id", "description": "The ID of the organization.", "required": true}]}, {"name": "list_organizations", "title": "List Organizations", "description": "Lists all HCP organizations.", "arguments": null}, {"name": "update_organization", "title": "Update Organization", "description": "Updates an HCP organization.", "arguments": [{"name": "organization_id", "description": "The ID of the organization.", "required": true}, {"name": "name", "description": "The new name for the organization.", "required": true}]}, {"name": "list_secrets", "title": "List Secrets", "description": "Lists all secrets for a given application.", "arguments": [{"name": "project_id", "description": "The ID of the project.", "required": true}, {"name": "app_name", "description": "The name of the application.", "required": true}]}, {"name": "get_secret", "title": "Get Secret", "description": "Gets a secret by its name.", "arguments": [{"name": "secret_name", "description": "The name of the secret.", "required": true}, {"name": "project_id", "description": "The ID of the project.", "required": true}, {"name": "app_name", "description": "The name of the application.", "required": true}]}, {"name": "delete_secret", "title": "Delete Secret", "description": "Deletes a secret by its name.", "arguments": [{"name": "secret_name", "description": "The name of the secret.", "required": true}, {"name": "project_id", "description": "The ID of the project.", "required": true}, {"name": "app_name", "description": "The name of the application.", "required": true}]}, {"name": "create_secret", "title": "Create Secret", "description": "Creates a new secret.", "arguments": [{"name": "secret_name", "description": "The name of the new secret.", "required": true}, {"name": "secret_value", "description": "The value of the new secret.", "required": true}, {"name": "project_id", "description": "The ID of the project.", "required": true}, {"name": "app_name", "description": "The name of the application.", "required": true}]}, {"name": "find_project_and_list_secrets", "title": "Find Project and List Secrets", "description": "Finds a project by name and lists its secrets.", "arguments": [{"name": "project_name", "description": "The name of the project.", "required": true}, {"name": "organization_id", "description": "The ID of the organization.", "required": true}, {"name": "app_name", "description": "The name of the application.", "required": true}]}, {"name": "list_resources", "title": "List Resources", "description": "Lists all resources in a project.", "arguments": [{"name": "project_id", "description": "The ID of the project.", "required": true}]}, {"name": "search_logs", "title": "Search Logs", "description": "Searches for audit logs in an organization using LogQL. The LLM should determine the best topic to use based on the user's query, or default to 'hashicorp.platform.audit' if the user is not specific. For advanced filtering, use the `query` parameter with LogQL syntax. To filter on specific JSON fields in the log entries, use the `| json` parser in your query. For example: `query='| json | control_plane_event_action=\"CREATE\"'`", "arguments": [{"name": "organization_id", "description": "The ID of the organization.", "required": true}, {"name": "query", "description": "The LogQL query string for advanced filtering. Can be combined with `project_id` and `topic`. Example: '| json | resource_uuid=\"some-uuid\"'", "required": false}, {"name": "project_id", "description": "A project ID to filter by.", "required": false}, {"name": "topic", "description": "A log topic to search. Example topics: 'hashicorp.platform.audit', 'hashicorp.packer.registry.audit', 'hashicorp.boundary.cluster.audit', 'hashicorp.consul.cluster.audit'", "required": true}, {"name": "start_time", "description": "The start time for the search. Accepts formats like '24 hours ago', 'yesterday at 5pm', or 'Oct 1, 2025'.", "required": true}, {"name": "end_time", "description": "The end time for the search. Accepts formats like 'now', 'today', or 'Oct 3, 2025'.", "required": true}]}]}, "id": 1}
2025-10-11 10:54:35,895 - mcp_server - INFO - Received request: {"method": "tools/list", "params": {}, "jsonrpc": "2.0", "id": 2}
2025-10-11 10:54:35,895 - mcp_server - INFO - Request data: stdio_main: {'jsonrpc': '2.0', 'result': {'tools': [{'name': 'list_projects', 'description': 'Lists all HCP projects for a given organization.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}}, 'required': ['organization_id']}}, {'name': 'get_project', 'description': 'Gets an HCP project by its ID.', 'inputSchema': {'type': 'object', 'properties': {'project_id': {'type': 'string', 'description': 'The ID of the project.'}}, 'required': ['project_id']}}, {'name': 'delete_project', 'description': 'Deletes an HCP project by its ID.', 'inputSchema': {'type': 'object', 'properties': {'project_id': {'type': 'string', 'description': 'The ID of the project.'}}, 'required': ['project_id']}}, {'name': 'create_project', 'description': 'Creates a new HCP project.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'name': {'type': 'string', 'description': 'The name of the new project.'}}, 'required': ['organization_id', 'name']}}, {'name': 'update_project', 'description': 'Updates an HCP project.', 'inputSchema': {'type': 'object', 'properties': {'project_id': {'type': 'string', 'description': 'The ID of the project.'}, 'name': {'type': 'string', 'description': 'The new name of the project.'}}, 'required': ['project_id', 'name']}}, {'name': 'get_organization', 'description': 'Gets an HCP organization by its ID.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}}, 'required': ['organization_id']}}, {'name': 'list_organizations', 'description': 'Lists all HCP organizations.', 'inputSchema': {'type': 'object', 'properties': {}}}, {'name': 'update_organization', 'description': 'Updates an HCP organization.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'name': {'type': 'string', 'description': 'The new name of the organization.'}}, 'required': ['organization_id', 'name']}}, {'name': 'search_principals', 'description': 'Searches for principals in an organization.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'filter_str': {'type': 'string', 'description': 'The filter string to use for the search.'}}, 'required': ['organization_id']}}, {'name': 'get_principals', 'description': 'Gets principals by their IDs.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'principal_ids': {'type': 'array', 'items': {'type': 'string'}, 'description': 'The IDs of the principals to get.'}}, 'required': ['organization_id', 'principal_ids']}}, {'name': 'delete_service_principal', 'description': 'Deletes a service principal by its ID.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'principal_id': {'type': 'string', 'description': 'The ID of the service principal.'}}, 'required': ['organization_id', 'principal_id']}}, {'name': 'create_service_principal', 'description': 'Creates a new service principal.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'name': {'type': 'string', 'description': 'The name of the new service principal.'}}, 'required': ['organization_id', 'name']}}, {'name': 'update_service_principal', 'description': 'Updates a service principal.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'principal_id': {'type': 'string', 'description': 'The ID of the service principal.'}, 'name': {'type': 'string', 'description': 'The new name of the service principal.'}}, 'required': ['organization_id', 'principal_id', 'name']}}, {'name': 'list_secrets', 'description': 'Lists all secrets for a given application.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'project_id': {'type': 'string', 'description': 'The ID of the project.'}, 'app_name': {'type': 'string', 'description': 'The name of the application.'}}, 'required': ['organization_id', 'project_id', 'app_name']}}, {'name': 'get_secret', 'description': 'Gets a secret by its name.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'project_id': {'type': 'string', 'description': 'The ID of the project.'}, 'app_name': {'type': 'string', 'description': 'The name of the application.'}, 'secret_name': {'type': 'string', 'description': 'The name of the secret.'}}, 'required': ['organization_id', 'project_id', 'app_name', 'secret_name']}}, {'name': 'delete_secret', 'description': 'Deletes a secret by its name.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'project_id': {'type': 'string', 'description': 'The ID of the project.'}, 'app_name': {'type': 'string', 'description': 'The name of the application.'}, 'secret_name': {'type': 'string', 'description': 'The name of the secret.'}}, 'required': ['organization_id', 'project_id', 'app_name', 'secret_name']}}, {'name': 'create_secret', 'description': 'Creates a new secret.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'project_id': {'type': 'string', 'description': 'The ID of the project.'}, 'app_name': {'type': 'string', 'description': 'The name of the application.'}, 'secret_name': {'type': 'string', 'description': 'The name of the new secret.'}, 'secret_value': {'type': 'string', 'description': 'The value of the new secret.'}}, 'required': ['organization_id', 'project_id', 'app_name', 'secret_name', 'secret_value']}}, {'name': 'find_project_by_name', 'description': 'Finds a project by its name.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'name': {'type': 'string', 'description': 'The name of the project.'}}, 'required': ['organization_id', 'name']}}, {'name': 'find_user_by_email', 'description': 'Finds a user by their email.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'email': {'type': 'string', 'description': 'The email of the user.'}}, 'required': ['organization_id', 'email']}}, {'name': 'find_organization_by_name', 'description': 'Finds an organization by its name.', 'inputSchema': {'type': 'object', 'properties': {'name': {'type': 'string', 'description': 'The name of the organization.'}}, 'required': ['name']}}, {'name': 'list_resources', 'description': 'Lists all resources in a project.', 'inputSchema': {'type': 'object', 'properties': {'project_id': {'type': 'string', 'description': 'The ID of the project.'}}, 'required': ['project_id']}}, {'name': 'search_logs', 'description': 'Searches for audit logs in an organization using LogQL. At least one of `query`, `project_id`, or `topic` must be provided. For advanced filtering, use the `query` parameter with LogQL syntax. To filter on specific JSON fields in the log entries, use the `| json` parser in your query. For example: `query=\'| json | control_plane_event_action="CREATE"\'`', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'query': {'type': 'string', 'description': 'The LogQL query string for advanced filtering. Can be combined with `project_id` and `topic`. Example: \'| json | resource_uuid="some-uuid"\''}, 'project_id': {'type': 'string', 'description': 'A project ID to filter by.'}, 'topic': {'type': 'string', 'description': "A log topic to search. Example topics: 'hashicorp.platform.audit', 'hashicorp.packer.registry.audit', 'hashicorp.boundary.cluster.audit', 'hashicorp.consul.cluster.audit'"}, 'start_time': {'type': 'string', 'description': "The start time for the search. Accepts formats like '24 hours ago', 'yesterday at 5pm', or 'Oct 1, 2025'."}, 'end_time': {'type': 'string', 'description': "The end time for the search. Accepts formats like 'now', 'today', or 'Oct 3, 2025'."}}, 'required': ['organization_id', 'start_time', 'end_time']}}]}, 'id': 2}
2025-10-11 10:54:35,895 - mcp_server - INFO - Request data: stdio_main json: {"jsonrpc": "2.0", "result": {"tools": [{"name": "list_projects", "description": "Lists all HCP projects for a given organization.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}}, "required": ["organization_id"]}}, {"name": "get_project", "description": "Gets an HCP project by its ID.", "inputSchema": {"type": "object", "properties": {"project_id": {"type": "string", "description": "The ID of the project."}}, "required": ["project_id"]}}, {"name": "delete_project", "description": "Deletes an HCP project by its ID.", "inputSchema": {"type": "object", "properties": {"project_id": {"type": "string", "description": "The ID of the project."}}, "required": ["project_id"]}}, {"name": "create_project", "description": "Creates a new HCP project.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "name": {"type": "string", "description": "The name of the new project."}}, "required": ["organization_id", "name"]}}, {"name": "update_project", "description": "Updates an HCP project.", "inputSchema": {"type": "object", "properties": {"project_id": {"type": "string", "description": "The ID of the project."}, "name": {"type": "string", "description": "The new name of the project."}}, "required": ["project_id", "name"]}}, {"name": "get_organization", "description": "Gets an HCP organization by its ID.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}}, "required": ["organization_id"]}}, {"name": "list_organizations", "description": "Lists all HCP organizations.", "inputSchema": {"type": "object", "properties": {}}}, {"name": "update_organization", "description": "Updates an HCP organization.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "name": {"type": "string", "description": "The new name of the organization."}}, "required": ["organization_id", "name"]}}, {"name": "search_principals", "description": "Searches for principals in an organization.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "filter_str": {"type": "string", "description": "The filter string to use for the search."}}, "required": ["organization_id"]}}, {"name": "get_principals", "description": "Gets principals by their IDs.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "principal_ids": {"type": "array", "items": {"type": "string"}, "description": "The IDs of the principals to get."}}, "required": ["organization_id", "principal_ids"]}}, {"name": "delete_service_principal", "description": "Deletes a service principal by its ID.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "principal_id": {"type": "string", "description": "The ID of the service principal."}}, "required": ["organization_id", "principal_id"]}}, {"name": "create_service_principal", "description": "Creates a new service principal.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "name": {"type": "string", "description": "The name of the new service principal."}}, "required": ["organization_id", "name"]}}, {"name": "update_service_principal", "description": "Updates a service principal.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "principal_id": {"type": "string", "description": "The ID of the service principal."}, "name": {"type": "string", "description": "The new name of the service principal."}}, "required": ["organization_id", "principal_id", "name"]}}, {"name": "list_secrets", "description": "Lists all secrets for a given application.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "project_id": {"type": "string", "description": "The ID of the project."}, "app_name": {"type": "string", "description": "The name of the application."}}, "required": ["organization_id", "project_id", "app_name"]}}, {"name": "get_secret", "description": "Gets a secret by its name.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "project_id": {"type": "string", "description": "The ID of the project."}, "app_name": {"type": "string", "description": "The name of the application."}, "secret_name": {"type": "string", "description": "The name of the secret."}}, "required": ["organization_id", "project_id", "app_name", "secret_name"]}}, {"name": "delete_secret", "description": "Deletes a secret by its name.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "project_id": {"type": "string", "description": "The ID of the project."}, "app_name": {"type": "string", "description": "The name of the application."}, "secret_name": {"type": "string", "description": "The name of the secret."}}, "required": ["organization_id", "project_id", "app_name", "secret_name"]}}, {"name": "create_secret", "description": "Creates a new secret.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "project_id": {"type": "string", "description": "The ID of the project."}, "app_name": {"type": "string", "description": "The name of the application."}, "secret_name": {"type": "string", "description": "The name of the new secret."}, "secret_value": {"type": "string", "description": "The value of the new secret."}}, "required": ["organization_id", "project_id", "app_name", "secret_name", "secret_value"]}}, {"name": "find_project_by_name", "description": "Finds a project by its name.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "name": {"type": "string", "description": "The name of the project."}}, "required": ["organization_id", "name"]}}, {"name": "find_user_by_email", "description": "Finds a user by their email.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "email": {"type": "string", "description": "The email of the user."}}, "required": ["organization_id", "email"]}}, {"name": "find_organization_by_name", "description": "Finds an organization by its name.", "inputSchema": {"type": "object", "properties": {"name": {"type": "string", "description": "The name of the organization."}}, "required": ["name"]}}, {"name": "list_resources", "description": "Lists all resources in a project.", "inputSchema": {"type": "object", "properties": {"project_id": {"type": "string", "description": "The ID of the project."}}, "required": ["project_id"]}}, {"name": "search_logs", "description": "Searches for audit logs in an organization using LogQL. At least one of `query`, `project_id`, or `topic` must be provided. For advanced filtering, use the `query` parameter with LogQL syntax. To filter on specific JSON fields in the log entries, use the `| json` parser in your query. For example: `query='| json | control_plane_event_action=\"CREATE\"'`", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "query": {"type": "string", "description": "The LogQL query string for advanced filtering. Can be combined with `project_id` and `topic`. Example: '| json | resource_uuid=\"some-uuid\"'"}, "project_id": {"type": "string", "description": "A project ID to filter by."}, "topic": {"type": "string", "description": "A log topic to search. Example topics: 'hashicorp.platform.audit', 'hashicorp.packer.registry.audit', 'hashicorp.boundary.cluster.audit', 'hashicorp.consul.cluster.audit'"}, "start_time": {"type": "string", "description": "The start time for the search. Accepts formats like '24 hours ago', 'yesterday at 5pm', or 'Oct 1, 2025'."}, "end_time": {"type": "string", "description": "The end time for the search. Accepts formats like 'now', 'today', or 'Oct 3, 2025'."}}, "required": ["organization_id", "start_time", "end_time"]}}]}, "id": 2}
2025-10-11 10:55:00,937 - mcp_server - INFO - Client call: {"method": "tools/call", "params": {"name": "search_logs", "arguments": {"start_time": "8 days ago", "organization_id": "11eab4a9-75f1-e0a5-8be1-0242ac110016", "end_time": "4 days ago", "topic": "hashicorp.platform.audit"}}, "jsonrpc": "2.0", "id": 3}
2025-10-11 10:55:05,695 - mcp_server - INFO - Tool request data: {'streams': {'entries': [{'id': '89634f56-97e0-4ac6-bf39-7dc90a3ab1a1', 'timestamp': '2025-10-07T08:56:55.771365379Z', 'stream': {'organization_id': '11eab4a9-75f1-e0a5-8be1-0242ac110016', 'project_id': '11eab4a9-760d-c9f2-adc9-0242ac11000a', 'topic': 'hashicorp.platform.audit'}, 'resource': None, 'control_plane_event': {'request_info': {'http_verb': 'POST', 'http_path': '/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive', 'http_user_agent': 'HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (bfea313)', 'http_client_ip': '35.90.87.232'}, 'authentication_info': {'principal': None, 'service_principal_delegation_chain': []}, 'authorization_info': [], 'metadata': {'cluster_id': 'vault-cluster'}, 'operation_info': {'operation_id': ''}, 'description': 'Host Manager Alive Requested', 'action': 'CREATE', 'status_code': 'OK'}, 'subject': None}, {'id': '3ee2bab5-e951-4489-ae35-d3a052ab05c3', 'timestamp': '2025-10-07T08:56:49.242102158Z', 'stream': {'organization_id': '11eab4a9-75f1-e0a5-8be1-0242ac110016', 'project_id': '11eab4a9-760d-c9f2-adc9-0242ac11000a', 'topic': 'hashicorp.platform.audit'}, 'resource': None, 'control_plane_event': {'request_info': {'http_verb': 'POST', 'http_path': '/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive', 'http_user_agent': 'HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (bfea313)', 'http_client_ip': '16.144.10.31'}, 'authentication_info': {'principal': None, 'service_principal_delegation_chain': []}, 'authorization_info': [], 'metadata': {'cluster_id': 'vault-cluster'}, 'operation_info': {'operation_id': ''}, 'description': 'Host Manager Alive Requested', 'action': 'CREATE', 'status_code': 'OK'}, 'subject': None}, {'id': '118d591d-5d43-496a-8cfd-f377861a82a3', 'timestamp': '2025-10-07T08:56:48.074774296Z', 'stream': {'organization_id': '11eab4a9-75f1-e0a5-8be1-0242ac110016', 'project_id': '11eab4a9-760d-c9f2-adc9-0242ac11000a', 'topic': 'hashicorp.platform.audit'}, 'resource': None, 'control_plane_event': {'request_info': {'http_verb': 'POST', 'http_path': '/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive', 'http_user_agent': 'HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (bfea313)', 'http_client_ip': '34.216.173.150'}, 'authentication_info': {'principal': None, 'service_principal_delegation_chain': []}, 'authorization_info': [], 'metadata': {'cluster_id': 'vault-cluster'}, 'operation_info': {'operation_id': ''}, 'description': 'Host Manager Alive Requested', 'action': 'CREATE', 'status_code': 'OK'}, 'subject': None}, {'id': '490c67cd-67c2-4365-a3fe-55741bc09bf0', 'timestamp': '2025-10-07T06:31:50.875751353Z', 'stream': {'organization_id': '11eab4a9-75f1-e0a5-8be1-0242ac110016', 'project_id': '11eab4a9-760d-c9f2-adc9-0242ac11000a', 'topic': 'hashicorp.platform.audit'}, 'resource': None, 'control_plane_event': {'request_info': {'http_verb': 'POST', 'http_path': '/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster-4/host-alive', 'http_user_agent': 'HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (bfea313)', 'http_client_ip': '54.200.13.172'}, 'authentication_info': {'principal': None, 'service_principal_delegation_chain': []}, 'authorization_info': [], 'metadata': {'cluster_id': 'vault-cluster-4'}, 'operation_info': {'operation_id': ''}, 'description': 'Host Manager Alive Requested', 'action': 'CREATE', 'status_code': 'OK'}, 'subject': None}, {'id': 'a92d7f8b-7215-4786-9cf5-4bb202aff413', 'timestamp': '2025-10-05T06:02:20.403589332Z', 'stream': {'organization_id': '11eab4a9-75f1-e0a5-8be1-0242ac110016', 'project_id': '11eab4a9-760d-c9f2-adc9-0242ac11000a', 'topic': 'hashicorp.platform.audit'}, 'resource': None, 'control_plane_event': {'request_info': {'http_verb': 'POST', 'http_path': '/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster1/host-alive', 'http_user_agent': 'HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (bfea313)', 'http_client_ip': '54.245.73.167'}, 'authentication_info': {'principal': None, 'service_principal_delegation_chain': []}, 'authorization_info': [], 'metadata': {'cluster_id': 'vault-cluster1'}, 'operation_info': {'operation_id': ''}, 'description': 'Host Manager Alive Requested', 'action': 'CREATE', 'status_code': 'OK'}, 'subject': None}, {'id': '083d7195-804b-4a6d-bd0f-d02d6954db8b', 'timestamp': '2025-10-04T08:56:55.980967454Z', 'stream': {'organization_id': '11eab4a9-75f1-e0a5-8be1-0242ac110016', 'project_id': '11eab4a9-760d-c9f2-adc9-0242ac11000a', 'topic': 'hashicorp.platform.audit'}, 'resource': None, 'control_plane_event': {'request_info': {'http_verb': 'POST', 'http_path': '/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive', 'http_user_agent': 'HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (0b39cad)', 'http_client_ip': '34.222.92.60'}, 'authentication_info': {'principal': None, 'service_principal_delegation_chain': []}, 'authorization_info': [], 'metadata': {'cluster_id': 'vault-cluster'}, 'operation_info': {'operation_id': ''}, 'description': 'Host Manager Alive Requested', 'action': 'CREATE', 'status_code': 'OK'}, 'subject': None}, {'id': '28b369ab-f548-42a4-9d90-55f3fa6c4bb3', 'timestamp': '2025-10-04T08:56:48.292359750Z', 'stream': {'organization_id': '11eab4a9-75f1-e0a5-8be1-0242ac110016', 'project_id': '11eab4a9-760d-c9f2-adc9-0242ac11000a', 'topic': 'hashicorp.platform.audit'}, 'resource': None, 'control_plane_event': {'request_info': {'http_verb': 'POST', 'http_path': '/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive', 'http_user_agent': 'HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (0b39cad)', 'http_client_ip': '16.144.32.73'}, 'authentication_info': {'principal': None, 'service_principal_delegation_chain': []}, 'authorization_info': [], 'metadata': {'cluster_id': 'vault-cluster'}, 'operation_info': {'operation_id': ''}, 'description': 'Host Manager Alive Requested', 'action': 'CREATE', 'status_code': 'OK'}, 'subject': None}, {'id': 'e8c3c10a-495e-42de-9bd9-6d7369d08759', 'timestamp': '2025-10-04T08:56:47.412025695Z', 'stream': {'organization_id': '11eab4a9-75f1-e0a5-8be1-0242ac110016', 'project_id': '11eab4a9-760d-c9f2-adc9-0242ac11000a', 'topic': 'hashicorp.platform.audit'}, 'resource': None, 'control_plane_event': {'request_info': {'http_verb': 'POST', 'http_path': '/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive', 'http_user_agent': 'HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (0b39cad)', 'http_client_ip': '18.236.173.238'}, 'authentication_info': {'principal': None, 'service_principal_delegation_chain': []}, 'authorization_info': [], 'metadata': {'cluster_id': 'vault-cluster'}, 'operation_info': {'operation_id': ''}, 'description': 'Host Manager Alive Requested', 'action': 'CREATE', 'status_code': 'OK'}, 'subject': None}, {'id': '6613b21e-3e56-41d1-9631-96d9c7a9654d', 'timestamp': '2025-10-04T06:31:56.092992719Z', 'stream': {'organization_id': '11eab4a9-75f1-e0a5-8be1-0242ac110016', 'project_id': '11eab4a9-760d-c9f2-adc9-0242ac11000a', 'topic': 'hashicorp.platform.audit'}, 'resource': None, 'control_plane_event': {'request_info': {'http_verb': 'POST', 'http_path': '/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster-4/host-alive', 'http_user_agent': 'HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (0b39cad)', 'http_client_ip': '54.218.27.160'}, 'authentication_info': {'principal': None, 'service_principal_delegation_chain': []}, 'authorization_info': [], 'metadata': {'cluster_id': 'vault-cluster-4'}, 'operation_info': {'operation_id': ''}, 'description': 'Host Manager Alive Requested', 'action': 'CREATE', 'status_code': 'OK'}, 'subject': None}, {'id': '4358ff2c-0669-4f4f-8868-7f42e76f261e', 'timestamp': '2025-10-03T18:43:42.006462630Z', 'stream': {'organization_id': '11eab4a9-75f1-e0a5-8be1-0242ac110016', 'project_id': '', 'topic': 'hashicorp.platform.audit'}, 'resource': None, 'control_plane_event': {'request_info': {'http_verb': 'GET', 'http_path': '/consent/complete', 'http_user_agent': '', 'http_client_ip': ''}, 'authentication_info': {'principal': {'id': 'c473b26e-f148-442b-9d2e-fb02a7cb7f5b', 'type': 'PRINCIPAL_TYPE_USER', 'user': {'id': 'c473b26e-f148-442b-9d2e-fb02a7cb7f5b', 'email': 'ijeri.omitogun@hashicorp.com', 'full_name': 'ijeri.omitogun@hashicorp.com', 'identity_type': 'UNSET', 'identity_types': [], 'subject': 'c473b26e-f148-442b-9d2e-fb02a7cb7f5b', 'scim_synchronized': False}, 'group_ids': []}, 'service_principal_delegation_chain': []}, 'authorization_info': [], 'metadata': {'email': 'ijeri.omitogun@hashicorp.com', 'event_type': 'hcp_id_auth_success', 'ip': '99.103.71.229', 'message': 'Authenticated successfully', 'timestamp': '2025-10-03 18:43:41 +0000 UTC', 'user_id': 'c473b26e-f148-442b-9d2e-fb02a7cb7f5b'}, 'operation_info': {'operation_id': ''}, 'description': 'Authenticated successfully', 'action': 'CREATE', 'status_code': 'OK'}, 'subject': None}]}, 'next_page_token': 'eyJ0aW1lc3RhbXAiOiIyMDI1LTEwLTAzVDE4OjQzOjQyLjAwNjQ2MjYzMFoiLCJpZCI6IjQzNThmZjJjLTA2NjktNGY0Zi04ODY4LTdmNDJlNzZmMjYxZSIsIm9mZnNldCI6MX0='}
2025-10-11 10:55:05,695 - mcp_server - INFO - Request data: stdio_main: {'jsonrpc': '2.0', 'result': {'content': [{'type': 'text', 'text': '{"streams": {"entries": [{"id": "89634f56-97e0-4ac6-bf39-7dc90a3ab1a1", "timestamp": "2025-10-07T08:56:55.771365379Z", "stream": {"organization_id": "11eab4a9-75f1-e0a5-8be1-0242ac110016", "project_id": "11eab4a9-760d-c9f2-adc9-0242ac11000a", "topic": "hashicorp.platform.audit"}, "resource": null, "control_plane_event": {"request_info": {"http_verb": "POST", "http_path": "/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive", "http_user_agent": "HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (bfea313)", "http_client_ip": "35.90.87.232"}, "authentication_info": {"principal": null, "service_principal_delegation_chain": []}, "authorization_info": [], "metadata": {"cluster_id": "vault-cluster"}, "operation_info": {"operation_id": ""}, "description": "Host Manager Alive Requested", "action": "CREATE", "status_code": "OK"}, "subject": null}, {"id": "3ee2bab5-e951-4489-ae35-d3a052ab05c3", "timestamp": "2025-10-07T08:56:49.242102158Z", "stream": {"organization_id": "11eab4a9-75f1-e0a5-8be1-0242ac110016", "project_id": "11eab4a9-760d-c9f2-adc9-0242ac11000a", "topic": "hashicorp.platform.audit"}, "resource": null, "control_plane_event": {"request_info": {"http_verb": "POST", "http_path": "/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive", "http_user_agent": "HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (bfea313)", "http_client_ip": "16.144.10.31"}, "authentication_info": {"principal": null, "service_principal_delegation_chain": []}, "authorization_info": [], "metadata": {"cluster_id": "vault-cluster"}, "operation_info": {"operation_id": ""}, "description": "Host Manager Alive Requested", "action": "CREATE", "status_code": "OK"}, "subject": null}, {"id": "118d591d-5d43-496a-8cfd-f377861a82a3", "timestamp": "2025-10-07T08:56:48.074774296Z", "stream": {"organization_id": "11eab4a9-75f1-e0a5-8be1-0242ac110016", "project_id": "11eab4a9-760d-c9f2-adc9-0242ac11000a", "topic": "hashicorp.platform.audit"}, "resource": null, "control_plane_event": {"request_info": {"http_verb": "POST", "http_path": "/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive", "http_user_agent": "HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (bfea313)", "http_client_ip": "34.216.173.150"}, "authentication_info": {"principal": null, "service_principal_delegation_chain": []}, "authorization_info": [], "metadata": {"cluster_id": "vault-cluster"}, "operation_info": {"operation_id": ""}, "description": "Host Manager Alive Requested", "action": "CREATE", "status_code": "OK"}, "subject": null}, {"id": "490c67cd-67c2-4365-a3fe-55741bc09bf0", "timestamp": "2025-10-07T06:31:50.875751353Z", "stream": {"organization_id": "11eab4a9-75f1-e0a5-8be1-0242ac110016", "project_id": "11eab4a9-760d-c9f2-adc9-0242ac11000a", "topic": "hashicorp.platform.audit"}, "resource": null, "control_plane_event": {"request_info": {"http_verb": "POST", "http_path": "/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster-4/host-alive", "http_user_agent": "HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (bfea313)", "http_client_ip": "54.200.13.172"}, "authentication_info": {"principal": null, "service_principal_delegation_chain": []}, "authorization_info": [], "metadata": {"cluster_id": "vault-cluster-4"}, "operation_info": {"operation_id": ""}, "description": "Host Manager Alive Requested", "action": "CREATE", "status_code": "OK"}, "subject": null}, {"id": "a92d7f8b-7215-4786-9cf5-4bb202aff413", "timestamp": "2025-10-05T06:02:20.403589332Z", "stream": {"organization_id": "11eab4a9-75f1-e0a5-8be1-0242ac110016", "project_id": "11eab4a9-760d-c9f2-adc9-0242ac11000a", "topic": "hashicorp.platform.audit"}, "resource": null, "control_plane_event": {"request_info": {"http_verb": "POST", "http_path": "/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster1/host-alive", "http_user_agent": "HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (bfea313)", "http_client_ip": "54.245.73.167"}, "authentication_info": {"principal": null, "service_principal_delegation_chain": []}, "authorization_info": [], "metadata": {"cluster_id": "vault-cluster1"}, "operation_info": {"operation_id": ""}, "description": "Host Manager Alive Requested", "action": "CREATE", "status_code": "OK"}, "subject": null}, {"id": "083d7195-804b-4a6d-bd0f-d02d6954db8b", "timestamp": "2025-10-04T08:56:55.980967454Z", "stream": {"organization_id": "11eab4a9-75f1-e0a5-8be1-0242ac110016", "project_id": "11eab4a9-760d-c9f2-adc9-0242ac11000a", "topic": "hashicorp.platform.audit"}, "resource": null, "control_plane_event": {"request_info": {"http_verb": "POST", "http_path": "/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive", "http_user_agent": "HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (0b39cad)", "http_client_ip": "34.222.92.60"}, "authentication_info": {"principal": null, "service_principal_delegation_chain": []}, "authorization_info": [], "metadata": {"cluster_id": "vault-cluster"}, "operation_info": {"operation_id": ""}, "description": "Host Manager Alive Requested", "action": "CREATE", "status_code": "OK"}, "subject": null}, {"id": "28b369ab-f548-42a4-9d90-55f3fa6c4bb3", "timestamp": "2025-10-04T08:56:48.292359750Z", "stream": {"organization_id": "11eab4a9-75f1-e0a5-8be1-0242ac110016", "project_id": "11eab4a9-760d-c9f2-adc9-0242ac11000a", "topic": "hashicorp.platform.audit"}, "resource": null, "control_plane_event": {"request_info": {"http_verb": "POST", "http_path": "/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive", "http_user_agent": "HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (0b39cad)", "http_client_ip": "16.144.32.73"}, "authentication_info": {"principal": null, "service_principal_delegation_chain": []}, "authorization_info": [], "metadata": {"cluster_id": "vault-cluster"}, "operation_info": {"operation_id": ""}, "description": "Host Manager Alive Requested", "action": "CREATE", "status_code": "OK"}, "subject": null}, {"id": "e8c3c10a-495e-42de-9bd9-6d7369d08759", "timestamp": "2025-10-04T08:56:47.412025695Z", "stream": {"organization_id": "11eab4a9-75f1-e0a5-8be1-0242ac110016", "project_id": "11eab4a9-760d-c9f2-adc9-0242ac11000a", "topic": "hashicorp.platform.audit"}, "resource": null, "control_plane_event": {"request_info": {"http_verb": "POST", "http_path": "/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive", "http_user_agent": "HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (0b39cad)", "http_client_ip": "18.236.173.238"}, "authentication_info": {"principal": null, "service_principal_delegation_chain": []}, "authorization_info": [], "metadata": {"cluster_id": "vault-cluster"}, "operation_info": {"operation_id": ""}, "description": "Host Manager Alive Requested", "action": "CREATE", "status_code": "OK"}, "subject": null}, {"id": "6613b21e-3e56-41d1-9631-96d9c7a9654d", "timestamp": "2025-10-04T06:31:56.092992719Z", "stream": {"organization_id": "11eab4a9-75f1-e0a5-8be1-0242ac110016", "project_id": "11eab4a9-760d-c9f2-adc9-0242ac11000a", "topic": "hashicorp.platform.audit"}, "resource": null, "control_plane_event": {"request_info": {"http_verb": "POST", "http_path": "/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster-4/host-alive", "http_user_agent": "HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (0b39cad)", "http_client_ip": "54.218.27.160"}, "authentication_info": {"principal": null, "service_principal_delegation_chain": []}, "authorization_info": [], "metadata": {"cluster_id": "vault-cluster-4"}, "operation_info": {"operation_id": ""}, "description": "Host Manager Alive Requested", "action": "CREATE", "status_code": "OK"}, "subject": null}, {"id": "4358ff2c-0669-4f4f-8868-7f42e76f261e", "timestamp": "2025-10-03T18:43:42.006462630Z", "stream": {"organization_id": "11eab4a9-75f1-e0a5-8be1-0242ac110016", "project_id": "", "topic": "hashicorp.platform.audit"}, "resource": null, "control_plane_event": {"request_info": {"http_verb": "GET", "http_path": "/consent/complete", "http_user_agent": "", "http_client_ip": ""}, "authentication_info": {"principal": {"id": "c473b26e-f148-442b-9d2e-fb02a7cb7f5b", "type": "PRINCIPAL_TYPE_USER", "user": {"id": "c473b26e-f148-442b-9d2e-fb02a7cb7f5b", "email": "ijeri.omitogun@hashicorp.com", "full_name": "ijeri.omitogun@hashicorp.com", "identity_type": "UNSET", "identity_types": [], "subject": "c473b26e-f148-442b-9d2e-fb02a7cb7f5b", "scim_synchronized": false}, "group_ids": []}, "service_principal_delegation_chain": []}, "authorization_info": [], "metadata": {"email": "ijeri.omitogun@hashicorp.com", "event_type": "hcp_id_auth_success", "ip": "99.103.71.229", "message": "Authenticated successfully", "timestamp": "2025-10-03 18:43:41 +0000 UTC", "user_id": "c473b26e-f148-442b-9d2e-fb02a7cb7f5b"}, "operation_info": {"operation_id": ""}, "description": "Authenticated successfully", "action": "CREATE", "status_code": "OK"}, "subject": null}]}, "next_page_token": "eyJ0aW1lc3RhbXAiOiIyMDI1LTEwLTAzVDE4OjQzOjQyLjAwNjQ2MjYzMFoiLCJpZCI6IjQzNThmZjJjLTA2NjktNGY0Zi04ODY4LTdmNDJlNzZmMjYxZSIsIm9mZnNldCI6MX0="}'}], 'isError': False}, 'id': 3}
2025-10-11 10:55:05,695 - mcp_server - INFO - Request data: stdio_main json: {"jsonrpc": "2.0", "result": {"content": [{"type": "text", "text": "{\"streams\": {\"entries\": [{\"id\": \"89634f56-97e0-4ac6-bf39-7dc90a3ab1a1\", \"timestamp\": \"2025-10-07T08:56:55.771365379Z\", \"stream\": {\"organization_id\": \"11eab4a9-75f1-e0a5-8be1-0242ac110016\", \"project_id\": \"11eab4a9-760d-c9f2-adc9-0242ac11000a\", \"topic\": \"hashicorp.platform.audit\"}, \"resource\": null, \"control_plane_event\": {\"request_info\": {\"http_verb\": \"POST\", \"http_path\": \"/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive\", \"http_user_agent\": \"HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (bfea313)\", \"http_client_ip\": \"35.90.87.232\"}, \"authentication_info\": {\"principal\": null, \"service_principal_delegation_chain\": []}, \"authorization_info\": [], \"metadata\": {\"cluster_id\": \"vault-cluster\"}, \"operation_info\": {\"operation_id\": \"\"}, \"description\": \"Host Manager Alive Requested\", \"action\": \"CREATE\", \"status_code\": \"OK\"}, \"subject\": null}, {\"id\": \"3ee2bab5-e951-4489-ae35-d3a052ab05c3\", \"timestamp\": \"2025-10-07T08:56:49.242102158Z\", \"stream\": {\"organization_id\": \"11eab4a9-75f1-e0a5-8be1-0242ac110016\", \"project_id\": \"11eab4a9-760d-c9f2-adc9-0242ac11000a\", \"topic\": \"hashicorp.platform.audit\"}, \"resource\": null, \"control_plane_event\": {\"request_info\": {\"http_verb\": \"POST\", \"http_path\": \"/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive\", \"http_user_agent\": \"HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (bfea313)\", \"http_client_ip\": \"16.144.10.31\"}, \"authentication_info\": {\"principal\": null, \"service_principal_delegation_chain\": []}, \"authorization_info\": [], \"metadata\": {\"cluster_id\": \"vault-cluster\"}, \"operation_info\": {\"operation_id\": \"\"}, \"description\": \"Host Manager Alive Requested\", \"action\": \"CREATE\", \"status_code\": \"OK\"}, \"subject\": null}, {\"id\": \"118d591d-5d43-496a-8cfd-f377861a82a3\", \"timestamp\": \"2025-10-07T08:56:48.074774296Z\", \"stream\": {\"organization_id\": \"11eab4a9-75f1-e0a5-8be1-0242ac110016\", \"project_id\": \"11eab4a9-760d-c9f2-adc9-0242ac11000a\", \"topic\": \"hashicorp.platform.audit\"}, \"resource\": null, \"control_plane_event\": {\"request_info\": {\"http_verb\": \"POST\", \"http_path\": \"/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive\", \"http_user_agent\": \"HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (bfea313)\", \"http_client_ip\": \"34.216.173.150\"}, \"authentication_info\": {\"principal\": null, \"service_principal_delegation_chain\": []}, \"authorization_info\": [], \"metadata\": {\"cluster_id\": \"vault-cluster\"}, \"operation_info\": {\"operation_id\": \"\"}, \"description\": \"Host Manager Alive Requested\", \"action\": \"CREATE\", \"status_code\": \"OK\"}, \"subject\": null}, {\"id\": \"490c67cd-67c2-4365-a3fe-55741bc09bf0\", \"timestamp\": \"2025-10-07T06:31:50.875751353Z\", \"stream\": {\"organization_id\": \"11eab4a9-75f1-e0a5-8be1-0242ac110016\", \"project_id\": \"11eab4a9-760d-c9f2-adc9-0242ac11000a\", \"topic\": \"hashicorp.platform.audit\"}, \"resource\": null, \"control_plane_event\": {\"request_info\": {\"http_verb\": \"POST\", \"http_path\": \"/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster-4/host-alive\", \"http_user_agent\": \"HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (bfea313)\", \"http_client_ip\": \"54.200.13.172\"}, \"authentication_info\": {\"principal\": null, \"service_principal_delegation_chain\": []}, \"authorization_info\": [], \"metadata\": {\"cluster_id\": \"vault-cluster-4\"}, \"operation_info\": {\"operation_id\": \"\"}, \"description\": \"Host Manager Alive Requested\", \"action\": \"CREATE\", \"status_code\": \"OK\"}, \"subject\": null}, {\"id\": \"a92d7f8b-7215-4786-9cf5-4bb202aff413\", \"timestamp\": \"2025-10-05T06:02:20.403589332Z\", \"stream\": {\"organization_id\": \"11eab4a9-75f1-e0a5-8be1-0242ac110016\", \"project_id\": \"11eab4a9-760d-c9f2-adc9-0242ac11000a\", \"topic\": \"hashicorp.platform.audit\"}, \"resource\": null, \"control_plane_event\": {\"request_info\": {\"http_verb\": \"POST\", \"http_path\": \"/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster1/host-alive\", \"http_user_agent\": \"HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (bfea313)\", \"http_client_ip\": \"54.245.73.167\"}, \"authentication_info\": {\"principal\": null, \"service_principal_delegation_chain\": []}, \"authorization_info\": [], \"metadata\": {\"cluster_id\": \"vault-cluster1\"}, \"operation_info\": {\"operation_id\": \"\"}, \"description\": \"Host Manager Alive Requested\", \"action\": \"CREATE\", \"status_code\": \"OK\"}, \"subject\": null}, {\"id\": \"083d7195-804b-4a6d-bd0f-d02d6954db8b\", \"timestamp\": \"2025-10-04T08:56:55.980967454Z\", \"stream\": {\"organization_id\": \"11eab4a9-75f1-e0a5-8be1-0242ac110016\", \"project_id\": \"11eab4a9-760d-c9f2-adc9-0242ac11000a\", \"topic\": \"hashicorp.platform.audit\"}, \"resource\": null, \"control_plane_event\": {\"request_info\": {\"http_verb\": \"POST\", \"http_path\": \"/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive\", \"http_user_agent\": \"HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (0b39cad)\", \"http_client_ip\": \"34.222.92.60\"}, \"authentication_info\": {\"principal\": null, \"service_principal_delegation_chain\": []}, \"authorization_info\": [], \"metadata\": {\"cluster_id\": \"vault-cluster\"}, \"operation_info\": {\"operation_id\": \"\"}, \"description\": \"Host Manager Alive Requested\", \"action\": \"CREATE\", \"status_code\": \"OK\"}, \"subject\": null}, {\"id\": \"28b369ab-f548-42a4-9d90-55f3fa6c4bb3\", \"timestamp\": \"2025-10-04T08:56:48.292359750Z\", \"stream\": {\"organization_id\": \"11eab4a9-75f1-e0a5-8be1-0242ac110016\", \"project_id\": \"11eab4a9-760d-c9f2-adc9-0242ac11000a\", \"topic\": \"hashicorp.platform.audit\"}, \"resource\": null, \"control_plane_event\": {\"request_info\": {\"http_verb\": \"POST\", \"http_path\": \"/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive\", \"http_user_agent\": \"HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (0b39cad)\", \"http_client_ip\": \"16.144.32.73\"}, \"authentication_info\": {\"principal\": null, \"service_principal_delegation_chain\": []}, \"authorization_info\": [], \"metadata\": {\"cluster_id\": \"vault-cluster\"}, \"operation_info\": {\"operation_id\": \"\"}, \"description\": \"Host Manager Alive Requested\", \"action\": \"CREATE\", \"status_code\": \"OK\"}, \"subject\": null}, {\"id\": \"e8c3c10a-495e-42de-9bd9-6d7369d08759\", \"timestamp\": \"2025-10-04T08:56:47.412025695Z\", \"stream\": {\"organization_id\": \"11eab4a9-75f1-e0a5-8be1-0242ac110016\", \"project_id\": \"11eab4a9-760d-c9f2-adc9-0242ac11000a\", \"topic\": \"hashicorp.platform.audit\"}, \"resource\": null, \"control_plane_event\": {\"request_info\": {\"http_verb\": \"POST\", \"http_path\": \"/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive\", \"http_user_agent\": \"HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (0b39cad)\", \"http_client_ip\": \"18.236.173.238\"}, \"authentication_info\": {\"principal\": null, \"service_principal_delegation_chain\": []}, \"authorization_info\": [], \"metadata\": {\"cluster_id\": \"vault-cluster\"}, \"operation_info\": {\"operation_id\": \"\"}, \"description\": \"Host Manager Alive Requested\", \"action\": \"CREATE\", \"status_code\": \"OK\"}, \"subject\": null}, {\"id\": \"6613b21e-3e56-41d1-9631-96d9c7a9654d\", \"timestamp\": \"2025-10-04T06:31:56.092992719Z\", \"stream\": {\"organization_id\": \"11eab4a9-75f1-e0a5-8be1-0242ac110016\", \"project_id\": \"11eab4a9-760d-c9f2-adc9-0242ac11000a\", \"topic\": \"hashicorp.platform.audit\"}, \"resource\": null, \"control_plane_event\": {\"request_info\": {\"http_verb\": \"POST\", \"http_path\": \"/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster-4/host-alive\", \"http_user_agent\": \"HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (0b39cad)\", \"http_client_ip\": \"54.218.27.160\"}, \"authentication_info\": {\"principal\": null, \"service_principal_delegation_chain\": []}, \"authorization_info\": [], \"metadata\": {\"cluster_id\": \"vault-cluster-4\"}, \"operation_info\": {\"operation_id\": \"\"}, \"description\": \"Host Manager Alive Requested\", \"action\": \"CREATE\", \"status_code\": \"OK\"}, \"subject\": null}, {\"id\": \"4358ff2c-0669-4f4f-8868-7f42e76f261e\", \"timestamp\": \"2025-10-03T18:43:42.006462630Z\", \"stream\": {\"organization_id\": \"11eab4a9-75f1-e0a5-8be1-0242ac110016\", \"project_id\": \"\", \"topic\": \"hashicorp.platform.audit\"}, \"resource\": null, \"control_plane_event\": {\"request_info\": {\"http_verb\": \"GET\", \"http_path\": \"/consent/complete\", \"http_user_agent\": \"\", \"http_client_ip\": \"\"}, \"authentication_info\": {\"principal\": {\"id\": \"c473b26e-f148-442b-9d2e-fb02a7cb7f5b\", \"type\": \"PRINCIPAL_TYPE_USER\", \"user\": {\"id\": \"c473b26e-f148-442b-9d2e-fb02a7cb7f5b\", \"email\": \"ijeri.omitogun@hashicorp.com\", \"full_name\": \"ijeri.omitogun@hashicorp.com\", \"identity_type\": \"UNSET\", \"identity_types\": [], \"subject\": \"c473b26e-f148-442b-9d2e-fb02a7cb7f5b\", \"scim_synchronized\": false}, \"group_ids\": []}, \"service_principal_delegation_chain\": []}, \"authorization_info\": [], \"metadata\": {\"email\": \"ijeri.omitogun@hashicorp.com\", \"event_type\": \"hcp_id_auth_success\", \"ip\": \"99.103.71.229\", \"message\": \"Authenticated successfully\", \"timestamp\": \"2025-10-03 18:43:41 +0000 UTC\", \"user_id\": \"c473b26e-f148-442b-9d2e-fb02a7cb7f5b\"}, \"operation_info\": {\"operation_id\": \"\"}, \"description\": \"Authenticated successfully\", \"action\": \"CREATE\", \"status_code\": \"OK\"}, \"subject\": null}]}, \"next_page_token\": \"eyJ0aW1lc3RhbXAiOiIyMDI1LTEwLTAzVDE4OjQzOjQyLjAwNjQ2MjYzMFoiLCJpZCI6IjQzNThmZjJjLTA2NjktNGY0Zi04ODY4LTdmNDJlNzZmMjYxZSIsIm9mZnNldCI6MX0=\"}"}], "isError": false}, "id": 3}
2025-10-11 10:55:05,696 - mcp_server - INFO - Client call: {"method": "tools/call", "params": {"name": "search_logs", "arguments": {"topic": "hashicorp.platform.audit", "end_time": "now", "start_time": "4 days ago", "organization_id": "11eab4a9-75f1-e0a5-8be1-0242ac110016"}}, "jsonrpc": "2.0", "id": 4}
2025-10-11 10:55:10,950 - mcp_server - INFO - Tool request data: {'streams': {'entries': [{'id': '0b907cfc-786b-4910-889c-d389ff480367', 'timestamp': '2025-10-11T06:01:51.975346169Z', 'stream': {'organization_id': '11eab4a9-75f1-e0a5-8be1-0242ac110016', 'project_id': '11eab4a9-760d-c9f2-adc9-0242ac11000a', 'topic': 'hashicorp.platform.audit'}, 'resource': None, 'control_plane_event': {'request_info': {'http_verb': 'POST', 'http_path': '/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster1/host-alive', 'http_user_agent': 'HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (91f0b20)', 'http_client_ip': '34.222.155.8'}, 'authentication_info': {'principal': None, 'service_principal_delegation_chain': []}, 'authorization_info': [], 'metadata': {'cluster_id': 'vault-cluster1'}, 'operation_info': {'operation_id': ''}, 'description': 'Host Manager Alive Requested', 'action': 'CREATE', 'status_code': 'OK'}, 'subject': None}, {'id': '122f81e8-22e6-4904-93b9-66bc619eabfe', 'timestamp': '2025-10-10T08:56:52.023953993Z', 'stream': {'organization_id': '11eab4a9-75f1-e0a5-8be1-0242ac110016', 'project_id': '11eab4a9-760d-c9f2-adc9-0242ac11000a', 'topic': 'hashicorp.platform.audit'}, 'resource': None, 'control_plane_event': {'request_info': {'http_verb': 'POST', 'http_path': '/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive', 'http_user_agent': 'HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (1f2925d)', 'http_client_ip': '35.91.140.117'}, 'authentication_info': {'principal': None, 'service_principal_delegation_chain': []}, 'authorization_info': [], 'metadata': {'cluster_id': 'vault-cluster'}, 'operation_info': {'operation_id': ''}, 'description': 'Host Manager Alive Requested', 'action': 'CREATE', 'status_code': 'OK'}, 'subject': None}, {'id': '02427d1f-9e48-4055-9eeb-1f938f6ca429', 'timestamp': '2025-10-10T08:56:50.585409396Z', 'stream': {'organization_id': '11eab4a9-75f1-e0a5-8be1-0242ac110016', 'project_id': '11eab4a9-760d-c9f2-adc9-0242ac11000a', 'topic': 'hashicorp.platform.audit'}, 'resource': None, 'control_plane_event': {'request_info': {'http_verb': 'POST', 'http_path': '/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive', 'http_user_agent': 'HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (1f2925d)', 'http_client_ip': '35.87.142.147'}, 'authentication_info': {'principal': None, 'service_principal_delegation_chain': []}, 'authorization_info': [], 'metadata': {'cluster_id': 'vault-cluster'}, 'operation_info': {'operation_id': ''}, 'description': 'Host Manager Alive Requested', 'action': 'CREATE', 'status_code': 'OK'}, 'subject': None}, {'id': '69a76856-4cb0-4609-b574-01b4cdba84d6', 'timestamp': '2025-10-10T08:56:48.565603242Z', 'stream': {'organization_id': '11eab4a9-75f1-e0a5-8be1-0242ac110016', 'project_id': '11eab4a9-760d-c9f2-adc9-0242ac11000a', 'topic': 'hashicorp.platform.audit'}, 'resource': None, 'control_plane_event': {'request_info': {'http_verb': 'POST', 'http_path': '/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive', 'http_user_agent': 'HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (1f2925d)', 'http_client_ip': '54.187.49.218'}, 'authentication_info': {'principal': None, 'service_principal_delegation_chain': []}, 'authorization_info': [], 'metadata': {'cluster_id': 'vault-cluster'}, 'operation_info': {'operation_id': ''}, 'description': 'Host Manager Alive Requested', 'action': 'CREATE', 'status_code': 'OK'}, 'subject': None}, {'id': '08813e54-bd3e-4e42-81a3-daadd2672e7e', 'timestamp': '2025-10-10T06:31:50.900038725Z', 'stream': {'organization_id': '11eab4a9-75f1-e0a5-8be1-0242ac110016', 'project_id': '11eab4a9-760d-c9f2-adc9-0242ac11000a', 'topic': 'hashicorp.platform.audit'}, 'resource': None, 'control_plane_event': {'request_info': {'http_verb': 'POST', 'http_path': '/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster-4/host-alive', 'http_user_agent': 'HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (98d7292)', 'http_client_ip': '54.188.11.180'}, 'authentication_info': {'principal': None, 'service_principal_delegation_chain': []}, 'authorization_info': [], 'metadata': {'cluster_id': 'vault-cluster-4'}, 'operation_info': {'operation_id': ''}, 'description': 'Host Manager Alive Requested', 'action': 'CREATE', 'status_code': 'OK'}, 'subject': None}, {'id': 'bd27928c-ae21-462e-be06-6630a49057d8', 'timestamp': '2025-10-09T20:24:13.287295802Z', 'stream': {'organization_id': '11eab4a9-75f1-e0a5-8be1-0242ac110016', 'project_id': '', 'topic': 'hashicorp.platform.audit'}, 'resource': None, 'control_plane_event': {'request_info': {'http_verb': 'GET', 'http_path': '/consent/complete', 'http_user_agent': '', 'http_client_ip': ''}, 'authentication_info': {'principal': {'id': '5f32f218-a0c0-4191-bd10-f2c1169bcfde', 'type': 'PRINCIPAL_TYPE_USER', 'user': {'id': '5f32f218-a0c0-4191-bd10-f2c1169bcfde', 'email': 'tpowell@hashicorp.com', 'full_name': 'tpowell@hashicorp.com', 'identity_type': 'UNSET', 'identity_types': [], 'subject': '5f32f218-a0c0-4191-bd10-f2c1169bcfde', 'scim_synchronized': False}, 'group_ids': []}, 'service_principal_delegation_chain': []}, 'authorization_info': [], 'metadata': {'email': 'tpowell@hashicorp.com', 'event_type': 'hcp_id_auth_success', 'ip': '73.252.181.35', 'message': 'Authenticated successfully', 'timestamp': '2025-10-09 20:24:12 +0000 UTC', 'user_id': '5f32f218-a0c0-4191-bd10-f2c1169bcfde'}, 'operation_info': {'operation_id': ''}, 'description': 'Authenticated successfully', 'action': 'CREATE', 'status_code': 'OK'}, 'subject': None}, {'id': '0e7bdf42-82d1-422c-9c34-ca0107593c76', 'timestamp': '2025-10-08T06:01:56.587155304Z', 'stream': {'organization_id': '11eab4a9-75f1-e0a5-8be1-0242ac110016', 'project_id': '11eab4a9-760d-c9f2-adc9-0242ac11000a', 'topic': 'hashicorp.platform.audit'}, 'resource': None, 'control_plane_event': {'request_info': {'http_verb': 'POST', 'http_path': '/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster1/host-alive', 'http_user_agent': 'HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (ee02d1c)', 'http_client_ip': '34.221.205.1'}, 'authentication_info': {'principal': None, 'service_principal_delegation_chain': []}, 'authorization_info': [], 'metadata': {'cluster_id': 'vault-cluster1'}, 'operation_info': {'operation_id': ''}, 'description': 'Host Manager Alive Requested', 'action': 'CREATE', 'status_code': 'OK'}, 'subject': None}]}, 'next_page_token': 'eyJ0aW1lc3RhbXAiOiIyMDI1LTEwLTA4VDA2OjAxOjU2LjU4NzE1NTMwNFoiLCJpZCI6IjBlN2JkZjQyLTgyZDEtNDIyYy05YzM0LWNhMDEwNzU5M2M3NiIsIm9mZnNldCI6MX0='}
2025-10-11 10:55:10,950 - mcp_server - INFO - Request data: stdio_main: {'jsonrpc': '2.0', 'result': {'content': [{'type': 'text', 'text': '{"streams": {"entries": [{"id": "0b907cfc-786b-4910-889c-d389ff480367", "timestamp": "2025-10-11T06:01:51.975346169Z", "stream": {"organization_id": "11eab4a9-75f1-e0a5-8be1-0242ac110016", "project_id": "11eab4a9-760d-c9f2-adc9-0242ac11000a", "topic": "hashicorp.platform.audit"}, "resource": null, "control_plane_event": {"request_info": {"http_verb": "POST", "http_path": "/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster1/host-alive", "http_user_agent": "HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (91f0b20)", "http_client_ip": "34.222.155.8"}, "authentication_info": {"principal": null, "service_principal_delegation_chain": []}, "authorization_info": [], "metadata": {"cluster_id": "vault-cluster1"}, "operation_info": {"operation_id": ""}, "description": "Host Manager Alive Requested", "action": "CREATE", "status_code": "OK"}, "subject": null}, {"id": "122f81e8-22e6-4904-93b9-66bc619eabfe", "timestamp": "2025-10-10T08:56:52.023953993Z", "stream": {"organization_id": "11eab4a9-75f1-e0a5-8be1-0242ac110016", "project_id": "11eab4a9-760d-c9f2-adc9-0242ac11000a", "topic": "hashicorp.platform.audit"}, "resource": null, "control_plane_event": {"request_info": {"http_verb": "POST", "http_path": "/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive", "http_user_agent": "HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (1f2925d)", "http_client_ip": "35.91.140.117"}, "authentication_info": {"principal": null, "service_principal_delegation_chain": []}, "authorization_info": [], "metadata": {"cluster_id": "vault-cluster"}, "operation_info": {"operation_id": ""}, "description": "Host Manager Alive Requested", "action": "CREATE", "status_code": "OK"}, "subject": null}, {"id": "02427d1f-9e48-4055-9eeb-1f938f6ca429", "timestamp": "2025-10-10T08:56:50.585409396Z", "stream": {"organization_id": "11eab4a9-75f1-e0a5-8be1-0242ac110016", "project_id": "11eab4a9-760d-c9f2-adc9-0242ac11000a", "topic": "hashicorp.platform.audit"}, "resource": null, "control_plane_event": {"request_info": {"http_verb": "POST", "http_path": "/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive", "http_user_agent": "HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (1f2925d)", "http_client_ip": "35.87.142.147"}, "authentication_info": {"principal": null, "service_principal_delegation_chain": []}, "authorization_info": [], "metadata": {"cluster_id": "vault-cluster"}, "operation_info": {"operation_id": ""}, "description": "Host Manager Alive Requested", "action": "CREATE", "status_code": "OK"}, "subject": null}, {"id": "69a76856-4cb0-4609-b574-01b4cdba84d6", "timestamp": "2025-10-10T08:56:48.565603242Z", "stream": {"organization_id": "11eab4a9-75f1-e0a5-8be1-0242ac110016", "project_id": "11eab4a9-760d-c9f2-adc9-0242ac11000a", "topic": "hashicorp.platform.audit"}, "resource": null, "control_plane_event": {"request_info": {"http_verb": "POST", "http_path": "/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive", "http_user_agent": "HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (1f2925d)", "http_client_ip": "54.187.49.218"}, "authentication_info": {"principal": null, "service_principal_delegation_chain": []}, "authorization_info": [], "metadata": {"cluster_id": "vault-cluster"}, "operation_info": {"operation_id": ""}, "description": "Host Manager Alive Requested", "action": "CREATE", "status_code": "OK"}, "subject": null}, {"id": "08813e54-bd3e-4e42-81a3-daadd2672e7e", "timestamp": "2025-10-10T06:31:50.900038725Z", "stream": {"organization_id": "11eab4a9-75f1-e0a5-8be1-0242ac110016", "project_id": "11eab4a9-760d-c9f2-adc9-0242ac11000a", "topic": "hashicorp.platform.audit"}, "resource": null, "control_plane_event": {"request_info": {"http_verb": "POST", "http_path": "/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster-4/host-alive", "http_user_agent": "HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (98d7292)", "http_client_ip": "54.188.11.180"}, "authentication_info": {"principal": null, "service_principal_delegation_chain": []}, "authorization_info": [], "metadata": {"cluster_id": "vault-cluster-4"}, "operation_info": {"operation_id": ""}, "description": "Host Manager Alive Requested", "action": "CREATE", "status_code": "OK"}, "subject": null}, {"id": "bd27928c-ae21-462e-be06-6630a49057d8", "timestamp": "2025-10-09T20:24:13.287295802Z", "stream": {"organization_id": "11eab4a9-75f1-e0a5-8be1-0242ac110016", "project_id": "", "topic": "hashicorp.platform.audit"}, "resource": null, "control_plane_event": {"request_info": {"http_verb": "GET", "http_path": "/consent/complete", "http_user_agent": "", "http_client_ip": ""}, "authentication_info": {"principal": {"id": "5f32f218-a0c0-4191-bd10-f2c1169bcfde", "type": "PRINCIPAL_TYPE_USER", "user": {"id": "5f32f218-a0c0-4191-bd10-f2c1169bcfde", "email": "tpowell@hashicorp.com", "full_name": "tpowell@hashicorp.com", "identity_type": "UNSET", "identity_types": [], "subject": "5f32f218-a0c0-4191-bd10-f2c1169bcfde", "scim_synchronized": false}, "group_ids": []}, "service_principal_delegation_chain": []}, "authorization_info": [], "metadata": {"email": "tpowell@hashicorp.com", "event_type": "hcp_id_auth_success", "ip": "73.252.181.35", "message": "Authenticated successfully", "timestamp": "2025-10-09 20:24:12 +0000 UTC", "user_id": "5f32f218-a0c0-4191-bd10-f2c1169bcfde"}, "operation_info": {"operation_id": ""}, "description": "Authenticated successfully", "action": "CREATE", "status_code": "OK"}, "subject": null}, {"id": "0e7bdf42-82d1-422c-9c34-ca0107593c76", "timestamp": "2025-10-08T06:01:56.587155304Z", "stream": {"organization_id": "11eab4a9-75f1-e0a5-8be1-0242ac110016", "project_id": "11eab4a9-760d-c9f2-adc9-0242ac11000a", "topic": "hashicorp.platform.audit"}, "resource": null, "control_plane_event": {"request_info": {"http_verb": "POST", "http_path": "/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster1/host-alive", "http_user_agent": "HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (ee02d1c)", "http_client_ip": "34.221.205.1"}, "authentication_info": {"principal": null, "service_principal_delegation_chain": []}, "authorization_info": [], "metadata": {"cluster_id": "vault-cluster1"}, "operation_info": {"operation_id": ""}, "description": "Host Manager Alive Requested", "action": "CREATE", "status_code": "OK"}, "subject": null}]}, "next_page_token": "eyJ0aW1lc3RhbXAiOiIyMDI1LTEwLTA4VDA2OjAxOjU2LjU4NzE1NTMwNFoiLCJpZCI6IjBlN2JkZjQyLTgyZDEtNDIyYy05YzM0LWNhMDEwNzU5M2M3NiIsIm9mZnNldCI6MX0="}'}], 'isError': False}, 'id': 4}
2025-10-11 10:55:10,950 - mcp_server - INFO - Request data: stdio_main json: {"jsonrpc": "2.0", "result": {"content": [{"type": "text", "text": "{\"streams\": {\"entries\": [{\"id\": \"0b907cfc-786b-4910-889c-d389ff480367\", \"timestamp\": \"2025-10-11T06:01:51.975346169Z\", \"stream\": {\"organization_id\": \"11eab4a9-75f1-e0a5-8be1-0242ac110016\", \"project_id\": \"11eab4a9-760d-c9f2-adc9-0242ac11000a\", \"topic\": \"hashicorp.platform.audit\"}, \"resource\": null, \"control_plane_event\": {\"request_info\": {\"http_verb\": \"POST\", \"http_path\": \"/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster1/host-alive\", \"http_user_agent\": \"HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (91f0b20)\", \"http_client_ip\": \"34.222.155.8\"}, \"authentication_info\": {\"principal\": null, \"service_principal_delegation_chain\": []}, \"authorization_info\": [], \"metadata\": {\"cluster_id\": \"vault-cluster1\"}, \"operation_info\": {\"operation_id\": \"\"}, \"description\": \"Host Manager Alive Requested\", \"action\": \"CREATE\", \"status_code\": \"OK\"}, \"subject\": null}, {\"id\": \"122f81e8-22e6-4904-93b9-66bc619eabfe\", \"timestamp\": \"2025-10-10T08:56:52.023953993Z\", \"stream\": {\"organization_id\": \"11eab4a9-75f1-e0a5-8be1-0242ac110016\", \"project_id\": \"11eab4a9-760d-c9f2-adc9-0242ac11000a\", \"topic\": \"hashicorp.platform.audit\"}, \"resource\": null, \"control_plane_event\": {\"request_info\": {\"http_verb\": \"POST\", \"http_path\": \"/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive\", \"http_user_agent\": \"HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (1f2925d)\", \"http_client_ip\": \"35.91.140.117\"}, \"authentication_info\": {\"principal\": null, \"service_principal_delegation_chain\": []}, \"authorization_info\": [], \"metadata\": {\"cluster_id\": \"vault-cluster\"}, \"operation_info\": {\"operation_id\": \"\"}, \"description\": \"Host Manager Alive Requested\", \"action\": \"CREATE\", \"status_code\": \"OK\"}, \"subject\": null}, {\"id\": \"02427d1f-9e48-4055-9eeb-1f938f6ca429\", \"timestamp\": \"2025-10-10T08:56:50.585409396Z\", \"stream\": {\"organization_id\": \"11eab4a9-75f1-e0a5-8be1-0242ac110016\", \"project_id\": \"11eab4a9-760d-c9f2-adc9-0242ac11000a\", \"topic\": \"hashicorp.platform.audit\"}, \"resource\": null, \"control_plane_event\": {\"request_info\": {\"http_verb\": \"POST\", \"http_path\": \"/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive\", \"http_user_agent\": \"HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (1f2925d)\", \"http_client_ip\": \"35.87.142.147\"}, \"authentication_info\": {\"principal\": null, \"service_principal_delegation_chain\": []}, \"authorization_info\": [], \"metadata\": {\"cluster_id\": \"vault-cluster\"}, \"operation_info\": {\"operation_id\": \"\"}, \"description\": \"Host Manager Alive Requested\", \"action\": \"CREATE\", \"status_code\": \"OK\"}, \"subject\": null}, {\"id\": \"69a76856-4cb0-4609-b574-01b4cdba84d6\", \"timestamp\": \"2025-10-10T08:56:48.565603242Z\", \"stream\": {\"organization_id\": \"11eab4a9-75f1-e0a5-8be1-0242ac110016\", \"project_id\": \"11eab4a9-760d-c9f2-adc9-0242ac11000a\", \"topic\": \"hashicorp.platform.audit\"}, \"resource\": null, \"control_plane_event\": {\"request_info\": {\"http_verb\": \"POST\", \"http_path\": \"/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive\", \"http_user_agent\": \"HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (1f2925d)\", \"http_client_ip\": \"54.187.49.218\"}, \"authentication_info\": {\"principal\": null, \"service_principal_delegation_chain\": []}, \"authorization_info\": [], \"metadata\": {\"cluster_id\": \"vault-cluster\"}, \"operation_info\": {\"operation_id\": \"\"}, \"description\": \"Host Manager Alive Requested\", \"action\": \"CREATE\", \"status_code\": \"OK\"}, \"subject\": null}, {\"id\": \"08813e54-bd3e-4e42-81a3-daadd2672e7e\", \"timestamp\": \"2025-10-10T06:31:50.900038725Z\", \"stream\": {\"organization_id\": \"11eab4a9-75f1-e0a5-8be1-0242ac110016\", \"project_id\": \"11eab4a9-760d-c9f2-adc9-0242ac11000a\", \"topic\": \"hashicorp.platform.audit\"}, \"resource\": null, \"control_plane_event\": {\"request_info\": {\"http_verb\": \"POST\", \"http_path\": \"/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster-4/host-alive\", \"http_user_agent\": \"HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (98d7292)\", \"http_client_ip\": \"54.188.11.180\"}, \"authentication_info\": {\"principal\": null, \"service_principal_delegation_chain\": []}, \"authorization_info\": [], \"metadata\": {\"cluster_id\": \"vault-cluster-4\"}, \"operation_info\": {\"operation_id\": \"\"}, \"description\": \"Host Manager Alive Requested\", \"action\": \"CREATE\", \"status_code\": \"OK\"}, \"subject\": null}, {\"id\": \"bd27928c-ae21-462e-be06-6630a49057d8\", \"timestamp\": \"2025-10-09T20:24:13.287295802Z\", \"stream\": {\"organization_id\": \"11eab4a9-75f1-e0a5-8be1-0242ac110016\", \"project_id\": \"\", \"topic\": \"hashicorp.platform.audit\"}, \"resource\": null, \"control_plane_event\": {\"request_info\": {\"http_verb\": \"GET\", \"http_path\": \"/consent/complete\", \"http_user_agent\": \"\", \"http_client_ip\": \"\"}, \"authentication_info\": {\"principal\": {\"id\": \"5f32f218-a0c0-4191-bd10-f2c1169bcfde\", \"type\": \"PRINCIPAL_TYPE_USER\", \"user\": {\"id\": \"5f32f218-a0c0-4191-bd10-f2c1169bcfde\", \"email\": \"tpowell@hashicorp.com\", \"full_name\": \"tpowell@hashicorp.com\", \"identity_type\": \"UNSET\", \"identity_types\": [], \"subject\": \"5f32f218-a0c0-4191-bd10-f2c1169bcfde\", \"scim_synchronized\": false}, \"group_ids\": []}, \"service_principal_delegation_chain\": []}, \"authorization_info\": [], \"metadata\": {\"email\": \"tpowell@hashicorp.com\", \"event_type\": \"hcp_id_auth_success\", \"ip\": \"73.252.181.35\", \"message\": \"Authenticated successfully\", \"timestamp\": \"2025-10-09 20:24:12 +0000 UTC\", \"user_id\": \"5f32f218-a0c0-4191-bd10-f2c1169bcfde\"}, \"operation_info\": {\"operation_id\": \"\"}, \"description\": \"Authenticated successfully\", \"action\": \"CREATE\", \"status_code\": \"OK\"}, \"subject\": null}, {\"id\": \"0e7bdf42-82d1-422c-9c34-ca0107593c76\", \"timestamp\": \"2025-10-08T06:01:56.587155304Z\", \"stream\": {\"organization_id\": \"11eab4a9-75f1-e0a5-8be1-0242ac110016\", \"project_id\": \"11eab4a9-760d-c9f2-adc9-0242ac11000a\", \"topic\": \"hashicorp.platform.audit\"}, \"resource\": null, \"control_plane_event\": {\"request_info\": {\"http_verb\": \"POST\", \"http_path\": \"/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster1/host-alive\", \"http_user_agent\": \"HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (ee02d1c)\", \"http_client_ip\": \"34.221.205.1\"}, \"authentication_info\": {\"principal\": null, \"service_principal_delegation_chain\": []}, \"authorization_info\": [], \"metadata\": {\"cluster_id\": \"vault-cluster1\"}, \"operation_info\": {\"operation_id\": \"\"}, \"description\": \"Host Manager Alive Requested\", \"action\": \"CREATE\", \"status_code\": \"OK\"}, \"subject\": null}]}, \"next_page_token\": \"eyJ0aW1lc3RhbXAiOiIyMDI1LTEwLTA4VDA2OjAxOjU2LjU4NzE1NTMwNFoiLCJpZCI6IjBlN2JkZjQyLTgyZDEtNDIyYy05YzM0LWNhMDEwNzU5M2M3NiIsIm9mZnNldCI6MX0=\"}"}], "isError": false}, "id": 4}
2025-10-11 11:00:49,718 - mcp_server - INFO - Client call: {"method": "tools/call", "params": {"name": "search_logs", "arguments": {"start_time": "30 days ago", "organization_id": "11eab4a9-75f1-e0a5-8be1-0242ac110016", "topic": "hashicorp.platform.audit", "end_time": "25 days ago"}}, "jsonrpc": "2.0", "id": 5}
2025-10-11 11:00:55,568 - mcp_server - ERROR - An unexpected error occurred: 
Traceback (most recent call last):
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpx/_transports/default.py", line 101, in map_httpcore_exceptions
    yield
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpx/_transports/default.py", line 394, in handle_async_request
    resp = await self._pool.handle_async_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpcore/_async/connection_pool.py", line 256, in handle_async_request
    raise exc from None
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpcore/_async/connection_pool.py", line 236, in handle_async_request
    response = await connection.handle_async_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpcore/_async/connection.py", line 103, in handle_async_request
    return await self._connection.handle_async_request(request)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpcore/_async/http11.py", line 136, in handle_async_request
    raise exc
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpcore/_async/http11.py", line 106, in handle_async_request
    ) = await self._receive_response_headers(**kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpcore/_async/http11.py", line 177, in _receive_response_headers
    event = await self._receive_event(timeout=timeout)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpcore/_async/http11.py", line 217, in _receive_event
    data = await self._network_stream.read(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpcore/_backends/anyio.py", line 32, in read
    with map_exceptions(exc_map):
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/contextlib.py", line 158, in __exit__
    self.gen.throw(value)
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ReadTimeout

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/tpowell/Documents/workspace/hcp_mcp_server/main.py", line 174, in process_mcp_request
    result = await TOOL_MAP[tool_name](**arguments)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/Documents/workspace/hcp_mcp_server/hcp/audit_logs.py", line 82, in search_logs
    response = await client.post(
               ^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpx/_client.py", line 1859, in post
    return await self.request(
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpx/_client.py", line 1540, in request
    return await self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpx/_client.py", line 1629, in send
    response = await self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpx/_client.py", line 1657, in _send_handling_auth
    response = await self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpx/_client.py", line 1694, in _send_handling_redirects
    response = await self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpx/_client.py", line 1730, in _send_single_request
    response = await transport.handle_async_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpx/_transports/default.py", line 393, in handle_async_request
    with map_httpcore_exceptions():
         ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/contextlib.py", line 158, in __exit__
    self.gen.throw(value)
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpx/_transports/default.py", line 118, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ReadTimeout
2025-10-11 11:00:55,576 - mcp_server - INFO - Request data: stdio_main: {'jsonrpc': '2.0', 'error': {'code': -32000, 'message': 'Server error', 'data': 'An unexpected error occurred. See logs for details.'}, 'id': 5}
2025-10-11 11:00:55,577 - mcp_server - INFO - Request data: stdio_main json: {"jsonrpc": "2.0", "error": {"code": -32000, "message": "Server error", "data": "An unexpected error occurred. See logs for details."}, "id": 5}
2025-10-11 11:00:55,577 - mcp_server - INFO - Client call: {"method": "tools/call", "params": {"name": "search_logs", "arguments": {"end_time": "20 days ago", "organization_id": "11eab4a9-75f1-e0a5-8be1-0242ac110016", "start_time": "25 days ago", "topic": "hashicorp.platform.audit"}}, "jsonrpc": "2.0", "id": 6}
2025-10-11 11:00:58,978 - mcp_server - INFO - Tool request data: {'streams': {'entries': [{'id': '4336142e-6643-410b-8cd8-d11f25d123e8', 'timestamp': '2025-09-21T08:56:46.837872528Z', 'stream': {'organization_id': '11eab4a9-75f1-e0a5-8be1-0242ac110016', 'project_id': '11eab4a9-760d-c9f2-adc9-0242ac11000a', 'topic': 'hashicorp.platform.audit'}, 'resource': None, 'control_plane_event': {'request_info': {'http_verb': 'POST', 'http_path': '/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive', 'http_user_agent': 'HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (034b138)', 'http_client_ip': '35.91.253.99'}, 'authentication_info': {'principal': None, 'service_principal_delegation_chain': []}, 'authorization_info': [], 'metadata': {'cluster_id': 'vault-cluster'}, 'operation_info': {'operation_id': ''}, 'description': 'Host Manager Alive Requested', 'action': 'CREATE', 'status_code': 'OK'}, 'subject': None}, {'id': 'fcb47d39-84e9-4807-b7e6-09826793ebe2', 'timestamp': '2025-09-21T08:56:45.788956577Z', 'stream': {'organization_id': '11eab4a9-75f1-e0a5-8be1-0242ac110016', 'project_id': '11eab4a9-760d-c9f2-adc9-0242ac11000a', 'topic': 'hashicorp.platform.audit'}, 'resource': None, 'control_plane_event': {'request_info': {'http_verb': 'POST', 'http_path': '/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive', 'http_user_agent': 'HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (034b138)', 'http_client_ip': '54.185.246.217'}, 'authentication_info': {'principal': None, 'service_principal_delegation_chain': []}, 'authorization_info': [], 'metadata': {'cluster_id': 'vault-cluster'}, 'operation_info': {'operation_id': ''}, 'description': 'Host Manager Alive Requested', 'action': 'CREATE', 'status_code': 'OK'}, 'subject': None}, {'id': '97080f93-e6a0-4af4-a486-4b6e7dc82133', 'timestamp': '2025-09-21T08:56:45.642128036Z', 'stream': {'organization_id': '11eab4a9-75f1-e0a5-8be1-0242ac110016', 'project_id': '11eab4a9-760d-c9f2-adc9-0242ac11000a', 'topic': 'hashicorp.platform.audit'}, 'resource': None, 'control_plane_event': {'request_info': {'http_verb': 'POST', 'http_path': '/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive', 'http_user_agent': 'HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (034b138)', 'http_client_ip': '44.249.72.203'}, 'authentication_info': {'principal': None, 'service_principal_delegation_chain': []}, 'authorization_info': [], 'metadata': {'cluster_id': 'vault-cluster'}, 'operation_info': {'operation_id': ''}, 'description': 'Host Manager Alive Requested', 'action': 'CREATE', 'status_code': 'OK'}, 'subject': None}, {'id': '20705b99-ecb6-4dc1-98ac-286122839806', 'timestamp': '2025-09-20T06:06:27.120285189Z', 'stream': {'organization_id': '11eab4a9-75f1-e0a5-8be1-0242ac110016', 'project_id': '11eab4a9-760d-c9f2-adc9-0242ac11000a', 'topic': 'hashicorp.platform.audit'}, 'resource': None, 'control_plane_event': {'request_info': {'http_verb': 'POST', 'http_path': '/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster1/host-alive', 'http_user_agent': 'HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (034b138)', 'http_client_ip': '35.94.124.189'}, 'authentication_info': {'principal': None, 'service_principal_delegation_chain': []}, 'authorization_info': [], 'metadata': {'cluster_id': 'vault-cluster1'}, 'operation_info': {'operation_id': ''}, 'description': 'Host Manager Alive Requested', 'action': 'CREATE', 'status_code': 'OK'}, 'subject': None}, {'id': 'a1d4f651-c1b6-40af-89d0-e29a6fff9b4d', 'timestamp': '2025-09-20T06:01:50.642295859Z', 'stream': {'organization_id': '11eab4a9-75f1-e0a5-8be1-0242ac110016', 'project_id': '11eab4a9-760d-c9f2-adc9-0242ac11000a', 'topic': 'hashicorp.platform.audit'}, 'resource': None, 'control_plane_event': {'request_info': {'http_verb': 'POST', 'http_path': '/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster1/host-alive', 'http_user_agent': 'HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (034b138)', 'http_client_ip': '35.94.124.189'}, 'authentication_info': {'principal': None, 'service_principal_delegation_chain': []}, 'authorization_info': [], 'metadata': {'cluster_id': 'vault-cluster1'}, 'operation_info': {'operation_id': ''}, 'description': 'Host Manager Alive Requested', 'action': 'CREATE', 'status_code': 'OK'}, 'subject': None}, {'id': '9f3c2084-2a7b-40b3-9932-923801c45cff', 'timestamp': '2025-09-19T06:36:03.644578187Z', 'stream': {'organization_id': '11eab4a9-75f1-e0a5-8be1-0242ac110016', 'project_id': '11eab4a9-760d-c9f2-adc9-0242ac11000a', 'topic': 'hashicorp.platform.audit'}, 'resource': None, 'control_plane_event': {'request_info': {'http_verb': 'POST', 'http_path': '/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster-4/host-alive', 'http_user_agent': 'HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (034b138)', 'http_client_ip': '34.215.250.27'}, 'authentication_info': {'principal': None, 'service_principal_delegation_chain': []}, 'authorization_info': [], 'metadata': {'cluster_id': 'vault-cluster-4'}, 'operation_info': {'operation_id': ''}, 'description': 'Host Manager Alive Requested', 'action': 'CREATE', 'status_code': 'OK'}, 'subject': None}, {'id': '8e4f6aec-0533-4bf1-8cfe-7bea957c4b0f', 'timestamp': '2025-09-19T06:31:54.327437055Z', 'stream': {'organization_id': '11eab4a9-75f1-e0a5-8be1-0242ac110016', 'project_id': '11eab4a9-760d-c9f2-adc9-0242ac11000a', 'topic': 'hashicorp.platform.audit'}, 'resource': None, 'control_plane_event': {'request_info': {'http_verb': 'POST', 'http_path': '/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster-4/host-alive', 'http_user_agent': 'HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (034b138)', 'http_client_ip': '34.215.250.27'}, 'authentication_info': {'principal': None, 'service_principal_delegation_chain': []}, 'authorization_info': [], 'metadata': {'cluster_id': 'vault-cluster-4'}, 'operation_info': {'operation_id': ''}, 'description': 'Host Manager Alive Requested', 'action': 'CREATE', 'status_code': 'OK'}, 'subject': None}, {'id': '2c722f10-52a2-4f71-a4ea-f82424f2f420', 'timestamp': '2025-09-18T08:56:49.845545181Z', 'stream': {'organization_id': '11eab4a9-75f1-e0a5-8be1-0242ac110016', 'project_id': '11eab4a9-760d-c9f2-adc9-0242ac11000a', 'topic': 'hashicorp.platform.audit'}, 'resource': None, 'control_plane_event': {'request_info': {'http_verb': 'POST', 'http_path': '/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive', 'http_user_agent': 'HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (034b138)', 'http_client_ip': '35.92.53.47'}, 'authentication_info': {'principal': None, 'service_principal_delegation_chain': []}, 'authorization_info': [], 'metadata': {'cluster_id': 'vault-cluster'}, 'operation_info': {'operation_id': ''}, 'description': 'Host Manager Alive Requested', 'action': 'CREATE', 'status_code': 'OK'}, 'subject': None}, {'id': '09179b82-ffec-4015-9f68-dd18f1133d4a', 'timestamp': '2025-09-18T08:56:48.030759957Z', 'stream': {'organization_id': '11eab4a9-75f1-e0a5-8be1-0242ac110016', 'project_id': '11eab4a9-760d-c9f2-adc9-0242ac11000a', 'topic': 'hashicorp.platform.audit'}, 'resource': None, 'control_plane_event': {'request_info': {'http_verb': 'POST', 'http_path': '/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive', 'http_user_agent': 'HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (034b138)', 'http_client_ip': '44.244.206.225'}, 'authentication_info': {'principal': None, 'service_principal_delegation_chain': []}, 'authorization_info': [], 'metadata': {'cluster_id': 'vault-cluster'}, 'operation_info': {'operation_id': ''}, 'description': 'Host Manager Alive Requested', 'action': 'CREATE', 'status_code': 'OK'}, 'subject': None}, {'id': 'a39b95a3-ac6b-4f44-ae6b-235ece41adce', 'timestamp': '2025-09-18T08:56:47.808259772Z', 'stream': {'organization_id': '11eab4a9-75f1-e0a5-8be1-0242ac110016', 'project_id': '11eab4a9-760d-c9f2-adc9-0242ac11000a', 'topic': 'hashicorp.platform.audit'}, 'resource': None, 'control_plane_event': {'request_info': {'http_verb': 'POST', 'http_path': '/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive', 'http_user_agent': 'HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (034b138)', 'http_client_ip': '54.71.56.251'}, 'authentication_info': {'principal': None, 'service_principal_delegation_chain': []}, 'authorization_info': [], 'metadata': {'cluster_id': 'vault-cluster'}, 'operation_info': {'operation_id': ''}, 'description': 'Host Manager Alive Requested', 'action': 'CREATE', 'status_code': 'OK'}, 'subject': None}, {'id': '5331f1b8-e3d4-4fc0-a5e5-4b915c5547ab', 'timestamp': '2025-09-17T21:35:13.076838035Z', 'stream': {'organization_id': '11eab4a9-75f1-e0a5-8be1-0242ac110016', 'project_id': '', 'topic': 'hashicorp.platform.audit'}, 'resource': None, 'control_plane_event': {'request_info': {'http_verb': 'GET', 'http_path': '/consent/complete', 'http_user_agent': '', 'http_client_ip': ''}, 'authentication_info': {'principal': {'id': '5f32f218-a0c0-4191-bd10-f2c1169bcfde', 'type': 'PRINCIPAL_TYPE_USER', 'user': {'id': '5f32f218-a0c0-4191-bd10-f2c1169bcfde', 'email': 'tpowell@hashicorp.com', 'full_name': 'tpowell@hashicorp.com', 'identity_type': 'UNSET', 'identity_types': [], 'subject': '5f32f218-a0c0-4191-bd10-f2c1169bcfde', 'scim_synchronized': False}, 'group_ids': []}, 'service_principal_delegation_chain': []}, 'authorization_info': [], 'metadata': {'email': 'tpowell@hashicorp.com', 'event_type': 'hcp_id_auth_success', 'ip': '73.252.181.35', 'message': 'Authenticated successfully', 'timestamp': '2025-09-17 14:10:12 +0000 UTC', 'user_id': '5f32f218-a0c0-4191-bd10-f2c1169bcfde'}, 'operation_info': {'operation_id': ''}, 'description': 'Authenticated successfully', 'action': 'CREATE', 'status_code': 'OK'}, 'subject': None}, {'id': '2461ef7b-0613-4930-9776-937e0520c0c3', 'timestamp': '2025-09-17T21:35:11.067285411Z', 'stream': {'organization_id': '11eab4a9-75f1-e0a5-8be1-0242ac110016', 'project_id': '', 'topic': 'hashicorp.platform.audit'}, 'resource': None, 'control_plane_event': {'request_info': {'http_verb': 'GET', 'http_path': '/consent/complete', 'http_user_agent': '', 'http_client_ip': ''}, 'authentication_info': {'principal': {'id': '5f32f218-a0c0-4191-bd10-f2c1169bcfde', 'type': 'PRINCIPAL_TYPE_USER', 'user': {'id': '5f32f218-a0c0-4191-bd10-f2c1169bcfde', 'email': 'tpowell@hashicorp.com', 'full_name': 'tpowell@hashicorp.com', 'identity_type': 'UNSET', 'identity_types': [], 'subject': '5f32f218-a0c0-4191-bd10-f2c1169bcfde', 'scim_synchronized': False}, 'group_ids': []}, 'service_principal_delegation_chain': []}, 'authorization_info': [], 'metadata': {'email': 'tpowell@hashicorp.com', 'event_type': 'hcp_id_auth_success', 'ip': '73.252.181.35', 'message': 'Authenticated successfully', 'timestamp': '2025-09-17 14:10:12 +0000 UTC', 'user_id': '5f32f218-a0c0-4191-bd10-f2c1169bcfde'}, 'operation_info': {'operation_id': ''}, 'description': 'Authenticated successfully', 'action': 'CREATE', 'status_code': 'OK'}, 'subject': None}, {'id': 'a29bbddd-eeed-4602-b3b7-134e9103cb4d', 'timestamp': '2025-09-17T21:34:41.454123777Z', 'stream': {'organization_id': '11eab4a9-75f1-e0a5-8be1-0242ac110016', 'project_id': '', 'topic': 'hashicorp.platform.audit'}, 'resource': None, 'control_plane_event': {'request_info': {'http_verb': 'GET', 'http_path': '/consent/complete', 'http_user_agent': '', 'http_client_ip': ''}, 'authentication_info': {'principal': {'id': '5f32f218-a0c0-4191-bd10-f2c1169bcfde', 'type': 'PRINCIPAL_TYPE_USER', 'user': {'id': '5f32f218-a0c0-4191-bd10-f2c1169bcfde', 'email': 'tpowell@hashicorp.com', 'full_name': 'tpowell@hashicorp.com', 'identity_type': 'UNSET', 'identity_types': [], 'subject': '5f32f218-a0c0-4191-bd10-f2c1169bcfde', 'scim_synchronized': False}, 'group_ids': []}, 'service_principal_delegation_chain': []}, 'authorization_info': [], 'metadata': {'email': 'tpowell@hashicorp.com', 'event_type': 'hcp_id_auth_success', 'ip': '73.252.181.35', 'message': 'Authenticated successfully', 'timestamp': '2025-09-17 14:10:12 +0000 UTC', 'user_id': '5f32f218-a0c0-4191-bd10-f2c1169bcfde'}, 'operation_info': {'operation_id': ''}, 'description': 'Authenticated successfully', 'action': 'CREATE', 'status_code': 'OK'}, 'subject': None}, {'id': '975a3166-ce85-4752-89db-5ed82b0cea98', 'timestamp': '2025-09-17T14:10:13.802285820Z', 'stream': {'organization_id': '11eab4a9-75f1-e0a5-8be1-0242ac110016', 'project_id': '', 'topic': 'hashicorp.platform.audit'}, 'resource': None, 'control_plane_event': {'request_info': {'http_verb': 'GET', 'http_path': '/consent/complete', 'http_user_agent': '', 'http_client_ip': ''}, 'authentication_info': {'principal': {'id': '5f32f218-a0c0-4191-bd10-f2c1169bcfde', 'type': 'PRINCIPAL_TYPE_USER', 'user': {'id': '5f32f218-a0c0-4191-bd10-f2c1169bcfde', 'email': 'tpowell@hashicorp.com', 'full_name': 'tpowell@hashicorp.com', 'identity_type': 'UNSET', 'identity_types': [], 'subject': '5f32f218-a0c0-4191-bd10-f2c1169bcfde', 'scim_synchronized': False}, 'group_ids': []}, 'service_principal_delegation_chain': []}, 'authorization_info': [], 'metadata': {'email': 'tpowell@hashicorp.com', 'event_type': 'hcp_id_auth_success', 'ip': '73.252.181.35', 'message': 'Authenticated successfully', 'timestamp': '2025-09-17 14:10:12 +0000 UTC', 'user_id': '5f32f218-a0c0-4191-bd10-f2c1169bcfde'}, 'operation_info': {'operation_id': ''}, 'description': 'Authenticated successfully', 'action': 'CREATE', 'status_code': 'OK'}, 'subject': None}, {'id': '2a2dedc5-1a66-4a2b-b85f-16b3dd54e873', 'timestamp': '2025-09-17T06:01:51.405726115Z', 'stream': {'organization_id': '11eab4a9-75f1-e0a5-8be1-0242ac110016', 'project_id': '11eab4a9-760d-c9f2-adc9-0242ac11000a', 'topic': 'hashicorp.platform.audit'}, 'resource': None, 'control_plane_event': {'request_info': {'http_verb': 'POST', 'http_path': '/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster1/host-alive', 'http_user_agent': 'HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (034b138)', 'http_client_ip': '35.155.247.128'}, 'authentication_info': {'principal': None, 'service_principal_delegation_chain': []}, 'authorization_info': [], 'metadata': {'cluster_id': 'vault-cluster1'}, 'operation_info': {'operation_id': ''}, 'description': 'Host Manager Alive Requested', 'action': 'CREATE', 'status_code': 'OK'}, 'subject': None}, {'id': '028b8b4e-1191-4a10-8db6-c0dcdef29232', 'timestamp': '2025-09-16T21:11:17.528232541Z', 'stream': {'organization_id': '11eab4a9-75f1-e0a5-8be1-0242ac110016', 'project_id': '', 'topic': 'hashicorp.platform.audit'}, 'resource': None, 'control_plane_event': {'request_info': {'http_verb': 'GET', 'http_path': '/consent/complete', 'http_user_agent': '', 'http_client_ip': ''}, 'authentication_info': {'principal': {'id': '8447b58b-ba1d-4bad-8a8f-73b08e83d53a', 'type': 'PRINCIPAL_TYPE_USER', 'user': {'id': '8447b58b-ba1d-4bad-8a8f-73b08e83d53a', 'email': 'shivani.jalan@hashicorp.com', 'full_name': 'shivani.jalan@hashicorp.com', 'identity_type': 'UNSET', 'identity_types': [], 'subject': '8447b58b-ba1d-4bad-8a8f-73b08e83d53a', 'scim_synchronized': False}, 'group_ids': []}, 'service_principal_delegation_chain': []}, 'authorization_info': [], 'metadata': {'email': 'shivani.jalan@hashicorp.com', 'event_type': 'hcp_id_auth_success', 'ip': '73.15.181.24', 'message': 'Authenticated successfully', 'timestamp': '2025-09-16 21:11:16 +0000 UTC', 'user_id': '8447b58b-ba1d-4bad-8a8f-73b08e83d53a'}, 'operation_info': {'operation_id': ''}, 'description': 'Authenticated successfully', 'action': 'CREATE', 'status_code': 'OK'}, 'subject': None}]}, 'next_page_token': 'eyJ0aW1lc3RhbXAiOiIyMDI1LTA5LTE2VDIxOjExOjE3LjUyODIzMjU0MVoiLCJpZCI6IjAyOGI4YjRlLTExOTEtNGExMC04ZGI2LWMwZGNkZWYyOTIzMiIsIm9mZnNldCI6MX0='}
2025-10-11 11:00:58,978 - mcp_server - INFO - Request data: stdio_main: {'jsonrpc': '2.0', 'result': {'content': [{'type': 'text', 'text': '{"streams": {"entries": [{"id": "4336142e-6643-410b-8cd8-d11f25d123e8", "timestamp": "2025-09-21T08:56:46.837872528Z", "stream": {"organization_id": "11eab4a9-75f1-e0a5-8be1-0242ac110016", "project_id": "11eab4a9-760d-c9f2-adc9-0242ac11000a", "topic": "hashicorp.platform.audit"}, "resource": null, "control_plane_event": {"request_info": {"http_verb": "POST", "http_path": "/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive", "http_user_agent": "HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (034b138)", "http_client_ip": "35.91.253.99"}, "authentication_info": {"principal": null, "service_principal_delegation_chain": []}, "authorization_info": [], "metadata": {"cluster_id": "vault-cluster"}, "operation_info": {"operation_id": ""}, "description": "Host Manager Alive Requested", "action": "CREATE", "status_code": "OK"}, "subject": null}, {"id": "fcb47d39-84e9-4807-b7e6-09826793ebe2", "timestamp": "2025-09-21T08:56:45.788956577Z", "stream": {"organization_id": "11eab4a9-75f1-e0a5-8be1-0242ac110016", "project_id": "11eab4a9-760d-c9f2-adc9-0242ac11000a", "topic": "hashicorp.platform.audit"}, "resource": null, "control_plane_event": {"request_info": {"http_verb": "POST", "http_path": "/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive", "http_user_agent": "HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (034b138)", "http_client_ip": "54.185.246.217"}, "authentication_info": {"principal": null, "service_principal_delegation_chain": []}, "authorization_info": [], "metadata": {"cluster_id": "vault-cluster"}, "operation_info": {"operation_id": ""}, "description": "Host Manager Alive Requested", "action": "CREATE", "status_code": "OK"}, "subject": null}, {"id": "97080f93-e6a0-4af4-a486-4b6e7dc82133", "timestamp": "2025-09-21T08:56:45.642128036Z", "stream": {"organization_id": "11eab4a9-75f1-e0a5-8be1-0242ac110016", "project_id": "11eab4a9-760d-c9f2-adc9-0242ac11000a", "topic": "hashicorp.platform.audit"}, "resource": null, "control_plane_event": {"request_info": {"http_verb": "POST", "http_path": "/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive", "http_user_agent": "HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (034b138)", "http_client_ip": "44.249.72.203"}, "authentication_info": {"principal": null, "service_principal_delegation_chain": []}, "authorization_info": [], "metadata": {"cluster_id": "vault-cluster"}, "operation_info": {"operation_id": ""}, "description": "Host Manager Alive Requested", "action": "CREATE", "status_code": "OK"}, "subject": null}, {"id": "20705b99-ecb6-4dc1-98ac-286122839806", "timestamp": "2025-09-20T06:06:27.120285189Z", "stream": {"organization_id": "11eab4a9-75f1-e0a5-8be1-0242ac110016", "project_id": "11eab4a9-760d-c9f2-adc9-0242ac11000a", "topic": "hashicorp.platform.audit"}, "resource": null, "control_plane_event": {"request_info": {"http_verb": "POST", "http_path": "/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster1/host-alive", "http_user_agent": "HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (034b138)", "http_client_ip": "35.94.124.189"}, "authentication_info": {"principal": null, "service_principal_delegation_chain": []}, "authorization_info": [], "metadata": {"cluster_id": "vault-cluster1"}, "operation_info": {"operation_id": ""}, "description": "Host Manager Alive Requested", "action": "CREATE", "status_code": "OK"}, "subject": null}, {"id": "a1d4f651-c1b6-40af-89d0-e29a6fff9b4d", "timestamp": "2025-09-20T06:01:50.642295859Z", "stream": {"organization_id": "11eab4a9-75f1-e0a5-8be1-0242ac110016", "project_id": "11eab4a9-760d-c9f2-adc9-0242ac11000a", "topic": "hashicorp.platform.audit"}, "resource": null, "control_plane_event": {"request_info": {"http_verb": "POST", "http_path": "/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster1/host-alive", "http_user_agent": "HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (034b138)", "http_client_ip": "35.94.124.189"}, "authentication_info": {"principal": null, "service_principal_delegation_chain": []}, "authorization_info": [], "metadata": {"cluster_id": "vault-cluster1"}, "operation_info": {"operation_id": ""}, "description": "Host Manager Alive Requested", "action": "CREATE", "status_code": "OK"}, "subject": null}, {"id": "9f3c2084-2a7b-40b3-9932-923801c45cff", "timestamp": "2025-09-19T06:36:03.644578187Z", "stream": {"organization_id": "11eab4a9-75f1-e0a5-8be1-0242ac110016", "project_id": "11eab4a9-760d-c9f2-adc9-0242ac11000a", "topic": "hashicorp.platform.audit"}, "resource": null, "control_plane_event": {"request_info": {"http_verb": "POST", "http_path": "/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster-4/host-alive", "http_user_agent": "HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (034b138)", "http_client_ip": "34.215.250.27"}, "authentication_info": {"principal": null, "service_principal_delegation_chain": []}, "authorization_info": [], "metadata": {"cluster_id": "vault-cluster-4"}, "operation_info": {"operation_id": ""}, "description": "Host Manager Alive Requested", "action": "CREATE", "status_code": "OK"}, "subject": null}, {"id": "8e4f6aec-0533-4bf1-8cfe-7bea957c4b0f", "timestamp": "2025-09-19T06:31:54.327437055Z", "stream": {"organization_id": "11eab4a9-75f1-e0a5-8be1-0242ac110016", "project_id": "11eab4a9-760d-c9f2-adc9-0242ac11000a", "topic": "hashicorp.platform.audit"}, "resource": null, "control_plane_event": {"request_info": {"http_verb": "POST", "http_path": "/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster-4/host-alive", "http_user_agent": "HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (034b138)", "http_client_ip": "34.215.250.27"}, "authentication_info": {"principal": null, "service_principal_delegation_chain": []}, "authorization_info": [], "metadata": {"cluster_id": "vault-cluster-4"}, "operation_info": {"operation_id": ""}, "description": "Host Manager Alive Requested", "action": "CREATE", "status_code": "OK"}, "subject": null}, {"id": "2c722f10-52a2-4f71-a4ea-f82424f2f420", "timestamp": "2025-09-18T08:56:49.845545181Z", "stream": {"organization_id": "11eab4a9-75f1-e0a5-8be1-0242ac110016", "project_id": "11eab4a9-760d-c9f2-adc9-0242ac11000a", "topic": "hashicorp.platform.audit"}, "resource": null, "control_plane_event": {"request_info": {"http_verb": "POST", "http_path": "/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive", "http_user_agent": "HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (034b138)", "http_client_ip": "35.92.53.47"}, "authentication_info": {"principal": null, "service_principal_delegation_chain": []}, "authorization_info": [], "metadata": {"cluster_id": "vault-cluster"}, "operation_info": {"operation_id": ""}, "description": "Host Manager Alive Requested", "action": "CREATE", "status_code": "OK"}, "subject": null}, {"id": "09179b82-ffec-4015-9f68-dd18f1133d4a", "timestamp": "2025-09-18T08:56:48.030759957Z", "stream": {"organization_id": "11eab4a9-75f1-e0a5-8be1-0242ac110016", "project_id": "11eab4a9-760d-c9f2-adc9-0242ac11000a", "topic": "hashicorp.platform.audit"}, "resource": null, "control_plane_event": {"request_info": {"http_verb": "POST", "http_path": "/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive", "http_user_agent": "HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (034b138)", "http_client_ip": "44.244.206.225"}, "authentication_info": {"principal": null, "service_principal_delegation_chain": []}, "authorization_info": [], "metadata": {"cluster_id": "vault-cluster"}, "operation_info": {"operation_id": ""}, "description": "Host Manager Alive Requested", "action": "CREATE", "status_code": "OK"}, "subject": null}, {"id": "a39b95a3-ac6b-4f44-ae6b-235ece41adce", "timestamp": "2025-09-18T08:56:47.808259772Z", "stream": {"organization_id": "11eab4a9-75f1-e0a5-8be1-0242ac110016", "project_id": "11eab4a9-760d-c9f2-adc9-0242ac11000a", "topic": "hashicorp.platform.audit"}, "resource": null, "control_plane_event": {"request_info": {"http_verb": "POST", "http_path": "/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive", "http_user_agent": "HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (034b138)", "http_client_ip": "54.71.56.251"}, "authentication_info": {"principal": null, "service_principal_delegation_chain": []}, "authorization_info": [], "metadata": {"cluster_id": "vault-cluster"}, "operation_info": {"operation_id": ""}, "description": "Host Manager Alive Requested", "action": "CREATE", "status_code": "OK"}, "subject": null}, {"id": "5331f1b8-e3d4-4fc0-a5e5-4b915c5547ab", "timestamp": "2025-09-17T21:35:13.076838035Z", "stream": {"organization_id": "11eab4a9-75f1-e0a5-8be1-0242ac110016", "project_id": "", "topic": "hashicorp.platform.audit"}, "resource": null, "control_plane_event": {"request_info": {"http_verb": "GET", "http_path": "/consent/complete", "http_user_agent": "", "http_client_ip": ""}, "authentication_info": {"principal": {"id": "5f32f218-a0c0-4191-bd10-f2c1169bcfde", "type": "PRINCIPAL_TYPE_USER", "user": {"id": "5f32f218-a0c0-4191-bd10-f2c1169bcfde", "email": "tpowell@hashicorp.com", "full_name": "tpowell@hashicorp.com", "identity_type": "UNSET", "identity_types": [], "subject": "5f32f218-a0c0-4191-bd10-f2c1169bcfde", "scim_synchronized": false}, "group_ids": []}, "service_principal_delegation_chain": []}, "authorization_info": [], "metadata": {"email": "tpowell@hashicorp.com", "event_type": "hcp_id_auth_success", "ip": "73.252.181.35", "message": "Authenticated successfully", "timestamp": "2025-09-17 14:10:12 +0000 UTC", "user_id": "5f32f218-a0c0-4191-bd10-f2c1169bcfde"}, "operation_info": {"operation_id": ""}, "description": "Authenticated successfully", "action": "CREATE", "status_code": "OK"}, "subject": null}, {"id": "2461ef7b-0613-4930-9776-937e0520c0c3", "timestamp": "2025-09-17T21:35:11.067285411Z", "stream": {"organization_id": "11eab4a9-75f1-e0a5-8be1-0242ac110016", "project_id": "", "topic": "hashicorp.platform.audit"}, "resource": null, "control_plane_event": {"request_info": {"http_verb": "GET", "http_path": "/consent/complete", "http_user_agent": "", "http_client_ip": ""}, "authentication_info": {"principal": {"id": "5f32f218-a0c0-4191-bd10-f2c1169bcfde", "type": "PRINCIPAL_TYPE_USER", "user": {"id": "5f32f218-a0c0-4191-bd10-f2c1169bcfde", "email": "tpowell@hashicorp.com", "full_name": "tpowell@hashicorp.com", "identity_type": "UNSET", "identity_types": [], "subject": "5f32f218-a0c0-4191-bd10-f2c1169bcfde", "scim_synchronized": false}, "group_ids": []}, "service_principal_delegation_chain": []}, "authorization_info": [], "metadata": {"email": "tpowell@hashicorp.com", "event_type": "hcp_id_auth_success", "ip": "73.252.181.35", "message": "Authenticated successfully", "timestamp": "2025-09-17 14:10:12 +0000 UTC", "user_id": "5f32f218-a0c0-4191-bd10-f2c1169bcfde"}, "operation_info": {"operation_id": ""}, "description": "Authenticated successfully", "action": "CREATE", "status_code": "OK"}, "subject": null}, {"id": "a29bbddd-eeed-4602-b3b7-134e9103cb4d", "timestamp": "2025-09-17T21:34:41.454123777Z", "stream": {"organization_id": "11eab4a9-75f1-e0a5-8be1-0242ac110016", "project_id": "", "topic": "hashicorp.platform.audit"}, "resource": null, "control_plane_event": {"request_info": {"http_verb": "GET", "http_path": "/consent/complete", "http_user_agent": "", "http_client_ip": ""}, "authentication_info": {"principal": {"id": "5f32f218-a0c0-4191-bd10-f2c1169bcfde", "type": "PRINCIPAL_TYPE_USER", "user": {"id": "5f32f218-a0c0-4191-bd10-f2c1169bcfde", "email": "tpowell@hashicorp.com", "full_name": "tpowell@hashicorp.com", "identity_type": "UNSET", "identity_types": [], "subject": "5f32f218-a0c0-4191-bd10-f2c1169bcfde", "scim_synchronized": false}, "group_ids": []}, "service_principal_delegation_chain": []}, "authorization_info": [], "metadata": {"email": "tpowell@hashicorp.com", "event_type": "hcp_id_auth_success", "ip": "73.252.181.35", "message": "Authenticated successfully", "timestamp": "2025-09-17 14:10:12 +0000 UTC", "user_id": "5f32f218-a0c0-4191-bd10-f2c1169bcfde"}, "operation_info": {"operation_id": ""}, "description": "Authenticated successfully", "action": "CREATE", "status_code": "OK"}, "subject": null}, {"id": "975a3166-ce85-4752-89db-5ed82b0cea98", "timestamp": "2025-09-17T14:10:13.802285820Z", "stream": {"organization_id": "11eab4a9-75f1-e0a5-8be1-0242ac110016", "project_id": "", "topic": "hashicorp.platform.audit"}, "resource": null, "control_plane_event": {"request_info": {"http_verb": "GET", "http_path": "/consent/complete", "http_user_agent": "", "http_client_ip": ""}, "authentication_info": {"principal": {"id": "5f32f218-a0c0-4191-bd10-f2c1169bcfde", "type": "PRINCIPAL_TYPE_USER", "user": {"id": "5f32f218-a0c0-4191-bd10-f2c1169bcfde", "email": "tpowell@hashicorp.com", "full_name": "tpowell@hashicorp.com", "identity_type": "UNSET", "identity_types": [], "subject": "5f32f218-a0c0-4191-bd10-f2c1169bcfde", "scim_synchronized": false}, "group_ids": []}, "service_principal_delegation_chain": []}, "authorization_info": [], "metadata": {"email": "tpowell@hashicorp.com", "event_type": "hcp_id_auth_success", "ip": "73.252.181.35", "message": "Authenticated successfully", "timestamp": "2025-09-17 14:10:12 +0000 UTC", "user_id": "5f32f218-a0c0-4191-bd10-f2c1169bcfde"}, "operation_info": {"operation_id": ""}, "description": "Authenticated successfully", "action": "CREATE", "status_code": "OK"}, "subject": null}, {"id": "2a2dedc5-1a66-4a2b-b85f-16b3dd54e873", "timestamp": "2025-09-17T06:01:51.405726115Z", "stream": {"organization_id": "11eab4a9-75f1-e0a5-8be1-0242ac110016", "project_id": "11eab4a9-760d-c9f2-adc9-0242ac11000a", "topic": "hashicorp.platform.audit"}, "resource": null, "control_plane_event": {"request_info": {"http_verb": "POST", "http_path": "/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster1/host-alive", "http_user_agent": "HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (034b138)", "http_client_ip": "35.155.247.128"}, "authentication_info": {"principal": null, "service_principal_delegation_chain": []}, "authorization_info": [], "metadata": {"cluster_id": "vault-cluster1"}, "operation_info": {"operation_id": ""}, "description": "Host Manager Alive Requested", "action": "CREATE", "status_code": "OK"}, "subject": null}, {"id": "028b8b4e-1191-4a10-8db6-c0dcdef29232", "timestamp": "2025-09-16T21:11:17.528232541Z", "stream": {"organization_id": "11eab4a9-75f1-e0a5-8be1-0242ac110016", "project_id": "", "topic": "hashicorp.platform.audit"}, "resource": null, "control_plane_event": {"request_info": {"http_verb": "GET", "http_path": "/consent/complete", "http_user_agent": "", "http_client_ip": ""}, "authentication_info": {"principal": {"id": "8447b58b-ba1d-4bad-8a8f-73b08e83d53a", "type": "PRINCIPAL_TYPE_USER", "user": {"id": "8447b58b-ba1d-4bad-8a8f-73b08e83d53a", "email": "shivani.jalan@hashicorp.com", "full_name": "shivani.jalan@hashicorp.com", "identity_type": "UNSET", "identity_types": [], "subject": "8447b58b-ba1d-4bad-8a8f-73b08e83d53a", "scim_synchronized": false}, "group_ids": []}, "service_principal_delegation_chain": []}, "authorization_info": [], "metadata": {"email": "shivani.jalan@hashicorp.com", "event_type": "hcp_id_auth_success", "ip": "73.15.181.24", "message": "Authenticated successfully", "timestamp": "2025-09-16 21:11:16 +0000 UTC", "user_id": "8447b58b-ba1d-4bad-8a8f-73b08e83d53a"}, "operation_info": {"operation_id": ""}, "description": "Authenticated successfully", "action": "CREATE", "status_code": "OK"}, "subject": null}]}, "next_page_token": "eyJ0aW1lc3RhbXAiOiIyMDI1LTA5LTE2VDIxOjExOjE3LjUyODIzMjU0MVoiLCJpZCI6IjAyOGI4YjRlLTExOTEtNGExMC04ZGI2LWMwZGNkZWYyOTIzMiIsIm9mZnNldCI6MX0="}'}], 'isError': False}, 'id': 6}
2025-10-11 11:00:58,979 - mcp_server - INFO - Request data: stdio_main json: {"jsonrpc": "2.0", "result": {"content": [{"type": "text", "text": "{\"streams\": {\"entries\": [{\"id\": \"4336142e-6643-410b-8cd8-d11f25d123e8\", \"timestamp\": \"2025-09-21T08:56:46.837872528Z\", \"stream\": {\"organization_id\": \"11eab4a9-75f1-e0a5-8be1-0242ac110016\", \"project_id\": \"11eab4a9-760d-c9f2-adc9-0242ac11000a\", \"topic\": \"hashicorp.platform.audit\"}, \"resource\": null, \"control_plane_event\": {\"request_info\": {\"http_verb\": \"POST\", \"http_path\": \"/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive\", \"http_user_agent\": \"HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (034b138)\", \"http_client_ip\": \"35.91.253.99\"}, \"authentication_info\": {\"principal\": null, \"service_principal_delegation_chain\": []}, \"authorization_info\": [], \"metadata\": {\"cluster_id\": \"vault-cluster\"}, \"operation_info\": {\"operation_id\": \"\"}, \"description\": \"Host Manager Alive Requested\", \"action\": \"CREATE\", \"status_code\": \"OK\"}, \"subject\": null}, {\"id\": \"fcb47d39-84e9-4807-b7e6-09826793ebe2\", \"timestamp\": \"2025-09-21T08:56:45.788956577Z\", \"stream\": {\"organization_id\": \"11eab4a9-75f1-e0a5-8be1-0242ac110016\", \"project_id\": \"11eab4a9-760d-c9f2-adc9-0242ac11000a\", \"topic\": \"hashicorp.platform.audit\"}, \"resource\": null, \"control_plane_event\": {\"request_info\": {\"http_verb\": \"POST\", \"http_path\": \"/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive\", \"http_user_agent\": \"HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (034b138)\", \"http_client_ip\": \"54.185.246.217\"}, \"authentication_info\": {\"principal\": null, \"service_principal_delegation_chain\": []}, \"authorization_info\": [], \"metadata\": {\"cluster_id\": \"vault-cluster\"}, \"operation_info\": {\"operation_id\": \"\"}, \"description\": \"Host Manager Alive Requested\", \"action\": \"CREATE\", \"status_code\": \"OK\"}, \"subject\": null}, {\"id\": \"97080f93-e6a0-4af4-a486-4b6e7dc82133\", \"timestamp\": \"2025-09-21T08:56:45.642128036Z\", \"stream\": {\"organization_id\": \"11eab4a9-75f1-e0a5-8be1-0242ac110016\", \"project_id\": \"11eab4a9-760d-c9f2-adc9-0242ac11000a\", \"topic\": \"hashicorp.platform.audit\"}, \"resource\": null, \"control_plane_event\": {\"request_info\": {\"http_verb\": \"POST\", \"http_path\": \"/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive\", \"http_user_agent\": \"HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (034b138)\", \"http_client_ip\": \"44.249.72.203\"}, \"authentication_info\": {\"principal\": null, \"service_principal_delegation_chain\": []}, \"authorization_info\": [], \"metadata\": {\"cluster_id\": \"vault-cluster\"}, \"operation_info\": {\"operation_id\": \"\"}, \"description\": \"Host Manager Alive Requested\", \"action\": \"CREATE\", \"status_code\": \"OK\"}, \"subject\": null}, {\"id\": \"20705b99-ecb6-4dc1-98ac-286122839806\", \"timestamp\": \"2025-09-20T06:06:27.120285189Z\", \"stream\": {\"organization_id\": \"11eab4a9-75f1-e0a5-8be1-0242ac110016\", \"project_id\": \"11eab4a9-760d-c9f2-adc9-0242ac11000a\", \"topic\": \"hashicorp.platform.audit\"}, \"resource\": null, \"control_plane_event\": {\"request_info\": {\"http_verb\": \"POST\", \"http_path\": \"/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster1/host-alive\", \"http_user_agent\": \"HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (034b138)\", \"http_client_ip\": \"35.94.124.189\"}, \"authentication_info\": {\"principal\": null, \"service_principal_delegation_chain\": []}, \"authorization_info\": [], \"metadata\": {\"cluster_id\": \"vault-cluster1\"}, \"operation_info\": {\"operation_id\": \"\"}, \"description\": \"Host Manager Alive Requested\", \"action\": \"CREATE\", \"status_code\": \"OK\"}, \"subject\": null}, {\"id\": \"a1d4f651-c1b6-40af-89d0-e29a6fff9b4d\", \"timestamp\": \"2025-09-20T06:01:50.642295859Z\", \"stream\": {\"organization_id\": \"11eab4a9-75f1-e0a5-8be1-0242ac110016\", \"project_id\": \"11eab4a9-760d-c9f2-adc9-0242ac11000a\", \"topic\": \"hashicorp.platform.audit\"}, \"resource\": null, \"control_plane_event\": {\"request_info\": {\"http_verb\": \"POST\", \"http_path\": \"/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster1/host-alive\", \"http_user_agent\": \"HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (034b138)\", \"http_client_ip\": \"35.94.124.189\"}, \"authentication_info\": {\"principal\": null, \"service_principal_delegation_chain\": []}, \"authorization_info\": [], \"metadata\": {\"cluster_id\": \"vault-cluster1\"}, \"operation_info\": {\"operation_id\": \"\"}, \"description\": \"Host Manager Alive Requested\", \"action\": \"CREATE\", \"status_code\": \"OK\"}, \"subject\": null}, {\"id\": \"9f3c2084-2a7b-40b3-9932-923801c45cff\", \"timestamp\": \"2025-09-19T06:36:03.644578187Z\", \"stream\": {\"organization_id\": \"11eab4a9-75f1-e0a5-8be1-0242ac110016\", \"project_id\": \"11eab4a9-760d-c9f2-adc9-0242ac11000a\", \"topic\": \"hashicorp.platform.audit\"}, \"resource\": null, \"control_plane_event\": {\"request_info\": {\"http_verb\": \"POST\", \"http_path\": \"/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster-4/host-alive\", \"http_user_agent\": \"HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (034b138)\", \"http_client_ip\": \"34.215.250.27\"}, \"authentication_info\": {\"principal\": null, \"service_principal_delegation_chain\": []}, \"authorization_info\": [], \"metadata\": {\"cluster_id\": \"vault-cluster-4\"}, \"operation_info\": {\"operation_id\": \"\"}, \"description\": \"Host Manager Alive Requested\", \"action\": \"CREATE\", \"status_code\": \"OK\"}, \"subject\": null}, {\"id\": \"8e4f6aec-0533-4bf1-8cfe-7bea957c4b0f\", \"timestamp\": \"2025-09-19T06:31:54.327437055Z\", \"stream\": {\"organization_id\": \"11eab4a9-75f1-e0a5-8be1-0242ac110016\", \"project_id\": \"11eab4a9-760d-c9f2-adc9-0242ac11000a\", \"topic\": \"hashicorp.platform.audit\"}, \"resource\": null, \"control_plane_event\": {\"request_info\": {\"http_verb\": \"POST\", \"http_path\": \"/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster-4/host-alive\", \"http_user_agent\": \"HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (034b138)\", \"http_client_ip\": \"34.215.250.27\"}, \"authentication_info\": {\"principal\": null, \"service_principal_delegation_chain\": []}, \"authorization_info\": [], \"metadata\": {\"cluster_id\": \"vault-cluster-4\"}, \"operation_info\": {\"operation_id\": \"\"}, \"description\": \"Host Manager Alive Requested\", \"action\": \"CREATE\", \"status_code\": \"OK\"}, \"subject\": null}, {\"id\": \"2c722f10-52a2-4f71-a4ea-f82424f2f420\", \"timestamp\": \"2025-09-18T08:56:49.845545181Z\", \"stream\": {\"organization_id\": \"11eab4a9-75f1-e0a5-8be1-0242ac110016\", \"project_id\": \"11eab4a9-760d-c9f2-adc9-0242ac11000a\", \"topic\": \"hashicorp.platform.audit\"}, \"resource\": null, \"control_plane_event\": {\"request_info\": {\"http_verb\": \"POST\", \"http_path\": \"/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive\", \"http_user_agent\": \"HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (034b138)\", \"http_client_ip\": \"35.92.53.47\"}, \"authentication_info\": {\"principal\": null, \"service_principal_delegation_chain\": []}, \"authorization_info\": [], \"metadata\": {\"cluster_id\": \"vault-cluster\"}, \"operation_info\": {\"operation_id\": \"\"}, \"description\": \"Host Manager Alive Requested\", \"action\": \"CREATE\", \"status_code\": \"OK\"}, \"subject\": null}, {\"id\": \"09179b82-ffec-4015-9f68-dd18f1133d4a\", \"timestamp\": \"2025-09-18T08:56:48.030759957Z\", \"stream\": {\"organization_id\": \"11eab4a9-75f1-e0a5-8be1-0242ac110016\", \"project_id\": \"11eab4a9-760d-c9f2-adc9-0242ac11000a\", \"topic\": \"hashicorp.platform.audit\"}, \"resource\": null, \"control_plane_event\": {\"request_info\": {\"http_verb\": \"POST\", \"http_path\": \"/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive\", \"http_user_agent\": \"HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (034b138)\", \"http_client_ip\": \"44.244.206.225\"}, \"authentication_info\": {\"principal\": null, \"service_principal_delegation_chain\": []}, \"authorization_info\": [], \"metadata\": {\"cluster_id\": \"vault-cluster\"}, \"operation_info\": {\"operation_id\": \"\"}, \"description\": \"Host Manager Alive Requested\", \"action\": \"CREATE\", \"status_code\": \"OK\"}, \"subject\": null}, {\"id\": \"a39b95a3-ac6b-4f44-ae6b-235ece41adce\", \"timestamp\": \"2025-09-18T08:56:47.808259772Z\", \"stream\": {\"organization_id\": \"11eab4a9-75f1-e0a5-8be1-0242ac110016\", \"project_id\": \"11eab4a9-760d-c9f2-adc9-0242ac11000a\", \"topic\": \"hashicorp.platform.audit\"}, \"resource\": null, \"control_plane_event\": {\"request_info\": {\"http_verb\": \"POST\", \"http_path\": \"/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive\", \"http_user_agent\": \"HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (034b138)\", \"http_client_ip\": \"54.71.56.251\"}, \"authentication_info\": {\"principal\": null, \"service_principal_delegation_chain\": []}, \"authorization_info\": [], \"metadata\": {\"cluster_id\": \"vault-cluster\"}, \"operation_info\": {\"operation_id\": \"\"}, \"description\": \"Host Manager Alive Requested\", \"action\": \"CREATE\", \"status_code\": \"OK\"}, \"subject\": null}, {\"id\": \"5331f1b8-e3d4-4fc0-a5e5-4b915c5547ab\", \"timestamp\": \"2025-09-17T21:35:13.076838035Z\", \"stream\": {\"organization_id\": \"11eab4a9-75f1-e0a5-8be1-0242ac110016\", \"project_id\": \"\", \"topic\": \"hashicorp.platform.audit\"}, \"resource\": null, \"control_plane_event\": {\"request_info\": {\"http_verb\": \"GET\", \"http_path\": \"/consent/complete\", \"http_user_agent\": \"\", \"http_client_ip\": \"\"}, \"authentication_info\": {\"principal\": {\"id\": \"5f32f218-a0c0-4191-bd10-f2c1169bcfde\", \"type\": \"PRINCIPAL_TYPE_USER\", \"user\": {\"id\": \"5f32f218-a0c0-4191-bd10-f2c1169bcfde\", \"email\": \"tpowell@hashicorp.com\", \"full_name\": \"tpowell@hashicorp.com\", \"identity_type\": \"UNSET\", \"identity_types\": [], \"subject\": \"5f32f218-a0c0-4191-bd10-f2c1169bcfde\", \"scim_synchronized\": false}, \"group_ids\": []}, \"service_principal_delegation_chain\": []}, \"authorization_info\": [], \"metadata\": {\"email\": \"tpowell@hashicorp.com\", \"event_type\": \"hcp_id_auth_success\", \"ip\": \"73.252.181.35\", \"message\": \"Authenticated successfully\", \"timestamp\": \"2025-09-17 14:10:12 +0000 UTC\", \"user_id\": \"5f32f218-a0c0-4191-bd10-f2c1169bcfde\"}, \"operation_info\": {\"operation_id\": \"\"}, \"description\": \"Authenticated successfully\", \"action\": \"CREATE\", \"status_code\": \"OK\"}, \"subject\": null}, {\"id\": \"2461ef7b-0613-4930-9776-937e0520c0c3\", \"timestamp\": \"2025-09-17T21:35:11.067285411Z\", \"stream\": {\"organization_id\": \"11eab4a9-75f1-e0a5-8be1-0242ac110016\", \"project_id\": \"\", \"topic\": \"hashicorp.platform.audit\"}, \"resource\": null, \"control_plane_event\": {\"request_info\": {\"http_verb\": \"GET\", \"http_path\": \"/consent/complete\", \"http_user_agent\": \"\", \"http_client_ip\": \"\"}, \"authentication_info\": {\"principal\": {\"id\": \"5f32f218-a0c0-4191-bd10-f2c1169bcfde\", \"type\": \"PRINCIPAL_TYPE_USER\", \"user\": {\"id\": \"5f32f218-a0c0-4191-bd10-f2c1169bcfde\", \"email\": \"tpowell@hashicorp.com\", \"full_name\": \"tpowell@hashicorp.com\", \"identity_type\": \"UNSET\", \"identity_types\": [], \"subject\": \"5f32f218-a0c0-4191-bd10-f2c1169bcfde\", \"scim_synchronized\": false}, \"group_ids\": []}, \"service_principal_delegation_chain\": []}, \"authorization_info\": [], \"metadata\": {\"email\": \"tpowell@hashicorp.com\", \"event_type\": \"hcp_id_auth_success\", \"ip\": \"73.252.181.35\", \"message\": \"Authenticated successfully\", \"timestamp\": \"2025-09-17 14:10:12 +0000 UTC\", \"user_id\": \"5f32f218-a0c0-4191-bd10-f2c1169bcfde\"}, \"operation_info\": {\"operation_id\": \"\"}, \"description\": \"Authenticated successfully\", \"action\": \"CREATE\", \"status_code\": \"OK\"}, \"subject\": null}, {\"id\": \"a29bbddd-eeed-4602-b3b7-134e9103cb4d\", \"timestamp\": \"2025-09-17T21:34:41.454123777Z\", \"stream\": {\"organization_id\": \"11eab4a9-75f1-e0a5-8be1-0242ac110016\", \"project_id\": \"\", \"topic\": \"hashicorp.platform.audit\"}, \"resource\": null, \"control_plane_event\": {\"request_info\": {\"http_verb\": \"GET\", \"http_path\": \"/consent/complete\", \"http_user_agent\": \"\", \"http_client_ip\": \"\"}, \"authentication_info\": {\"principal\": {\"id\": \"5f32f218-a0c0-4191-bd10-f2c1169bcfde\", \"type\": \"PRINCIPAL_TYPE_USER\", \"user\": {\"id\": \"5f32f218-a0c0-4191-bd10-f2c1169bcfde\", \"email\": \"tpowell@hashicorp.com\", \"full_name\": \"tpowell@hashicorp.com\", \"identity_type\": \"UNSET\", \"identity_types\": [], \"subject\": \"5f32f218-a0c0-4191-bd10-f2c1169bcfde\", \"scim_synchronized\": false}, \"group_ids\": []}, \"service_principal_delegation_chain\": []}, \"authorization_info\": [], \"metadata\": {\"email\": \"tpowell@hashicorp.com\", \"event_type\": \"hcp_id_auth_success\", \"ip\": \"73.252.181.35\", \"message\": \"Authenticated successfully\", \"timestamp\": \"2025-09-17 14:10:12 +0000 UTC\", \"user_id\": \"5f32f218-a0c0-4191-bd10-f2c1169bcfde\"}, \"operation_info\": {\"operation_id\": \"\"}, \"description\": \"Authenticated successfully\", \"action\": \"CREATE\", \"status_code\": \"OK\"}, \"subject\": null}, {\"id\": \"975a3166-ce85-4752-89db-5ed82b0cea98\", \"timestamp\": \"2025-09-17T14:10:13.802285820Z\", \"stream\": {\"organization_id\": \"11eab4a9-75f1-e0a5-8be1-0242ac110016\", \"project_id\": \"\", \"topic\": \"hashicorp.platform.audit\"}, \"resource\": null, \"control_plane_event\": {\"request_info\": {\"http_verb\": \"GET\", \"http_path\": \"/consent/complete\", \"http_user_agent\": \"\", \"http_client_ip\": \"\"}, \"authentication_info\": {\"principal\": {\"id\": \"5f32f218-a0c0-4191-bd10-f2c1169bcfde\", \"type\": \"PRINCIPAL_TYPE_USER\", \"user\": {\"id\": \"5f32f218-a0c0-4191-bd10-f2c1169bcfde\", \"email\": \"tpowell@hashicorp.com\", \"full_name\": \"tpowell@hashicorp.com\", \"identity_type\": \"UNSET\", \"identity_types\": [], \"subject\": \"5f32f218-a0c0-4191-bd10-f2c1169bcfde\", \"scim_synchronized\": false}, \"group_ids\": []}, \"service_principal_delegation_chain\": []}, \"authorization_info\": [], \"metadata\": {\"email\": \"tpowell@hashicorp.com\", \"event_type\": \"hcp_id_auth_success\", \"ip\": \"73.252.181.35\", \"message\": \"Authenticated successfully\", \"timestamp\": \"2025-09-17 14:10:12 +0000 UTC\", \"user_id\": \"5f32f218-a0c0-4191-bd10-f2c1169bcfde\"}, \"operation_info\": {\"operation_id\": \"\"}, \"description\": \"Authenticated successfully\", \"action\": \"CREATE\", \"status_code\": \"OK\"}, \"subject\": null}, {\"id\": \"2a2dedc5-1a66-4a2b-b85f-16b3dd54e873\", \"timestamp\": \"2025-09-17T06:01:51.405726115Z\", \"stream\": {\"organization_id\": \"11eab4a9-75f1-e0a5-8be1-0242ac110016\", \"project_id\": \"11eab4a9-760d-c9f2-adc9-0242ac11000a\", \"topic\": \"hashicorp.platform.audit\"}, \"resource\": null, \"control_plane_event\": {\"request_info\": {\"http_verb\": \"POST\", \"http_path\": \"/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster1/host-alive\", \"http_user_agent\": \"HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (034b138)\", \"http_client_ip\": \"35.155.247.128\"}, \"authentication_info\": {\"principal\": null, \"service_principal_delegation_chain\": []}, \"authorization_info\": [], \"metadata\": {\"cluster_id\": \"vault-cluster1\"}, \"operation_info\": {\"operation_id\": \"\"}, \"description\": \"Host Manager Alive Requested\", \"action\": \"CREATE\", \"status_code\": \"OK\"}, \"subject\": null}, {\"id\": \"028b8b4e-1191-4a10-8db6-c0dcdef29232\", \"timestamp\": \"2025-09-16T21:11:17.528232541Z\", \"stream\": {\"organization_id\": \"11eab4a9-75f1-e0a5-8be1-0242ac110016\", \"project_id\": \"\", \"topic\": \"hashicorp.platform.audit\"}, \"resource\": null, \"control_plane_event\": {\"request_info\": {\"http_verb\": \"GET\", \"http_path\": \"/consent/complete\", \"http_user_agent\": \"\", \"http_client_ip\": \"\"}, \"authentication_info\": {\"principal\": {\"id\": \"8447b58b-ba1d-4bad-8a8f-73b08e83d53a\", \"type\": \"PRINCIPAL_TYPE_USER\", \"user\": {\"id\": \"8447b58b-ba1d-4bad-8a8f-73b08e83d53a\", \"email\": \"shivani.jalan@hashicorp.com\", \"full_name\": \"shivani.jalan@hashicorp.com\", \"identity_type\": \"UNSET\", \"identity_types\": [], \"subject\": \"8447b58b-ba1d-4bad-8a8f-73b08e83d53a\", \"scim_synchronized\": false}, \"group_ids\": []}, \"service_principal_delegation_chain\": []}, \"authorization_info\": [], \"metadata\": {\"email\": \"shivani.jalan@hashicorp.com\", \"event_type\": \"hcp_id_auth_success\", \"ip\": \"73.15.181.24\", \"message\": \"Authenticated successfully\", \"timestamp\": \"2025-09-16 21:11:16 +0000 UTC\", \"user_id\": \"8447b58b-ba1d-4bad-8a8f-73b08e83d53a\"}, \"operation_info\": {\"operation_id\": \"\"}, \"description\": \"Authenticated successfully\", \"action\": \"CREATE\", \"status_code\": \"OK\"}, \"subject\": null}]}, \"next_page_token\": \"eyJ0aW1lc3RhbXAiOiIyMDI1LTA5LTE2VDIxOjExOjE3LjUyODIzMjU0MVoiLCJpZCI6IjAyOGI4YjRlLTExOTEtNGExMC04ZGI2LWMwZGNkZWYyOTIzMiIsIm9mZnNldCI6MX0=\"}"}], "isError": false}, "id": 6}
2025-10-11 11:00:58,979 - mcp_server - INFO - Client call: {"method": "tools/call", "params": {"name": "search_logs", "arguments": {"organization_id": "11eab4a9-75f1-e0a5-8be1-0242ac110016", "end_time": "15 days ago", "topic": "hashicorp.platform.audit", "start_time": "20 days ago"}}, "jsonrpc": "2.0", "id": 7}
2025-10-11 11:01:04,728 - mcp_server - ERROR - An unexpected error occurred: 
Traceback (most recent call last):
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpx/_transports/default.py", line 101, in map_httpcore_exceptions
    yield
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpx/_transports/default.py", line 394, in handle_async_request
    resp = await self._pool.handle_async_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpcore/_async/connection_pool.py", line 256, in handle_async_request
    raise exc from None
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpcore/_async/connection_pool.py", line 236, in handle_async_request
    response = await connection.handle_async_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpcore/_async/connection.py", line 103, in handle_async_request
    return await self._connection.handle_async_request(request)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpcore/_async/http11.py", line 136, in handle_async_request
    raise exc
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpcore/_async/http11.py", line 106, in handle_async_request
    ) = await self._receive_response_headers(**kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpcore/_async/http11.py", line 177, in _receive_response_headers
    event = await self._receive_event(timeout=timeout)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpcore/_async/http11.py", line 217, in _receive_event
    data = await self._network_stream.read(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpcore/_backends/anyio.py", line 32, in read
    with map_exceptions(exc_map):
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/contextlib.py", line 158, in __exit__
    self.gen.throw(value)
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ReadTimeout

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/tpowell/Documents/workspace/hcp_mcp_server/main.py", line 174, in process_mcp_request
    result = await TOOL_MAP[tool_name](**arguments)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/Documents/workspace/hcp_mcp_server/hcp/audit_logs.py", line 82, in search_logs
    response = await client.post(
               ^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpx/_client.py", line 1859, in post
    return await self.request(
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpx/_client.py", line 1540, in request
    return await self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpx/_client.py", line 1629, in send
    response = await self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpx/_client.py", line 1657, in _send_handling_auth
    response = await self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpx/_client.py", line 1694, in _send_handling_redirects
    response = await self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpx/_client.py", line 1730, in _send_single_request
    response = await transport.handle_async_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpx/_transports/default.py", line 393, in handle_async_request
    with map_httpcore_exceptions():
         ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/contextlib.py", line 158, in __exit__
    self.gen.throw(value)
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpx/_transports/default.py", line 118, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ReadTimeout
2025-10-11 11:01:04,730 - mcp_server - INFO - Request data: stdio_main: {'jsonrpc': '2.0', 'error': {'code': -32000, 'message': 'Server error', 'data': 'An unexpected error occurred. See logs for details.'}, 'id': 7}
2025-10-11 11:01:04,730 - mcp_server - INFO - Request data: stdio_main json: {"jsonrpc": "2.0", "error": {"code": -32000, "message": "Server error", "data": "An unexpected error occurred. See logs for details."}, "id": 7}
2025-10-11 11:01:04,730 - mcp_server - INFO - Client call: {"method": "tools/call", "params": {"name": "search_logs", "arguments": {"topic": "hashicorp.platform.audit", "start_time": "15 days ago", "organization_id": "11eab4a9-75f1-e0a5-8be1-0242ac110016", "end_time": "10 days ago"}}, "jsonrpc": "2.0", "id": 8}
2025-10-11 11:01:08,913 - mcp_server - INFO - Tool request data: {'streams': {'entries': [{'id': 'f5a3989f-07ed-4037-8c83-13504e8d5938', 'timestamp': '2025-10-01T06:31:53.700139815Z', 'stream': {'organization_id': '11eab4a9-75f1-e0a5-8be1-0242ac110016', 'project_id': '11eab4a9-760d-c9f2-adc9-0242ac11000a', 'topic': 'hashicorp.platform.audit'}, 'resource': None, 'control_plane_event': {'request_info': {'http_verb': 'POST', 'http_path': '/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster-4/host-alive', 'http_user_agent': 'HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (22b34cd)', 'http_client_ip': '54.148.17.23'}, 'authentication_info': {'principal': None, 'service_principal_delegation_chain': []}, 'authorization_info': [], 'metadata': {'cluster_id': 'vault-cluster-4'}, 'operation_info': {'operation_id': ''}, 'description': 'Host Manager Alive Requested', 'action': 'CREATE', 'status_code': 'OK'}, 'subject': None}, {'id': '35c042cb-86bf-4eb7-baf1-2608819e0f74', 'timestamp': '2025-10-01T01:02:03.522078714Z', 'stream': {'organization_id': '11eab4a9-75f1-e0a5-8be1-0242ac110016', 'project_id': '11eab4a9-760d-c9f2-adc9-0242ac11000a', 'topic': 'hashicorp.platform.audit'}, 'resource': None, 'control_plane_event': {'request_info': {'http_verb': '', 'http_path': '', 'http_user_agent': '', 'http_client_ip': ''}, 'authentication_info': {'principal': None, 'service_principal_delegation_chain': []}, 'authorization_info': [], 'metadata': {'cluster_id': 'vault-cluster'}, 'operation_info': {'operation_id': ''}, 'description': 'Update Version Requested', 'action': 'CREATE', 'status_code': 'OK'}, 'subject': None}, {'id': 'a4a90561-b92f-43f4-b148-76693bce2359', 'timestamp': '2025-10-01T00:51:55.918178924Z', 'stream': {'organization_id': '11eab4a9-75f1-e0a5-8be1-0242ac110016', 'project_id': '11eab4a9-760d-c9f2-adc9-0242ac11000a', 'topic': 'hashicorp.platform.audit'}, 'resource': None, 'control_plane_event': {'request_info': {'http_verb': 'POST', 'http_path': '/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive', 'http_user_agent': 'HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (0c3d674)', 'http_client_ip': '54.202.162.249'}, 'authentication_info': {'principal': None, 'service_principal_delegation_chain': []}, 'authorization_info': [], 'metadata': {'cluster_id': 'vault-cluster'}, 'operation_info': {'operation_id': ''}, 'description': 'Host Manager Alive Requested', 'action': 'CREATE', 'status_code': 'OK'}, 'subject': None}, {'id': 'c732f3c2-373d-4490-bd13-dccca2e7d05b', 'timestamp': '2025-10-01T00:51:52.411580417Z', 'stream': {'organization_id': '11eab4a9-75f1-e0a5-8be1-0242ac110016', 'project_id': '11eab4a9-760d-c9f2-adc9-0242ac11000a', 'topic': 'hashicorp.platform.audit'}, 'resource': None, 'control_plane_event': {'request_info': {'http_verb': 'POST', 'http_path': '/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive', 'http_user_agent': 'HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (0c3d674)', 'http_client_ip': '54.187.230.149'}, 'authentication_info': {'principal': None, 'service_principal_delegation_chain': []}, 'authorization_info': [], 'metadata': {'cluster_id': 'vault-cluster'}, 'operation_info': {'operation_id': ''}, 'description': 'Host Manager Alive Requested', 'action': 'CREATE', 'status_code': 'OK'}, 'subject': None}, {'id': '0ee5cfb9-17f4-4b43-b7a7-f3a2dccb2e8a', 'timestamp': '2025-10-01T00:51:49.085725344Z', 'stream': {'organization_id': '11eab4a9-75f1-e0a5-8be1-0242ac110016', 'project_id': '11eab4a9-760d-c9f2-adc9-0242ac11000a', 'topic': 'hashicorp.platform.audit'}, 'resource': None, 'control_plane_event': {'request_info': {'http_verb': 'POST', 'http_path': '/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive', 'http_user_agent': 'HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (0c3d674)', 'http_client_ip': '18.246.38.3'}, 'authentication_info': {'principal': None, 'service_principal_delegation_chain': []}, 'authorization_info': [], 'metadata': {'cluster_id': 'vault-cluster'}, 'operation_info': {'operation_id': ''}, 'description': 'Host Manager Alive Requested', 'action': 'CREATE', 'status_code': 'OK'}, 'subject': None}, {'id': '278fcc03-73d1-44e3-8b60-d475705c8e64', 'timestamp': '2025-10-01T00:50:02.341187228Z', 'stream': {'organization_id': '11eab4a9-75f1-e0a5-8be1-0242ac110016', 'project_id': '11eab4a9-760d-c9f2-adc9-0242ac11000a', 'topic': 'hashicorp.platform.audit'}, 'resource': None, 'control_plane_event': {'request_info': {'http_verb': '', 'http_path': '', 'http_user_agent': '', 'http_client_ip': ''}, 'authentication_info': {'principal': None, 'service_principal_delegation_chain': []}, 'authorization_info': [], 'metadata': {'cluster_id': 'vault-cluster'}, 'operation_info': {'operation_id': ''}, 'description': 'Update Version Requested', 'action': 'CREATE', 'status_code': 'OK'}, 'subject': None}, {'id': 'c3ba1e6d-12fd-4d40-9bbe-5e14e47491c0', 'timestamp': '2025-09-30T08:57:11.278996137Z', 'stream': {'organization_id': '11eab4a9-75f1-e0a5-8be1-0242ac110016', 'project_id': '11eab4a9-760d-c9f2-adc9-0242ac11000a', 'topic': 'hashicorp.platform.audit'}, 'resource': None, 'control_plane_event': {'request_info': {'http_verb': 'POST', 'http_path': '/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive', 'http_user_agent': 'HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (786852f)', 'http_client_ip': '18.237.217.15'}, 'authentication_info': {'principal': None, 'service_principal_delegation_chain': []}, 'authorization_info': [], 'metadata': {'cluster_id': 'vault-cluster'}, 'operation_info': {'operation_id': ''}, 'description': 'Host Manager Alive Requested', 'action': 'CREATE', 'status_code': 'OK'}, 'subject': None}, {'id': 'd99ad228-c976-4383-aa55-c6c15e5e5344', 'timestamp': '2025-09-30T08:56:49.602118853Z', 'stream': {'organization_id': '11eab4a9-75f1-e0a5-8be1-0242ac110016', 'project_id': '11eab4a9-760d-c9f2-adc9-0242ac11000a', 'topic': 'hashicorp.platform.audit'}, 'resource': None, 'control_plane_event': {'request_info': {'http_verb': 'POST', 'http_path': '/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive', 'http_user_agent': 'HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (786852f)', 'http_client_ip': '34.219.153.237'}, 'authentication_info': {'principal': None, 'service_principal_delegation_chain': []}, 'authorization_info': [], 'metadata': {'cluster_id': 'vault-cluster'}, 'operation_info': {'operation_id': ''}, 'description': 'Host Manager Alive Requested', 'action': 'CREATE', 'status_code': 'OK'}, 'subject': None}, {'id': '69d1de6d-21be-4f67-bffb-9ae99d09c48f', 'timestamp': '2025-09-30T08:56:47.916811866Z', 'stream': {'organization_id': '11eab4a9-75f1-e0a5-8be1-0242ac110016', 'project_id': '11eab4a9-760d-c9f2-adc9-0242ac11000a', 'topic': 'hashicorp.platform.audit'}, 'resource': None, 'control_plane_event': {'request_info': {'http_verb': 'POST', 'http_path': '/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive', 'http_user_agent': 'HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (786852f)', 'http_client_ip': '35.89.159.22'}, 'authentication_info': {'principal': None, 'service_principal_delegation_chain': []}, 'authorization_info': [], 'metadata': {'cluster_id': 'vault-cluster'}, 'operation_info': {'operation_id': ''}, 'description': 'Host Manager Alive Requested', 'action': 'CREATE', 'status_code': 'OK'}, 'subject': None}, {'id': 'fa909a1b-1407-4491-b423-19a61779a3f7', 'timestamp': '2025-09-29T06:07:59.209043977Z', 'stream': {'organization_id': '11eab4a9-75f1-e0a5-8be1-0242ac110016', 'project_id': '11eab4a9-760d-c9f2-adc9-0242ac11000a', 'topic': 'hashicorp.platform.audit'}, 'resource': None, 'control_plane_event': {'request_info': {'http_verb': 'POST', 'http_path': '/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster1/host-alive', 'http_user_agent': 'HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (55f85f6)', 'http_client_ip': '54.185.243.202'}, 'authentication_info': {'principal': None, 'service_principal_delegation_chain': []}, 'authorization_info': [], 'metadata': {'cluster_id': 'vault-cluster1'}, 'operation_info': {'operation_id': ''}, 'description': 'Host Manager Alive Requested', 'action': 'CREATE', 'status_code': 'OK'}, 'subject': None}, {'id': 'f4cec1d0-b4ca-4941-853a-842dead6f0a4', 'timestamp': '2025-09-29T06:01:54.192522119Z', 'stream': {'organization_id': '11eab4a9-75f1-e0a5-8be1-0242ac110016', 'project_id': '11eab4a9-760d-c9f2-adc9-0242ac11000a', 'topic': 'hashicorp.platform.audit'}, 'resource': None, 'control_plane_event': {'request_info': {'http_verb': 'POST', 'http_path': '/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster1/host-alive', 'http_user_agent': 'HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (55f85f6)', 'http_client_ip': '54.185.243.202'}, 'authentication_info': {'principal': None, 'service_principal_delegation_chain': []}, 'authorization_info': [], 'metadata': {'cluster_id': 'vault-cluster1'}, 'operation_info': {'operation_id': ''}, 'description': 'Host Manager Alive Requested', 'action': 'CREATE', 'status_code': 'OK'}, 'subject': None}, {'id': '228f6d49-3c58-4c7b-a462-fc93b95156ae', 'timestamp': '2025-09-27T19:55:02.940894829Z', 'stream': {'organization_id': '11eab4a9-75f1-e0a5-8be1-0242ac110016', 'project_id': '11eab4a9-760d-c9f2-adc9-0242ac11000a', 'topic': 'hashicorp.platform.audit'}, 'resource': None, 'control_plane_event': {'request_info': {'http_verb': '', 'http_path': '', 'http_user_agent': '', 'http_client_ip': ''}, 'authentication_info': {'principal': None, 'service_principal_delegation_chain': []}, 'authorization_info': [], 'metadata': {'cluster_id': 'vault-cluster-4'}, 'operation_info': {'operation_id': ''}, 'description': 'Update Version Requested', 'action': 'CREATE', 'status_code': 'OK'}, 'subject': None}, {'id': 'eb6c7092-bde8-41c1-9296-bbb7873c5b89', 'timestamp': '2025-09-27T19:46:50.292891831Z', 'stream': {'organization_id': '11eab4a9-75f1-e0a5-8be1-0242ac110016', 'project_id': '11eab4a9-760d-c9f2-adc9-0242ac11000a', 'topic': 'hashicorp.platform.audit'}, 'resource': None, 'control_plane_event': {'request_info': {'http_verb': 'POST', 'http_path': '/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster-4/host-alive', 'http_user_agent': 'HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (eae88d8)', 'http_client_ip': '44.250.97.34'}, 'authentication_info': {'principal': None, 'service_principal_delegation_chain': []}, 'authorization_info': [], 'metadata': {'cluster_id': 'vault-cluster-4'}, 'operation_info': {'operation_id': ''}, 'description': 'Host Manager Alive Requested', 'action': 'CREATE', 'status_code': 'OK'}, 'subject': None}, {'id': '6bdbc058-c366-4137-91c0-94ce808a2e3e', 'timestamp': '2025-09-27T19:45:03.478604787Z', 'stream': {'organization_id': '11eab4a9-75f1-e0a5-8be1-0242ac110016', 'project_id': '11eab4a9-760d-c9f2-adc9-0242ac11000a', 'topic': 'hashicorp.platform.audit'}, 'resource': None, 'control_plane_event': {'request_info': {'http_verb': '', 'http_path': '', 'http_user_agent': '', 'http_client_ip': ''}, 'authentication_info': {'principal': None, 'service_principal_delegation_chain': []}, 'authorization_info': [], 'metadata': {'cluster_id': 'vault-cluster-4'}, 'operation_info': {'operation_id': ''}, 'description': 'Update Version Requested', 'action': 'CREATE', 'status_code': 'OK'}, 'subject': None}, {'id': '9a98d6f5-f0e3-4b51-800a-616501eebd19', 'timestamp': '2025-09-27T08:56:48.480192075Z', 'stream': {'organization_id': '11eab4a9-75f1-e0a5-8be1-0242ac110016', 'project_id': '11eab4a9-760d-c9f2-adc9-0242ac11000a', 'topic': 'hashicorp.platform.audit'}, 'resource': None, 'control_plane_event': {'request_info': {'http_verb': 'POST', 'http_path': '/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive', 'http_user_agent': 'HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (eae88d8)', 'http_client_ip': '34.220.47.235'}, 'authentication_info': {'principal': None, 'service_principal_delegation_chain': []}, 'authorization_info': [], 'metadata': {'cluster_id': 'vault-cluster'}, 'operation_info': {'operation_id': ''}, 'description': 'Host Manager Alive Requested', 'action': 'CREATE', 'status_code': 'OK'}, 'subject': None}, {'id': 'd350875b-acfa-4104-a972-4de7bfb5c960', 'timestamp': '2025-09-27T08:56:46.472484511Z', 'stream': {'organization_id': '11eab4a9-75f1-e0a5-8be1-0242ac110016', 'project_id': '11eab4a9-760d-c9f2-adc9-0242ac11000a', 'topic': 'hashicorp.platform.audit'}, 'resource': None, 'control_plane_event': {'request_info': {'http_verb': 'POST', 'http_path': '/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive', 'http_user_agent': 'HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (eae88d8)', 'http_client_ip': '52.27.99.16'}, 'authentication_info': {'principal': None, 'service_principal_delegation_chain': []}, 'authorization_info': [], 'metadata': {'cluster_id': 'vault-cluster'}, 'operation_info': {'operation_id': ''}, 'description': 'Host Manager Alive Requested', 'action': 'CREATE', 'status_code': 'OK'}, 'subject': None}, {'id': 'c9c17283-bd07-420b-80b1-4a2fb740cd97', 'timestamp': '2025-09-27T08:56:44.558745866Z', 'stream': {'organization_id': '11eab4a9-75f1-e0a5-8be1-0242ac110016', 'project_id': '11eab4a9-760d-c9f2-adc9-0242ac11000a', 'topic': 'hashicorp.platform.audit'}, 'resource': None, 'control_plane_event': {'request_info': {'http_verb': 'POST', 'http_path': '/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive', 'http_user_agent': 'HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (eae88d8)', 'http_client_ip': '54.191.192.213'}, 'authentication_info': {'principal': None, 'service_principal_delegation_chain': []}, 'authorization_info': [], 'metadata': {'cluster_id': 'vault-cluster'}, 'operation_info': {'operation_id': ''}, 'description': 'Host Manager Alive Requested', 'action': 'CREATE', 'status_code': 'OK'}, 'subject': None}]}, 'next_page_token': 'eyJ0aW1lc3RhbXAiOiIyMDI1LTA5LTI3VDA4OjU2OjQ0LjU1ODc0NTg2NloiLCJpZCI6ImM5YzE3MjgzLWJkMDctNDIwYi04MGIxLTRhMmZiNzQwY2Q5NyIsIm9mZnNldCI6MX0='}
2025-10-11 11:01:08,914 - mcp_server - INFO - Request data: stdio_main: {'jsonrpc': '2.0', 'result': {'content': [{'type': 'text', 'text': '{"streams": {"entries": [{"id": "f5a3989f-07ed-4037-8c83-13504e8d5938", "timestamp": "2025-10-01T06:31:53.700139815Z", "stream": {"organization_id": "11eab4a9-75f1-e0a5-8be1-0242ac110016", "project_id": "11eab4a9-760d-c9f2-adc9-0242ac11000a", "topic": "hashicorp.platform.audit"}, "resource": null, "control_plane_event": {"request_info": {"http_verb": "POST", "http_path": "/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster-4/host-alive", "http_user_agent": "HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (22b34cd)", "http_client_ip": "54.148.17.23"}, "authentication_info": {"principal": null, "service_principal_delegation_chain": []}, "authorization_info": [], "metadata": {"cluster_id": "vault-cluster-4"}, "operation_info": {"operation_id": ""}, "description": "Host Manager Alive Requested", "action": "CREATE", "status_code": "OK"}, "subject": null}, {"id": "35c042cb-86bf-4eb7-baf1-2608819e0f74", "timestamp": "2025-10-01T01:02:03.522078714Z", "stream": {"organization_id": "11eab4a9-75f1-e0a5-8be1-0242ac110016", "project_id": "11eab4a9-760d-c9f2-adc9-0242ac11000a", "topic": "hashicorp.platform.audit"}, "resource": null, "control_plane_event": {"request_info": {"http_verb": "", "http_path": "", "http_user_agent": "", "http_client_ip": ""}, "authentication_info": {"principal": null, "service_principal_delegation_chain": []}, "authorization_info": [], "metadata": {"cluster_id": "vault-cluster"}, "operation_info": {"operation_id": ""}, "description": "Update Version Requested", "action": "CREATE", "status_code": "OK"}, "subject": null}, {"id": "a4a90561-b92f-43f4-b148-76693bce2359", "timestamp": "2025-10-01T00:51:55.918178924Z", "stream": {"organization_id": "11eab4a9-75f1-e0a5-8be1-0242ac110016", "project_id": "11eab4a9-760d-c9f2-adc9-0242ac11000a", "topic": "hashicorp.platform.audit"}, "resource": null, "control_plane_event": {"request_info": {"http_verb": "POST", "http_path": "/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive", "http_user_agent": "HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (0c3d674)", "http_client_ip": "54.202.162.249"}, "authentication_info": {"principal": null, "service_principal_delegation_chain": []}, "authorization_info": [], "metadata": {"cluster_id": "vault-cluster"}, "operation_info": {"operation_id": ""}, "description": "Host Manager Alive Requested", "action": "CREATE", "status_code": "OK"}, "subject": null}, {"id": "c732f3c2-373d-4490-bd13-dccca2e7d05b", "timestamp": "2025-10-01T00:51:52.411580417Z", "stream": {"organization_id": "11eab4a9-75f1-e0a5-8be1-0242ac110016", "project_id": "11eab4a9-760d-c9f2-adc9-0242ac11000a", "topic": "hashicorp.platform.audit"}, "resource": null, "control_plane_event": {"request_info": {"http_verb": "POST", "http_path": "/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive", "http_user_agent": "HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (0c3d674)", "http_client_ip": "54.187.230.149"}, "authentication_info": {"principal": null, "service_principal_delegation_chain": []}, "authorization_info": [], "metadata": {"cluster_id": "vault-cluster"}, "operation_info": {"operation_id": ""}, "description": "Host Manager Alive Requested", "action": "CREATE", "status_code": "OK"}, "subject": null}, {"id": "0ee5cfb9-17f4-4b43-b7a7-f3a2dccb2e8a", "timestamp": "2025-10-01T00:51:49.085725344Z", "stream": {"organization_id": "11eab4a9-75f1-e0a5-8be1-0242ac110016", "project_id": "11eab4a9-760d-c9f2-adc9-0242ac11000a", "topic": "hashicorp.platform.audit"}, "resource": null, "control_plane_event": {"request_info": {"http_verb": "POST", "http_path": "/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive", "http_user_agent": "HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (0c3d674)", "http_client_ip": "18.246.38.3"}, "authentication_info": {"principal": null, "service_principal_delegation_chain": []}, "authorization_info": [], "metadata": {"cluster_id": "vault-cluster"}, "operation_info": {"operation_id": ""}, "description": "Host Manager Alive Requested", "action": "CREATE", "status_code": "OK"}, "subject": null}, {"id": "278fcc03-73d1-44e3-8b60-d475705c8e64", "timestamp": "2025-10-01T00:50:02.341187228Z", "stream": {"organization_id": "11eab4a9-75f1-e0a5-8be1-0242ac110016", "project_id": "11eab4a9-760d-c9f2-adc9-0242ac11000a", "topic": "hashicorp.platform.audit"}, "resource": null, "control_plane_event": {"request_info": {"http_verb": "", "http_path": "", "http_user_agent": "", "http_client_ip": ""}, "authentication_info": {"principal": null, "service_principal_delegation_chain": []}, "authorization_info": [], "metadata": {"cluster_id": "vault-cluster"}, "operation_info": {"operation_id": ""}, "description": "Update Version Requested", "action": "CREATE", "status_code": "OK"}, "subject": null}, {"id": "c3ba1e6d-12fd-4d40-9bbe-5e14e47491c0", "timestamp": "2025-09-30T08:57:11.278996137Z", "stream": {"organization_id": "11eab4a9-75f1-e0a5-8be1-0242ac110016", "project_id": "11eab4a9-760d-c9f2-adc9-0242ac11000a", "topic": "hashicorp.platform.audit"}, "resource": null, "control_plane_event": {"request_info": {"http_verb": "POST", "http_path": "/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive", "http_user_agent": "HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (786852f)", "http_client_ip": "18.237.217.15"}, "authentication_info": {"principal": null, "service_principal_delegation_chain": []}, "authorization_info": [], "metadata": {"cluster_id": "vault-cluster"}, "operation_info": {"operation_id": ""}, "description": "Host Manager Alive Requested", "action": "CREATE", "status_code": "OK"}, "subject": null}, {"id": "d99ad228-c976-4383-aa55-c6c15e5e5344", "timestamp": "2025-09-30T08:56:49.602118853Z", "stream": {"organization_id": "11eab4a9-75f1-e0a5-8be1-0242ac110016", "project_id": "11eab4a9-760d-c9f2-adc9-0242ac11000a", "topic": "hashicorp.platform.audit"}, "resource": null, "control_plane_event": {"request_info": {"http_verb": "POST", "http_path": "/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive", "http_user_agent": "HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (786852f)", "http_client_ip": "34.219.153.237"}, "authentication_info": {"principal": null, "service_principal_delegation_chain": []}, "authorization_info": [], "metadata": {"cluster_id": "vault-cluster"}, "operation_info": {"operation_id": ""}, "description": "Host Manager Alive Requested", "action": "CREATE", "status_code": "OK"}, "subject": null}, {"id": "69d1de6d-21be-4f67-bffb-9ae99d09c48f", "timestamp": "2025-09-30T08:56:47.916811866Z", "stream": {"organization_id": "11eab4a9-75f1-e0a5-8be1-0242ac110016", "project_id": "11eab4a9-760d-c9f2-adc9-0242ac11000a", "topic": "hashicorp.platform.audit"}, "resource": null, "control_plane_event": {"request_info": {"http_verb": "POST", "http_path": "/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive", "http_user_agent": "HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (786852f)", "http_client_ip": "35.89.159.22"}, "authentication_info": {"principal": null, "service_principal_delegation_chain": []}, "authorization_info": [], "metadata": {"cluster_id": "vault-cluster"}, "operation_info": {"operation_id": ""}, "description": "Host Manager Alive Requested", "action": "CREATE", "status_code": "OK"}, "subject": null}, {"id": "fa909a1b-1407-4491-b423-19a61779a3f7", "timestamp": "2025-09-29T06:07:59.209043977Z", "stream": {"organization_id": "11eab4a9-75f1-e0a5-8be1-0242ac110016", "project_id": "11eab4a9-760d-c9f2-adc9-0242ac11000a", "topic": "hashicorp.platform.audit"}, "resource": null, "control_plane_event": {"request_info": {"http_verb": "POST", "http_path": "/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster1/host-alive", "http_user_agent": "HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (55f85f6)", "http_client_ip": "54.185.243.202"}, "authentication_info": {"principal": null, "service_principal_delegation_chain": []}, "authorization_info": [], "metadata": {"cluster_id": "vault-cluster1"}, "operation_info": {"operation_id": ""}, "description": "Host Manager Alive Requested", "action": "CREATE", "status_code": "OK"}, "subject": null}, {"id": "f4cec1d0-b4ca-4941-853a-842dead6f0a4", "timestamp": "2025-09-29T06:01:54.192522119Z", "stream": {"organization_id": "11eab4a9-75f1-e0a5-8be1-0242ac110016", "project_id": "11eab4a9-760d-c9f2-adc9-0242ac11000a", "topic": "hashicorp.platform.audit"}, "resource": null, "control_plane_event": {"request_info": {"http_verb": "POST", "http_path": "/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster1/host-alive", "http_user_agent": "HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (55f85f6)", "http_client_ip": "54.185.243.202"}, "authentication_info": {"principal": null, "service_principal_delegation_chain": []}, "authorization_info": [], "metadata": {"cluster_id": "vault-cluster1"}, "operation_info": {"operation_id": ""}, "description": "Host Manager Alive Requested", "action": "CREATE", "status_code": "OK"}, "subject": null}, {"id": "228f6d49-3c58-4c7b-a462-fc93b95156ae", "timestamp": "2025-09-27T19:55:02.940894829Z", "stream": {"organization_id": "11eab4a9-75f1-e0a5-8be1-0242ac110016", "project_id": "11eab4a9-760d-c9f2-adc9-0242ac11000a", "topic": "hashicorp.platform.audit"}, "resource": null, "control_plane_event": {"request_info": {"http_verb": "", "http_path": "", "http_user_agent": "", "http_client_ip": ""}, "authentication_info": {"principal": null, "service_principal_delegation_chain": []}, "authorization_info": [], "metadata": {"cluster_id": "vault-cluster-4"}, "operation_info": {"operation_id": ""}, "description": "Update Version Requested", "action": "CREATE", "status_code": "OK"}, "subject": null}, {"id": "eb6c7092-bde8-41c1-9296-bbb7873c5b89", "timestamp": "2025-09-27T19:46:50.292891831Z", "stream": {"organization_id": "11eab4a9-75f1-e0a5-8be1-0242ac110016", "project_id": "11eab4a9-760d-c9f2-adc9-0242ac11000a", "topic": "hashicorp.platform.audit"}, "resource": null, "control_plane_event": {"request_info": {"http_verb": "POST", "http_path": "/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster-4/host-alive", "http_user_agent": "HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (eae88d8)", "http_client_ip": "44.250.97.34"}, "authentication_info": {"principal": null, "service_principal_delegation_chain": []}, "authorization_info": [], "metadata": {"cluster_id": "vault-cluster-4"}, "operation_info": {"operation_id": ""}, "description": "Host Manager Alive Requested", "action": "CREATE", "status_code": "OK"}, "subject": null}, {"id": "6bdbc058-c366-4137-91c0-94ce808a2e3e", "timestamp": "2025-09-27T19:45:03.478604787Z", "stream": {"organization_id": "11eab4a9-75f1-e0a5-8be1-0242ac110016", "project_id": "11eab4a9-760d-c9f2-adc9-0242ac11000a", "topic": "hashicorp.platform.audit"}, "resource": null, "control_plane_event": {"request_info": {"http_verb": "", "http_path": "", "http_user_agent": "", "http_client_ip": ""}, "authentication_info": {"principal": null, "service_principal_delegation_chain": []}, "authorization_info": [], "metadata": {"cluster_id": "vault-cluster-4"}, "operation_info": {"operation_id": ""}, "description": "Update Version Requested", "action": "CREATE", "status_code": "OK"}, "subject": null}, {"id": "9a98d6f5-f0e3-4b51-800a-616501eebd19", "timestamp": "2025-09-27T08:56:48.480192075Z", "stream": {"organization_id": "11eab4a9-75f1-e0a5-8be1-0242ac110016", "project_id": "11eab4a9-760d-c9f2-adc9-0242ac11000a", "topic": "hashicorp.platform.audit"}, "resource": null, "control_plane_event": {"request_info": {"http_verb": "POST", "http_path": "/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive", "http_user_agent": "HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (eae88d8)", "http_client_ip": "34.220.47.235"}, "authentication_info": {"principal": null, "service_principal_delegation_chain": []}, "authorization_info": [], "metadata": {"cluster_id": "vault-cluster"}, "operation_info": {"operation_id": ""}, "description": "Host Manager Alive Requested", "action": "CREATE", "status_code": "OK"}, "subject": null}, {"id": "d350875b-acfa-4104-a972-4de7bfb5c960", "timestamp": "2025-09-27T08:56:46.472484511Z", "stream": {"organization_id": "11eab4a9-75f1-e0a5-8be1-0242ac110016", "project_id": "11eab4a9-760d-c9f2-adc9-0242ac11000a", "topic": "hashicorp.platform.audit"}, "resource": null, "control_plane_event": {"request_info": {"http_verb": "POST", "http_path": "/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive", "http_user_agent": "HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (eae88d8)", "http_client_ip": "52.27.99.16"}, "authentication_info": {"principal": null, "service_principal_delegation_chain": []}, "authorization_info": [], "metadata": {"cluster_id": "vault-cluster"}, "operation_info": {"operation_id": ""}, "description": "Host Manager Alive Requested", "action": "CREATE", "status_code": "OK"}, "subject": null}, {"id": "c9c17283-bd07-420b-80b1-4a2fb740cd97", "timestamp": "2025-09-27T08:56:44.558745866Z", "stream": {"organization_id": "11eab4a9-75f1-e0a5-8be1-0242ac110016", "project_id": "11eab4a9-760d-c9f2-adc9-0242ac11000a", "topic": "hashicorp.platform.audit"}, "resource": null, "control_plane_event": {"request_info": {"http_verb": "POST", "http_path": "/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive", "http_user_agent": "HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (eae88d8)", "http_client_ip": "54.191.192.213"}, "authentication_info": {"principal": null, "service_principal_delegation_chain": []}, "authorization_info": [], "metadata": {"cluster_id": "vault-cluster"}, "operation_info": {"operation_id": ""}, "description": "Host Manager Alive Requested", "action": "CREATE", "status_code": "OK"}, "subject": null}]}, "next_page_token": "eyJ0aW1lc3RhbXAiOiIyMDI1LTA5LTI3VDA4OjU2OjQ0LjU1ODc0NTg2NloiLCJpZCI6ImM5YzE3MjgzLWJkMDctNDIwYi04MGIxLTRhMmZiNzQwY2Q5NyIsIm9mZnNldCI6MX0="}'}], 'isError': False}, 'id': 8}
2025-10-11 11:01:08,914 - mcp_server - INFO - Request data: stdio_main json: {"jsonrpc": "2.0", "result": {"content": [{"type": "text", "text": "{\"streams\": {\"entries\": [{\"id\": \"f5a3989f-07ed-4037-8c83-13504e8d5938\", \"timestamp\": \"2025-10-01T06:31:53.700139815Z\", \"stream\": {\"organization_id\": \"11eab4a9-75f1-e0a5-8be1-0242ac110016\", \"project_id\": \"11eab4a9-760d-c9f2-adc9-0242ac11000a\", \"topic\": \"hashicorp.platform.audit\"}, \"resource\": null, \"control_plane_event\": {\"request_info\": {\"http_verb\": \"POST\", \"http_path\": \"/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster-4/host-alive\", \"http_user_agent\": \"HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (22b34cd)\", \"http_client_ip\": \"54.148.17.23\"}, \"authentication_info\": {\"principal\": null, \"service_principal_delegation_chain\": []}, \"authorization_info\": [], \"metadata\": {\"cluster_id\": \"vault-cluster-4\"}, \"operation_info\": {\"operation_id\": \"\"}, \"description\": \"Host Manager Alive Requested\", \"action\": \"CREATE\", \"status_code\": \"OK\"}, \"subject\": null}, {\"id\": \"35c042cb-86bf-4eb7-baf1-2608819e0f74\", \"timestamp\": \"2025-10-01T01:02:03.522078714Z\", \"stream\": {\"organization_id\": \"11eab4a9-75f1-e0a5-8be1-0242ac110016\", \"project_id\": \"11eab4a9-760d-c9f2-adc9-0242ac11000a\", \"topic\": \"hashicorp.platform.audit\"}, \"resource\": null, \"control_plane_event\": {\"request_info\": {\"http_verb\": \"\", \"http_path\": \"\", \"http_user_agent\": \"\", \"http_client_ip\": \"\"}, \"authentication_info\": {\"principal\": null, \"service_principal_delegation_chain\": []}, \"authorization_info\": [], \"metadata\": {\"cluster_id\": \"vault-cluster\"}, \"operation_info\": {\"operation_id\": \"\"}, \"description\": \"Update Version Requested\", \"action\": \"CREATE\", \"status_code\": \"OK\"}, \"subject\": null}, {\"id\": \"a4a90561-b92f-43f4-b148-76693bce2359\", \"timestamp\": \"2025-10-01T00:51:55.918178924Z\", \"stream\": {\"organization_id\": \"11eab4a9-75f1-e0a5-8be1-0242ac110016\", \"project_id\": \"11eab4a9-760d-c9f2-adc9-0242ac11000a\", \"topic\": \"hashicorp.platform.audit\"}, \"resource\": null, \"control_plane_event\": {\"request_info\": {\"http_verb\": \"POST\", \"http_path\": \"/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive\", \"http_user_agent\": \"HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (0c3d674)\", \"http_client_ip\": \"54.202.162.249\"}, \"authentication_info\": {\"principal\": null, \"service_principal_delegation_chain\": []}, \"authorization_info\": [], \"metadata\": {\"cluster_id\": \"vault-cluster\"}, \"operation_info\": {\"operation_id\": \"\"}, \"description\": \"Host Manager Alive Requested\", \"action\": \"CREATE\", \"status_code\": \"OK\"}, \"subject\": null}, {\"id\": \"c732f3c2-373d-4490-bd13-dccca2e7d05b\", \"timestamp\": \"2025-10-01T00:51:52.411580417Z\", \"stream\": {\"organization_id\": \"11eab4a9-75f1-e0a5-8be1-0242ac110016\", \"project_id\": \"11eab4a9-760d-c9f2-adc9-0242ac11000a\", \"topic\": \"hashicorp.platform.audit\"}, \"resource\": null, \"control_plane_event\": {\"request_info\": {\"http_verb\": \"POST\", \"http_path\": \"/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive\", \"http_user_agent\": \"HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (0c3d674)\", \"http_client_ip\": \"54.187.230.149\"}, \"authentication_info\": {\"principal\": null, \"service_principal_delegation_chain\": []}, \"authorization_info\": [], \"metadata\": {\"cluster_id\": \"vault-cluster\"}, \"operation_info\": {\"operation_id\": \"\"}, \"description\": \"Host Manager Alive Requested\", \"action\": \"CREATE\", \"status_code\": \"OK\"}, \"subject\": null}, {\"id\": \"0ee5cfb9-17f4-4b43-b7a7-f3a2dccb2e8a\", \"timestamp\": \"2025-10-01T00:51:49.085725344Z\", \"stream\": {\"organization_id\": \"11eab4a9-75f1-e0a5-8be1-0242ac110016\", \"project_id\": \"11eab4a9-760d-c9f2-adc9-0242ac11000a\", \"topic\": \"hashicorp.platform.audit\"}, \"resource\": null, \"control_plane_event\": {\"request_info\": {\"http_verb\": \"POST\", \"http_path\": \"/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive\", \"http_user_agent\": \"HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (0c3d674)\", \"http_client_ip\": \"18.246.38.3\"}, \"authentication_info\": {\"principal\": null, \"service_principal_delegation_chain\": []}, \"authorization_info\": [], \"metadata\": {\"cluster_id\": \"vault-cluster\"}, \"operation_info\": {\"operation_id\": \"\"}, \"description\": \"Host Manager Alive Requested\", \"action\": \"CREATE\", \"status_code\": \"OK\"}, \"subject\": null}, {\"id\": \"278fcc03-73d1-44e3-8b60-d475705c8e64\", \"timestamp\": \"2025-10-01T00:50:02.341187228Z\", \"stream\": {\"organization_id\": \"11eab4a9-75f1-e0a5-8be1-0242ac110016\", \"project_id\": \"11eab4a9-760d-c9f2-adc9-0242ac11000a\", \"topic\": \"hashicorp.platform.audit\"}, \"resource\": null, \"control_plane_event\": {\"request_info\": {\"http_verb\": \"\", \"http_path\": \"\", \"http_user_agent\": \"\", \"http_client_ip\": \"\"}, \"authentication_info\": {\"principal\": null, \"service_principal_delegation_chain\": []}, \"authorization_info\": [], \"metadata\": {\"cluster_id\": \"vault-cluster\"}, \"operation_info\": {\"operation_id\": \"\"}, \"description\": \"Update Version Requested\", \"action\": \"CREATE\", \"status_code\": \"OK\"}, \"subject\": null}, {\"id\": \"c3ba1e6d-12fd-4d40-9bbe-5e14e47491c0\", \"timestamp\": \"2025-09-30T08:57:11.278996137Z\", \"stream\": {\"organization_id\": \"11eab4a9-75f1-e0a5-8be1-0242ac110016\", \"project_id\": \"11eab4a9-760d-c9f2-adc9-0242ac11000a\", \"topic\": \"hashicorp.platform.audit\"}, \"resource\": null, \"control_plane_event\": {\"request_info\": {\"http_verb\": \"POST\", \"http_path\": \"/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive\", \"http_user_agent\": \"HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (786852f)\", \"http_client_ip\": \"18.237.217.15\"}, \"authentication_info\": {\"principal\": null, \"service_principal_delegation_chain\": []}, \"authorization_info\": [], \"metadata\": {\"cluster_id\": \"vault-cluster\"}, \"operation_info\": {\"operation_id\": \"\"}, \"description\": \"Host Manager Alive Requested\", \"action\": \"CREATE\", \"status_code\": \"OK\"}, \"subject\": null}, {\"id\": \"d99ad228-c976-4383-aa55-c6c15e5e5344\", \"timestamp\": \"2025-09-30T08:56:49.602118853Z\", \"stream\": {\"organization_id\": \"11eab4a9-75f1-e0a5-8be1-0242ac110016\", \"project_id\": \"11eab4a9-760d-c9f2-adc9-0242ac11000a\", \"topic\": \"hashicorp.platform.audit\"}, \"resource\": null, \"control_plane_event\": {\"request_info\": {\"http_verb\": \"POST\", \"http_path\": \"/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive\", \"http_user_agent\": \"HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (786852f)\", \"http_client_ip\": \"34.219.153.237\"}, \"authentication_info\": {\"principal\": null, \"service_principal_delegation_chain\": []}, \"authorization_info\": [], \"metadata\": {\"cluster_id\": \"vault-cluster\"}, \"operation_info\": {\"operation_id\": \"\"}, \"description\": \"Host Manager Alive Requested\", \"action\": \"CREATE\", \"status_code\": \"OK\"}, \"subject\": null}, {\"id\": \"69d1de6d-21be-4f67-bffb-9ae99d09c48f\", \"timestamp\": \"2025-09-30T08:56:47.916811866Z\", \"stream\": {\"organization_id\": \"11eab4a9-75f1-e0a5-8be1-0242ac110016\", \"project_id\": \"11eab4a9-760d-c9f2-adc9-0242ac11000a\", \"topic\": \"hashicorp.platform.audit\"}, \"resource\": null, \"control_plane_event\": {\"request_info\": {\"http_verb\": \"POST\", \"http_path\": \"/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive\", \"http_user_agent\": \"HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (786852f)\", \"http_client_ip\": \"35.89.159.22\"}, \"authentication_info\": {\"principal\": null, \"service_principal_delegation_chain\": []}, \"authorization_info\": [], \"metadata\": {\"cluster_id\": \"vault-cluster\"}, \"operation_info\": {\"operation_id\": \"\"}, \"description\": \"Host Manager Alive Requested\", \"action\": \"CREATE\", \"status_code\": \"OK\"}, \"subject\": null}, {\"id\": \"fa909a1b-1407-4491-b423-19a61779a3f7\", \"timestamp\": \"2025-09-29T06:07:59.209043977Z\", \"stream\": {\"organization_id\": \"11eab4a9-75f1-e0a5-8be1-0242ac110016\", \"project_id\": \"11eab4a9-760d-c9f2-adc9-0242ac11000a\", \"topic\": \"hashicorp.platform.audit\"}, \"resource\": null, \"control_plane_event\": {\"request_info\": {\"http_verb\": \"POST\", \"http_path\": \"/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster1/host-alive\", \"http_user_agent\": \"HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (55f85f6)\", \"http_client_ip\": \"54.185.243.202\"}, \"authentication_info\": {\"principal\": null, \"service_principal_delegation_chain\": []}, \"authorization_info\": [], \"metadata\": {\"cluster_id\": \"vault-cluster1\"}, \"operation_info\": {\"operation_id\": \"\"}, \"description\": \"Host Manager Alive Requested\", \"action\": \"CREATE\", \"status_code\": \"OK\"}, \"subject\": null}, {\"id\": \"f4cec1d0-b4ca-4941-853a-842dead6f0a4\", \"timestamp\": \"2025-09-29T06:01:54.192522119Z\", \"stream\": {\"organization_id\": \"11eab4a9-75f1-e0a5-8be1-0242ac110016\", \"project_id\": \"11eab4a9-760d-c9f2-adc9-0242ac11000a\", \"topic\": \"hashicorp.platform.audit\"}, \"resource\": null, \"control_plane_event\": {\"request_info\": {\"http_verb\": \"POST\", \"http_path\": \"/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster1/host-alive\", \"http_user_agent\": \"HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (55f85f6)\", \"http_client_ip\": \"54.185.243.202\"}, \"authentication_info\": {\"principal\": null, \"service_principal_delegation_chain\": []}, \"authorization_info\": [], \"metadata\": {\"cluster_id\": \"vault-cluster1\"}, \"operation_info\": {\"operation_id\": \"\"}, \"description\": \"Host Manager Alive Requested\", \"action\": \"CREATE\", \"status_code\": \"OK\"}, \"subject\": null}, {\"id\": \"228f6d49-3c58-4c7b-a462-fc93b95156ae\", \"timestamp\": \"2025-09-27T19:55:02.940894829Z\", \"stream\": {\"organization_id\": \"11eab4a9-75f1-e0a5-8be1-0242ac110016\", \"project_id\": \"11eab4a9-760d-c9f2-adc9-0242ac11000a\", \"topic\": \"hashicorp.platform.audit\"}, \"resource\": null, \"control_plane_event\": {\"request_info\": {\"http_verb\": \"\", \"http_path\": \"\", \"http_user_agent\": \"\", \"http_client_ip\": \"\"}, \"authentication_info\": {\"principal\": null, \"service_principal_delegation_chain\": []}, \"authorization_info\": [], \"metadata\": {\"cluster_id\": \"vault-cluster-4\"}, \"operation_info\": {\"operation_id\": \"\"}, \"description\": \"Update Version Requested\", \"action\": \"CREATE\", \"status_code\": \"OK\"}, \"subject\": null}, {\"id\": \"eb6c7092-bde8-41c1-9296-bbb7873c5b89\", \"timestamp\": \"2025-09-27T19:46:50.292891831Z\", \"stream\": {\"organization_id\": \"11eab4a9-75f1-e0a5-8be1-0242ac110016\", \"project_id\": \"11eab4a9-760d-c9f2-adc9-0242ac11000a\", \"topic\": \"hashicorp.platform.audit\"}, \"resource\": null, \"control_plane_event\": {\"request_info\": {\"http_verb\": \"POST\", \"http_path\": \"/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster-4/host-alive\", \"http_user_agent\": \"HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (eae88d8)\", \"http_client_ip\": \"44.250.97.34\"}, \"authentication_info\": {\"principal\": null, \"service_principal_delegation_chain\": []}, \"authorization_info\": [], \"metadata\": {\"cluster_id\": \"vault-cluster-4\"}, \"operation_info\": {\"operation_id\": \"\"}, \"description\": \"Host Manager Alive Requested\", \"action\": \"CREATE\", \"status_code\": \"OK\"}, \"subject\": null}, {\"id\": \"6bdbc058-c366-4137-91c0-94ce808a2e3e\", \"timestamp\": \"2025-09-27T19:45:03.478604787Z\", \"stream\": {\"organization_id\": \"11eab4a9-75f1-e0a5-8be1-0242ac110016\", \"project_id\": \"11eab4a9-760d-c9f2-adc9-0242ac11000a\", \"topic\": \"hashicorp.platform.audit\"}, \"resource\": null, \"control_plane_event\": {\"request_info\": {\"http_verb\": \"\", \"http_path\": \"\", \"http_user_agent\": \"\", \"http_client_ip\": \"\"}, \"authentication_info\": {\"principal\": null, \"service_principal_delegation_chain\": []}, \"authorization_info\": [], \"metadata\": {\"cluster_id\": \"vault-cluster-4\"}, \"operation_info\": {\"operation_id\": \"\"}, \"description\": \"Update Version Requested\", \"action\": \"CREATE\", \"status_code\": \"OK\"}, \"subject\": null}, {\"id\": \"9a98d6f5-f0e3-4b51-800a-616501eebd19\", \"timestamp\": \"2025-09-27T08:56:48.480192075Z\", \"stream\": {\"organization_id\": \"11eab4a9-75f1-e0a5-8be1-0242ac110016\", \"project_id\": \"11eab4a9-760d-c9f2-adc9-0242ac11000a\", \"topic\": \"hashicorp.platform.audit\"}, \"resource\": null, \"control_plane_event\": {\"request_info\": {\"http_verb\": \"POST\", \"http_path\": \"/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive\", \"http_user_agent\": \"HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (eae88d8)\", \"http_client_ip\": \"34.220.47.235\"}, \"authentication_info\": {\"principal\": null, \"service_principal_delegation_chain\": []}, \"authorization_info\": [], \"metadata\": {\"cluster_id\": \"vault-cluster\"}, \"operation_info\": {\"operation_id\": \"\"}, \"description\": \"Host Manager Alive Requested\", \"action\": \"CREATE\", \"status_code\": \"OK\"}, \"subject\": null}, {\"id\": \"d350875b-acfa-4104-a972-4de7bfb5c960\", \"timestamp\": \"2025-09-27T08:56:46.472484511Z\", \"stream\": {\"organization_id\": \"11eab4a9-75f1-e0a5-8be1-0242ac110016\", \"project_id\": \"11eab4a9-760d-c9f2-adc9-0242ac11000a\", \"topic\": \"hashicorp.platform.audit\"}, \"resource\": null, \"control_plane_event\": {\"request_info\": {\"http_verb\": \"POST\", \"http_path\": \"/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive\", \"http_user_agent\": \"HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (eae88d8)\", \"http_client_ip\": \"52.27.99.16\"}, \"authentication_info\": {\"principal\": null, \"service_principal_delegation_chain\": []}, \"authorization_info\": [], \"metadata\": {\"cluster_id\": \"vault-cluster\"}, \"operation_info\": {\"operation_id\": \"\"}, \"description\": \"Host Manager Alive Requested\", \"action\": \"CREATE\", \"status_code\": \"OK\"}, \"subject\": null}, {\"id\": \"c9c17283-bd07-420b-80b1-4a2fb740cd97\", \"timestamp\": \"2025-09-27T08:56:44.558745866Z\", \"stream\": {\"organization_id\": \"11eab4a9-75f1-e0a5-8be1-0242ac110016\", \"project_id\": \"11eab4a9-760d-c9f2-adc9-0242ac11000a\", \"topic\": \"hashicorp.platform.audit\"}, \"resource\": null, \"control_plane_event\": {\"request_info\": {\"http_verb\": \"POST\", \"http_path\": \"/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive\", \"http_user_agent\": \"HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (eae88d8)\", \"http_client_ip\": \"54.191.192.213\"}, \"authentication_info\": {\"principal\": null, \"service_principal_delegation_chain\": []}, \"authorization_info\": [], \"metadata\": {\"cluster_id\": \"vault-cluster\"}, \"operation_info\": {\"operation_id\": \"\"}, \"description\": \"Host Manager Alive Requested\", \"action\": \"CREATE\", \"status_code\": \"OK\"}, \"subject\": null}]}, \"next_page_token\": \"eyJ0aW1lc3RhbXAiOiIyMDI1LTA5LTI3VDA4OjU2OjQ0LjU1ODc0NTg2NloiLCJpZCI6ImM5YzE3MjgzLWJkMDctNDIwYi04MGIxLTRhMmZiNzQwY2Q5NyIsIm9mZnNldCI6MX0=\"}"}], "isError": false}, "id": 8}
2025-10-11 11:01:08,914 - mcp_server - INFO - Client call: {"method": "tools/call", "params": {"name": "search_logs", "arguments": {"end_time": "5 days ago", "organization_id": "11eab4a9-75f1-e0a5-8be1-0242ac110016", "start_time": "10 days ago", "topic": "hashicorp.platform.audit"}}, "jsonrpc": "2.0", "id": 9}
2025-10-11 11:01:11,955 - mcp_server - INFO - Tool request data: {'streams': {'entries': [{'id': 'a92d7f8b-7215-4786-9cf5-4bb202aff413', 'timestamp': '2025-10-05T06:02:20.403589332Z', 'stream': {'organization_id': '11eab4a9-75f1-e0a5-8be1-0242ac110016', 'project_id': '11eab4a9-760d-c9f2-adc9-0242ac11000a', 'topic': 'hashicorp.platform.audit'}, 'resource': None, 'control_plane_event': {'request_info': {'http_verb': 'POST', 'http_path': '/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster1/host-alive', 'http_user_agent': 'HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (bfea313)', 'http_client_ip': '54.245.73.167'}, 'authentication_info': {'principal': None, 'service_principal_delegation_chain': []}, 'authorization_info': [], 'metadata': {'cluster_id': 'vault-cluster1'}, 'operation_info': {'operation_id': ''}, 'description': 'Host Manager Alive Requested', 'action': 'CREATE', 'status_code': 'OK'}, 'subject': None}, {'id': '083d7195-804b-4a6d-bd0f-d02d6954db8b', 'timestamp': '2025-10-04T08:56:55.980967454Z', 'stream': {'organization_id': '11eab4a9-75f1-e0a5-8be1-0242ac110016', 'project_id': '11eab4a9-760d-c9f2-adc9-0242ac11000a', 'topic': 'hashicorp.platform.audit'}, 'resource': None, 'control_plane_event': {'request_info': {'http_verb': 'POST', 'http_path': '/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive', 'http_user_agent': 'HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (0b39cad)', 'http_client_ip': '34.222.92.60'}, 'authentication_info': {'principal': None, 'service_principal_delegation_chain': []}, 'authorization_info': [], 'metadata': {'cluster_id': 'vault-cluster'}, 'operation_info': {'operation_id': ''}, 'description': 'Host Manager Alive Requested', 'action': 'CREATE', 'status_code': 'OK'}, 'subject': None}, {'id': '28b369ab-f548-42a4-9d90-55f3fa6c4bb3', 'timestamp': '2025-10-04T08:56:48.292359750Z', 'stream': {'organization_id': '11eab4a9-75f1-e0a5-8be1-0242ac110016', 'project_id': '11eab4a9-760d-c9f2-adc9-0242ac11000a', 'topic': 'hashicorp.platform.audit'}, 'resource': None, 'control_plane_event': {'request_info': {'http_verb': 'POST', 'http_path': '/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive', 'http_user_agent': 'HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (0b39cad)', 'http_client_ip': '16.144.32.73'}, 'authentication_info': {'principal': None, 'service_principal_delegation_chain': []}, 'authorization_info': [], 'metadata': {'cluster_id': 'vault-cluster'}, 'operation_info': {'operation_id': ''}, 'description': 'Host Manager Alive Requested', 'action': 'CREATE', 'status_code': 'OK'}, 'subject': None}, {'id': 'e8c3c10a-495e-42de-9bd9-6d7369d08759', 'timestamp': '2025-10-04T08:56:47.412025695Z', 'stream': {'organization_id': '11eab4a9-75f1-e0a5-8be1-0242ac110016', 'project_id': '11eab4a9-760d-c9f2-adc9-0242ac11000a', 'topic': 'hashicorp.platform.audit'}, 'resource': None, 'control_plane_event': {'request_info': {'http_verb': 'POST', 'http_path': '/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive', 'http_user_agent': 'HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (0b39cad)', 'http_client_ip': '18.236.173.238'}, 'authentication_info': {'principal': None, 'service_principal_delegation_chain': []}, 'authorization_info': [], 'metadata': {'cluster_id': 'vault-cluster'}, 'operation_info': {'operation_id': ''}, 'description': 'Host Manager Alive Requested', 'action': 'CREATE', 'status_code': 'OK'}, 'subject': None}, {'id': '6613b21e-3e56-41d1-9631-96d9c7a9654d', 'timestamp': '2025-10-04T06:31:56.092992719Z', 'stream': {'organization_id': '11eab4a9-75f1-e0a5-8be1-0242ac110016', 'project_id': '11eab4a9-760d-c9f2-adc9-0242ac11000a', 'topic': 'hashicorp.platform.audit'}, 'resource': None, 'control_plane_event': {'request_info': {'http_verb': 'POST', 'http_path': '/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster-4/host-alive', 'http_user_agent': 'HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (0b39cad)', 'http_client_ip': '54.218.27.160'}, 'authentication_info': {'principal': None, 'service_principal_delegation_chain': []}, 'authorization_info': [], 'metadata': {'cluster_id': 'vault-cluster-4'}, 'operation_info': {'operation_id': ''}, 'description': 'Host Manager Alive Requested', 'action': 'CREATE', 'status_code': 'OK'}, 'subject': None}, {'id': '4358ff2c-0669-4f4f-8868-7f42e76f261e', 'timestamp': '2025-10-03T18:43:42.006462630Z', 'stream': {'organization_id': '11eab4a9-75f1-e0a5-8be1-0242ac110016', 'project_id': '', 'topic': 'hashicorp.platform.audit'}, 'resource': None, 'control_plane_event': {'request_info': {'http_verb': 'GET', 'http_path': '/consent/complete', 'http_user_agent': '', 'http_client_ip': ''}, 'authentication_info': {'principal': {'id': 'c473b26e-f148-442b-9d2e-fb02a7cb7f5b', 'type': 'PRINCIPAL_TYPE_USER', 'user': {'id': 'c473b26e-f148-442b-9d2e-fb02a7cb7f5b', 'email': 'ijeri.omitogun@hashicorp.com', 'full_name': 'ijeri.omitogun@hashicorp.com', 'identity_type': 'UNSET', 'identity_types': [], 'subject': 'c473b26e-f148-442b-9d2e-fb02a7cb7f5b', 'scim_synchronized': False}, 'group_ids': []}, 'service_principal_delegation_chain': []}, 'authorization_info': [], 'metadata': {'email': 'ijeri.omitogun@hashicorp.com', 'event_type': 'hcp_id_auth_success', 'ip': '99.103.71.229', 'message': 'Authenticated successfully', 'timestamp': '2025-10-03 18:43:41 +0000 UTC', 'user_id': 'c473b26e-f148-442b-9d2e-fb02a7cb7f5b'}, 'operation_info': {'operation_id': ''}, 'description': 'Authenticated successfully', 'action': 'CREATE', 'status_code': 'OK'}, 'subject': None}, {'id': '616abf19-68db-448f-b2da-6a490d0f1ed7', 'timestamp': '2025-10-02T06:01:51.608184892Z', 'stream': {'organization_id': '11eab4a9-75f1-e0a5-8be1-0242ac110016', 'project_id': '11eab4a9-760d-c9f2-adc9-0242ac11000a', 'topic': 'hashicorp.platform.audit'}, 'resource': None, 'control_plane_event': {'request_info': {'http_verb': 'POST', 'http_path': '/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster1/host-alive', 'http_user_agent': 'HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (22b34cd)', 'http_client_ip': '44.250.234.159'}, 'authentication_info': {'principal': None, 'service_principal_delegation_chain': []}, 'authorization_info': [], 'metadata': {'cluster_id': 'vault-cluster1'}, 'operation_info': {'operation_id': ''}, 'description': 'Host Manager Alive Requested', 'action': 'CREATE', 'status_code': 'OK'}, 'subject': None}]}, 'next_page_token': 'eyJ0aW1lc3RhbXAiOiIyMDI1LTEwLTAyVDA2OjAxOjUxLjYwODE4NDg5MloiLCJpZCI6IjYxNmFiZjE5LTY4ZGItNDQ4Zi1iMmRhLTZhNDkwZDBmMWVkNyIsIm9mZnNldCI6MX0='}
2025-10-11 11:01:11,955 - mcp_server - INFO - Request data: stdio_main: {'jsonrpc': '2.0', 'result': {'content': [{'type': 'text', 'text': '{"streams": {"entries": [{"id": "a92d7f8b-7215-4786-9cf5-4bb202aff413", "timestamp": "2025-10-05T06:02:20.403589332Z", "stream": {"organization_id": "11eab4a9-75f1-e0a5-8be1-0242ac110016", "project_id": "11eab4a9-760d-c9f2-adc9-0242ac11000a", "topic": "hashicorp.platform.audit"}, "resource": null, "control_plane_event": {"request_info": {"http_verb": "POST", "http_path": "/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster1/host-alive", "http_user_agent": "HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (bfea313)", "http_client_ip": "54.245.73.167"}, "authentication_info": {"principal": null, "service_principal_delegation_chain": []}, "authorization_info": [], "metadata": {"cluster_id": "vault-cluster1"}, "operation_info": {"operation_id": ""}, "description": "Host Manager Alive Requested", "action": "CREATE", "status_code": "OK"}, "subject": null}, {"id": "083d7195-804b-4a6d-bd0f-d02d6954db8b", "timestamp": "2025-10-04T08:56:55.980967454Z", "stream": {"organization_id": "11eab4a9-75f1-e0a5-8be1-0242ac110016", "project_id": "11eab4a9-760d-c9f2-adc9-0242ac11000a", "topic": "hashicorp.platform.audit"}, "resource": null, "control_plane_event": {"request_info": {"http_verb": "POST", "http_path": "/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive", "http_user_agent": "HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (0b39cad)", "http_client_ip": "34.222.92.60"}, "authentication_info": {"principal": null, "service_principal_delegation_chain": []}, "authorization_info": [], "metadata": {"cluster_id": "vault-cluster"}, "operation_info": {"operation_id": ""}, "description": "Host Manager Alive Requested", "action": "CREATE", "status_code": "OK"}, "subject": null}, {"id": "28b369ab-f548-42a4-9d90-55f3fa6c4bb3", "timestamp": "2025-10-04T08:56:48.292359750Z", "stream": {"organization_id": "11eab4a9-75f1-e0a5-8be1-0242ac110016", "project_id": "11eab4a9-760d-c9f2-adc9-0242ac11000a", "topic": "hashicorp.platform.audit"}, "resource": null, "control_plane_event": {"request_info": {"http_verb": "POST", "http_path": "/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive", "http_user_agent": "HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (0b39cad)", "http_client_ip": "16.144.32.73"}, "authentication_info": {"principal": null, "service_principal_delegation_chain": []}, "authorization_info": [], "metadata": {"cluster_id": "vault-cluster"}, "operation_info": {"operation_id": ""}, "description": "Host Manager Alive Requested", "action": "CREATE", "status_code": "OK"}, "subject": null}, {"id": "e8c3c10a-495e-42de-9bd9-6d7369d08759", "timestamp": "2025-10-04T08:56:47.412025695Z", "stream": {"organization_id": "11eab4a9-75f1-e0a5-8be1-0242ac110016", "project_id": "11eab4a9-760d-c9f2-adc9-0242ac11000a", "topic": "hashicorp.platform.audit"}, "resource": null, "control_plane_event": {"request_info": {"http_verb": "POST", "http_path": "/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive", "http_user_agent": "HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (0b39cad)", "http_client_ip": "18.236.173.238"}, "authentication_info": {"principal": null, "service_principal_delegation_chain": []}, "authorization_info": [], "metadata": {"cluster_id": "vault-cluster"}, "operation_info": {"operation_id": ""}, "description": "Host Manager Alive Requested", "action": "CREATE", "status_code": "OK"}, "subject": null}, {"id": "6613b21e-3e56-41d1-9631-96d9c7a9654d", "timestamp": "2025-10-04T06:31:56.092992719Z", "stream": {"organization_id": "11eab4a9-75f1-e0a5-8be1-0242ac110016", "project_id": "11eab4a9-760d-c9f2-adc9-0242ac11000a", "topic": "hashicorp.platform.audit"}, "resource": null, "control_plane_event": {"request_info": {"http_verb": "POST", "http_path": "/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster-4/host-alive", "http_user_agent": "HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (0b39cad)", "http_client_ip": "54.218.27.160"}, "authentication_info": {"principal": null, "service_principal_delegation_chain": []}, "authorization_info": [], "metadata": {"cluster_id": "vault-cluster-4"}, "operation_info": {"operation_id": ""}, "description": "Host Manager Alive Requested", "action": "CREATE", "status_code": "OK"}, "subject": null}, {"id": "4358ff2c-0669-4f4f-8868-7f42e76f261e", "timestamp": "2025-10-03T18:43:42.006462630Z", "stream": {"organization_id": "11eab4a9-75f1-e0a5-8be1-0242ac110016", "project_id": "", "topic": "hashicorp.platform.audit"}, "resource": null, "control_plane_event": {"request_info": {"http_verb": "GET", "http_path": "/consent/complete", "http_user_agent": "", "http_client_ip": ""}, "authentication_info": {"principal": {"id": "c473b26e-f148-442b-9d2e-fb02a7cb7f5b", "type": "PRINCIPAL_TYPE_USER", "user": {"id": "c473b26e-f148-442b-9d2e-fb02a7cb7f5b", "email": "ijeri.omitogun@hashicorp.com", "full_name": "ijeri.omitogun@hashicorp.com", "identity_type": "UNSET", "identity_types": [], "subject": "c473b26e-f148-442b-9d2e-fb02a7cb7f5b", "scim_synchronized": false}, "group_ids": []}, "service_principal_delegation_chain": []}, "authorization_info": [], "metadata": {"email": "ijeri.omitogun@hashicorp.com", "event_type": "hcp_id_auth_success", "ip": "99.103.71.229", "message": "Authenticated successfully", "timestamp": "2025-10-03 18:43:41 +0000 UTC", "user_id": "c473b26e-f148-442b-9d2e-fb02a7cb7f5b"}, "operation_info": {"operation_id": ""}, "description": "Authenticated successfully", "action": "CREATE", "status_code": "OK"}, "subject": null}, {"id": "616abf19-68db-448f-b2da-6a490d0f1ed7", "timestamp": "2025-10-02T06:01:51.608184892Z", "stream": {"organization_id": "11eab4a9-75f1-e0a5-8be1-0242ac110016", "project_id": "11eab4a9-760d-c9f2-adc9-0242ac11000a", "topic": "hashicorp.platform.audit"}, "resource": null, "control_plane_event": {"request_info": {"http_verb": "POST", "http_path": "/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster1/host-alive", "http_user_agent": "HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (22b34cd)", "http_client_ip": "44.250.234.159"}, "authentication_info": {"principal": null, "service_principal_delegation_chain": []}, "authorization_info": [], "metadata": {"cluster_id": "vault-cluster1"}, "operation_info": {"operation_id": ""}, "description": "Host Manager Alive Requested", "action": "CREATE", "status_code": "OK"}, "subject": null}]}, "next_page_token": "eyJ0aW1lc3RhbXAiOiIyMDI1LTEwLTAyVDA2OjAxOjUxLjYwODE4NDg5MloiLCJpZCI6IjYxNmFiZjE5LTY4ZGItNDQ4Zi1iMmRhLTZhNDkwZDBmMWVkNyIsIm9mZnNldCI6MX0="}'}], 'isError': False}, 'id': 9}
2025-10-11 11:01:11,955 - mcp_server - INFO - Request data: stdio_main json: {"jsonrpc": "2.0", "result": {"content": [{"type": "text", "text": "{\"streams\": {\"entries\": [{\"id\": \"a92d7f8b-7215-4786-9cf5-4bb202aff413\", \"timestamp\": \"2025-10-05T06:02:20.403589332Z\", \"stream\": {\"organization_id\": \"11eab4a9-75f1-e0a5-8be1-0242ac110016\", \"project_id\": \"11eab4a9-760d-c9f2-adc9-0242ac11000a\", \"topic\": \"hashicorp.platform.audit\"}, \"resource\": null, \"control_plane_event\": {\"request_info\": {\"http_verb\": \"POST\", \"http_path\": \"/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster1/host-alive\", \"http_user_agent\": \"HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (bfea313)\", \"http_client_ip\": \"54.245.73.167\"}, \"authentication_info\": {\"principal\": null, \"service_principal_delegation_chain\": []}, \"authorization_info\": [], \"metadata\": {\"cluster_id\": \"vault-cluster1\"}, \"operation_info\": {\"operation_id\": \"\"}, \"description\": \"Host Manager Alive Requested\", \"action\": \"CREATE\", \"status_code\": \"OK\"}, \"subject\": null}, {\"id\": \"083d7195-804b-4a6d-bd0f-d02d6954db8b\", \"timestamp\": \"2025-10-04T08:56:55.980967454Z\", \"stream\": {\"organization_id\": \"11eab4a9-75f1-e0a5-8be1-0242ac110016\", \"project_id\": \"11eab4a9-760d-c9f2-adc9-0242ac11000a\", \"topic\": \"hashicorp.platform.audit\"}, \"resource\": null, \"control_plane_event\": {\"request_info\": {\"http_verb\": \"POST\", \"http_path\": \"/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive\", \"http_user_agent\": \"HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (0b39cad)\", \"http_client_ip\": \"34.222.92.60\"}, \"authentication_info\": {\"principal\": null, \"service_principal_delegation_chain\": []}, \"authorization_info\": [], \"metadata\": {\"cluster_id\": \"vault-cluster\"}, \"operation_info\": {\"operation_id\": \"\"}, \"description\": \"Host Manager Alive Requested\", \"action\": \"CREATE\", \"status_code\": \"OK\"}, \"subject\": null}, {\"id\": \"28b369ab-f548-42a4-9d90-55f3fa6c4bb3\", \"timestamp\": \"2025-10-04T08:56:48.292359750Z\", \"stream\": {\"organization_id\": \"11eab4a9-75f1-e0a5-8be1-0242ac110016\", \"project_id\": \"11eab4a9-760d-c9f2-adc9-0242ac11000a\", \"topic\": \"hashicorp.platform.audit\"}, \"resource\": null, \"control_plane_event\": {\"request_info\": {\"http_verb\": \"POST\", \"http_path\": \"/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive\", \"http_user_agent\": \"HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (0b39cad)\", \"http_client_ip\": \"16.144.32.73\"}, \"authentication_info\": {\"principal\": null, \"service_principal_delegation_chain\": []}, \"authorization_info\": [], \"metadata\": {\"cluster_id\": \"vault-cluster\"}, \"operation_info\": {\"operation_id\": \"\"}, \"description\": \"Host Manager Alive Requested\", \"action\": \"CREATE\", \"status_code\": \"OK\"}, \"subject\": null}, {\"id\": \"e8c3c10a-495e-42de-9bd9-6d7369d08759\", \"timestamp\": \"2025-10-04T08:56:47.412025695Z\", \"stream\": {\"organization_id\": \"11eab4a9-75f1-e0a5-8be1-0242ac110016\", \"project_id\": \"11eab4a9-760d-c9f2-adc9-0242ac11000a\", \"topic\": \"hashicorp.platform.audit\"}, \"resource\": null, \"control_plane_event\": {\"request_info\": {\"http_verb\": \"POST\", \"http_path\": \"/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive\", \"http_user_agent\": \"HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (0b39cad)\", \"http_client_ip\": \"18.236.173.238\"}, \"authentication_info\": {\"principal\": null, \"service_principal_delegation_chain\": []}, \"authorization_info\": [], \"metadata\": {\"cluster_id\": \"vault-cluster\"}, \"operation_info\": {\"operation_id\": \"\"}, \"description\": \"Host Manager Alive Requested\", \"action\": \"CREATE\", \"status_code\": \"OK\"}, \"subject\": null}, {\"id\": \"6613b21e-3e56-41d1-9631-96d9c7a9654d\", \"timestamp\": \"2025-10-04T06:31:56.092992719Z\", \"stream\": {\"organization_id\": \"11eab4a9-75f1-e0a5-8be1-0242ac110016\", \"project_id\": \"11eab4a9-760d-c9f2-adc9-0242ac11000a\", \"topic\": \"hashicorp.platform.audit\"}, \"resource\": null, \"control_plane_event\": {\"request_info\": {\"http_verb\": \"POST\", \"http_path\": \"/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster-4/host-alive\", \"http_user_agent\": \"HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (0b39cad)\", \"http_client_ip\": \"54.218.27.160\"}, \"authentication_info\": {\"principal\": null, \"service_principal_delegation_chain\": []}, \"authorization_info\": [], \"metadata\": {\"cluster_id\": \"vault-cluster-4\"}, \"operation_info\": {\"operation_id\": \"\"}, \"description\": \"Host Manager Alive Requested\", \"action\": \"CREATE\", \"status_code\": \"OK\"}, \"subject\": null}, {\"id\": \"4358ff2c-0669-4f4f-8868-7f42e76f261e\", \"timestamp\": \"2025-10-03T18:43:42.006462630Z\", \"stream\": {\"organization_id\": \"11eab4a9-75f1-e0a5-8be1-0242ac110016\", \"project_id\": \"\", \"topic\": \"hashicorp.platform.audit\"}, \"resource\": null, \"control_plane_event\": {\"request_info\": {\"http_verb\": \"GET\", \"http_path\": \"/consent/complete\", \"http_user_agent\": \"\", \"http_client_ip\": \"\"}, \"authentication_info\": {\"principal\": {\"id\": \"c473b26e-f148-442b-9d2e-fb02a7cb7f5b\", \"type\": \"PRINCIPAL_TYPE_USER\", \"user\": {\"id\": \"c473b26e-f148-442b-9d2e-fb02a7cb7f5b\", \"email\": \"ijeri.omitogun@hashicorp.com\", \"full_name\": \"ijeri.omitogun@hashicorp.com\", \"identity_type\": \"UNSET\", \"identity_types\": [], \"subject\": \"c473b26e-f148-442b-9d2e-fb02a7cb7f5b\", \"scim_synchronized\": false}, \"group_ids\": []}, \"service_principal_delegation_chain\": []}, \"authorization_info\": [], \"metadata\": {\"email\": \"ijeri.omitogun@hashicorp.com\", \"event_type\": \"hcp_id_auth_success\", \"ip\": \"99.103.71.229\", \"message\": \"Authenticated successfully\", \"timestamp\": \"2025-10-03 18:43:41 +0000 UTC\", \"user_id\": \"c473b26e-f148-442b-9d2e-fb02a7cb7f5b\"}, \"operation_info\": {\"operation_id\": \"\"}, \"description\": \"Authenticated successfully\", \"action\": \"CREATE\", \"status_code\": \"OK\"}, \"subject\": null}, {\"id\": \"616abf19-68db-448f-b2da-6a490d0f1ed7\", \"timestamp\": \"2025-10-02T06:01:51.608184892Z\", \"stream\": {\"organization_id\": \"11eab4a9-75f1-e0a5-8be1-0242ac110016\", \"project_id\": \"11eab4a9-760d-c9f2-adc9-0242ac11000a\", \"topic\": \"hashicorp.platform.audit\"}, \"resource\": null, \"control_plane_event\": {\"request_info\": {\"http_verb\": \"POST\", \"http_path\": \"/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster1/host-alive\", \"http_user_agent\": \"HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (22b34cd)\", \"http_client_ip\": \"44.250.234.159\"}, \"authentication_info\": {\"principal\": null, \"service_principal_delegation_chain\": []}, \"authorization_info\": [], \"metadata\": {\"cluster_id\": \"vault-cluster1\"}, \"operation_info\": {\"operation_id\": \"\"}, \"description\": \"Host Manager Alive Requested\", \"action\": \"CREATE\", \"status_code\": \"OK\"}, \"subject\": null}]}, \"next_page_token\": \"eyJ0aW1lc3RhbXAiOiIyMDI1LTEwLTAyVDA2OjAxOjUxLjYwODE4NDg5MloiLCJpZCI6IjYxNmFiZjE5LTY4ZGItNDQ4Zi1iMmRhLTZhNDkwZDBmMWVkNyIsIm9mZnNldCI6MX0=\"}"}], "isError": false}, "id": 9}
2025-10-11 11:01:11,956 - mcp_server - INFO - Client call: {"method": "tools/call", "params": {"name": "search_logs", "arguments": {"start_time": "5 days ago", "topic": "hashicorp.platform.audit", "organization_id": "11eab4a9-75f1-e0a5-8be1-0242ac110016", "end_time": "now"}}, "jsonrpc": "2.0", "id": 10}
2025-10-11 11:01:17,720 - mcp_server - ERROR - An unexpected error occurred: 
Traceback (most recent call last):
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpx/_transports/default.py", line 101, in map_httpcore_exceptions
    yield
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpx/_transports/default.py", line 394, in handle_async_request
    resp = await self._pool.handle_async_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpcore/_async/connection_pool.py", line 256, in handle_async_request
    raise exc from None
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpcore/_async/connection_pool.py", line 236, in handle_async_request
    response = await connection.handle_async_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpcore/_async/connection.py", line 103, in handle_async_request
    return await self._connection.handle_async_request(request)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpcore/_async/http11.py", line 136, in handle_async_request
    raise exc
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpcore/_async/http11.py", line 106, in handle_async_request
    ) = await self._receive_response_headers(**kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpcore/_async/http11.py", line 177, in _receive_response_headers
    event = await self._receive_event(timeout=timeout)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpcore/_async/http11.py", line 217, in _receive_event
    data = await self._network_stream.read(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpcore/_backends/anyio.py", line 32, in read
    with map_exceptions(exc_map):
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/contextlib.py", line 158, in __exit__
    self.gen.throw(value)
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ReadTimeout

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/tpowell/Documents/workspace/hcp_mcp_server/main.py", line 174, in process_mcp_request
    result = await TOOL_MAP[tool_name](**arguments)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/Documents/workspace/hcp_mcp_server/hcp/audit_logs.py", line 82, in search_logs
    response = await client.post(
               ^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpx/_client.py", line 1859, in post
    return await self.request(
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpx/_client.py", line 1540, in request
    return await self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpx/_client.py", line 1629, in send
    response = await self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpx/_client.py", line 1657, in _send_handling_auth
    response = await self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpx/_client.py", line 1694, in _send_handling_redirects
    response = await self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpx/_client.py", line 1730, in _send_single_request
    response = await transport.handle_async_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpx/_transports/default.py", line 393, in handle_async_request
    with map_httpcore_exceptions():
         ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/contextlib.py", line 158, in __exit__
    self.gen.throw(value)
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpx/_transports/default.py", line 118, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ReadTimeout
2025-10-11 11:01:17,724 - mcp_server - INFO - Request data: stdio_main: {'jsonrpc': '2.0', 'error': {'code': -32000, 'message': 'Server error', 'data': 'An unexpected error occurred. See logs for details.'}, 'id': 10}
2025-10-11 11:01:17,724 - mcp_server - INFO - Request data: stdio_main json: {"jsonrpc": "2.0", "error": {"code": -32000, "message": "Server error", "data": "An unexpected error occurred. See logs for details."}, "id": 10}
2025-10-14 10:21:17,152 - mcp_server - INFO - Received request: {"method": "initialize", "params": {"protocolVersion": "2025-06-18", "capabilities": {"roots": {}}, "clientInfo": {"name": "gemini-cli-mcp-client-HCP", "version": "0.0.1"}}, "jsonrpc": "2.0", "id": 0}
2025-10-14 10:21:17,153 - mcp_server - INFO - Request data: stdio_main: {'jsonrpc': '2.0', 'result': {'protocolVersion': '2024-11-05', 'serverInfo': {'name': 'HCP', 'version': '0.0.1'}, 'capabilities': {'tools': {'listChanged': True}, 'prompts': {'listChanged': True}, 'resources': {'listChanged': True}}}, 'id': 0}
2025-10-14 10:21:17,153 - mcp_server - INFO - Request data: stdio_main json: {"jsonrpc": "2.0", "result": {"protocolVersion": "2024-11-05", "serverInfo": {"name": "HCP", "version": "0.0.1"}, "capabilities": {"tools": {"listChanged": true}, "prompts": {"listChanged": true}, "resources": {"listChanged": true}}}, "id": 0}
2025-10-14 10:21:17,153 - mcp_server - INFO - Received request: {"method": "notifications/initialized", "jsonrpc": "2.0"}
2025-10-14 10:21:17,153 - mcp_server - INFO - Client initialized.
2025-10-14 10:21:17,153 - mcp_server - INFO - Received request: {"method": "prompts/list", "params": {}, "jsonrpc": "2.0", "id": 1}
2025-10-14 10:21:17,153 - mcp_server - INFO - Request data: stdio_main: {'jsonrpc': '2.0', 'result': {'prompts': [{'name': 'list_projects', 'title': 'List Projects', 'description': 'Lists all HCP projects for a given organization.', 'arguments': [{'name': 'organization_id', 'description': 'The ID of the organization.', 'required': True}]}, {'name': 'get_project', 'title': 'Get Project', 'description': 'Gets an HCP project by its ID.', 'arguments': [{'name': 'project_id', 'description': 'The ID of the project.', 'required': True}]}, {'name': 'delete_project', 'title': 'Delete Project', 'description': 'Deletes an HCP project by its ID.', 'arguments': [{'name': 'project_id', 'description': 'The ID of the project.', 'required': True}]}, {'name': 'create_project', 'title': 'Create Project', 'description': 'Creates a new HCP project.', 'arguments': [{'name': 'name', 'description': 'The name of the new project.', 'required': True}, {'name': 'organization_id', 'description': 'The ID of the organization.', 'required': True}]}, {'name': 'update_project', 'title': 'Update Project', 'description': 'Updates an HCP project.', 'arguments': [{'name': 'project_id', 'description': 'The ID of the project.', 'required': True}, {'name': 'name', 'description': 'The new name for the project.', 'required': True}, {'name': 'organization_id', 'description': 'The ID of the organization.', 'required': True}]}, {'name': 'get_organization', 'title': 'Get Organization', 'description': 'Gets an HCP organization by its ID.', 'arguments': [{'name': 'organization_id', 'description': 'The ID of the organization.', 'required': True}]}, {'name': 'list_organizations', 'title': 'List Organizations', 'description': 'Lists all HCP organizations.', 'arguments': None}, {'name': 'update_organization', 'title': 'Update Organization', 'description': 'Updates an HCP organization.', 'arguments': [{'name': 'organization_id', 'description': 'The ID of the organization.', 'required': True}, {'name': 'name', 'description': 'The new name for the organization.', 'required': True}]}, {'name': 'list_secrets', 'title': 'List Secrets', 'description': 'Lists all secrets for a given application.', 'arguments': [{'name': 'project_id', 'description': 'The ID of the project.', 'required': True}, {'name': 'app_name', 'description': 'The name of the application.', 'required': True}]}, {'name': 'get_secret', 'title': 'Get Secret', 'description': 'Gets a secret by its name.', 'arguments': [{'name': 'secret_name', 'description': 'The name of the secret.', 'required': True}, {'name': 'project_id', 'description': 'The ID of the project.', 'required': True}, {'name': 'app_name', 'description': 'The name of the application.', 'required': True}]}, {'name': 'delete_secret', 'title': 'Delete Secret', 'description': 'Deletes a secret by its name.', 'arguments': [{'name': 'secret_name', 'description': 'The name of the secret.', 'required': True}, {'name': 'project_id', 'description': 'The ID of the project.', 'required': True}, {'name': 'app_name', 'description': 'The name of the application.', 'required': True}]}, {'name': 'create_secret', 'title': 'Create Secret', 'description': 'Creates a new secret.', 'arguments': [{'name': 'secret_name', 'description': 'The name of the new secret.', 'required': True}, {'name': 'secret_value', 'description': 'The value of the new secret.', 'required': True}, {'name': 'project_id', 'description': 'The ID of the project.', 'required': True}, {'name': 'app_name', 'description': 'The name of the application.', 'required': True}]}, {'name': 'find_project_and_list_secrets', 'title': 'Find Project and List Secrets', 'description': 'Finds a project by name and lists its secrets.', 'arguments': [{'name': 'project_name', 'description': 'The name of the project.', 'required': True}, {'name': 'organization_id', 'description': 'The ID of the organization.', 'required': True}, {'name': 'app_name', 'description': 'The name of the application.', 'required': True}]}, {'name': 'list_resources', 'title': 'List Resources', 'description': 'Lists all resources in a project.', 'arguments': [{'name': 'project_id', 'description': 'The ID of the project.', 'required': True}]}, {'name': 'search_logs', 'title': 'Search Logs', 'description': 'Searches for audit logs in an organization using LogQL. The LLM should determine the best topic to use based on the user\'s query, or default to \'hashicorp.platform.audit\' if the user is not specific. For advanced filtering, use the `query` parameter with LogQL syntax. To filter on specific JSON fields in the log entries, use the `| json` parser in your query. For example: `query=\'| json | control_plane_event_action="CREATE"\'`', 'arguments': [{'name': 'organization_id', 'description': 'The ID of the organization.', 'required': True}, {'name': 'query', 'description': 'The LogQL query string for advanced filtering. Can be combined with `project_id` and `topic`. Example: \'| json | resource_uuid="some-uuid"\'', 'required': False}, {'name': 'project_id', 'description': 'A project ID to filter by.', 'required': False}, {'name': 'topic', 'description': "A log topic to search. Example topics: 'hashicorp.platform.audit', 'hashicorp.packer.registry.audit', 'hashicorp.boundary.cluster.audit', 'hashicorp.consul.cluster.audit'", 'required': True}, {'name': 'start_time', 'description': "The start time for the search. Accepts formats like '24 hours ago', 'yesterday at 5pm', or 'Oct 1, 2025'.", 'required': True}, {'name': 'end_time', 'description': "The end time for the search. Accepts formats like 'now', 'today', or 'Oct 3, 2025'.", 'required': True}]}]}, 'id': 1}
2025-10-14 10:21:17,153 - mcp_server - INFO - Request data: stdio_main json: {"jsonrpc": "2.0", "result": {"prompts": [{"name": "list_projects", "title": "List Projects", "description": "Lists all HCP projects for a given organization.", "arguments": [{"name": "organization_id", "description": "The ID of the organization.", "required": true}]}, {"name": "get_project", "title": "Get Project", "description": "Gets an HCP project by its ID.", "arguments": [{"name": "project_id", "description": "The ID of the project.", "required": true}]}, {"name": "delete_project", "title": "Delete Project", "description": "Deletes an HCP project by its ID.", "arguments": [{"name": "project_id", "description": "The ID of the project.", "required": true}]}, {"name": "create_project", "title": "Create Project", "description": "Creates a new HCP project.", "arguments": [{"name": "name", "description": "The name of the new project.", "required": true}, {"name": "organization_id", "description": "The ID of the organization.", "required": true}]}, {"name": "update_project", "title": "Update Project", "description": "Updates an HCP project.", "arguments": [{"name": "project_id", "description": "The ID of the project.", "required": true}, {"name": "name", "description": "The new name for the project.", "required": true}, {"name": "organization_id", "description": "The ID of the organization.", "required": true}]}, {"name": "get_organization", "title": "Get Organization", "description": "Gets an HCP organization by its ID.", "arguments": [{"name": "organization_id", "description": "The ID of the organization.", "required": true}]}, {"name": "list_organizations", "title": "List Organizations", "description": "Lists all HCP organizations.", "arguments": null}, {"name": "update_organization", "title": "Update Organization", "description": "Updates an HCP organization.", "arguments": [{"name": "organization_id", "description": "The ID of the organization.", "required": true}, {"name": "name", "description": "The new name for the organization.", "required": true}]}, {"name": "list_secrets", "title": "List Secrets", "description": "Lists all secrets for a given application.", "arguments": [{"name": "project_id", "description": "The ID of the project.", "required": true}, {"name": "app_name", "description": "The name of the application.", "required": true}]}, {"name": "get_secret", "title": "Get Secret", "description": "Gets a secret by its name.", "arguments": [{"name": "secret_name", "description": "The name of the secret.", "required": true}, {"name": "project_id", "description": "The ID of the project.", "required": true}, {"name": "app_name", "description": "The name of the application.", "required": true}]}, {"name": "delete_secret", "title": "Delete Secret", "description": "Deletes a secret by its name.", "arguments": [{"name": "secret_name", "description": "The name of the secret.", "required": true}, {"name": "project_id", "description": "The ID of the project.", "required": true}, {"name": "app_name", "description": "The name of the application.", "required": true}]}, {"name": "create_secret", "title": "Create Secret", "description": "Creates a new secret.", "arguments": [{"name": "secret_name", "description": "The name of the new secret.", "required": true}, {"name": "secret_value", "description": "The value of the new secret.", "required": true}, {"name": "project_id", "description": "The ID of the project.", "required": true}, {"name": "app_name", "description": "The name of the application.", "required": true}]}, {"name": "find_project_and_list_secrets", "title": "Find Project and List Secrets", "description": "Finds a project by name and lists its secrets.", "arguments": [{"name": "project_name", "description": "The name of the project.", "required": true}, {"name": "organization_id", "description": "The ID of the organization.", "required": true}, {"name": "app_name", "description": "The name of the application.", "required": true}]}, {"name": "list_resources", "title": "List Resources", "description": "Lists all resources in a project.", "arguments": [{"name": "project_id", "description": "The ID of the project.", "required": true}]}, {"name": "search_logs", "title": "Search Logs", "description": "Searches for audit logs in an organization using LogQL. The LLM should determine the best topic to use based on the user's query, or default to 'hashicorp.platform.audit' if the user is not specific. For advanced filtering, use the `query` parameter with LogQL syntax. To filter on specific JSON fields in the log entries, use the `| json` parser in your query. For example: `query='| json | control_plane_event_action=\"CREATE\"'`", "arguments": [{"name": "organization_id", "description": "The ID of the organization.", "required": true}, {"name": "query", "description": "The LogQL query string for advanced filtering. Can be combined with `project_id` and `topic`. Example: '| json | resource_uuid=\"some-uuid\"'", "required": false}, {"name": "project_id", "description": "A project ID to filter by.", "required": false}, {"name": "topic", "description": "A log topic to search. Example topics: 'hashicorp.platform.audit', 'hashicorp.packer.registry.audit', 'hashicorp.boundary.cluster.audit', 'hashicorp.consul.cluster.audit'", "required": true}, {"name": "start_time", "description": "The start time for the search. Accepts formats like '24 hours ago', 'yesterday at 5pm', or 'Oct 1, 2025'.", "required": true}, {"name": "end_time", "description": "The end time for the search. Accepts formats like 'now', 'today', or 'Oct 3, 2025'.", "required": true}]}]}, "id": 1}
2025-10-14 10:21:17,154 - mcp_server - INFO - Received request: {"method": "tools/list", "params": {}, "jsonrpc": "2.0", "id": 2}
2025-10-14 10:21:17,154 - mcp_server - INFO - Request data: stdio_main: {'jsonrpc': '2.0', 'result': {'tools': [{'name': 'list_projects', 'description': 'Lists all HCP projects for a given organization.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}}, 'required': ['organization_id']}}, {'name': 'get_project', 'description': 'Gets an HCP project by its ID.', 'inputSchema': {'type': 'object', 'properties': {'project_id': {'type': 'string', 'description': 'The ID of the project.'}}, 'required': ['project_id']}}, {'name': 'delete_project', 'description': 'Deletes an HCP project by its ID.', 'inputSchema': {'type': 'object', 'properties': {'project_id': {'type': 'string', 'description': 'The ID of the project.'}}, 'required': ['project_id']}}, {'name': 'create_project', 'description': 'Creates a new HCP project.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'name': {'type': 'string', 'description': 'The name of the new project.'}}, 'required': ['organization_id', 'name']}}, {'name': 'update_project', 'description': 'Updates an HCP project.', 'inputSchema': {'type': 'object', 'properties': {'project_id': {'type': 'string', 'description': 'The ID of the project.'}, 'name': {'type': 'string', 'description': 'The new name of the project.'}}, 'required': ['project_id', 'name']}}, {'name': 'get_organization', 'description': 'Gets an HCP organization by its ID.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}}, 'required': ['organization_id']}}, {'name': 'list_organizations', 'description': 'Lists all HCP organizations.', 'inputSchema': {'type': 'object', 'properties': {}}}, {'name': 'update_organization', 'description': 'Updates an HCP organization.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'name': {'type': 'string', 'description': 'The new name of the organization.'}}, 'required': ['organization_id', 'name']}}, {'name': 'search_principals', 'description': 'Searches for principals in an organization.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'filter_str': {'type': 'string', 'description': 'The filter string to use for the search.'}}, 'required': ['organization_id']}}, {'name': 'get_principals', 'description': 'Gets principals by their IDs.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'principal_ids': {'type': 'array', 'items': {'type': 'string'}, 'description': 'The IDs of the principals to get.'}}, 'required': ['organization_id', 'principal_ids']}}, {'name': 'delete_service_principal', 'description': 'Deletes a service principal by its ID.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'principal_id': {'type': 'string', 'description': 'The ID of the service principal.'}}, 'required': ['organization_id', 'principal_id']}}, {'name': 'create_service_principal', 'description': 'Creates a new service principal.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'name': {'type': 'string', 'description': 'The name of the new service principal.'}}, 'required': ['organization_id', 'name']}}, {'name': 'update_service_principal', 'description': 'Updates a service principal.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'principal_id': {'type': 'string', 'description': 'The ID of the service principal.'}, 'name': {'type': 'string', 'description': 'The new name of the service principal.'}}, 'required': ['organization_id', 'principal_id', 'name']}}, {'name': 'list_secrets', 'description': 'Lists all secrets for a given application.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'project_id': {'type': 'string', 'description': 'The ID of the project.'}, 'app_name': {'type': 'string', 'description': 'The name of the application.'}}, 'required': ['organization_id', 'project_id', 'app_name']}}, {'name': 'get_secret', 'description': 'Gets a secret by its name.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'project_id': {'type': 'string', 'description': 'The ID of the project.'}, 'app_name': {'type': 'string', 'description': 'The name of the application.'}, 'secret_name': {'type': 'string', 'description': 'The name of the secret.'}}, 'required': ['organization_id', 'project_id', 'app_name', 'secret_name']}}, {'name': 'delete_secret', 'description': 'Deletes a secret by its name.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'project_id': {'type': 'string', 'description': 'The ID of the project.'}, 'app_name': {'type': 'string', 'description': 'The name of the application.'}, 'secret_name': {'type': 'string', 'description': 'The name of the secret.'}}, 'required': ['organization_id', 'project_id', 'app_name', 'secret_name']}}, {'name': 'create_secret', 'description': 'Creates a new secret.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'project_id': {'type': 'string', 'description': 'The ID of the project.'}, 'app_name': {'type': 'string', 'description': 'The name of the application.'}, 'secret_name': {'type': 'string', 'description': 'The name of the new secret.'}, 'secret_value': {'type': 'string', 'description': 'The value of the new secret.'}}, 'required': ['organization_id', 'project_id', 'app_name', 'secret_name', 'secret_value']}}, {'name': 'find_project_by_name', 'description': 'Finds a project by its name.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'name': {'type': 'string', 'description': 'The name of the project.'}}, 'required': ['organization_id', 'name']}}, {'name': 'find_user_by_email', 'description': 'Finds a user by their email.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'email': {'type': 'string', 'description': 'The email of the user.'}}, 'required': ['organization_id', 'email']}}, {'name': 'find_organization_by_name', 'description': 'Finds an organization by its name.', 'inputSchema': {'type': 'object', 'properties': {'name': {'type': 'string', 'description': 'The name of the organization.'}}, 'required': ['name']}}, {'name': 'list_resources', 'description': 'Lists all resources in a project.', 'inputSchema': {'type': 'object', 'properties': {'project_id': {'type': 'string', 'description': 'The ID of the project.'}}, 'required': ['project_id']}}, {'name': 'search_logs', 'description': 'Searches for audit logs in an organization using LogQL. At least one of `query`, `project_id`, or `topic` must be provided. For advanced filtering, use the `query` parameter with LogQL syntax. To filter on specific JSON fields in the log entries, use the `| json` parser in your query. For example: `query=\'| json | control_plane_event_action="CREATE"\'`', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'query': {'type': 'string', 'description': 'The LogQL query string for advanced filtering. Can be combined with `project_id` and `topic`. Example: \'| json | resource_uuid="some-uuid"\''}, 'project_id': {'type': 'string', 'description': 'A project ID to filter by.'}, 'topic': {'type': 'string', 'description': "A log topic to search. Example topics: 'hashicorp.platform.audit', 'hashicorp.packer.registry.audit', 'hashicorp.boundary.cluster.audit', 'hashicorp.consul.cluster.audit'"}, 'start_time': {'type': 'string', 'description': "The start time for the search. Accepts formats like '24 hours ago', 'yesterday at 5pm', or 'Oct 1, 2025'."}, 'end_time': {'type': 'string', 'description': "The end time for the search. Accepts formats like 'now', 'today', or 'Oct 3, 2025'."}}, 'required': ['organization_id', 'start_time', 'end_time']}}]}, 'id': 2}
2025-10-14 10:21:17,154 - mcp_server - INFO - Request data: stdio_main json: {"jsonrpc": "2.0", "result": {"tools": [{"name": "list_projects", "description": "Lists all HCP projects for a given organization.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}}, "required": ["organization_id"]}}, {"name": "get_project", "description": "Gets an HCP project by its ID.", "inputSchema": {"type": "object", "properties": {"project_id": {"type": "string", "description": "The ID of the project."}}, "required": ["project_id"]}}, {"name": "delete_project", "description": "Deletes an HCP project by its ID.", "inputSchema": {"type": "object", "properties": {"project_id": {"type": "string", "description": "The ID of the project."}}, "required": ["project_id"]}}, {"name": "create_project", "description": "Creates a new HCP project.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "name": {"type": "string", "description": "The name of the new project."}}, "required": ["organization_id", "name"]}}, {"name": "update_project", "description": "Updates an HCP project.", "inputSchema": {"type": "object", "properties": {"project_id": {"type": "string", "description": "The ID of the project."}, "name": {"type": "string", "description": "The new name of the project."}}, "required": ["project_id", "name"]}}, {"name": "get_organization", "description": "Gets an HCP organization by its ID.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}}, "required": ["organization_id"]}}, {"name": "list_organizations", "description": "Lists all HCP organizations.", "inputSchema": {"type": "object", "properties": {}}}, {"name": "update_organization", "description": "Updates an HCP organization.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "name": {"type": "string", "description": "The new name of the organization."}}, "required": ["organization_id", "name"]}}, {"name": "search_principals", "description": "Searches for principals in an organization.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "filter_str": {"type": "string", "description": "The filter string to use for the search."}}, "required": ["organization_id"]}}, {"name": "get_principals", "description": "Gets principals by their IDs.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "principal_ids": {"type": "array", "items": {"type": "string"}, "description": "The IDs of the principals to get."}}, "required": ["organization_id", "principal_ids"]}}, {"name": "delete_service_principal", "description": "Deletes a service principal by its ID.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "principal_id": {"type": "string", "description": "The ID of the service principal."}}, "required": ["organization_id", "principal_id"]}}, {"name": "create_service_principal", "description": "Creates a new service principal.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "name": {"type": "string", "description": "The name of the new service principal."}}, "required": ["organization_id", "name"]}}, {"name": "update_service_principal", "description": "Updates a service principal.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "principal_id": {"type": "string", "description": "The ID of the service principal."}, "name": {"type": "string", "description": "The new name of the service principal."}}, "required": ["organization_id", "principal_id", "name"]}}, {"name": "list_secrets", "description": "Lists all secrets for a given application.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "project_id": {"type": "string", "description": "The ID of the project."}, "app_name": {"type": "string", "description": "The name of the application."}}, "required": ["organization_id", "project_id", "app_name"]}}, {"name": "get_secret", "description": "Gets a secret by its name.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "project_id": {"type": "string", "description": "The ID of the project."}, "app_name": {"type": "string", "description": "The name of the application."}, "secret_name": {"type": "string", "description": "The name of the secret."}}, "required": ["organization_id", "project_id", "app_name", "secret_name"]}}, {"name": "delete_secret", "description": "Deletes a secret by its name.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "project_id": {"type": "string", "description": "The ID of the project."}, "app_name": {"type": "string", "description": "The name of the application."}, "secret_name": {"type": "string", "description": "The name of the secret."}}, "required": ["organization_id", "project_id", "app_name", "secret_name"]}}, {"name": "create_secret", "description": "Creates a new secret.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "project_id": {"type": "string", "description": "The ID of the project."}, "app_name": {"type": "string", "description": "The name of the application."}, "secret_name": {"type": "string", "description": "The name of the new secret."}, "secret_value": {"type": "string", "description": "The value of the new secret."}}, "required": ["organization_id", "project_id", "app_name", "secret_name", "secret_value"]}}, {"name": "find_project_by_name", "description": "Finds a project by its name.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "name": {"type": "string", "description": "The name of the project."}}, "required": ["organization_id", "name"]}}, {"name": "find_user_by_email", "description": "Finds a user by their email.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "email": {"type": "string", "description": "The email of the user."}}, "required": ["organization_id", "email"]}}, {"name": "find_organization_by_name", "description": "Finds an organization by its name.", "inputSchema": {"type": "object", "properties": {"name": {"type": "string", "description": "The name of the organization."}}, "required": ["name"]}}, {"name": "list_resources", "description": "Lists all resources in a project.", "inputSchema": {"type": "object", "properties": {"project_id": {"type": "string", "description": "The ID of the project."}}, "required": ["project_id"]}}, {"name": "search_logs", "description": "Searches for audit logs in an organization using LogQL. At least one of `query`, `project_id`, or `topic` must be provided. For advanced filtering, use the `query` parameter with LogQL syntax. To filter on specific JSON fields in the log entries, use the `| json` parser in your query. For example: `query='| json | control_plane_event_action=\"CREATE\"'`", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "query": {"type": "string", "description": "The LogQL query string for advanced filtering. Can be combined with `project_id` and `topic`. Example: '| json | resource_uuid=\"some-uuid\"'"}, "project_id": {"type": "string", "description": "A project ID to filter by."}, "topic": {"type": "string", "description": "A log topic to search. Example topics: 'hashicorp.platform.audit', 'hashicorp.packer.registry.audit', 'hashicorp.boundary.cluster.audit', 'hashicorp.consul.cluster.audit'"}, "start_time": {"type": "string", "description": "The start time for the search. Accepts formats like '24 hours ago', 'yesterday at 5pm', or 'Oct 1, 2025'."}, "end_time": {"type": "string", "description": "The end time for the search. Accepts formats like 'now', 'today', or 'Oct 3, 2025'."}}, "required": ["organization_id", "start_time", "end_time"]}}]}, "id": 2}
2025-10-14 10:21:33,355 - mcp_server - INFO - Client call: {"method": "tools/call", "params": {"name": "search_logs", "arguments": {"organization_id": "11eab4a9-75f1-e0a5-8be1-0242ac110016", "end_time": "now", "start_time": "8 days ago"}}, "jsonrpc": "2.0", "id": 3}
2025-10-14 10:21:33,934 - mcp_server - INFO - Request data: stdio_main: {'jsonrpc': '2.0', 'error': {'code': -32000, 'message': 'Server error', 'data': 'A query, project_id, or topic must be provided to search logs.'}, 'id': 3}
2025-10-14 10:21:33,934 - mcp_server - INFO - Request data: stdio_main json: {"jsonrpc": "2.0", "error": {"code": -32000, "message": "Server error", "data": "A query, project_id, or topic must be provided to search logs."}, "id": 3}
2025-10-14 10:25:29,482 - mcp_server - INFO - Received request: {"method": "initialize", "params": {"protocolVersion": "2025-06-18", "capabilities": {"roots": {}}, "clientInfo": {"name": "gemini-cli-mcp-client-HCP", "version": "0.0.1"}}, "jsonrpc": "2.0", "id": 0}
2025-10-14 10:25:29,482 - mcp_server - INFO - Request data: stdio_main: {'jsonrpc': '2.0', 'result': {'protocolVersion': '2024-11-05', 'serverInfo': {'name': 'HCP', 'version': '0.0.1'}, 'capabilities': {'tools': {'listChanged': True}, 'prompts': {'listChanged': True}, 'resources': {'listChanged': True}}}, 'id': 0}
2025-10-14 10:25:29,482 - mcp_server - INFO - Request data: stdio_main json: {"jsonrpc": "2.0", "result": {"protocolVersion": "2024-11-05", "serverInfo": {"name": "HCP", "version": "0.0.1"}, "capabilities": {"tools": {"listChanged": true}, "prompts": {"listChanged": true}, "resources": {"listChanged": true}}}, "id": 0}
2025-10-14 10:25:29,483 - mcp_server - INFO - Received request: {"method": "notifications/initialized", "jsonrpc": "2.0"}
2025-10-14 10:25:29,483 - mcp_server - INFO - Client initialized.
2025-10-14 10:25:29,483 - mcp_server - INFO - Received request: {"method": "prompts/list", "params": {}, "jsonrpc": "2.0", "id": 1}
2025-10-14 10:25:29,483 - mcp_server - INFO - Request data: stdio_main: {'jsonrpc': '2.0', 'result': {'prompts': [{'name': 'list_projects', 'title': 'List Projects', 'description': 'Lists all HCP projects for a given organization.', 'arguments': [{'name': 'organization_id', 'description': 'The ID of the organization.', 'required': True}]}, {'name': 'get_project', 'title': 'Get Project', 'description': 'Gets an HCP project by its ID.', 'arguments': [{'name': 'project_id', 'description': 'The ID of the project.', 'required': True}]}, {'name': 'delete_project', 'title': 'Delete Project', 'description': 'Deletes an HCP project by its ID.', 'arguments': [{'name': 'project_id', 'description': 'The ID of the project.', 'required': True}]}, {'name': 'create_project', 'title': 'Create Project', 'description': 'Creates a new HCP project.', 'arguments': [{'name': 'name', 'description': 'The name of the new project.', 'required': True}, {'name': 'organization_id', 'description': 'The ID of the organization.', 'required': True}]}, {'name': 'update_project', 'title': 'Update Project', 'description': 'Updates an HCP project.', 'arguments': [{'name': 'project_id', 'description': 'The ID of the project.', 'required': True}, {'name': 'name', 'description': 'The new name for the project.', 'required': True}, {'name': 'organization_id', 'description': 'The ID of the organization.', 'required': True}]}, {'name': 'get_organization', 'title': 'Get Organization', 'description': 'Gets an HCP organization by its ID.', 'arguments': [{'name': 'organization_id', 'description': 'The ID of the organization.', 'required': True}]}, {'name': 'list_organizations', 'title': 'List Organizations', 'description': 'Lists all HCP organizations.', 'arguments': None}, {'name': 'update_organization', 'title': 'Update Organization', 'description': 'Updates an HCP organization.', 'arguments': [{'name': 'organization_id', 'description': 'The ID of the organization.', 'required': True}, {'name': 'name', 'description': 'The new name for the organization.', 'required': True}]}, {'name': 'list_secrets', 'title': 'List Secrets', 'description': 'Lists all secrets for a given application.', 'arguments': [{'name': 'project_id', 'description': 'The ID of the project.', 'required': True}, {'name': 'app_name', 'description': 'The name of the application.', 'required': True}]}, {'name': 'get_secret', 'title': 'Get Secret', 'description': 'Gets a secret by its name.', 'arguments': [{'name': 'secret_name', 'description': 'The name of the secret.', 'required': True}, {'name': 'project_id', 'description': 'The ID of the project.', 'required': True}, {'name': 'app_name', 'description': 'The name of the application.', 'required': True}]}, {'name': 'delete_secret', 'title': 'Delete Secret', 'description': 'Deletes a secret by its name.', 'arguments': [{'name': 'secret_name', 'description': 'The name of the secret.', 'required': True}, {'name': 'project_id', 'description': 'The ID of the project.', 'required': True}, {'name': 'app_name', 'description': 'The name of the application.', 'required': True}]}, {'name': 'create_secret', 'title': 'Create Secret', 'description': 'Creates a new secret.', 'arguments': [{'name': 'secret_name', 'description': 'The name of the new secret.', 'required': True}, {'name': 'secret_value', 'description': 'The value of the new secret.', 'required': True}, {'name': 'project_id', 'description': 'The ID of the project.', 'required': True}, {'name': 'app_name', 'description': 'The name of the application.', 'required': True}]}, {'name': 'find_project_and_list_secrets', 'title': 'Find Project and List Secrets', 'description': 'Finds a project by name and lists its secrets.', 'arguments': [{'name': 'project_name', 'description': 'The name of the project.', 'required': True}, {'name': 'organization_id', 'description': 'The ID of the organization.', 'required': True}, {'name': 'app_name', 'description': 'The name of the application.', 'required': True}]}, {'name': 'list_resources', 'title': 'List Resources', 'description': 'Lists all resources in a project.', 'arguments': [{'name': 'project_id', 'description': 'The ID of the project.', 'required': True}]}, {'name': 'search_logs', 'title': 'Search Logs', 'description': 'Searches for audit logs in an organization using LogQL. The LLM should determine the best topic to use based on the user\'s query, or default to \'hashicorp.platform.audit\' if the user is not specific. For advanced filtering, use the `query` parameter with LogQL syntax. To filter on specific JSON fields in the log entries, use the `| json` parser in your query. For example: `query=\'| json | control_plane_event_action="CREATE"\'`', 'arguments': [{'name': 'organization_id', 'description': 'The ID of the organization.', 'required': True}, {'name': 'query', 'description': 'The LogQL query string for advanced filtering. Can be combined with `project_id` and `topic`. Example: \'| json | resource_uuid="some-uuid"\'', 'required': False}, {'name': 'project_id', 'description': 'A project ID to filter by.', 'required': False}, {'name': 'topic', 'description': "A log topic to search. Example topics: 'hashicorp.platform.audit', 'hashicorp.packer.registry.audit', 'hashicorp.boundary.cluster.audit', 'hashicorp.consul.cluster.audit'", 'required': True}, {'name': 'start_time', 'description': "The start time for the search. Accepts formats like '24 hours ago', 'yesterday at 5pm', or 'Oct 1, 2025'.", 'required': True}, {'name': 'end_time', 'description': "The end time for the search. Accepts formats like 'now', 'today', or 'Oct 3, 2025'.", 'required': True}]}]}, 'id': 1}
2025-10-14 10:25:29,484 - mcp_server - INFO - Request data: stdio_main json: {"jsonrpc": "2.0", "result": {"prompts": [{"name": "list_projects", "title": "List Projects", "description": "Lists all HCP projects for a given organization.", "arguments": [{"name": "organization_id", "description": "The ID of the organization.", "required": true}]}, {"name": "get_project", "title": "Get Project", "description": "Gets an HCP project by its ID.", "arguments": [{"name": "project_id", "description": "The ID of the project.", "required": true}]}, {"name": "delete_project", "title": "Delete Project", "description": "Deletes an HCP project by its ID.", "arguments": [{"name": "project_id", "description": "The ID of the project.", "required": true}]}, {"name": "create_project", "title": "Create Project", "description": "Creates a new HCP project.", "arguments": [{"name": "name", "description": "The name of the new project.", "required": true}, {"name": "organization_id", "description": "The ID of the organization.", "required": true}]}, {"name": "update_project", "title": "Update Project", "description": "Updates an HCP project.", "arguments": [{"name": "project_id", "description": "The ID of the project.", "required": true}, {"name": "name", "description": "The new name for the project.", "required": true}, {"name": "organization_id", "description": "The ID of the organization.", "required": true}]}, {"name": "get_organization", "title": "Get Organization", "description": "Gets an HCP organization by its ID.", "arguments": [{"name": "organization_id", "description": "The ID of the organization.", "required": true}]}, {"name": "list_organizations", "title": "List Organizations", "description": "Lists all HCP organizations.", "arguments": null}, {"name": "update_organization", "title": "Update Organization", "description": "Updates an HCP organization.", "arguments": [{"name": "organization_id", "description": "The ID of the organization.", "required": true}, {"name": "name", "description": "The new name for the organization.", "required": true}]}, {"name": "list_secrets", "title": "List Secrets", "description": "Lists all secrets for a given application.", "arguments": [{"name": "project_id", "description": "The ID of the project.", "required": true}, {"name": "app_name", "description": "The name of the application.", "required": true}]}, {"name": "get_secret", "title": "Get Secret", "description": "Gets a secret by its name.", "arguments": [{"name": "secret_name", "description": "The name of the secret.", "required": true}, {"name": "project_id", "description": "The ID of the project.", "required": true}, {"name": "app_name", "description": "The name of the application.", "required": true}]}, {"name": "delete_secret", "title": "Delete Secret", "description": "Deletes a secret by its name.", "arguments": [{"name": "secret_name", "description": "The name of the secret.", "required": true}, {"name": "project_id", "description": "The ID of the project.", "required": true}, {"name": "app_name", "description": "The name of the application.", "required": true}]}, {"name": "create_secret", "title": "Create Secret", "description": "Creates a new secret.", "arguments": [{"name": "secret_name", "description": "The name of the new secret.", "required": true}, {"name": "secret_value", "description": "The value of the new secret.", "required": true}, {"name": "project_id", "description": "The ID of the project.", "required": true}, {"name": "app_name", "description": "The name of the application.", "required": true}]}, {"name": "find_project_and_list_secrets", "title": "Find Project and List Secrets", "description": "Finds a project by name and lists its secrets.", "arguments": [{"name": "project_name", "description": "The name of the project.", "required": true}, {"name": "organization_id", "description": "The ID of the organization.", "required": true}, {"name": "app_name", "description": "The name of the application.", "required": true}]}, {"name": "list_resources", "title": "List Resources", "description": "Lists all resources in a project.", "arguments": [{"name": "project_id", "description": "The ID of the project.", "required": true}]}, {"name": "search_logs", "title": "Search Logs", "description": "Searches for audit logs in an organization using LogQL. The LLM should determine the best topic to use based on the user's query, or default to 'hashicorp.platform.audit' if the user is not specific. For advanced filtering, use the `query` parameter with LogQL syntax. To filter on specific JSON fields in the log entries, use the `| json` parser in your query. For example: `query='| json | control_plane_event_action=\"CREATE\"'`", "arguments": [{"name": "organization_id", "description": "The ID of the organization.", "required": true}, {"name": "query", "description": "The LogQL query string for advanced filtering. Can be combined with `project_id` and `topic`. Example: '| json | resource_uuid=\"some-uuid\"'", "required": false}, {"name": "project_id", "description": "A project ID to filter by.", "required": false}, {"name": "topic", "description": "A log topic to search. Example topics: 'hashicorp.platform.audit', 'hashicorp.packer.registry.audit', 'hashicorp.boundary.cluster.audit', 'hashicorp.consul.cluster.audit'", "required": true}, {"name": "start_time", "description": "The start time for the search. Accepts formats like '24 hours ago', 'yesterday at 5pm', or 'Oct 1, 2025'.", "required": true}, {"name": "end_time", "description": "The end time for the search. Accepts formats like 'now', 'today', or 'Oct 3, 2025'.", "required": true}]}]}, "id": 1}
2025-10-14 10:25:29,484 - mcp_server - INFO - Received request: {"method": "tools/list", "params": {}, "jsonrpc": "2.0", "id": 2}
2025-10-14 10:25:29,485 - mcp_server - INFO - Request data: stdio_main: {'jsonrpc': '2.0', 'result': {'tools': [{'name': 'list_projects', 'description': 'Lists all HCP projects for a given organization.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}}, 'required': ['organization_id']}}, {'name': 'get_project', 'description': 'Gets an HCP project by its ID.', 'inputSchema': {'type': 'object', 'properties': {'project_id': {'type': 'string', 'description': 'The ID of the project.'}}, 'required': ['project_id']}}, {'name': 'delete_project', 'description': 'Deletes an HCP project by its ID.', 'inputSchema': {'type': 'object', 'properties': {'project_id': {'type': 'string', 'description': 'The ID of the project.'}}, 'required': ['project_id']}}, {'name': 'create_project', 'description': 'Creates a new HCP project.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'name': {'type': 'string', 'description': 'The name of the new project.'}}, 'required': ['organization_id', 'name']}}, {'name': 'update_project', 'description': 'Updates an HCP project.', 'inputSchema': {'type': 'object', 'properties': {'project_id': {'type': 'string', 'description': 'The ID of the project.'}, 'name': {'type': 'string', 'description': 'The new name of the project.'}}, 'required': ['project_id', 'name']}}, {'name': 'get_organization', 'description': 'Gets an HCP organization by its ID.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}}, 'required': ['organization_id']}}, {'name': 'list_organizations', 'description': 'Lists all HCP organizations.', 'inputSchema': {'type': 'object', 'properties': {}}}, {'name': 'update_organization', 'description': 'Updates an HCP organization.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'name': {'type': 'string', 'description': 'The new name of the organization.'}}, 'required': ['organization_id', 'name']}}, {'name': 'search_principals', 'description': 'Searches for principals in an organization.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'filter_str': {'type': 'string', 'description': 'The filter string to use for the search.'}}, 'required': ['organization_id']}}, {'name': 'get_principals', 'description': 'Gets principals by their IDs.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'principal_ids': {'type': 'array', 'items': {'type': 'string'}, 'description': 'The IDs of the principals to get.'}}, 'required': ['organization_id', 'principal_ids']}}, {'name': 'delete_service_principal', 'description': 'Deletes a service principal by its ID.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'principal_id': {'type': 'string', 'description': 'The ID of the service principal.'}}, 'required': ['organization_id', 'principal_id']}}, {'name': 'create_service_principal', 'description': 'Creates a new service principal.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'name': {'type': 'string', 'description': 'The name of the new service principal.'}}, 'required': ['organization_id', 'name']}}, {'name': 'update_service_principal', 'description': 'Updates a service principal.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'principal_id': {'type': 'string', 'description': 'The ID of the service principal.'}, 'name': {'type': 'string', 'description': 'The new name of the service principal.'}}, 'required': ['organization_id', 'principal_id', 'name']}}, {'name': 'list_secrets', 'description': 'Lists all secrets for a given application.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'project_id': {'type': 'string', 'description': 'The ID of the project.'}, 'app_name': {'type': 'string', 'description': 'The name of the application.'}}, 'required': ['organization_id', 'project_id', 'app_name']}}, {'name': 'get_secret', 'description': 'Gets a secret by its name.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'project_id': {'type': 'string', 'description': 'The ID of the project.'}, 'app_name': {'type': 'string', 'description': 'The name of the application.'}, 'secret_name': {'type': 'string', 'description': 'The name of the secret.'}}, 'required': ['organization_id', 'project_id', 'app_name', 'secret_name']}}, {'name': 'delete_secret', 'description': 'Deletes a secret by its name.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'project_id': {'type': 'string', 'description': 'The ID of the project.'}, 'app_name': {'type': 'string', 'description': 'The name of the application.'}, 'secret_name': {'type': 'string', 'description': 'The name of the secret.'}}, 'required': ['organization_id', 'project_id', 'app_name', 'secret_name']}}, {'name': 'create_secret', 'description': 'Creates a new secret.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'project_id': {'type': 'string', 'description': 'The ID of the project.'}, 'app_name': {'type': 'string', 'description': 'The name of the application.'}, 'secret_name': {'type': 'string', 'description': 'The name of the new secret.'}, 'secret_value': {'type': 'string', 'description': 'The value of the new secret.'}}, 'required': ['organization_id', 'project_id', 'app_name', 'secret_name', 'secret_value']}}, {'name': 'find_project_by_name', 'description': 'Finds a project by its name.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'name': {'type': 'string', 'description': 'The name of the project.'}}, 'required': ['organization_id', 'name']}}, {'name': 'find_user_by_email', 'description': 'Finds a user by their email.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'email': {'type': 'string', 'description': 'The email of the user.'}}, 'required': ['organization_id', 'email']}}, {'name': 'find_organization_by_name', 'description': 'Finds an organization by its name.', 'inputSchema': {'type': 'object', 'properties': {'name': {'type': 'string', 'description': 'The name of the organization.'}}, 'required': ['name']}}, {'name': 'list_resources', 'description': 'Lists all resources in a project.', 'inputSchema': {'type': 'object', 'properties': {'project_id': {'type': 'string', 'description': 'The ID of the project.'}}, 'required': ['project_id']}}, {'name': 'search_logs', 'description': 'Searches for audit logs in an organization using LogQL. At least one of `query`, `project_id`, or `topic` must be provided. For advanced filtering, use the `query` parameter with LogQL syntax. To filter on specific JSON fields in the log entries, use the `| json` parser in your query. For example: `query=\'| json | control_plane_event_action="CREATE"\'`', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'query': {'type': 'string', 'description': 'The LogQL query string for advanced filtering. Can be combined with `project_id` and `topic`. Example: \'| json | resource_uuid="some-uuid"\''}, 'project_id': {'type': 'string', 'description': 'A project ID to filter by.'}, 'topic': {'type': 'string', 'description': "A log topic to search. Example topics: 'hashicorp.platform.audit', 'hashicorp.packer.registry.audit', 'hashicorp.boundary.cluster.audit', 'hashicorp.consul.cluster.audit'"}, 'start_time': {'type': 'string', 'description': "The start time for the search. Accepts formats like '24 hours ago', 'yesterday at 5pm', or 'Oct 1, 2025'."}, 'end_time': {'type': 'string', 'description': "The end time for the search. Accepts formats like 'now', 'today', or 'Oct 3, 2025'."}}, 'required': ['organization_id', 'start_time', 'end_time']}}]}, 'id': 2}
2025-10-14 10:25:29,485 - mcp_server - INFO - Request data: stdio_main json: {"jsonrpc": "2.0", "result": {"tools": [{"name": "list_projects", "description": "Lists all HCP projects for a given organization.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}}, "required": ["organization_id"]}}, {"name": "get_project", "description": "Gets an HCP project by its ID.", "inputSchema": {"type": "object", "properties": {"project_id": {"type": "string", "description": "The ID of the project."}}, "required": ["project_id"]}}, {"name": "delete_project", "description": "Deletes an HCP project by its ID.", "inputSchema": {"type": "object", "properties": {"project_id": {"type": "string", "description": "The ID of the project."}}, "required": ["project_id"]}}, {"name": "create_project", "description": "Creates a new HCP project.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "name": {"type": "string", "description": "The name of the new project."}}, "required": ["organization_id", "name"]}}, {"name": "update_project", "description": "Updates an HCP project.", "inputSchema": {"type": "object", "properties": {"project_id": {"type": "string", "description": "The ID of the project."}, "name": {"type": "string", "description": "The new name of the project."}}, "required": ["project_id", "name"]}}, {"name": "get_organization", "description": "Gets an HCP organization by its ID.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}}, "required": ["organization_id"]}}, {"name": "list_organizations", "description": "Lists all HCP organizations.", "inputSchema": {"type": "object", "properties": {}}}, {"name": "update_organization", "description": "Updates an HCP organization.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "name": {"type": "string", "description": "The new name of the organization."}}, "required": ["organization_id", "name"]}}, {"name": "search_principals", "description": "Searches for principals in an organization.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "filter_str": {"type": "string", "description": "The filter string to use for the search."}}, "required": ["organization_id"]}}, {"name": "get_principals", "description": "Gets principals by their IDs.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "principal_ids": {"type": "array", "items": {"type": "string"}, "description": "The IDs of the principals to get."}}, "required": ["organization_id", "principal_ids"]}}, {"name": "delete_service_principal", "description": "Deletes a service principal by its ID.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "principal_id": {"type": "string", "description": "The ID of the service principal."}}, "required": ["organization_id", "principal_id"]}}, {"name": "create_service_principal", "description": "Creates a new service principal.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "name": {"type": "string", "description": "The name of the new service principal."}}, "required": ["organization_id", "name"]}}, {"name": "update_service_principal", "description": "Updates a service principal.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "principal_id": {"type": "string", "description": "The ID of the service principal."}, "name": {"type": "string", "description": "The new name of the service principal."}}, "required": ["organization_id", "principal_id", "name"]}}, {"name": "list_secrets", "description": "Lists all secrets for a given application.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "project_id": {"type": "string", "description": "The ID of the project."}, "app_name": {"type": "string", "description": "The name of the application."}}, "required": ["organization_id", "project_id", "app_name"]}}, {"name": "get_secret", "description": "Gets a secret by its name.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "project_id": {"type": "string", "description": "The ID of the project."}, "app_name": {"type": "string", "description": "The name of the application."}, "secret_name": {"type": "string", "description": "The name of the secret."}}, "required": ["organization_id", "project_id", "app_name", "secret_name"]}}, {"name": "delete_secret", "description": "Deletes a secret by its name.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "project_id": {"type": "string", "description": "The ID of the project."}, "app_name": {"type": "string", "description": "The name of the application."}, "secret_name": {"type": "string", "description": "The name of the secret."}}, "required": ["organization_id", "project_id", "app_name", "secret_name"]}}, {"name": "create_secret", "description": "Creates a new secret.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "project_id": {"type": "string", "description": "The ID of the project."}, "app_name": {"type": "string", "description": "The name of the application."}, "secret_name": {"type": "string", "description": "The name of the new secret."}, "secret_value": {"type": "string", "description": "The value of the new secret."}}, "required": ["organization_id", "project_id", "app_name", "secret_name", "secret_value"]}}, {"name": "find_project_by_name", "description": "Finds a project by its name.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "name": {"type": "string", "description": "The name of the project."}}, "required": ["organization_id", "name"]}}, {"name": "find_user_by_email", "description": "Finds a user by their email.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "email": {"type": "string", "description": "The email of the user."}}, "required": ["organization_id", "email"]}}, {"name": "find_organization_by_name", "description": "Finds an organization by its name.", "inputSchema": {"type": "object", "properties": {"name": {"type": "string", "description": "The name of the organization."}}, "required": ["name"]}}, {"name": "list_resources", "description": "Lists all resources in a project.", "inputSchema": {"type": "object", "properties": {"project_id": {"type": "string", "description": "The ID of the project."}}, "required": ["project_id"]}}, {"name": "search_logs", "description": "Searches for audit logs in an organization using LogQL. At least one of `query`, `project_id`, or `topic` must be provided. For advanced filtering, use the `query` parameter with LogQL syntax. To filter on specific JSON fields in the log entries, use the `| json` parser in your query. For example: `query='| json | control_plane_event_action=\"CREATE\"'`", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "query": {"type": "string", "description": "The LogQL query string for advanced filtering. Can be combined with `project_id` and `topic`. Example: '| json | resource_uuid=\"some-uuid\"'"}, "project_id": {"type": "string", "description": "A project ID to filter by."}, "topic": {"type": "string", "description": "A log topic to search. Example topics: 'hashicorp.platform.audit', 'hashicorp.packer.registry.audit', 'hashicorp.boundary.cluster.audit', 'hashicorp.consul.cluster.audit'"}, "start_time": {"type": "string", "description": "The start time for the search. Accepts formats like '24 hours ago', 'yesterday at 5pm', or 'Oct 1, 2025'."}, "end_time": {"type": "string", "description": "The end time for the search. Accepts formats like 'now', 'today', or 'Oct 3, 2025'."}}, "required": ["organization_id", "start_time", "end_time"]}}]}, "id": 2}
2025-10-14 10:26:23,190 - mcp_server - INFO - Client call: {"method": "tools/call", "params": {"name": "search_logs", "arguments": {"end_time": "now", "organization_id": "11eab4a9-75f1-e0a5-8be1-0242ac110016", "start_time": "8 days ago"}}, "jsonrpc": "2.0", "id": 3}
2025-10-14 10:26:23,757 - mcp_server - INFO - Request data: stdio_main: {'jsonrpc': '2.0', 'error': {'code': -32000, 'message': 'Server error', 'data': 'A query, project_id, or topic must be provided to search logs.'}, 'id': 3}
2025-10-14 10:26:23,757 - mcp_server - INFO - Request data: stdio_main json: {"jsonrpc": "2.0", "error": {"code": -32000, "message": "Server error", "data": "A query, project_id, or topic must be provided to search logs."}, "id": 3}
2025-10-14 10:45:28,434 - mcp_server - INFO - Received request: {"method": "initialize", "params": {"protocolVersion": "2025-06-18", "capabilities": {"roots": {}}, "clientInfo": {"name": "gemini-cli-mcp-client-HCP", "version": "0.0.1"}}, "jsonrpc": "2.0", "id": 0}
2025-10-14 10:45:28,434 - mcp_server - INFO - Request data: stdio_main: {'jsonrpc': '2.0', 'result': {'protocolVersion': '2024-11-05', 'serverInfo': {'name': 'HCP', 'version': '0.0.1'}, 'capabilities': {'tools': {'listChanged': True}, 'prompts': {'listChanged': True}, 'resources': {'listChanged': True}}}, 'id': 0}
2025-10-14 10:45:28,435 - mcp_server - INFO - Request data: stdio_main json: {"jsonrpc": "2.0", "result": {"protocolVersion": "2024-11-05", "serverInfo": {"name": "HCP", "version": "0.0.1"}, "capabilities": {"tools": {"listChanged": true}, "prompts": {"listChanged": true}, "resources": {"listChanged": true}}}, "id": 0}
2025-10-14 10:45:28,435 - mcp_server - INFO - Received request: {"method": "notifications/initialized", "jsonrpc": "2.0"}
2025-10-14 10:45:28,435 - mcp_server - INFO - Client initialized.
2025-10-14 10:45:28,435 - mcp_server - INFO - Received request: {"method": "prompts/list", "params": {}, "jsonrpc": "2.0", "id": 1}
2025-10-14 10:45:28,435 - mcp_server - INFO - Request data: stdio_main: {'jsonrpc': '2.0', 'result': {'prompts': [{'name': 'list_projects', 'title': 'List Projects', 'description': 'Lists all HCP projects for a given organization.', 'arguments': [{'name': 'organization_id', 'description': 'The ID of the organization.', 'required': True}]}, {'name': 'get_project', 'title': 'Get Project', 'description': 'Gets an HCP project by its ID.', 'arguments': [{'name': 'project_id', 'description': 'The ID of the project.', 'required': True}]}, {'name': 'delete_project', 'title': 'Delete Project', 'description': 'Deletes an HCP project by its ID.', 'arguments': [{'name': 'project_id', 'description': 'The ID of the project.', 'required': True}]}, {'name': 'create_project', 'title': 'Create Project', 'description': 'Creates a new HCP project.', 'arguments': [{'name': 'name', 'description': 'The name of the new project.', 'required': True}, {'name': 'organization_id', 'description': 'The ID of the organization.', 'required': True}]}, {'name': 'update_project', 'title': 'Update Project', 'description': 'Updates an HCP project.', 'arguments': [{'name': 'project_id', 'description': 'The ID of the project.', 'required': True}, {'name': 'name', 'description': 'The new name for the project.', 'required': True}, {'name': 'organization_id', 'description': 'The ID of the organization.', 'required': True}]}, {'name': 'get_organization', 'title': 'Get Organization', 'description': 'Gets an HCP organization by its ID.', 'arguments': [{'name': 'organization_id', 'description': 'The ID of the organization.', 'required': True}]}, {'name': 'list_organizations', 'title': 'List Organizations', 'description': 'Lists all HCP organizations.', 'arguments': None}, {'name': 'update_organization', 'title': 'Update Organization', 'description': 'Updates an HCP organization.', 'arguments': [{'name': 'organization_id', 'description': 'The ID of the organization.', 'required': True}, {'name': 'name', 'description': 'The new name for the organization.', 'required': True}]}, {'name': 'list_secrets', 'title': 'List Secrets', 'description': 'Lists all secrets for a given application.', 'arguments': [{'name': 'project_id', 'description': 'The ID of the project.', 'required': True}, {'name': 'app_name', 'description': 'The name of the application.', 'required': True}]}, {'name': 'get_secret', 'title': 'Get Secret', 'description': 'Gets a secret by its name.', 'arguments': [{'name': 'secret_name', 'description': 'The name of the secret.', 'required': True}, {'name': 'project_id', 'description': 'The ID of the project.', 'required': True}, {'name': 'app_name', 'description': 'The name of the application.', 'required': True}]}, {'name': 'delete_secret', 'title': 'Delete Secret', 'description': 'Deletes a secret by its name.', 'arguments': [{'name': 'secret_name', 'description': 'The name of the secret.', 'required': True}, {'name': 'project_id', 'description': 'The ID of the project.', 'required': True}, {'name': 'app_name', 'description': 'The name of the application.', 'required': True}]}, {'name': 'create_secret', 'title': 'Create Secret', 'description': 'Creates a new secret.', 'arguments': [{'name': 'secret_name', 'description': 'The name of the new secret.', 'required': True}, {'name': 'secret_value', 'description': 'The value of the new secret.', 'required': True}, {'name': 'project_id', 'description': 'The ID of the project.', 'required': True}, {'name': 'app_name', 'description': 'The name of the application.', 'required': True}]}, {'name': 'find_project_and_list_secrets', 'title': 'Find Project and List Secrets', 'description': 'Finds a project by name and lists its secrets.', 'arguments': [{'name': 'project_name', 'description': 'The name of the project.', 'required': True}, {'name': 'organization_id', 'description': 'The ID of the organization.', 'required': True}, {'name': 'app_name', 'description': 'The name of the application.', 'required': True}]}, {'name': 'list_resources', 'title': 'List Resources', 'description': 'Lists all resources in a project.', 'arguments': [{'name': 'project_id', 'description': 'The ID of the project.', 'required': True}]}, {'name': 'search_logs', 'title': 'Search Logs', 'description': 'Searches for audit logs in an organization using LogQL. The LLM should determine the best topic to use based on the user\'s query, or default to \'hashicorp.platform.audit\' if the user is not specific. For advanced filtering, use the `query` parameter with LogQL syntax. To filter on specific JSON fields in the log entries, use the `| json` parser in your query. For example: `query=\'| json | control_plane_event_action="CREATE"\'`', 'arguments': [{'name': 'organization_id', 'description': 'The ID of the organization.', 'required': True}, {'name': 'query', 'description': 'The LogQL query string for advanced filtering. Can be combined with `project_id` and `topic`. Example: \'| json | resource_uuid="some-uuid"\'', 'required': False}, {'name': 'project_id', 'description': 'A project ID to filter by.', 'required': False}, {'name': 'topic', 'description': "A log topic to search. Example topics: 'hashicorp.platform.audit', 'hashicorp.packer.registry.audit', 'hashicorp.boundary.cluster.audit', 'hashicorp.consul.cluster.audit'", 'required': True}, {'name': 'start_time', 'description': "The start time for the search. Accepts formats like '24 hours ago', 'yesterday at 5pm', or 'Oct 1, 2025'.", 'required': True}, {'name': 'end_time', 'description': "The end time for the search. Accepts formats like 'now', 'today', or 'Oct 3, 2025'.", 'required': True}]}]}, 'id': 1}
2025-10-14 10:45:28,435 - mcp_server - INFO - Request data: stdio_main json: {"jsonrpc": "2.0", "result": {"prompts": [{"name": "list_projects", "title": "List Projects", "description": "Lists all HCP projects for a given organization.", "arguments": [{"name": "organization_id", "description": "The ID of the organization.", "required": true}]}, {"name": "get_project", "title": "Get Project", "description": "Gets an HCP project by its ID.", "arguments": [{"name": "project_id", "description": "The ID of the project.", "required": true}]}, {"name": "delete_project", "title": "Delete Project", "description": "Deletes an HCP project by its ID.", "arguments": [{"name": "project_id", "description": "The ID of the project.", "required": true}]}, {"name": "create_project", "title": "Create Project", "description": "Creates a new HCP project.", "arguments": [{"name": "name", "description": "The name of the new project.", "required": true}, {"name": "organization_id", "description": "The ID of the organization.", "required": true}]}, {"name": "update_project", "title": "Update Project", "description": "Updates an HCP project.", "arguments": [{"name": "project_id", "description": "The ID of the project.", "required": true}, {"name": "name", "description": "The new name for the project.", "required": true}, {"name": "organization_id", "description": "The ID of the organization.", "required": true}]}, {"name": "get_organization", "title": "Get Organization", "description": "Gets an HCP organization by its ID.", "arguments": [{"name": "organization_id", "description": "The ID of the organization.", "required": true}]}, {"name": "list_organizations", "title": "List Organizations", "description": "Lists all HCP organizations.", "arguments": null}, {"name": "update_organization", "title": "Update Organization", "description": "Updates an HCP organization.", "arguments": [{"name": "organization_id", "description": "The ID of the organization.", "required": true}, {"name": "name", "description": "The new name for the organization.", "required": true}]}, {"name": "list_secrets", "title": "List Secrets", "description": "Lists all secrets for a given application.", "arguments": [{"name": "project_id", "description": "The ID of the project.", "required": true}, {"name": "app_name", "description": "The name of the application.", "required": true}]}, {"name": "get_secret", "title": "Get Secret", "description": "Gets a secret by its name.", "arguments": [{"name": "secret_name", "description": "The name of the secret.", "required": true}, {"name": "project_id", "description": "The ID of the project.", "required": true}, {"name": "app_name", "description": "The name of the application.", "required": true}]}, {"name": "delete_secret", "title": "Delete Secret", "description": "Deletes a secret by its name.", "arguments": [{"name": "secret_name", "description": "The name of the secret.", "required": true}, {"name": "project_id", "description": "The ID of the project.", "required": true}, {"name": "app_name", "description": "The name of the application.", "required": true}]}, {"name": "create_secret", "title": "Create Secret", "description": "Creates a new secret.", "arguments": [{"name": "secret_name", "description": "The name of the new secret.", "required": true}, {"name": "secret_value", "description": "The value of the new secret.", "required": true}, {"name": "project_id", "description": "The ID of the project.", "required": true}, {"name": "app_name", "description": "The name of the application.", "required": true}]}, {"name": "find_project_and_list_secrets", "title": "Find Project and List Secrets", "description": "Finds a project by name and lists its secrets.", "arguments": [{"name": "project_name", "description": "The name of the project.", "required": true}, {"name": "organization_id", "description": "The ID of the organization.", "required": true}, {"name": "app_name", "description": "The name of the application.", "required": true}]}, {"name": "list_resources", "title": "List Resources", "description": "Lists all resources in a project.", "arguments": [{"name": "project_id", "description": "The ID of the project.", "required": true}]}, {"name": "search_logs", "title": "Search Logs", "description": "Searches for audit logs in an organization using LogQL. The LLM should determine the best topic to use based on the user's query, or default to 'hashicorp.platform.audit' if the user is not specific. For advanced filtering, use the `query` parameter with LogQL syntax. To filter on specific JSON fields in the log entries, use the `| json` parser in your query. For example: `query='| json | control_plane_event_action=\"CREATE\"'`", "arguments": [{"name": "organization_id", "description": "The ID of the organization.", "required": true}, {"name": "query", "description": "The LogQL query string for advanced filtering. Can be combined with `project_id` and `topic`. Example: '| json | resource_uuid=\"some-uuid\"'", "required": false}, {"name": "project_id", "description": "A project ID to filter by.", "required": false}, {"name": "topic", "description": "A log topic to search. Example topics: 'hashicorp.platform.audit', 'hashicorp.packer.registry.audit', 'hashicorp.boundary.cluster.audit', 'hashicorp.consul.cluster.audit'", "required": true}, {"name": "start_time", "description": "The start time for the search. Accepts formats like '24 hours ago', 'yesterday at 5pm', or 'Oct 1, 2025'.", "required": true}, {"name": "end_time", "description": "The end time for the search. Accepts formats like 'now', 'today', or 'Oct 3, 2025'.", "required": true}]}]}, "id": 1}
2025-10-14 10:45:28,436 - mcp_server - INFO - Received request: {"method": "tools/list", "params": {}, "jsonrpc": "2.0", "id": 2}
2025-10-14 10:45:28,436 - mcp_server - INFO - Request data: stdio_main: {'jsonrpc': '2.0', 'result': {'tools': [{'name': 'list_projects', 'description': 'Lists all HCP projects for a given organization.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}}, 'required': ['organization_id']}}, {'name': 'get_project', 'description': 'Gets an HCP project by its ID.', 'inputSchema': {'type': 'object', 'properties': {'project_id': {'type': 'string', 'description': 'The ID of the project.'}}, 'required': ['project_id']}}, {'name': 'delete_project', 'description': 'Deletes an HCP project by its ID.', 'inputSchema': {'type': 'object', 'properties': {'project_id': {'type': 'string', 'description': 'The ID of the project.'}}, 'required': ['project_id']}}, {'name': 'create_project', 'description': 'Creates a new HCP project.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'name': {'type': 'string', 'description': 'The name of the new project.'}}, 'required': ['organization_id', 'name']}}, {'name': 'update_project', 'description': 'Updates an HCP project.', 'inputSchema': {'type': 'object', 'properties': {'project_id': {'type': 'string', 'description': 'The ID of the project.'}, 'name': {'type': 'string', 'description': 'The new name of the project.'}}, 'required': ['project_id', 'name']}}, {'name': 'get_organization', 'description': 'Gets an HCP organization by its ID.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}}, 'required': ['organization_id']}}, {'name': 'list_organizations', 'description': 'Lists all HCP organizations.', 'inputSchema': {'type': 'object', 'properties': {}}}, {'name': 'update_organization', 'description': 'Updates an HCP organization.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'name': {'type': 'string', 'description': 'The new name of the organization.'}}, 'required': ['organization_id', 'name']}}, {'name': 'search_principals', 'description': 'Searches for principals in an organization.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'filter_str': {'type': 'string', 'description': 'The filter string to use for the search.'}}, 'required': ['organization_id']}}, {'name': 'get_principals', 'description': 'Gets principals by their IDs.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'principal_ids': {'type': 'array', 'items': {'type': 'string'}, 'description': 'The IDs of the principals to get.'}}, 'required': ['organization_id', 'principal_ids']}}, {'name': 'delete_service_principal', 'description': 'Deletes a service principal by its ID.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'principal_id': {'type': 'string', 'description': 'The ID of the service principal.'}}, 'required': ['organization_id', 'principal_id']}}, {'name': 'create_service_principal', 'description': 'Creates a new service principal.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'name': {'type': 'string', 'description': 'The name of the new service principal.'}}, 'required': ['organization_id', 'name']}}, {'name': 'update_service_principal', 'description': 'Updates a service principal.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'principal_id': {'type': 'string', 'description': 'The ID of the service principal.'}, 'name': {'type': 'string', 'description': 'The new name of the service principal.'}}, 'required': ['organization_id', 'principal_id', 'name']}}, {'name': 'list_secrets', 'description': 'Lists all secrets for a given application.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'project_id': {'type': 'string', 'description': 'The ID of the project.'}, 'app_name': {'type': 'string', 'description': 'The name of the application.'}}, 'required': ['organization_id', 'project_id', 'app_name']}}, {'name': 'get_secret', 'description': 'Gets a secret by its name.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'project_id': {'type': 'string', 'description': 'The ID of the project.'}, 'app_name': {'type': 'string', 'description': 'The name of the application.'}, 'secret_name': {'type': 'string', 'description': 'The name of the secret.'}}, 'required': ['organization_id', 'project_id', 'app_name', 'secret_name']}}, {'name': 'delete_secret', 'description': 'Deletes a secret by its name.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'project_id': {'type': 'string', 'description': 'The ID of the project.'}, 'app_name': {'type': 'string', 'description': 'The name of the application.'}, 'secret_name': {'type': 'string', 'description': 'The name of the secret.'}}, 'required': ['organization_id', 'project_id', 'app_name', 'secret_name']}}, {'name': 'create_secret', 'description': 'Creates a new secret.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'project_id': {'type': 'string', 'description': 'The ID of the project.'}, 'app_name': {'type': 'string', 'description': 'The name of the application.'}, 'secret_name': {'type': 'string', 'description': 'The name of the new secret.'}, 'secret_value': {'type': 'string', 'description': 'The value of the new secret.'}}, 'required': ['organization_id', 'project_id', 'app_name', 'secret_name', 'secret_value']}}, {'name': 'find_project_by_name', 'description': 'Finds a project by its name.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'name': {'type': 'string', 'description': 'The name of the project.'}}, 'required': ['organization_id', 'name']}}, {'name': 'find_user_by_email', 'description': 'Finds a user by their email.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'email': {'type': 'string', 'description': 'The email of the user.'}}, 'required': ['organization_id', 'email']}}, {'name': 'find_organization_by_name', 'description': 'Finds an organization by its name.', 'inputSchema': {'type': 'object', 'properties': {'name': {'type': 'string', 'description': 'The name of the organization.'}}, 'required': ['name']}}, {'name': 'list_resources', 'description': 'Lists all resources in a project.', 'inputSchema': {'type': 'object', 'properties': {'project_id': {'type': 'string', 'description': 'The ID of the project.'}}, 'required': ['project_id']}}, {'name': 'search_logs', 'description': 'Searches for audit logs in an organization using LogQL. At least one of `query`, `project_id`, or `topic` must be provided. For advanced filtering, use the `query` parameter with LogQL syntax. To filter on specific JSON fields in the log entries, use the `| json` parser in your query. For example: `query=\'| json | control_plane_event_action="CREATE"\'`', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'query': {'type': 'string', 'description': 'The LogQL query string for advanced filtering. Can be combined with `project_id` and `topic`. Example: \'| json | resource_uuid="some-uuid"\''}, 'project_id': {'type': 'string', 'description': 'A project ID to filter by.'}, 'topic': {'type': 'string', 'description': "A log topic to search. Example topics: 'hashicorp.platform.audit', 'hashicorp.packer.registry.audit', 'hashicorp.boundary.cluster.audit', 'hashicorp.consul.cluster.audit'"}, 'start_time': {'type': 'string', 'description': "The start time for the search. Accepts formats like '24 hours ago', 'yesterday at 5pm', or 'Oct 1, 2025'."}, 'end_time': {'type': 'string', 'description': "The end time for the search. Accepts formats like 'now', 'today', or 'Oct 3, 2025'."}}, 'required': ['organization_id', 'start_time', 'end_time']}}]}, 'id': 2}
2025-10-14 10:45:28,436 - mcp_server - INFO - Request data: stdio_main json: {"jsonrpc": "2.0", "result": {"tools": [{"name": "list_projects", "description": "Lists all HCP projects for a given organization.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}}, "required": ["organization_id"]}}, {"name": "get_project", "description": "Gets an HCP project by its ID.", "inputSchema": {"type": "object", "properties": {"project_id": {"type": "string", "description": "The ID of the project."}}, "required": ["project_id"]}}, {"name": "delete_project", "description": "Deletes an HCP project by its ID.", "inputSchema": {"type": "object", "properties": {"project_id": {"type": "string", "description": "The ID of the project."}}, "required": ["project_id"]}}, {"name": "create_project", "description": "Creates a new HCP project.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "name": {"type": "string", "description": "The name of the new project."}}, "required": ["organization_id", "name"]}}, {"name": "update_project", "description": "Updates an HCP project.", "inputSchema": {"type": "object", "properties": {"project_id": {"type": "string", "description": "The ID of the project."}, "name": {"type": "string", "description": "The new name of the project."}}, "required": ["project_id", "name"]}}, {"name": "get_organization", "description": "Gets an HCP organization by its ID.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}}, "required": ["organization_id"]}}, {"name": "list_organizations", "description": "Lists all HCP organizations.", "inputSchema": {"type": "object", "properties": {}}}, {"name": "update_organization", "description": "Updates an HCP organization.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "name": {"type": "string", "description": "The new name of the organization."}}, "required": ["organization_id", "name"]}}, {"name": "search_principals", "description": "Searches for principals in an organization.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "filter_str": {"type": "string", "description": "The filter string to use for the search."}}, "required": ["organization_id"]}}, {"name": "get_principals", "description": "Gets principals by their IDs.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "principal_ids": {"type": "array", "items": {"type": "string"}, "description": "The IDs of the principals to get."}}, "required": ["organization_id", "principal_ids"]}}, {"name": "delete_service_principal", "description": "Deletes a service principal by its ID.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "principal_id": {"type": "string", "description": "The ID of the service principal."}}, "required": ["organization_id", "principal_id"]}}, {"name": "create_service_principal", "description": "Creates a new service principal.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "name": {"type": "string", "description": "The name of the new service principal."}}, "required": ["organization_id", "name"]}}, {"name": "update_service_principal", "description": "Updates a service principal.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "principal_id": {"type": "string", "description": "The ID of the service principal."}, "name": {"type": "string", "description": "The new name of the service principal."}}, "required": ["organization_id", "principal_id", "name"]}}, {"name": "list_secrets", "description": "Lists all secrets for a given application.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "project_id": {"type": "string", "description": "The ID of the project."}, "app_name": {"type": "string", "description": "The name of the application."}}, "required": ["organization_id", "project_id", "app_name"]}}, {"name": "get_secret", "description": "Gets a secret by its name.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "project_id": {"type": "string", "description": "The ID of the project."}, "app_name": {"type": "string", "description": "The name of the application."}, "secret_name": {"type": "string", "description": "The name of the secret."}}, "required": ["organization_id", "project_id", "app_name", "secret_name"]}}, {"name": "delete_secret", "description": "Deletes a secret by its name.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "project_id": {"type": "string", "description": "The ID of the project."}, "app_name": {"type": "string", "description": "The name of the application."}, "secret_name": {"type": "string", "description": "The name of the secret."}}, "required": ["organization_id", "project_id", "app_name", "secret_name"]}}, {"name": "create_secret", "description": "Creates a new secret.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "project_id": {"type": "string", "description": "The ID of the project."}, "app_name": {"type": "string", "description": "The name of the application."}, "secret_name": {"type": "string", "description": "The name of the new secret."}, "secret_value": {"type": "string", "description": "The value of the new secret."}}, "required": ["organization_id", "project_id", "app_name", "secret_name", "secret_value"]}}, {"name": "find_project_by_name", "description": "Finds a project by its name.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "name": {"type": "string", "description": "The name of the project."}}, "required": ["organization_id", "name"]}}, {"name": "find_user_by_email", "description": "Finds a user by their email.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "email": {"type": "string", "description": "The email of the user."}}, "required": ["organization_id", "email"]}}, {"name": "find_organization_by_name", "description": "Finds an organization by its name.", "inputSchema": {"type": "object", "properties": {"name": {"type": "string", "description": "The name of the organization."}}, "required": ["name"]}}, {"name": "list_resources", "description": "Lists all resources in a project.", "inputSchema": {"type": "object", "properties": {"project_id": {"type": "string", "description": "The ID of the project."}}, "required": ["project_id"]}}, {"name": "search_logs", "description": "Searches for audit logs in an organization using LogQL. At least one of `query`, `project_id`, or `topic` must be provided. For advanced filtering, use the `query` parameter with LogQL syntax. To filter on specific JSON fields in the log entries, use the `| json` parser in your query. For example: `query='| json | control_plane_event_action=\"CREATE\"'`", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "query": {"type": "string", "description": "The LogQL query string for advanced filtering. Can be combined with `project_id` and `topic`. Example: '| json | resource_uuid=\"some-uuid\"'"}, "project_id": {"type": "string", "description": "A project ID to filter by."}, "topic": {"type": "string", "description": "A log topic to search. Example topics: 'hashicorp.platform.audit', 'hashicorp.packer.registry.audit', 'hashicorp.boundary.cluster.audit', 'hashicorp.consul.cluster.audit'"}, "start_time": {"type": "string", "description": "The start time for the search. Accepts formats like '24 hours ago', 'yesterday at 5pm', or 'Oct 1, 2025'."}, "end_time": {"type": "string", "description": "The end time for the search. Accepts formats like 'now', 'today', or 'Oct 3, 2025'."}}, "required": ["organization_id", "start_time", "end_time"]}}]}, "id": 2}
2025-10-14 10:46:23,877 - mcp_server - INFO - Client call: {"method": "tools/call", "params": {"name": "search_logs", "arguments": {"start_time": "8 days ago", "end_time": "now", "organization_id": "11eab4a9-75f1-e0a5-8be1-0242ac110016"}}, "jsonrpc": "2.0", "id": 3}
2025-10-14 10:46:24,785 - mcp_server - INFO - Request data: stdio_main: {'jsonrpc': '2.0', 'error': {'code': -32000, 'message': 'Server error', 'data': 'A query, project_id, or topic must be provided to search logs.'}, 'id': 3}
2025-10-14 10:46:24,785 - mcp_server - INFO - Request data: stdio_main json: {"jsonrpc": "2.0", "error": {"code": -32000, "message": "Server error", "data": "A query, project_id, or topic must be provided to search logs."}, "id": 3}
2025-10-14 10:49:21,154 - mcp_server - INFO - Received request: {"method": "initialize", "params": {"protocolVersion": "2025-06-18", "capabilities": {"roots": {}}, "clientInfo": {"name": "gemini-cli-mcp-client-HCP", "version": "0.0.1"}}, "jsonrpc": "2.0", "id": 0}
2025-10-14 10:49:21,154 - mcp_server - INFO - Request data: stdio_main: {'jsonrpc': '2.0', 'result': {'protocolVersion': '2024-11-05', 'serverInfo': {'name': 'HCP', 'version': '0.0.1'}, 'capabilities': {'tools': {'listChanged': True}, 'prompts': {'listChanged': True}, 'resources': {'listChanged': True}}}, 'id': 0}
2025-10-14 10:49:21,154 - mcp_server - INFO - Request data: stdio_main json: {"jsonrpc": "2.0", "result": {"protocolVersion": "2024-11-05", "serverInfo": {"name": "HCP", "version": "0.0.1"}, "capabilities": {"tools": {"listChanged": true}, "prompts": {"listChanged": true}, "resources": {"listChanged": true}}}, "id": 0}
2025-10-14 10:49:21,155 - mcp_server - INFO - Received request: {"method": "notifications/initialized", "jsonrpc": "2.0"}
2025-10-14 10:49:21,155 - mcp_server - INFO - Client initialized.
2025-10-14 10:49:21,155 - mcp_server - INFO - Received request: {"method": "prompts/list", "params": {}, "jsonrpc": "2.0", "id": 1}
2025-10-14 10:49:21,155 - mcp_server - INFO - Request data: stdio_main: {'jsonrpc': '2.0', 'result': {'prompts': [{'name': 'list_projects', 'title': 'List Projects', 'description': 'Lists all HCP projects for a given organization.', 'arguments': [{'name': 'organization_id', 'description': 'The ID of the organization.', 'required': True}]}, {'name': 'get_project', 'title': 'Get Project', 'description': 'Gets an HCP project by its ID.', 'arguments': [{'name': 'project_id', 'description': 'The ID of the project.', 'required': True}]}, {'name': 'delete_project', 'title': 'Delete Project', 'description': 'Deletes an HCP project by its ID.', 'arguments': [{'name': 'project_id', 'description': 'The ID of the project.', 'required': True}]}, {'name': 'create_project', 'title': 'Create Project', 'description': 'Creates a new HCP project.', 'arguments': [{'name': 'name', 'description': 'The name of the new project.', 'required': True}, {'name': 'organization_id', 'description': 'The ID of the organization.', 'required': True}]}, {'name': 'update_project', 'title': 'Update Project', 'description': 'Updates an HCP project.', 'arguments': [{'name': 'project_id', 'description': 'The ID of the project.', 'required': True}, {'name': 'name', 'description': 'The new name for the project.', 'required': True}, {'name': 'organization_id', 'description': 'The ID of the organization.', 'required': True}]}, {'name': 'get_organization', 'title': 'Get Organization', 'description': 'Gets an HCP organization by its ID.', 'arguments': [{'name': 'organization_id', 'description': 'The ID of the organization.', 'required': True}]}, {'name': 'list_organizations', 'title': 'List Organizations', 'description': 'Lists all HCP organizations.', 'arguments': None}, {'name': 'update_organization', 'title': 'Update Organization', 'description': 'Updates an HCP organization.', 'arguments': [{'name': 'organization_id', 'description': 'The ID of the organization.', 'required': True}, {'name': 'name', 'description': 'The new name for the organization.', 'required': True}]}, {'name': 'list_secrets', 'title': 'List Secrets', 'description': 'Lists all secrets for a given application.', 'arguments': [{'name': 'project_id', 'description': 'The ID of the project.', 'required': True}, {'name': 'app_name', 'description': 'The name of the application.', 'required': True}]}, {'name': 'get_secret', 'title': 'Get Secret', 'description': 'Gets a secret by its name.', 'arguments': [{'name': 'secret_name', 'description': 'The name of the secret.', 'required': True}, {'name': 'project_id', 'description': 'The ID of the project.', 'required': True}, {'name': 'app_name', 'description': 'The name of the application.', 'required': True}]}, {'name': 'delete_secret', 'title': 'Delete Secret', 'description': 'Deletes a secret by its name.', 'arguments': [{'name': 'secret_name', 'description': 'The name of the secret.', 'required': True}, {'name': 'project_id', 'description': 'The ID of the project.', 'required': True}, {'name': 'app_name', 'description': 'The name of the application.', 'required': True}]}, {'name': 'create_secret', 'title': 'Create Secret', 'description': 'Creates a new secret.', 'arguments': [{'name': 'secret_name', 'description': 'The name of the new secret.', 'required': True}, {'name': 'secret_value', 'description': 'The value of the new secret.', 'required': True}, {'name': 'project_id', 'description': 'The ID of the project.', 'required': True}, {'name': 'app_name', 'description': 'The name of the application.', 'required': True}]}, {'name': 'find_project_and_list_secrets', 'title': 'Find Project and List Secrets', 'description': 'Finds a project by name and lists its secrets.', 'arguments': [{'name': 'project_name', 'description': 'The name of the project.', 'required': True}, {'name': 'organization_id', 'description': 'The ID of the organization.', 'required': True}, {'name': 'app_name', 'description': 'The name of the application.', 'required': True}]}, {'name': 'list_resources', 'title': 'List Resources', 'description': 'Lists all resources in a project.', 'arguments': [{'name': 'project_id', 'description': 'The ID of the project.', 'required': True}]}, {'name': 'search_logs', 'title': 'Search Logs', 'description': 'Searches for audit logs in an organization using LogQL. The LLM should determine the best topic to use based on the user\'s query, or default to \'hashicorp.platform.audit\' if the user is not specific. For advanced filtering, use the `query` parameter with LogQL syntax. To filter on specific JSON fields in the log entries, use the `| json` parser in your query. For example: `query=\'| json | control_plane_event_action="CREATE"\'`', 'arguments': [{'name': 'organization_id', 'description': 'The ID of the organization.', 'required': True}, {'name': 'query', 'description': 'The LogQL query string for advanced filtering. Can be combined with `project_id` and `topic`. Example: \'| json | resource_uuid="some-uuid"\'', 'required': False}, {'name': 'project_id', 'description': 'A project ID to filter by.', 'required': False}, {'name': 'topic', 'description': "A log topic to search. Example topics: 'hashicorp.platform.audit', 'hashicorp.packer.registry.audit', 'hashicorp.boundary.cluster.audit', 'hashicorp.consul.cluster.audit'", 'required': True}, {'name': 'start_time', 'description': "The start time for the search. Accepts formats like '24 hours ago', 'yesterday at 5pm', or 'Oct 1, 2025'.", 'required': True}, {'name': 'end_time', 'description': "The end time for the search. Accepts formats like 'now', 'today', or 'Oct 3, 2025'.", 'required': True}]}]}, 'id': 1}
2025-10-14 10:49:21,155 - mcp_server - INFO - Request data: stdio_main json: {"jsonrpc": "2.0", "result": {"prompts": [{"name": "list_projects", "title": "List Projects", "description": "Lists all HCP projects for a given organization.", "arguments": [{"name": "organization_id", "description": "The ID of the organization.", "required": true}]}, {"name": "get_project", "title": "Get Project", "description": "Gets an HCP project by its ID.", "arguments": [{"name": "project_id", "description": "The ID of the project.", "required": true}]}, {"name": "delete_project", "title": "Delete Project", "description": "Deletes an HCP project by its ID.", "arguments": [{"name": "project_id", "description": "The ID of the project.", "required": true}]}, {"name": "create_project", "title": "Create Project", "description": "Creates a new HCP project.", "arguments": [{"name": "name", "description": "The name of the new project.", "required": true}, {"name": "organization_id", "description": "The ID of the organization.", "required": true}]}, {"name": "update_project", "title": "Update Project", "description": "Updates an HCP project.", "arguments": [{"name": "project_id", "description": "The ID of the project.", "required": true}, {"name": "name", "description": "The new name for the project.", "required": true}, {"name": "organization_id", "description": "The ID of the organization.", "required": true}]}, {"name": "get_organization", "title": "Get Organization", "description": "Gets an HCP organization by its ID.", "arguments": [{"name": "organization_id", "description": "The ID of the organization.", "required": true}]}, {"name": "list_organizations", "title": "List Organizations", "description": "Lists all HCP organizations.", "arguments": null}, {"name": "update_organization", "title": "Update Organization", "description": "Updates an HCP organization.", "arguments": [{"name": "organization_id", "description": "The ID of the organization.", "required": true}, {"name": "name", "description": "The new name for the organization.", "required": true}]}, {"name": "list_secrets", "title": "List Secrets", "description": "Lists all secrets for a given application.", "arguments": [{"name": "project_id", "description": "The ID of the project.", "required": true}, {"name": "app_name", "description": "The name of the application.", "required": true}]}, {"name": "get_secret", "title": "Get Secret", "description": "Gets a secret by its name.", "arguments": [{"name": "secret_name", "description": "The name of the secret.", "required": true}, {"name": "project_id", "description": "The ID of the project.", "required": true}, {"name": "app_name", "description": "The name of the application.", "required": true}]}, {"name": "delete_secret", "title": "Delete Secret", "description": "Deletes a secret by its name.", "arguments": [{"name": "secret_name", "description": "The name of the secret.", "required": true}, {"name": "project_id", "description": "The ID of the project.", "required": true}, {"name": "app_name", "description": "The name of the application.", "required": true}]}, {"name": "create_secret", "title": "Create Secret", "description": "Creates a new secret.", "arguments": [{"name": "secret_name", "description": "The name of the new secret.", "required": true}, {"name": "secret_value", "description": "The value of the new secret.", "required": true}, {"name": "project_id", "description": "The ID of the project.", "required": true}, {"name": "app_name", "description": "The name of the application.", "required": true}]}, {"name": "find_project_and_list_secrets", "title": "Find Project and List Secrets", "description": "Finds a project by name and lists its secrets.", "arguments": [{"name": "project_name", "description": "The name of the project.", "required": true}, {"name": "organization_id", "description": "The ID of the organization.", "required": true}, {"name": "app_name", "description": "The name of the application.", "required": true}]}, {"name": "list_resources", "title": "List Resources", "description": "Lists all resources in a project.", "arguments": [{"name": "project_id", "description": "The ID of the project.", "required": true}]}, {"name": "search_logs", "title": "Search Logs", "description": "Searches for audit logs in an organization using LogQL. The LLM should determine the best topic to use based on the user's query, or default to 'hashicorp.platform.audit' if the user is not specific. For advanced filtering, use the `query` parameter with LogQL syntax. To filter on specific JSON fields in the log entries, use the `| json` parser in your query. For example: `query='| json | control_plane_event_action=\"CREATE\"'`", "arguments": [{"name": "organization_id", "description": "The ID of the organization.", "required": true}, {"name": "query", "description": "The LogQL query string for advanced filtering. Can be combined with `project_id` and `topic`. Example: '| json | resource_uuid=\"some-uuid\"'", "required": false}, {"name": "project_id", "description": "A project ID to filter by.", "required": false}, {"name": "topic", "description": "A log topic to search. Example topics: 'hashicorp.platform.audit', 'hashicorp.packer.registry.audit', 'hashicorp.boundary.cluster.audit', 'hashicorp.consul.cluster.audit'", "required": true}, {"name": "start_time", "description": "The start time for the search. Accepts formats like '24 hours ago', 'yesterday at 5pm', or 'Oct 1, 2025'.", "required": true}, {"name": "end_time", "description": "The end time for the search. Accepts formats like 'now', 'today', or 'Oct 3, 2025'.", "required": true}]}]}, "id": 1}
2025-10-14 10:49:21,155 - mcp_server - INFO - Received request: {"method": "tools/list", "params": {}, "jsonrpc": "2.0", "id": 2}
2025-10-14 10:49:21,156 - mcp_server - INFO - Request data: stdio_main: {'jsonrpc': '2.0', 'result': {'tools': [{'name': 'list_projects', 'description': 'Lists all HCP projects for a given organization.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}}, 'required': ['organization_id']}}, {'name': 'get_project', 'description': 'Gets an HCP project by its ID.', 'inputSchema': {'type': 'object', 'properties': {'project_id': {'type': 'string', 'description': 'The ID of the project.'}}, 'required': ['project_id']}}, {'name': 'delete_project', 'description': 'Deletes an HCP project by its ID.', 'inputSchema': {'type': 'object', 'properties': {'project_id': {'type': 'string', 'description': 'The ID of the project.'}}, 'required': ['project_id']}}, {'name': 'create_project', 'description': 'Creates a new HCP project.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'name': {'type': 'string', 'description': 'The name of the new project.'}}, 'required': ['organization_id', 'name']}}, {'name': 'update_project', 'description': 'Updates an HCP project.', 'inputSchema': {'type': 'object', 'properties': {'project_id': {'type': 'string', 'description': 'The ID of the project.'}, 'name': {'type': 'string', 'description': 'The new name of the project.'}}, 'required': ['project_id', 'name']}}, {'name': 'get_organization', 'description': 'Gets an HCP organization by its ID.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}}, 'required': ['organization_id']}}, {'name': 'list_organizations', 'description': 'Lists all HCP organizations.', 'inputSchema': {'type': 'object', 'properties': {}}}, {'name': 'update_organization', 'description': 'Updates an HCP organization.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'name': {'type': 'string', 'description': 'The new name of the organization.'}}, 'required': ['organization_id', 'name']}}, {'name': 'search_principals', 'description': 'Searches for principals in an organization.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'filter_str': {'type': 'string', 'description': 'The filter string to use for the search.'}}, 'required': ['organization_id']}}, {'name': 'get_principals', 'description': 'Gets principals by their IDs.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'principal_ids': {'type': 'array', 'items': {'type': 'string'}, 'description': 'The IDs of the principals to get.'}}, 'required': ['organization_id', 'principal_ids']}}, {'name': 'delete_service_principal', 'description': 'Deletes a service principal by its ID.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'principal_id': {'type': 'string', 'description': 'The ID of the service principal.'}}, 'required': ['organization_id', 'principal_id']}}, {'name': 'create_service_principal', 'description': 'Creates a new service principal.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'name': {'type': 'string', 'description': 'The name of the new service principal.'}}, 'required': ['organization_id', 'name']}}, {'name': 'update_service_principal', 'description': 'Updates a service principal.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'principal_id': {'type': 'string', 'description': 'The ID of the service principal.'}, 'name': {'type': 'string', 'description': 'The new name of the service principal.'}}, 'required': ['organization_id', 'principal_id', 'name']}}, {'name': 'list_secrets', 'description': 'Lists all secrets for a given application.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'project_id': {'type': 'string', 'description': 'The ID of the project.'}, 'app_name': {'type': 'string', 'description': 'The name of the application.'}}, 'required': ['organization_id', 'project_id', 'app_name']}}, {'name': 'get_secret', 'description': 'Gets a secret by its name.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'project_id': {'type': 'string', 'description': 'The ID of the project.'}, 'app_name': {'type': 'string', 'description': 'The name of the application.'}, 'secret_name': {'type': 'string', 'description': 'The name of the secret.'}}, 'required': ['organization_id', 'project_id', 'app_name', 'secret_name']}}, {'name': 'delete_secret', 'description': 'Deletes a secret by its name.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'project_id': {'type': 'string', 'description': 'The ID of the project.'}, 'app_name': {'type': 'string', 'description': 'The name of the application.'}, 'secret_name': {'type': 'string', 'description': 'The name of the secret.'}}, 'required': ['organization_id', 'project_id', 'app_name', 'secret_name']}}, {'name': 'create_secret', 'description': 'Creates a new secret.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'project_id': {'type': 'string', 'description': 'The ID of the project.'}, 'app_name': {'type': 'string', 'description': 'The name of the application.'}, 'secret_name': {'type': 'string', 'description': 'The name of the new secret.'}, 'secret_value': {'type': 'string', 'description': 'The value of the new secret.'}}, 'required': ['organization_id', 'project_id', 'app_name', 'secret_name', 'secret_value']}}, {'name': 'find_project_by_name', 'description': 'Finds a project by its name.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'name': {'type': 'string', 'description': 'The name of the project.'}}, 'required': ['organization_id', 'name']}}, {'name': 'find_user_by_email', 'description': 'Finds a user by their email.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'email': {'type': 'string', 'description': 'The email of the user.'}}, 'required': ['organization_id', 'email']}}, {'name': 'find_organization_by_name', 'description': 'Finds an organization by its name.', 'inputSchema': {'type': 'object', 'properties': {'name': {'type': 'string', 'description': 'The name of the organization.'}}, 'required': ['name']}}, {'name': 'list_resources', 'description': 'Lists all resources in a project.', 'inputSchema': {'type': 'object', 'properties': {'project_id': {'type': 'string', 'description': 'The ID of the project.'}}, 'required': ['project_id']}}, {'name': 'search_logs', 'description': 'Searches for audit logs in an organization using LogQL. At least one of `query`, `project_id`, or `topic` must be provided. For advanced filtering, use the `query` parameter with LogQL syntax. To filter on specific JSON fields in the log entries, use the `| json` parser in your query. For example: `query=\'| json | control_plane_event_action="CREATE"\'`', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'query': {'type': 'string', 'description': 'The LogQL query string for advanced filtering. Can be combined with `project_id` and `topic`. Example: \'| json | resource_uuid="some-uuid"\''}, 'project_id': {'type': 'string', 'description': 'A project ID to filter by.'}, 'topic': {'type': 'string', 'description': "A log topic to search. Example topics: 'hashicorp.platform.audit', 'hashicorp.packer.registry.audit', 'hashicorp.boundary.cluster.audit', 'hashicorp.consul.cluster.audit'"}, 'start_time': {'type': 'string', 'description': "The start time for the search. Accepts formats like '24 hours ago', 'yesterday at 5pm', or 'Oct 1, 2025'."}, 'end_time': {'type': 'string', 'description': "The end time for the search. Accepts formats like 'now', 'today', or 'Oct 3, 2025'."}}, 'required': ['organization_id', 'start_time', 'end_time']}}]}, 'id': 2}
2025-10-14 10:49:21,156 - mcp_server - INFO - Request data: stdio_main json: {"jsonrpc": "2.0", "result": {"tools": [{"name": "list_projects", "description": "Lists all HCP projects for a given organization.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}}, "required": ["organization_id"]}}, {"name": "get_project", "description": "Gets an HCP project by its ID.", "inputSchema": {"type": "object", "properties": {"project_id": {"type": "string", "description": "The ID of the project."}}, "required": ["project_id"]}}, {"name": "delete_project", "description": "Deletes an HCP project by its ID.", "inputSchema": {"type": "object", "properties": {"project_id": {"type": "string", "description": "The ID of the project."}}, "required": ["project_id"]}}, {"name": "create_project", "description": "Creates a new HCP project.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "name": {"type": "string", "description": "The name of the new project."}}, "required": ["organization_id", "name"]}}, {"name": "update_project", "description": "Updates an HCP project.", "inputSchema": {"type": "object", "properties": {"project_id": {"type": "string", "description": "The ID of the project."}, "name": {"type": "string", "description": "The new name of the project."}}, "required": ["project_id", "name"]}}, {"name": "get_organization", "description": "Gets an HCP organization by its ID.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}}, "required": ["organization_id"]}}, {"name": "list_organizations", "description": "Lists all HCP organizations.", "inputSchema": {"type": "object", "properties": {}}}, {"name": "update_organization", "description": "Updates an HCP organization.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "name": {"type": "string", "description": "The new name of the organization."}}, "required": ["organization_id", "name"]}}, {"name": "search_principals", "description": "Searches for principals in an organization.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "filter_str": {"type": "string", "description": "The filter string to use for the search."}}, "required": ["organization_id"]}}, {"name": "get_principals", "description": "Gets principals by their IDs.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "principal_ids": {"type": "array", "items": {"type": "string"}, "description": "The IDs of the principals to get."}}, "required": ["organization_id", "principal_ids"]}}, {"name": "delete_service_principal", "description": "Deletes a service principal by its ID.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "principal_id": {"type": "string", "description": "The ID of the service principal."}}, "required": ["organization_id", "principal_id"]}}, {"name": "create_service_principal", "description": "Creates a new service principal.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "name": {"type": "string", "description": "The name of the new service principal."}}, "required": ["organization_id", "name"]}}, {"name": "update_service_principal", "description": "Updates a service principal.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "principal_id": {"type": "string", "description": "The ID of the service principal."}, "name": {"type": "string", "description": "The new name of the service principal."}}, "required": ["organization_id", "principal_id", "name"]}}, {"name": "list_secrets", "description": "Lists all secrets for a given application.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "project_id": {"type": "string", "description": "The ID of the project."}, "app_name": {"type": "string", "description": "The name of the application."}}, "required": ["organization_id", "project_id", "app_name"]}}, {"name": "get_secret", "description": "Gets a secret by its name.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "project_id": {"type": "string", "description": "The ID of the project."}, "app_name": {"type": "string", "description": "The name of the application."}, "secret_name": {"type": "string", "description": "The name of the secret."}}, "required": ["organization_id", "project_id", "app_name", "secret_name"]}}, {"name": "delete_secret", "description": "Deletes a secret by its name.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "project_id": {"type": "string", "description": "The ID of the project."}, "app_name": {"type": "string", "description": "The name of the application."}, "secret_name": {"type": "string", "description": "The name of the secret."}}, "required": ["organization_id", "project_id", "app_name", "secret_name"]}}, {"name": "create_secret", "description": "Creates a new secret.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "project_id": {"type": "string", "description": "The ID of the project."}, "app_name": {"type": "string", "description": "The name of the application."}, "secret_name": {"type": "string", "description": "The name of the new secret."}, "secret_value": {"type": "string", "description": "The value of the new secret."}}, "required": ["organization_id", "project_id", "app_name", "secret_name", "secret_value"]}}, {"name": "find_project_by_name", "description": "Finds a project by its name.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "name": {"type": "string", "description": "The name of the project."}}, "required": ["organization_id", "name"]}}, {"name": "find_user_by_email", "description": "Finds a user by their email.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "email": {"type": "string", "description": "The email of the user."}}, "required": ["organization_id", "email"]}}, {"name": "find_organization_by_name", "description": "Finds an organization by its name.", "inputSchema": {"type": "object", "properties": {"name": {"type": "string", "description": "The name of the organization."}}, "required": ["name"]}}, {"name": "list_resources", "description": "Lists all resources in a project.", "inputSchema": {"type": "object", "properties": {"project_id": {"type": "string", "description": "The ID of the project."}}, "required": ["project_id"]}}, {"name": "search_logs", "description": "Searches for audit logs in an organization using LogQL. At least one of `query`, `project_id`, or `topic` must be provided. For advanced filtering, use the `query` parameter with LogQL syntax. To filter on specific JSON fields in the log entries, use the `| json` parser in your query. For example: `query='| json | control_plane_event_action=\"CREATE\"'`", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "query": {"type": "string", "description": "The LogQL query string for advanced filtering. Can be combined with `project_id` and `topic`. Example: '| json | resource_uuid=\"some-uuid\"'"}, "project_id": {"type": "string", "description": "A project ID to filter by."}, "topic": {"type": "string", "description": "A log topic to search. Example topics: 'hashicorp.platform.audit', 'hashicorp.packer.registry.audit', 'hashicorp.boundary.cluster.audit', 'hashicorp.consul.cluster.audit'"}, "start_time": {"type": "string", "description": "The start time for the search. Accepts formats like '24 hours ago', 'yesterday at 5pm', or 'Oct 1, 2025'."}, "end_time": {"type": "string", "description": "The end time for the search. Accepts formats like 'now', 'today', or 'Oct 3, 2025'."}}, "required": ["organization_id", "start_time", "end_time"]}}]}, "id": 2}
2025-10-14 10:59:06,386 - mcp_server - INFO - Received request: {"method": "initialize", "params": {"protocolVersion": "2025-06-18", "capabilities": {"roots": {}}, "clientInfo": {"name": "gemini-cli-mcp-client-HCP", "version": "0.0.1"}}, "jsonrpc": "2.0", "id": 0}
2025-10-14 10:59:06,386 - mcp_server - INFO - Request data: stdio_main: {'jsonrpc': '2.0', 'result': {'protocolVersion': '2024-11-05', 'serverInfo': {'name': 'HCP', 'version': '0.0.1'}, 'capabilities': {'tools': {'listChanged': True}, 'prompts': {'listChanged': True}, 'resources': {'listChanged': True}}}, 'id': 0}
2025-10-14 10:59:06,386 - mcp_server - INFO - Request data: stdio_main json: {"jsonrpc": "2.0", "result": {"protocolVersion": "2024-11-05", "serverInfo": {"name": "HCP", "version": "0.0.1"}, "capabilities": {"tools": {"listChanged": true}, "prompts": {"listChanged": true}, "resources": {"listChanged": true}}}, "id": 0}
2025-10-14 10:59:06,386 - mcp_server - INFO - Received request: {"method": "notifications/initialized", "jsonrpc": "2.0"}
2025-10-14 10:59:06,386 - mcp_server - INFO - Client initialized.
2025-10-14 10:59:06,386 - mcp_server - INFO - Received request: {"method": "prompts/list", "params": {}, "jsonrpc": "2.0", "id": 1}
2025-10-14 10:59:06,387 - mcp_server - INFO - Request data: stdio_main: {'jsonrpc': '2.0', 'result': {'prompts': [{'name': 'list_projects', 'title': 'List Projects', 'description': 'Lists all HCP projects for a given organization.', 'arguments': [{'name': 'organization_id', 'description': 'The ID of the organization.', 'required': True}]}, {'name': 'get_project', 'title': 'Get Project', 'description': 'Gets an HCP project by its ID.', 'arguments': [{'name': 'project_id', 'description': 'The ID of the project.', 'required': True}]}, {'name': 'delete_project', 'title': 'Delete Project', 'description': 'Deletes an HCP project by its ID.', 'arguments': [{'name': 'project_id', 'description': 'The ID of the project.', 'required': True}]}, {'name': 'create_project', 'title': 'Create Project', 'description': 'Creates a new HCP project.', 'arguments': [{'name': 'name', 'description': 'The name of the new project.', 'required': True}, {'name': 'organization_id', 'description': 'The ID of the organization.', 'required': True}]}, {'name': 'update_project', 'title': 'Update Project', 'description': 'Updates an HCP project.', 'arguments': [{'name': 'project_id', 'description': 'The ID of the project.', 'required': True}, {'name': 'name', 'description': 'The new name for the project.', 'required': True}, {'name': 'organization_id', 'description': 'The ID of the organization.', 'required': True}]}, {'name': 'get_organization', 'title': 'Get Organization', 'description': 'Gets an HCP organization by its ID.', 'arguments': [{'name': 'organization_id', 'description': 'The ID of the organization.', 'required': True}]}, {'name': 'list_organizations', 'title': 'List Organizations', 'description': 'Lists all HCP organizations.', 'arguments': None}, {'name': 'update_organization', 'title': 'Update Organization', 'description': 'Updates an HCP organization.', 'arguments': [{'name': 'organization_id', 'description': 'The ID of the organization.', 'required': True}, {'name': 'name', 'description': 'The new name for the organization.', 'required': True}]}, {'name': 'list_secrets', 'title': 'List Secrets', 'description': 'Lists all secrets for a given application.', 'arguments': [{'name': 'project_id', 'description': 'The ID of the project.', 'required': True}, {'name': 'app_name', 'description': 'The name of the application.', 'required': True}]}, {'name': 'get_secret', 'title': 'Get Secret', 'description': 'Gets a secret by its name.', 'arguments': [{'name': 'secret_name', 'description': 'The name of the secret.', 'required': True}, {'name': 'project_id', 'description': 'The ID of the project.', 'required': True}, {'name': 'app_name', 'description': 'The name of the application.', 'required': True}]}, {'name': 'delete_secret', 'title': 'Delete Secret', 'description': 'Deletes a secret by its name.', 'arguments': [{'name': 'secret_name', 'description': 'The name of the secret.', 'required': True}, {'name': 'project_id', 'description': 'The ID of the project.', 'required': True}, {'name': 'app_name', 'description': 'The name of the application.', 'required': True}]}, {'name': 'create_secret', 'title': 'Create Secret', 'description': 'Creates a new secret.', 'arguments': [{'name': 'secret_name', 'description': 'The name of the new secret.', 'required': True}, {'name': 'secret_value', 'description': 'The value of the new secret.', 'required': True}, {'name': 'project_id', 'description': 'The ID of the project.', 'required': True}, {'name': 'app_name', 'description': 'The name of the application.', 'required': True}]}, {'name': 'find_project_and_list_secrets', 'title': 'Find Project and List Secrets', 'description': 'Finds a project by name and lists its secrets.', 'arguments': [{'name': 'project_name', 'description': 'The name of the project.', 'required': True}, {'name': 'organization_id', 'description': 'The ID of the organization.', 'required': True}, {'name': 'app_name', 'description': 'The name of the application.', 'required': True}]}, {'name': 'list_resources', 'title': 'List Resources', 'description': 'Lists all resources in a project.', 'arguments': [{'name': 'project_id', 'description': 'The ID of the project.', 'required': True}]}, {'name': 'search_logs', 'title': 'Search Logs', 'description': 'Searches for audit logs in an organization using LogQL. The LLM should determine the best topic to use based on the user\'s query, or default to \'hashicorp.platform.audit\' if the user is not specific. For advanced filtering, use the `query` parameter with LogQL syntax. To filter on specific JSON fields in the log entries, use the `| json` parser in your query. For example: `query=\'| json | control_plane_event_action="CREATE"\'`', 'arguments': [{'name': 'organization_id', 'description': 'The ID of the organization.', 'required': True}, {'name': 'query', 'description': 'The LogQL query string for advanced filtering. Can be combined with `project_id` and `topic`. Example: \'| json | resource_uuid="some-uuid"\'', 'required': False}, {'name': 'project_id', 'description': 'A project ID to filter by.', 'required': False}, {'name': 'topic', 'description': "A log topic to search. Example topics: 'hashicorp.platform.audit', 'hashicorp.packer.registry.audit', 'hashicorp.boundary.cluster.audit', 'hashicorp.consul.cluster.audit'", 'required': True}, {'name': 'start_time', 'description': "The start time for the search. Accepts formats like '24 hours ago', 'yesterday at 5pm', or 'Oct 1, 2025'.", 'required': True}, {'name': 'end_time', 'description': "The end time for the search. Accepts formats like 'now', 'today', or 'Oct 3, 2025'.", 'required': True}]}]}, 'id': 1}
2025-10-14 10:59:06,387 - mcp_server - INFO - Request data: stdio_main json: {"jsonrpc": "2.0", "result": {"prompts": [{"name": "list_projects", "title": "List Projects", "description": "Lists all HCP projects for a given organization.", "arguments": [{"name": "organization_id", "description": "The ID of the organization.", "required": true}]}, {"name": "get_project", "title": "Get Project", "description": "Gets an HCP project by its ID.", "arguments": [{"name": "project_id", "description": "The ID of the project.", "required": true}]}, {"name": "delete_project", "title": "Delete Project", "description": "Deletes an HCP project by its ID.", "arguments": [{"name": "project_id", "description": "The ID of the project.", "required": true}]}, {"name": "create_project", "title": "Create Project", "description": "Creates a new HCP project.", "arguments": [{"name": "name", "description": "The name of the new project.", "required": true}, {"name": "organization_id", "description": "The ID of the organization.", "required": true}]}, {"name": "update_project", "title": "Update Project", "description": "Updates an HCP project.", "arguments": [{"name": "project_id", "description": "The ID of the project.", "required": true}, {"name": "name", "description": "The new name for the project.", "required": true}, {"name": "organization_id", "description": "The ID of the organization.", "required": true}]}, {"name": "get_organization", "title": "Get Organization", "description": "Gets an HCP organization by its ID.", "arguments": [{"name": "organization_id", "description": "The ID of the organization.", "required": true}]}, {"name": "list_organizations", "title": "List Organizations", "description": "Lists all HCP organizations.", "arguments": null}, {"name": "update_organization", "title": "Update Organization", "description": "Updates an HCP organization.", "arguments": [{"name": "organization_id", "description": "The ID of the organization.", "required": true}, {"name": "name", "description": "The new name for the organization.", "required": true}]}, {"name": "list_secrets", "title": "List Secrets", "description": "Lists all secrets for a given application.", "arguments": [{"name": "project_id", "description": "The ID of the project.", "required": true}, {"name": "app_name", "description": "The name of the application.", "required": true}]}, {"name": "get_secret", "title": "Get Secret", "description": "Gets a secret by its name.", "arguments": [{"name": "secret_name", "description": "The name of the secret.", "required": true}, {"name": "project_id", "description": "The ID of the project.", "required": true}, {"name": "app_name", "description": "The name of the application.", "required": true}]}, {"name": "delete_secret", "title": "Delete Secret", "description": "Deletes a secret by its name.", "arguments": [{"name": "secret_name", "description": "The name of the secret.", "required": true}, {"name": "project_id", "description": "The ID of the project.", "required": true}, {"name": "app_name", "description": "The name of the application.", "required": true}]}, {"name": "create_secret", "title": "Create Secret", "description": "Creates a new secret.", "arguments": [{"name": "secret_name", "description": "The name of the new secret.", "required": true}, {"name": "secret_value", "description": "The value of the new secret.", "required": true}, {"name": "project_id", "description": "The ID of the project.", "required": true}, {"name": "app_name", "description": "The name of the application.", "required": true}]}, {"name": "find_project_and_list_secrets", "title": "Find Project and List Secrets", "description": "Finds a project by name and lists its secrets.", "arguments": [{"name": "project_name", "description": "The name of the project.", "required": true}, {"name": "organization_id", "description": "The ID of the organization.", "required": true}, {"name": "app_name", "description": "The name of the application.", "required": true}]}, {"name": "list_resources", "title": "List Resources", "description": "Lists all resources in a project.", "arguments": [{"name": "project_id", "description": "The ID of the project.", "required": true}]}, {"name": "search_logs", "title": "Search Logs", "description": "Searches for audit logs in an organization using LogQL. The LLM should determine the best topic to use based on the user's query, or default to 'hashicorp.platform.audit' if the user is not specific. For advanced filtering, use the `query` parameter with LogQL syntax. To filter on specific JSON fields in the log entries, use the `| json` parser in your query. For example: `query='| json | control_plane_event_action=\"CREATE\"'`", "arguments": [{"name": "organization_id", "description": "The ID of the organization.", "required": true}, {"name": "query", "description": "The LogQL query string for advanced filtering. Can be combined with `project_id` and `topic`. Example: '| json | resource_uuid=\"some-uuid\"'", "required": false}, {"name": "project_id", "description": "A project ID to filter by.", "required": false}, {"name": "topic", "description": "A log topic to search. Example topics: 'hashicorp.platform.audit', 'hashicorp.packer.registry.audit', 'hashicorp.boundary.cluster.audit', 'hashicorp.consul.cluster.audit'", "required": true}, {"name": "start_time", "description": "The start time for the search. Accepts formats like '24 hours ago', 'yesterday at 5pm', or 'Oct 1, 2025'.", "required": true}, {"name": "end_time", "description": "The end time for the search. Accepts formats like 'now', 'today', or 'Oct 3, 2025'.", "required": true}]}]}, "id": 1}
2025-10-14 10:59:06,387 - mcp_server - INFO - Received request: {"method": "tools/list", "params": {}, "jsonrpc": "2.0", "id": 2}
2025-10-14 10:59:06,387 - mcp_server - INFO - Request data: stdio_main: {'jsonrpc': '2.0', 'result': {'tools': [{'name': 'list_projects', 'description': 'Lists all HCP projects for a given organization.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}}, 'required': ['organization_id']}}, {'name': 'get_project', 'description': 'Gets an HCP project by its ID.', 'inputSchema': {'type': 'object', 'properties': {'project_id': {'type': 'string', 'description': 'The ID of the project.'}}, 'required': ['project_id']}}, {'name': 'delete_project', 'description': 'Deletes an HCP project by its ID.', 'inputSchema': {'type': 'object', 'properties': {'project_id': {'type': 'string', 'description': 'The ID of the project.'}}, 'required': ['project_id']}}, {'name': 'create_project', 'description': 'Creates a new HCP project.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'name': {'type': 'string', 'description': 'The name of the new project.'}}, 'required': ['organization_id', 'name']}}, {'name': 'update_project', 'description': 'Updates an HCP project.', 'inputSchema': {'type': 'object', 'properties': {'project_id': {'type': 'string', 'description': 'The ID of the project.'}, 'name': {'type': 'string', 'description': 'The new name of the project.'}}, 'required': ['project_id', 'name']}}, {'name': 'get_organization', 'description': 'Gets an HCP organization by its ID.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}}, 'required': ['organization_id']}}, {'name': 'list_organizations', 'description': 'Lists all HCP organizations.', 'inputSchema': {'type': 'object', 'properties': {}}}, {'name': 'update_organization', 'description': 'Updates an HCP organization.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'name': {'type': 'string', 'description': 'The new name of the organization.'}}, 'required': ['organization_id', 'name']}}, {'name': 'search_principals', 'description': 'Searches for principals in an organization.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'filter_str': {'type': 'string', 'description': 'The filter string to use for the search.'}}, 'required': ['organization_id']}}, {'name': 'get_principals', 'description': 'Gets principals by their IDs.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'principal_ids': {'type': 'array', 'items': {'type': 'string'}, 'description': 'The IDs of the principals to get.'}}, 'required': ['organization_id', 'principal_ids']}}, {'name': 'delete_service_principal', 'description': 'Deletes a service principal by its ID.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'principal_id': {'type': 'string', 'description': 'The ID of the service principal.'}}, 'required': ['organization_id', 'principal_id']}}, {'name': 'create_service_principal', 'description': 'Creates a new service principal.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'name': {'type': 'string', 'description': 'The name of the new service principal.'}}, 'required': ['organization_id', 'name']}}, {'name': 'update_service_principal', 'description': 'Updates a service principal.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'principal_id': {'type': 'string', 'description': 'The ID of the service principal.'}, 'name': {'type': 'string', 'description': 'The new name of the service principal.'}}, 'required': ['organization_id', 'principal_id', 'name']}}, {'name': 'list_secrets', 'description': 'Lists all secrets for a given application.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'project_id': {'type': 'string', 'description': 'The ID of the project.'}, 'app_name': {'type': 'string', 'description': 'The name of the application.'}}, 'required': ['organization_id', 'project_id', 'app_name']}}, {'name': 'get_secret', 'description': 'Gets a secret by its name.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'project_id': {'type': 'string', 'description': 'The ID of the project.'}, 'app_name': {'type': 'string', 'description': 'The name of the application.'}, 'secret_name': {'type': 'string', 'description': 'The name of the secret.'}}, 'required': ['organization_id', 'project_id', 'app_name', 'secret_name']}}, {'name': 'delete_secret', 'description': 'Deletes a secret by its name.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'project_id': {'type': 'string', 'description': 'The ID of the project.'}, 'app_name': {'type': 'string', 'description': 'The name of the application.'}, 'secret_name': {'type': 'string', 'description': 'The name of the secret.'}}, 'required': ['organization_id', 'project_id', 'app_name', 'secret_name']}}, {'name': 'create_secret', 'description': 'Creates a new secret.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'project_id': {'type': 'string', 'description': 'The ID of the project.'}, 'app_name': {'type': 'string', 'description': 'The name of the application.'}, 'secret_name': {'type': 'string', 'description': 'The name of the new secret.'}, 'secret_value': {'type': 'string', 'description': 'The value of the new secret.'}}, 'required': ['organization_id', 'project_id', 'app_name', 'secret_name', 'secret_value']}}, {'name': 'find_project_by_name', 'description': 'Finds a project by its name.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'name': {'type': 'string', 'description': 'The name of the project.'}}, 'required': ['organization_id', 'name']}}, {'name': 'find_user_by_email', 'description': 'Finds a user by their email.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'email': {'type': 'string', 'description': 'The email of the user.'}}, 'required': ['organization_id', 'email']}}, {'name': 'find_organization_by_name', 'description': 'Finds an organization by its name.', 'inputSchema': {'type': 'object', 'properties': {'name': {'type': 'string', 'description': 'The name of the organization.'}}, 'required': ['name']}}, {'name': 'list_resources', 'description': 'Lists all resources in a project.', 'inputSchema': {'type': 'object', 'properties': {'project_id': {'type': 'string', 'description': 'The ID of the project.'}}, 'required': ['project_id']}}, {'name': 'search_logs', 'description': 'Searches for audit logs in an organization using LogQL. At least one of `query`, `project_id`, or `topic` must be provided. For advanced filtering, use the `query` parameter with LogQL syntax. To filter on specific JSON fields in the log entries, use the `| json` parser in your query. For example: `query=\'| json | control_plane_event_action="CREATE"\'`', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'query': {'type': 'string', 'description': 'The LogQL query string for advanced filtering. Can be combined with `project_id` and `topic`. Example: \'| json | resource_uuid="some-uuid"\''}, 'project_id': {'type': 'string', 'description': 'A project ID to filter by.'}, 'topic': {'type': 'string', 'description': "A log topic to search. Example topics: 'hashicorp.platform.audit', 'hashicorp.packer.registry.audit', 'hashicorp.boundary.cluster.audit', 'hashicorp.consul.cluster.audit'"}, 'start_time': {'type': 'string', 'description': "The start time for the search. Accepts formats like '24 hours ago', 'yesterday at 5pm', or 'Oct 1, 2025'."}, 'end_time': {'type': 'string', 'description': "The end time for the search. Accepts formats like 'now', 'today', or 'Oct 3, 2025'."}}, 'required': ['organization_id', 'start_time', 'end_time']}}]}, 'id': 2}
2025-10-14 10:59:06,388 - mcp_server - INFO - Request data: stdio_main json: {"jsonrpc": "2.0", "result": {"tools": [{"name": "list_projects", "description": "Lists all HCP projects for a given organization.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}}, "required": ["organization_id"]}}, {"name": "get_project", "description": "Gets an HCP project by its ID.", "inputSchema": {"type": "object", "properties": {"project_id": {"type": "string", "description": "The ID of the project."}}, "required": ["project_id"]}}, {"name": "delete_project", "description": "Deletes an HCP project by its ID.", "inputSchema": {"type": "object", "properties": {"project_id": {"type": "string", "description": "The ID of the project."}}, "required": ["project_id"]}}, {"name": "create_project", "description": "Creates a new HCP project.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "name": {"type": "string", "description": "The name of the new project."}}, "required": ["organization_id", "name"]}}, {"name": "update_project", "description": "Updates an HCP project.", "inputSchema": {"type": "object", "properties": {"project_id": {"type": "string", "description": "The ID of the project."}, "name": {"type": "string", "description": "The new name of the project."}}, "required": ["project_id", "name"]}}, {"name": "get_organization", "description": "Gets an HCP organization by its ID.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}}, "required": ["organization_id"]}}, {"name": "list_organizations", "description": "Lists all HCP organizations.", "inputSchema": {"type": "object", "properties": {}}}, {"name": "update_organization", "description": "Updates an HCP organization.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "name": {"type": "string", "description": "The new name of the organization."}}, "required": ["organization_id", "name"]}}, {"name": "search_principals", "description": "Searches for principals in an organization.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "filter_str": {"type": "string", "description": "The filter string to use for the search."}}, "required": ["organization_id"]}}, {"name": "get_principals", "description": "Gets principals by their IDs.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "principal_ids": {"type": "array", "items": {"type": "string"}, "description": "The IDs of the principals to get."}}, "required": ["organization_id", "principal_ids"]}}, {"name": "delete_service_principal", "description": "Deletes a service principal by its ID.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "principal_id": {"type": "string", "description": "The ID of the service principal."}}, "required": ["organization_id", "principal_id"]}}, {"name": "create_service_principal", "description": "Creates a new service principal.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "name": {"type": "string", "description": "The name of the new service principal."}}, "required": ["organization_id", "name"]}}, {"name": "update_service_principal", "description": "Updates a service principal.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "principal_id": {"type": "string", "description": "The ID of the service principal."}, "name": {"type": "string", "description": "The new name of the service principal."}}, "required": ["organization_id", "principal_id", "name"]}}, {"name": "list_secrets", "description": "Lists all secrets for a given application.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "project_id": {"type": "string", "description": "The ID of the project."}, "app_name": {"type": "string", "description": "The name of the application."}}, "required": ["organization_id", "project_id", "app_name"]}}, {"name": "get_secret", "description": "Gets a secret by its name.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "project_id": {"type": "string", "description": "The ID of the project."}, "app_name": {"type": "string", "description": "The name of the application."}, "secret_name": {"type": "string", "description": "The name of the secret."}}, "required": ["organization_id", "project_id", "app_name", "secret_name"]}}, {"name": "delete_secret", "description": "Deletes a secret by its name.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "project_id": {"type": "string", "description": "The ID of the project."}, "app_name": {"type": "string", "description": "The name of the application."}, "secret_name": {"type": "string", "description": "The name of the secret."}}, "required": ["organization_id", "project_id", "app_name", "secret_name"]}}, {"name": "create_secret", "description": "Creates a new secret.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "project_id": {"type": "string", "description": "The ID of the project."}, "app_name": {"type": "string", "description": "The name of the application."}, "secret_name": {"type": "string", "description": "The name of the new secret."}, "secret_value": {"type": "string", "description": "The value of the new secret."}}, "required": ["organization_id", "project_id", "app_name", "secret_name", "secret_value"]}}, {"name": "find_project_by_name", "description": "Finds a project by its name.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "name": {"type": "string", "description": "The name of the project."}}, "required": ["organization_id", "name"]}}, {"name": "find_user_by_email", "description": "Finds a user by their email.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "email": {"type": "string", "description": "The email of the user."}}, "required": ["organization_id", "email"]}}, {"name": "find_organization_by_name", "description": "Finds an organization by its name.", "inputSchema": {"type": "object", "properties": {"name": {"type": "string", "description": "The name of the organization."}}, "required": ["name"]}}, {"name": "list_resources", "description": "Lists all resources in a project.", "inputSchema": {"type": "object", "properties": {"project_id": {"type": "string", "description": "The ID of the project."}}, "required": ["project_id"]}}, {"name": "search_logs", "description": "Searches for audit logs in an organization using LogQL. At least one of `query`, `project_id`, or `topic` must be provided. For advanced filtering, use the `query` parameter with LogQL syntax. To filter on specific JSON fields in the log entries, use the `| json` parser in your query. For example: `query='| json | control_plane_event_action=\"CREATE\"'`", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "query": {"type": "string", "description": "The LogQL query string for advanced filtering. Can be combined with `project_id` and `topic`. Example: '| json | resource_uuid=\"some-uuid\"'"}, "project_id": {"type": "string", "description": "A project ID to filter by."}, "topic": {"type": "string", "description": "A log topic to search. Example topics: 'hashicorp.platform.audit', 'hashicorp.packer.registry.audit', 'hashicorp.boundary.cluster.audit', 'hashicorp.consul.cluster.audit'"}, "start_time": {"type": "string", "description": "The start time for the search. Accepts formats like '24 hours ago', 'yesterday at 5pm', or 'Oct 1, 2025'."}, "end_time": {"type": "string", "description": "The end time for the search. Accepts formats like 'now', 'today', or 'Oct 3, 2025'."}}, "required": ["organization_id", "start_time", "end_time"]}}]}, "id": 2}
2025-10-14 10:59:19,485 - mcp_server - INFO - Client call: {"method": "tools/call", "params": {"name": "search_logs", "arguments": {"start_time": "1 day ago", "end_time": "now", "organization_id": "11eab4a9-75f1-e0a5-8be1-0242ac110016"}}, "jsonrpc": "2.0", "id": 3}
2025-10-14 10:59:20,046 - mcp_server - INFO - Request data: stdio_main: {'jsonrpc': '2.0', 'error': {'code': -32000, 'message': 'Server error/ValueError', 'data': 'A query, project_id, or topic must be provided to search logs.'}, 'id': 3}
2025-10-14 10:59:20,046 - mcp_server - INFO - Request data: stdio_main json: {"jsonrpc": "2.0", "error": {"code": -32000, "message": "Server error/ValueError", "data": "A query, project_id, or topic must be provided to search logs."}, "id": 3}
2025-10-14 11:04:43,459 - mcp_server - INFO - Received request: {"method": "initialize", "params": {"protocolVersion": "2025-06-18", "capabilities": {"roots": {}}, "clientInfo": {"name": "gemini-cli-mcp-client-HCP", "version": "0.0.1"}}, "jsonrpc": "2.0", "id": 0}
2025-10-14 11:04:43,460 - mcp_server - INFO - Request data: stdio_main: {'jsonrpc': '2.0', 'result': {'protocolVersion': '2024-11-05', 'serverInfo': {'name': 'HCP', 'version': '0.0.1'}, 'capabilities': {'tools': {'listChanged': True}, 'prompts': {'listChanged': True}, 'resources': {'listChanged': True}}}, 'id': 0}
2025-10-14 11:04:43,460 - mcp_server - INFO - Request data: stdio_main json: {"jsonrpc": "2.0", "result": {"protocolVersion": "2024-11-05", "serverInfo": {"name": "HCP", "version": "0.0.1"}, "capabilities": {"tools": {"listChanged": true}, "prompts": {"listChanged": true}, "resources": {"listChanged": true}}}, "id": 0}
2025-10-14 11:04:43,460 - mcp_server - INFO - Received request: {"method": "notifications/initialized", "jsonrpc": "2.0"}
2025-10-14 11:04:43,460 - mcp_server - INFO - Client initialized.
2025-10-14 11:04:43,460 - mcp_server - INFO - Received request: {"method": "prompts/list", "params": {}, "jsonrpc": "2.0", "id": 1}
2025-10-14 11:04:43,460 - mcp_server - INFO - Request data: stdio_main: {'jsonrpc': '2.0', 'result': {'prompts': [{'name': 'list_projects', 'title': 'List Projects', 'description': 'Lists all HCP projects for a given organization.', 'arguments': [{'name': 'organization_id', 'description': 'The ID of the organization.', 'required': True}]}, {'name': 'get_project', 'title': 'Get Project', 'description': 'Gets an HCP project by its ID.', 'arguments': [{'name': 'project_id', 'description': 'The ID of the project.', 'required': True}]}, {'name': 'delete_project', 'title': 'Delete Project', 'description': 'Deletes an HCP project by its ID.', 'arguments': [{'name': 'project_id', 'description': 'The ID of the project.', 'required': True}]}, {'name': 'create_project', 'title': 'Create Project', 'description': 'Creates a new HCP project.', 'arguments': [{'name': 'name', 'description': 'The name of the new project.', 'required': True}, {'name': 'organization_id', 'description': 'The ID of the organization.', 'required': True}]}, {'name': 'update_project', 'title': 'Update Project', 'description': 'Updates an HCP project.', 'arguments': [{'name': 'project_id', 'description': 'The ID of the project.', 'required': True}, {'name': 'name', 'description': 'The new name for the project.', 'required': True}, {'name': 'organization_id', 'description': 'The ID of the organization.', 'required': True}]}, {'name': 'get_organization', 'title': 'Get Organization', 'description': 'Gets an HCP organization by its ID.', 'arguments': [{'name': 'organization_id', 'description': 'The ID of the organization.', 'required': True}]}, {'name': 'list_organizations', 'title': 'List Organizations', 'description': 'Lists all HCP organizations.', 'arguments': None}, {'name': 'update_organization', 'title': 'Update Organization', 'description': 'Updates an HCP organization.', 'arguments': [{'name': 'organization_id', 'description': 'The ID of the organization.', 'required': True}, {'name': 'name', 'description': 'The new name for the organization.', 'required': True}]}, {'name': 'list_secrets', 'title': 'List Secrets', 'description': 'Lists all secrets for a given application.', 'arguments': [{'name': 'project_id', 'description': 'The ID of the project.', 'required': True}, {'name': 'app_name', 'description': 'The name of the application.', 'required': True}]}, {'name': 'get_secret', 'title': 'Get Secret', 'description': 'Gets a secret by its name.', 'arguments': [{'name': 'secret_name', 'description': 'The name of the secret.', 'required': True}, {'name': 'project_id', 'description': 'The ID of the project.', 'required': True}, {'name': 'app_name', 'description': 'The name of the application.', 'required': True}]}, {'name': 'delete_secret', 'title': 'Delete Secret', 'description': 'Deletes a secret by its name.', 'arguments': [{'name': 'secret_name', 'description': 'The name of the secret.', 'required': True}, {'name': 'project_id', 'description': 'The ID of the project.', 'required': True}, {'name': 'app_name', 'description': 'The name of the application.', 'required': True}]}, {'name': 'create_secret', 'title': 'Create Secret', 'description': 'Creates a new secret.', 'arguments': [{'name': 'secret_name', 'description': 'The name of the new secret.', 'required': True}, {'name': 'secret_value', 'description': 'The value of the new secret.', 'required': True}, {'name': 'project_id', 'description': 'The ID of the project.', 'required': True}, {'name': 'app_name', 'description': 'The name of the application.', 'required': True}]}, {'name': 'find_project_and_list_secrets', 'title': 'Find Project and List Secrets', 'description': 'Finds a project by name and lists its secrets.', 'arguments': [{'name': 'project_name', 'description': 'The name of the project.', 'required': True}, {'name': 'organization_id', 'description': 'The ID of the organization.', 'required': True}, {'name': 'app_name', 'description': 'The name of the application.', 'required': True}]}, {'name': 'list_resources', 'title': 'List Resources', 'description': 'Lists all resources in a project.', 'arguments': [{'name': 'project_id', 'description': 'The ID of the project.', 'required': True}]}, {'name': 'search_logs', 'title': 'Search Logs', 'description': 'Searches for audit logs in an organization using LogQL. The LLM should determine the best topic to use based on the user\'s query, or default to \'hashicorp.platform.audit\' if the user is not specific. For advanced filtering, use the `query` parameter with LogQL syntax. To filter on specific JSON fields in the log entries, use the `| json` parser in your query. For example: `query=\'| json | control_plane_event_action="CREATE"\'`', 'arguments': [{'name': 'organization_id', 'description': 'The ID of the organization.', 'required': True}, {'name': 'query', 'description': 'The LogQL query string for advanced filtering. Can be combined with `project_id` and `topic`. Example: \'| json | resource_uuid="some-uuid"\'', 'required': False}, {'name': 'project_id', 'description': 'A project ID to filter by.', 'required': False}, {'name': 'topic', 'description': "A log topic to search. Example topics: 'hashicorp.platform.audit', 'hashicorp.packer.registry.audit', 'hashicorp.boundary.cluster.audit', 'hashicorp.consul.cluster.audit'", 'required': True}, {'name': 'start_time', 'description': "The start time for the search. Accepts formats like '24 hours ago', 'yesterday at 5pm', or 'Oct 1, 2025'.", 'required': True}, {'name': 'end_time', 'description': "The end time for the search. Accepts formats like 'now', 'today', or 'Oct 3, 2025'.", 'required': True}]}]}, 'id': 1}
2025-10-14 11:04:43,460 - mcp_server - INFO - Request data: stdio_main json: {"jsonrpc": "2.0", "result": {"prompts": [{"name": "list_projects", "title": "List Projects", "description": "Lists all HCP projects for a given organization.", "arguments": [{"name": "organization_id", "description": "The ID of the organization.", "required": true}]}, {"name": "get_project", "title": "Get Project", "description": "Gets an HCP project by its ID.", "arguments": [{"name": "project_id", "description": "The ID of the project.", "required": true}]}, {"name": "delete_project", "title": "Delete Project", "description": "Deletes an HCP project by its ID.", "arguments": [{"name": "project_id", "description": "The ID of the project.", "required": true}]}, {"name": "create_project", "title": "Create Project", "description": "Creates a new HCP project.", "arguments": [{"name": "name", "description": "The name of the new project.", "required": true}, {"name": "organization_id", "description": "The ID of the organization.", "required": true}]}, {"name": "update_project", "title": "Update Project", "description": "Updates an HCP project.", "arguments": [{"name": "project_id", "description": "The ID of the project.", "required": true}, {"name": "name", "description": "The new name for the project.", "required": true}, {"name": "organization_id", "description": "The ID of the organization.", "required": true}]}, {"name": "get_organization", "title": "Get Organization", "description": "Gets an HCP organization by its ID.", "arguments": [{"name": "organization_id", "description": "The ID of the organization.", "required": true}]}, {"name": "list_organizations", "title": "List Organizations", "description": "Lists all HCP organizations.", "arguments": null}, {"name": "update_organization", "title": "Update Organization", "description": "Updates an HCP organization.", "arguments": [{"name": "organization_id", "description": "The ID of the organization.", "required": true}, {"name": "name", "description": "The new name for the organization.", "required": true}]}, {"name": "list_secrets", "title": "List Secrets", "description": "Lists all secrets for a given application.", "arguments": [{"name": "project_id", "description": "The ID of the project.", "required": true}, {"name": "app_name", "description": "The name of the application.", "required": true}]}, {"name": "get_secret", "title": "Get Secret", "description": "Gets a secret by its name.", "arguments": [{"name": "secret_name", "description": "The name of the secret.", "required": true}, {"name": "project_id", "description": "The ID of the project.", "required": true}, {"name": "app_name", "description": "The name of the application.", "required": true}]}, {"name": "delete_secret", "title": "Delete Secret", "description": "Deletes a secret by its name.", "arguments": [{"name": "secret_name", "description": "The name of the secret.", "required": true}, {"name": "project_id", "description": "The ID of the project.", "required": true}, {"name": "app_name", "description": "The name of the application.", "required": true}]}, {"name": "create_secret", "title": "Create Secret", "description": "Creates a new secret.", "arguments": [{"name": "secret_name", "description": "The name of the new secret.", "required": true}, {"name": "secret_value", "description": "The value of the new secret.", "required": true}, {"name": "project_id", "description": "The ID of the project.", "required": true}, {"name": "app_name", "description": "The name of the application.", "required": true}]}, {"name": "find_project_and_list_secrets", "title": "Find Project and List Secrets", "description": "Finds a project by name and lists its secrets.", "arguments": [{"name": "project_name", "description": "The name of the project.", "required": true}, {"name": "organization_id", "description": "The ID of the organization.", "required": true}, {"name": "app_name", "description": "The name of the application.", "required": true}]}, {"name": "list_resources", "title": "List Resources", "description": "Lists all resources in a project.", "arguments": [{"name": "project_id", "description": "The ID of the project.", "required": true}]}, {"name": "search_logs", "title": "Search Logs", "description": "Searches for audit logs in an organization using LogQL. The LLM should determine the best topic to use based on the user's query, or default to 'hashicorp.platform.audit' if the user is not specific. For advanced filtering, use the `query` parameter with LogQL syntax. To filter on specific JSON fields in the log entries, use the `| json` parser in your query. For example: `query='| json | control_plane_event_action=\"CREATE\"'`", "arguments": [{"name": "organization_id", "description": "The ID of the organization.", "required": true}, {"name": "query", "description": "The LogQL query string for advanced filtering. Can be combined with `project_id` and `topic`. Example: '| json | resource_uuid=\"some-uuid\"'", "required": false}, {"name": "project_id", "description": "A project ID to filter by.", "required": false}, {"name": "topic", "description": "A log topic to search. Example topics: 'hashicorp.platform.audit', 'hashicorp.packer.registry.audit', 'hashicorp.boundary.cluster.audit', 'hashicorp.consul.cluster.audit'", "required": true}, {"name": "start_time", "description": "The start time for the search. Accepts formats like '24 hours ago', 'yesterday at 5pm', or 'Oct 1, 2025'.", "required": true}, {"name": "end_time", "description": "The end time for the search. Accepts formats like 'now', 'today', or 'Oct 3, 2025'.", "required": true}]}]}, "id": 1}
2025-10-14 11:04:43,461 - mcp_server - INFO - Received request: {"method": "tools/list", "params": {}, "jsonrpc": "2.0", "id": 2}
2025-10-14 11:04:43,461 - mcp_server - INFO - Request data: stdio_main: {'jsonrpc': '2.0', 'result': {'tools': [{'name': 'list_projects', 'description': 'Lists all HCP projects for a given organization.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}}, 'required': ['organization_id']}}, {'name': 'get_project', 'description': 'Gets an HCP project by its ID.', 'inputSchema': {'type': 'object', 'properties': {'project_id': {'type': 'string', 'description': 'The ID of the project.'}}, 'required': ['project_id']}}, {'name': 'delete_project', 'description': 'Deletes an HCP project by its ID.', 'inputSchema': {'type': 'object', 'properties': {'project_id': {'type': 'string', 'description': 'The ID of the project.'}}, 'required': ['project_id']}}, {'name': 'create_project', 'description': 'Creates a new HCP project.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'name': {'type': 'string', 'description': 'The name of the new project.'}}, 'required': ['organization_id', 'name']}}, {'name': 'update_project', 'description': 'Updates an HCP project.', 'inputSchema': {'type': 'object', 'properties': {'project_id': {'type': 'string', 'description': 'The ID of the project.'}, 'name': {'type': 'string', 'description': 'The new name of the project.'}}, 'required': ['project_id', 'name']}}, {'name': 'get_organization', 'description': 'Gets an HCP organization by its ID.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}}, 'required': ['organization_id']}}, {'name': 'list_organizations', 'description': 'Lists all HCP organizations.', 'inputSchema': {'type': 'object', 'properties': {}}}, {'name': 'update_organization', 'description': 'Updates an HCP organization.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'name': {'type': 'string', 'description': 'The new name of the organization.'}}, 'required': ['organization_id', 'name']}}, {'name': 'search_principals', 'description': 'Searches for principals in an organization.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'filter_str': {'type': 'string', 'description': 'The filter string to use for the search.'}}, 'required': ['organization_id']}}, {'name': 'get_principals', 'description': 'Gets principals by their IDs.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'principal_ids': {'type': 'array', 'items': {'type': 'string'}, 'description': 'The IDs of the principals to get.'}}, 'required': ['organization_id', 'principal_ids']}}, {'name': 'delete_service_principal', 'description': 'Deletes a service principal by its ID.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'principal_id': {'type': 'string', 'description': 'The ID of the service principal.'}}, 'required': ['organization_id', 'principal_id']}}, {'name': 'create_service_principal', 'description': 'Creates a new service principal.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'name': {'type': 'string', 'description': 'The name of the new service principal.'}}, 'required': ['organization_id', 'name']}}, {'name': 'update_service_principal', 'description': 'Updates a service principal.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'principal_id': {'type': 'string', 'description': 'The ID of the service principal.'}, 'name': {'type': 'string', 'description': 'The new name of the service principal.'}}, 'required': ['organization_id', 'principal_id', 'name']}}, {'name': 'list_secrets', 'description': 'Lists all secrets for a given application.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'project_id': {'type': 'string', 'description': 'The ID of the project.'}, 'app_name': {'type': 'string', 'description': 'The name of the application.'}}, 'required': ['organization_id', 'project_id', 'app_name']}}, {'name': 'get_secret', 'description': 'Gets a secret by its name.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'project_id': {'type': 'string', 'description': 'The ID of the project.'}, 'app_name': {'type': 'string', 'description': 'The name of the application.'}, 'secret_name': {'type': 'string', 'description': 'The name of the secret.'}}, 'required': ['organization_id', 'project_id', 'app_name', 'secret_name']}}, {'name': 'delete_secret', 'description': 'Deletes a secret by its name.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'project_id': {'type': 'string', 'description': 'The ID of the project.'}, 'app_name': {'type': 'string', 'description': 'The name of the application.'}, 'secret_name': {'type': 'string', 'description': 'The name of the secret.'}}, 'required': ['organization_id', 'project_id', 'app_name', 'secret_name']}}, {'name': 'create_secret', 'description': 'Creates a new secret.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'project_id': {'type': 'string', 'description': 'The ID of the project.'}, 'app_name': {'type': 'string', 'description': 'The name of the application.'}, 'secret_name': {'type': 'string', 'description': 'The name of the new secret.'}, 'secret_value': {'type': 'string', 'description': 'The value of the new secret.'}}, 'required': ['organization_id', 'project_id', 'app_name', 'secret_name', 'secret_value']}}, {'name': 'find_project_by_name', 'description': 'Finds a project by its name.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'name': {'type': 'string', 'description': 'The name of the project.'}}, 'required': ['organization_id', 'name']}}, {'name': 'find_user_by_email', 'description': 'Finds a user by their email.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'email': {'type': 'string', 'description': 'The email of the user.'}}, 'required': ['organization_id', 'email']}}, {'name': 'find_organization_by_name', 'description': 'Finds an organization by its name.', 'inputSchema': {'type': 'object', 'properties': {'name': {'type': 'string', 'description': 'The name of the organization.'}}, 'required': ['name']}}, {'name': 'list_resources', 'description': 'Lists all resources in a project.', 'inputSchema': {'type': 'object', 'properties': {'project_id': {'type': 'string', 'description': 'The ID of the project.'}}, 'required': ['project_id']}}, {'name': 'search_logs', 'description': 'Searches for audit logs in an organization using LogQL. At least one of `query`, `project_id`, or `topic` must be provided. For advanced filtering, use the `query` parameter with LogQL syntax. To filter on specific JSON fields in the log entries, use the `| json` parser in your query. For example: `query=\'| json | control_plane_event_action="CREATE"\'`', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'query': {'type': 'string', 'description': 'The LogQL query string for advanced filtering. Can be combined with `project_id` and `topic`. Example: \'| json | resource_uuid="some-uuid"\''}, 'project_id': {'type': 'string', 'description': 'A project ID to filter by.'}, 'topic': {'type': 'string', 'description': "A log topic to search. Example topics: 'hashicorp.platform.audit', 'hashicorp.packer.registry.audit', 'hashicorp.boundary.cluster.audit', 'hashicorp.consul.cluster.audit'"}, 'start_time': {'type': 'string', 'description': "The start time for the search. Accepts formats like '24 hours ago', 'yesterday at 5pm', or 'Oct 1, 2025'."}, 'end_time': {'type': 'string', 'description': "The end time for the search. Accepts formats like 'now', 'today', or 'Oct 3, 2025'."}}, 'required': ['organization_id', 'start_time', 'end_time']}}]}, 'id': 2}
2025-10-14 11:04:43,461 - mcp_server - INFO - Request data: stdio_main json: {"jsonrpc": "2.0", "result": {"tools": [{"name": "list_projects", "description": "Lists all HCP projects for a given organization.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}}, "required": ["organization_id"]}}, {"name": "get_project", "description": "Gets an HCP project by its ID.", "inputSchema": {"type": "object", "properties": {"project_id": {"type": "string", "description": "The ID of the project."}}, "required": ["project_id"]}}, {"name": "delete_project", "description": "Deletes an HCP project by its ID.", "inputSchema": {"type": "object", "properties": {"project_id": {"type": "string", "description": "The ID of the project."}}, "required": ["project_id"]}}, {"name": "create_project", "description": "Creates a new HCP project.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "name": {"type": "string", "description": "The name of the new project."}}, "required": ["organization_id", "name"]}}, {"name": "update_project", "description": "Updates an HCP project.", "inputSchema": {"type": "object", "properties": {"project_id": {"type": "string", "description": "The ID of the project."}, "name": {"type": "string", "description": "The new name of the project."}}, "required": ["project_id", "name"]}}, {"name": "get_organization", "description": "Gets an HCP organization by its ID.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}}, "required": ["organization_id"]}}, {"name": "list_organizations", "description": "Lists all HCP organizations.", "inputSchema": {"type": "object", "properties": {}}}, {"name": "update_organization", "description": "Updates an HCP organization.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "name": {"type": "string", "description": "The new name of the organization."}}, "required": ["organization_id", "name"]}}, {"name": "search_principals", "description": "Searches for principals in an organization.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "filter_str": {"type": "string", "description": "The filter string to use for the search."}}, "required": ["organization_id"]}}, {"name": "get_principals", "description": "Gets principals by their IDs.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "principal_ids": {"type": "array", "items": {"type": "string"}, "description": "The IDs of the principals to get."}}, "required": ["organization_id", "principal_ids"]}}, {"name": "delete_service_principal", "description": "Deletes a service principal by its ID.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "principal_id": {"type": "string", "description": "The ID of the service principal."}}, "required": ["organization_id", "principal_id"]}}, {"name": "create_service_principal", "description": "Creates a new service principal.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "name": {"type": "string", "description": "The name of the new service principal."}}, "required": ["organization_id", "name"]}}, {"name": "update_service_principal", "description": "Updates a service principal.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "principal_id": {"type": "string", "description": "The ID of the service principal."}, "name": {"type": "string", "description": "The new name of the service principal."}}, "required": ["organization_id", "principal_id", "name"]}}, {"name": "list_secrets", "description": "Lists all secrets for a given application.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "project_id": {"type": "string", "description": "The ID of the project."}, "app_name": {"type": "string", "description": "The name of the application."}}, "required": ["organization_id", "project_id", "app_name"]}}, {"name": "get_secret", "description": "Gets a secret by its name.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "project_id": {"type": "string", "description": "The ID of the project."}, "app_name": {"type": "string", "description": "The name of the application."}, "secret_name": {"type": "string", "description": "The name of the secret."}}, "required": ["organization_id", "project_id", "app_name", "secret_name"]}}, {"name": "delete_secret", "description": "Deletes a secret by its name.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "project_id": {"type": "string", "description": "The ID of the project."}, "app_name": {"type": "string", "description": "The name of the application."}, "secret_name": {"type": "string", "description": "The name of the secret."}}, "required": ["organization_id", "project_id", "app_name", "secret_name"]}}, {"name": "create_secret", "description": "Creates a new secret.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "project_id": {"type": "string", "description": "The ID of the project."}, "app_name": {"type": "string", "description": "The name of the application."}, "secret_name": {"type": "string", "description": "The name of the new secret."}, "secret_value": {"type": "string", "description": "The value of the new secret."}}, "required": ["organization_id", "project_id", "app_name", "secret_name", "secret_value"]}}, {"name": "find_project_by_name", "description": "Finds a project by its name.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "name": {"type": "string", "description": "The name of the project."}}, "required": ["organization_id", "name"]}}, {"name": "find_user_by_email", "description": "Finds a user by their email.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "email": {"type": "string", "description": "The email of the user."}}, "required": ["organization_id", "email"]}}, {"name": "find_organization_by_name", "description": "Finds an organization by its name.", "inputSchema": {"type": "object", "properties": {"name": {"type": "string", "description": "The name of the organization."}}, "required": ["name"]}}, {"name": "list_resources", "description": "Lists all resources in a project.", "inputSchema": {"type": "object", "properties": {"project_id": {"type": "string", "description": "The ID of the project."}}, "required": ["project_id"]}}, {"name": "search_logs", "description": "Searches for audit logs in an organization using LogQL. At least one of `query`, `project_id`, or `topic` must be provided. For advanced filtering, use the `query` parameter with LogQL syntax. To filter on specific JSON fields in the log entries, use the `| json` parser in your query. For example: `query='| json | control_plane_event_action=\"CREATE\"'`", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "query": {"type": "string", "description": "The LogQL query string for advanced filtering. Can be combined with `project_id` and `topic`. Example: '| json | resource_uuid=\"some-uuid\"'"}, "project_id": {"type": "string", "description": "A project ID to filter by."}, "topic": {"type": "string", "description": "A log topic to search. Example topics: 'hashicorp.platform.audit', 'hashicorp.packer.registry.audit', 'hashicorp.boundary.cluster.audit', 'hashicorp.consul.cluster.audit'"}, "start_time": {"type": "string", "description": "The start time for the search. Accepts formats like '24 hours ago', 'yesterday at 5pm', or 'Oct 1, 2025'."}, "end_time": {"type": "string", "description": "The end time for the search. Accepts formats like 'now', 'today', or 'Oct 3, 2025'."}}, "required": ["organization_id", "start_time", "end_time"]}}]}, "id": 2}
2025-10-14 11:06:04,950 - mcp_server - INFO - Received request: {"method": "initialize", "params": {"protocolVersion": "2025-06-18", "capabilities": {"roots": {}}, "clientInfo": {"name": "gemini-cli-mcp-client-HCP", "version": "0.0.1"}}, "jsonrpc": "2.0", "id": 0}
2025-10-14 11:06:04,950 - mcp_server - INFO - Request data: stdio_main: {'jsonrpc': '2.0', 'result': {'protocolVersion': '2024-11-05', 'serverInfo': {'name': 'HCP', 'version': '0.0.1'}, 'capabilities': {'tools': {'listChanged': True}, 'prompts': {'listChanged': True}, 'resources': {'listChanged': True}}}, 'id': 0}
2025-10-14 11:06:04,950 - mcp_server - INFO - Request data: stdio_main json: {"jsonrpc": "2.0", "result": {"protocolVersion": "2024-11-05", "serverInfo": {"name": "HCP", "version": "0.0.1"}, "capabilities": {"tools": {"listChanged": true}, "prompts": {"listChanged": true}, "resources": {"listChanged": true}}}, "id": 0}
2025-10-14 11:06:04,950 - mcp_server - INFO - Received request: {"method": "notifications/initialized", "jsonrpc": "2.0"}
2025-10-14 11:06:04,950 - mcp_server - INFO - Client initialized.
2025-10-14 11:06:04,950 - mcp_server - INFO - Received request: {"method": "prompts/list", "params": {}, "jsonrpc": "2.0", "id": 1}
2025-10-14 11:06:04,950 - mcp_server - INFO - Request data: stdio_main: {'jsonrpc': '2.0', 'result': {'prompts': [{'name': 'list_projects', 'title': 'List Projects', 'description': 'Lists all HCP projects for a given organization.', 'arguments': [{'name': 'organization_id', 'description': 'The ID of the organization.', 'required': True}]}, {'name': 'get_project', 'title': 'Get Project', 'description': 'Gets an HCP project by its ID.', 'arguments': [{'name': 'project_id', 'description': 'The ID of the project.', 'required': True}]}, {'name': 'delete_project', 'title': 'Delete Project', 'description': 'Deletes an HCP project by its ID.', 'arguments': [{'name': 'project_id', 'description': 'The ID of the project.', 'required': True}]}, {'name': 'create_project', 'title': 'Create Project', 'description': 'Creates a new HCP project.', 'arguments': [{'name': 'name', 'description': 'The name of the new project.', 'required': True}, {'name': 'organization_id', 'description': 'The ID of the organization.', 'required': True}]}, {'name': 'update_project', 'title': 'Update Project', 'description': 'Updates an HCP project.', 'arguments': [{'name': 'project_id', 'description': 'The ID of the project.', 'required': True}, {'name': 'name', 'description': 'The new name for the project.', 'required': True}, {'name': 'organization_id', 'description': 'The ID of the organization.', 'required': True}]}, {'name': 'get_organization', 'title': 'Get Organization', 'description': 'Gets an HCP organization by its ID.', 'arguments': [{'name': 'organization_id', 'description': 'The ID of the organization.', 'required': True}]}, {'name': 'list_organizations', 'title': 'List Organizations', 'description': 'Lists all HCP organizations.', 'arguments': None}, {'name': 'update_organization', 'title': 'Update Organization', 'description': 'Updates an HCP organization.', 'arguments': [{'name': 'organization_id', 'description': 'The ID of the organization.', 'required': True}, {'name': 'name', 'description': 'The new name for the organization.', 'required': True}]}, {'name': 'list_secrets', 'title': 'List Secrets', 'description': 'Lists all secrets for a given application.', 'arguments': [{'name': 'project_id', 'description': 'The ID of the project.', 'required': True}, {'name': 'app_name', 'description': 'The name of the application.', 'required': True}]}, {'name': 'get_secret', 'title': 'Get Secret', 'description': 'Gets a secret by its name.', 'arguments': [{'name': 'secret_name', 'description': 'The name of the secret.', 'required': True}, {'name': 'project_id', 'description': 'The ID of the project.', 'required': True}, {'name': 'app_name', 'description': 'The name of the application.', 'required': True}]}, {'name': 'delete_secret', 'title': 'Delete Secret', 'description': 'Deletes a secret by its name.', 'arguments': [{'name': 'secret_name', 'description': 'The name of the secret.', 'required': True}, {'name': 'project_id', 'description': 'The ID of the project.', 'required': True}, {'name': 'app_name', 'description': 'The name of the application.', 'required': True}]}, {'name': 'create_secret', 'title': 'Create Secret', 'description': 'Creates a new secret.', 'arguments': [{'name': 'secret_name', 'description': 'The name of the new secret.', 'required': True}, {'name': 'secret_value', 'description': 'The value of the new secret.', 'required': True}, {'name': 'project_id', 'description': 'The ID of the project.', 'required': True}, {'name': 'app_name', 'description': 'The name of the application.', 'required': True}]}, {'name': 'find_project_and_list_secrets', 'title': 'Find Project and List Secrets', 'description': 'Finds a project by name and lists its secrets.', 'arguments': [{'name': 'project_name', 'description': 'The name of the project.', 'required': True}, {'name': 'organization_id', 'description': 'The ID of the organization.', 'required': True}, {'name': 'app_name', 'description': 'The name of the application.', 'required': True}]}, {'name': 'list_resources', 'title': 'List Resources', 'description': 'Lists all resources in a project.', 'arguments': [{'name': 'project_id', 'description': 'The ID of the project.', 'required': True}]}, {'name': 'search_logs', 'title': 'Search Logs', 'description': 'Searches for audit logs in an organization using LogQL. The LLM should determine the best topic to use based on the user\'s query, or default to \'hashicorp.platform.audit\' if the user is not specific. For advanced filtering, use the `query` parameter with LogQL syntax. To filter on specific JSON fields in the log entries, use the `| json` parser in your query. For example: `query=\'| json | control_plane_event_action="CREATE"\'`', 'arguments': [{'name': 'organization_id', 'description': 'The ID of the organization.', 'required': True}, {'name': 'query', 'description': 'The LogQL query string for advanced filtering. Can be combined with `project_id` and `topic`. Example: \'| json | resource_uuid="some-uuid"\'', 'required': False}, {'name': 'project_id', 'description': 'A project ID to filter by.', 'required': False}, {'name': 'topic', 'description': "A log topic to search. Example topics: 'hashicorp.platform.audit', 'hashicorp.packer.registry.audit', 'hashicorp.boundary.cluster.audit', 'hashicorp.consul.cluster.audit'", 'required': True}, {'name': 'start_time', 'description': "The start time for the search. Accepts formats like '24 hours ago', 'yesterday at 5pm', or 'Oct 1, 2025'.", 'required': True}, {'name': 'end_time', 'description': "The end time for the search. Accepts formats like 'now', 'today', or 'Oct 3, 2025'.", 'required': True}]}]}, 'id': 1}
2025-10-14 11:06:04,951 - mcp_server - INFO - Request data: stdio_main json: {"jsonrpc": "2.0", "result": {"prompts": [{"name": "list_projects", "title": "List Projects", "description": "Lists all HCP projects for a given organization.", "arguments": [{"name": "organization_id", "description": "The ID of the organization.", "required": true}]}, {"name": "get_project", "title": "Get Project", "description": "Gets an HCP project by its ID.", "arguments": [{"name": "project_id", "description": "The ID of the project.", "required": true}]}, {"name": "delete_project", "title": "Delete Project", "description": "Deletes an HCP project by its ID.", "arguments": [{"name": "project_id", "description": "The ID of the project.", "required": true}]}, {"name": "create_project", "title": "Create Project", "description": "Creates a new HCP project.", "arguments": [{"name": "name", "description": "The name of the new project.", "required": true}, {"name": "organization_id", "description": "The ID of the organization.", "required": true}]}, {"name": "update_project", "title": "Update Project", "description": "Updates an HCP project.", "arguments": [{"name": "project_id", "description": "The ID of the project.", "required": true}, {"name": "name", "description": "The new name for the project.", "required": true}, {"name": "organization_id", "description": "The ID of the organization.", "required": true}]}, {"name": "get_organization", "title": "Get Organization", "description": "Gets an HCP organization by its ID.", "arguments": [{"name": "organization_id", "description": "The ID of the organization.", "required": true}]}, {"name": "list_organizations", "title": "List Organizations", "description": "Lists all HCP organizations.", "arguments": null}, {"name": "update_organization", "title": "Update Organization", "description": "Updates an HCP organization.", "arguments": [{"name": "organization_id", "description": "The ID of the organization.", "required": true}, {"name": "name", "description": "The new name for the organization.", "required": true}]}, {"name": "list_secrets", "title": "List Secrets", "description": "Lists all secrets for a given application.", "arguments": [{"name": "project_id", "description": "The ID of the project.", "required": true}, {"name": "app_name", "description": "The name of the application.", "required": true}]}, {"name": "get_secret", "title": "Get Secret", "description": "Gets a secret by its name.", "arguments": [{"name": "secret_name", "description": "The name of the secret.", "required": true}, {"name": "project_id", "description": "The ID of the project.", "required": true}, {"name": "app_name", "description": "The name of the application.", "required": true}]}, {"name": "delete_secret", "title": "Delete Secret", "description": "Deletes a secret by its name.", "arguments": [{"name": "secret_name", "description": "The name of the secret.", "required": true}, {"name": "project_id", "description": "The ID of the project.", "required": true}, {"name": "app_name", "description": "The name of the application.", "required": true}]}, {"name": "create_secret", "title": "Create Secret", "description": "Creates a new secret.", "arguments": [{"name": "secret_name", "description": "The name of the new secret.", "required": true}, {"name": "secret_value", "description": "The value of the new secret.", "required": true}, {"name": "project_id", "description": "The ID of the project.", "required": true}, {"name": "app_name", "description": "The name of the application.", "required": true}]}, {"name": "find_project_and_list_secrets", "title": "Find Project and List Secrets", "description": "Finds a project by name and lists its secrets.", "arguments": [{"name": "project_name", "description": "The name of the project.", "required": true}, {"name": "organization_id", "description": "The ID of the organization.", "required": true}, {"name": "app_name", "description": "The name of the application.", "required": true}]}, {"name": "list_resources", "title": "List Resources", "description": "Lists all resources in a project.", "arguments": [{"name": "project_id", "description": "The ID of the project.", "required": true}]}, {"name": "search_logs", "title": "Search Logs", "description": "Searches for audit logs in an organization using LogQL. The LLM should determine the best topic to use based on the user's query, or default to 'hashicorp.platform.audit' if the user is not specific. For advanced filtering, use the `query` parameter with LogQL syntax. To filter on specific JSON fields in the log entries, use the `| json` parser in your query. For example: `query='| json | control_plane_event_action=\"CREATE\"'`", "arguments": [{"name": "organization_id", "description": "The ID of the organization.", "required": true}, {"name": "query", "description": "The LogQL query string for advanced filtering. Can be combined with `project_id` and `topic`. Example: '| json | resource_uuid=\"some-uuid\"'", "required": false}, {"name": "project_id", "description": "A project ID to filter by.", "required": false}, {"name": "topic", "description": "A log topic to search. Example topics: 'hashicorp.platform.audit', 'hashicorp.packer.registry.audit', 'hashicorp.boundary.cluster.audit', 'hashicorp.consul.cluster.audit'", "required": true}, {"name": "start_time", "description": "The start time for the search. Accepts formats like '24 hours ago', 'yesterday at 5pm', or 'Oct 1, 2025'.", "required": true}, {"name": "end_time", "description": "The end time for the search. Accepts formats like 'now', 'today', or 'Oct 3, 2025'.", "required": true}]}]}, "id": 1}
2025-10-14 11:06:04,951 - mcp_server - INFO - Received request: {"method": "tools/list", "params": {}, "jsonrpc": "2.0", "id": 2}
2025-10-14 11:06:04,951 - mcp_server - INFO - Request data: stdio_main: {'jsonrpc': '2.0', 'result': {'tools': [{'name': 'list_projects', 'description': 'Lists all HCP projects for a given organization.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}}, 'required': ['organization_id']}}, {'name': 'get_project', 'description': 'Gets an HCP project by its ID.', 'inputSchema': {'type': 'object', 'properties': {'project_id': {'type': 'string', 'description': 'The ID of the project.'}}, 'required': ['project_id']}}, {'name': 'delete_project', 'description': 'Deletes an HCP project by its ID.', 'inputSchema': {'type': 'object', 'properties': {'project_id': {'type': 'string', 'description': 'The ID of the project.'}}, 'required': ['project_id']}}, {'name': 'create_project', 'description': 'Creates a new HCP project.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'name': {'type': 'string', 'description': 'The name of the new project.'}}, 'required': ['organization_id', 'name']}}, {'name': 'update_project', 'description': 'Updates an HCP project.', 'inputSchema': {'type': 'object', 'properties': {'project_id': {'type': 'string', 'description': 'The ID of the project.'}, 'name': {'type': 'string', 'description': 'The new name of the project.'}}, 'required': ['project_id', 'name']}}, {'name': 'get_organization', 'description': 'Gets an HCP organization by its ID.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}}, 'required': ['organization_id']}}, {'name': 'list_organizations', 'description': 'Lists all HCP organizations.', 'inputSchema': {'type': 'object', 'properties': {}}}, {'name': 'update_organization', 'description': 'Updates an HCP organization.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'name': {'type': 'string', 'description': 'The new name of the organization.'}}, 'required': ['organization_id', 'name']}}, {'name': 'search_principals', 'description': 'Searches for principals in an organization.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'filter_str': {'type': 'string', 'description': 'The filter string to use for the search.'}}, 'required': ['organization_id']}}, {'name': 'get_principals', 'description': 'Gets principals by their IDs.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'principal_ids': {'type': 'array', 'items': {'type': 'string'}, 'description': 'The IDs of the principals to get.'}}, 'required': ['organization_id', 'principal_ids']}}, {'name': 'delete_service_principal', 'description': 'Deletes a service principal by its ID.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'principal_id': {'type': 'string', 'description': 'The ID of the service principal.'}}, 'required': ['organization_id', 'principal_id']}}, {'name': 'create_service_principal', 'description': 'Creates a new service principal.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'name': {'type': 'string', 'description': 'The name of the new service principal.'}}, 'required': ['organization_id', 'name']}}, {'name': 'update_service_principal', 'description': 'Updates a service principal.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'principal_id': {'type': 'string', 'description': 'The ID of the service principal.'}, 'name': {'type': 'string', 'description': 'The new name of the service principal.'}}, 'required': ['organization_id', 'principal_id', 'name']}}, {'name': 'list_secrets', 'description': 'Lists all secrets for a given application.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'project_id': {'type': 'string', 'description': 'The ID of the project.'}, 'app_name': {'type': 'string', 'description': 'The name of the application.'}}, 'required': ['organization_id', 'project_id', 'app_name']}}, {'name': 'get_secret', 'description': 'Gets a secret by its name.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'project_id': {'type': 'string', 'description': 'The ID of the project.'}, 'app_name': {'type': 'string', 'description': 'The name of the application.'}, 'secret_name': {'type': 'string', 'description': 'The name of the secret.'}}, 'required': ['organization_id', 'project_id', 'app_name', 'secret_name']}}, {'name': 'delete_secret', 'description': 'Deletes a secret by its name.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'project_id': {'type': 'string', 'description': 'The ID of the project.'}, 'app_name': {'type': 'string', 'description': 'The name of the application.'}, 'secret_name': {'type': 'string', 'description': 'The name of the secret.'}}, 'required': ['organization_id', 'project_id', 'app_name', 'secret_name']}}, {'name': 'create_secret', 'description': 'Creates a new secret.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'project_id': {'type': 'string', 'description': 'The ID of the project.'}, 'app_name': {'type': 'string', 'description': 'The name of the application.'}, 'secret_name': {'type': 'string', 'description': 'The name of the new secret.'}, 'secret_value': {'type': 'string', 'description': 'The value of the new secret.'}}, 'required': ['organization_id', 'project_id', 'app_name', 'secret_name', 'secret_value']}}, {'name': 'find_project_by_name', 'description': 'Finds a project by its name.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'name': {'type': 'string', 'description': 'The name of the project.'}}, 'required': ['organization_id', 'name']}}, {'name': 'find_user_by_email', 'description': 'Finds a user by their email.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'email': {'type': 'string', 'description': 'The email of the user.'}}, 'required': ['organization_id', 'email']}}, {'name': 'find_organization_by_name', 'description': 'Finds an organization by its name.', 'inputSchema': {'type': 'object', 'properties': {'name': {'type': 'string', 'description': 'The name of the organization.'}}, 'required': ['name']}}, {'name': 'list_resources', 'description': 'Lists all resources in a project.', 'inputSchema': {'type': 'object', 'properties': {'project_id': {'type': 'string', 'description': 'The ID of the project.'}}, 'required': ['project_id']}}, {'name': 'search_logs', 'description': 'Searches for audit logs in an organization using LogQL. At least one of `query`, `project_id`, or `topic` must be provided. For advanced filtering, use the `query` parameter with LogQL syntax. To filter on specific JSON fields in the log entries, use the `| json` parser in your query. For example: `query=\'| json | control_plane_event_action="CREATE"\'`', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'query': {'type': 'string', 'description': 'The LogQL query string for advanced filtering. Can be combined with `project_id` and `topic`. Example: \'| json | resource_uuid="some-uuid"\''}, 'project_id': {'type': 'string', 'description': 'A project ID to filter by.'}, 'topic': {'type': 'string', 'description': "A log topic to search. Example topics: 'hashicorp.platform.audit', 'hashicorp.packer.registry.audit', 'hashicorp.boundary.cluster.audit', 'hashicorp.consul.cluster.audit'"}, 'start_time': {'type': 'string', 'description': "The start time for the search. Accepts formats like '24 hours ago', 'yesterday at 5pm', or 'Oct 1, 2025'."}, 'end_time': {'type': 'string', 'description': "The end time for the search. Accepts formats like 'now', 'today', or 'Oct 3, 2025'."}}, 'required': ['organization_id', 'start_time', 'end_time']}}]}, 'id': 2}
2025-10-14 11:06:04,951 - mcp_server - INFO - Request data: stdio_main json: {"jsonrpc": "2.0", "result": {"tools": [{"name": "list_projects", "description": "Lists all HCP projects for a given organization.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}}, "required": ["organization_id"]}}, {"name": "get_project", "description": "Gets an HCP project by its ID.", "inputSchema": {"type": "object", "properties": {"project_id": {"type": "string", "description": "The ID of the project."}}, "required": ["project_id"]}}, {"name": "delete_project", "description": "Deletes an HCP project by its ID.", "inputSchema": {"type": "object", "properties": {"project_id": {"type": "string", "description": "The ID of the project."}}, "required": ["project_id"]}}, {"name": "create_project", "description": "Creates a new HCP project.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "name": {"type": "string", "description": "The name of the new project."}}, "required": ["organization_id", "name"]}}, {"name": "update_project", "description": "Updates an HCP project.", "inputSchema": {"type": "object", "properties": {"project_id": {"type": "string", "description": "The ID of the project."}, "name": {"type": "string", "description": "The new name of the project."}}, "required": ["project_id", "name"]}}, {"name": "get_organization", "description": "Gets an HCP organization by its ID.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}}, "required": ["organization_id"]}}, {"name": "list_organizations", "description": "Lists all HCP organizations.", "inputSchema": {"type": "object", "properties": {}}}, {"name": "update_organization", "description": "Updates an HCP organization.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "name": {"type": "string", "description": "The new name of the organization."}}, "required": ["organization_id", "name"]}}, {"name": "search_principals", "description": "Searches for principals in an organization.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "filter_str": {"type": "string", "description": "The filter string to use for the search."}}, "required": ["organization_id"]}}, {"name": "get_principals", "description": "Gets principals by their IDs.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "principal_ids": {"type": "array", "items": {"type": "string"}, "description": "The IDs of the principals to get."}}, "required": ["organization_id", "principal_ids"]}}, {"name": "delete_service_principal", "description": "Deletes a service principal by its ID.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "principal_id": {"type": "string", "description": "The ID of the service principal."}}, "required": ["organization_id", "principal_id"]}}, {"name": "create_service_principal", "description": "Creates a new service principal.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "name": {"type": "string", "description": "The name of the new service principal."}}, "required": ["organization_id", "name"]}}, {"name": "update_service_principal", "description": "Updates a service principal.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "principal_id": {"type": "string", "description": "The ID of the service principal."}, "name": {"type": "string", "description": "The new name of the service principal."}}, "required": ["organization_id", "principal_id", "name"]}}, {"name": "list_secrets", "description": "Lists all secrets for a given application.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "project_id": {"type": "string", "description": "The ID of the project."}, "app_name": {"type": "string", "description": "The name of the application."}}, "required": ["organization_id", "project_id", "app_name"]}}, {"name": "get_secret", "description": "Gets a secret by its name.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "project_id": {"type": "string", "description": "The ID of the project."}, "app_name": {"type": "string", "description": "The name of the application."}, "secret_name": {"type": "string", "description": "The name of the secret."}}, "required": ["organization_id", "project_id", "app_name", "secret_name"]}}, {"name": "delete_secret", "description": "Deletes a secret by its name.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "project_id": {"type": "string", "description": "The ID of the project."}, "app_name": {"type": "string", "description": "The name of the application."}, "secret_name": {"type": "string", "description": "The name of the secret."}}, "required": ["organization_id", "project_id", "app_name", "secret_name"]}}, {"name": "create_secret", "description": "Creates a new secret.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "project_id": {"type": "string", "description": "The ID of the project."}, "app_name": {"type": "string", "description": "The name of the application."}, "secret_name": {"type": "string", "description": "The name of the new secret."}, "secret_value": {"type": "string", "description": "The value of the new secret."}}, "required": ["organization_id", "project_id", "app_name", "secret_name", "secret_value"]}}, {"name": "find_project_by_name", "description": "Finds a project by its name.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "name": {"type": "string", "description": "The name of the project."}}, "required": ["organization_id", "name"]}}, {"name": "find_user_by_email", "description": "Finds a user by their email.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "email": {"type": "string", "description": "The email of the user."}}, "required": ["organization_id", "email"]}}, {"name": "find_organization_by_name", "description": "Finds an organization by its name.", "inputSchema": {"type": "object", "properties": {"name": {"type": "string", "description": "The name of the organization."}}, "required": ["name"]}}, {"name": "list_resources", "description": "Lists all resources in a project.", "inputSchema": {"type": "object", "properties": {"project_id": {"type": "string", "description": "The ID of the project."}}, "required": ["project_id"]}}, {"name": "search_logs", "description": "Searches for audit logs in an organization using LogQL. At least one of `query`, `project_id`, or `topic` must be provided. For advanced filtering, use the `query` parameter with LogQL syntax. To filter on specific JSON fields in the log entries, use the `| json` parser in your query. For example: `query='| json | control_plane_event_action=\"CREATE\"'`", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "query": {"type": "string", "description": "The LogQL query string for advanced filtering. Can be combined with `project_id` and `topic`. Example: '| json | resource_uuid=\"some-uuid\"'"}, "project_id": {"type": "string", "description": "A project ID to filter by."}, "topic": {"type": "string", "description": "A log topic to search. Example topics: 'hashicorp.platform.audit', 'hashicorp.packer.registry.audit', 'hashicorp.boundary.cluster.audit', 'hashicorp.consul.cluster.audit'"}, "start_time": {"type": "string", "description": "The start time for the search. Accepts formats like '24 hours ago', 'yesterday at 5pm', or 'Oct 1, 2025'."}, "end_time": {"type": "string", "description": "The end time for the search. Accepts formats like 'now', 'today', or 'Oct 3, 2025'."}}, "required": ["organization_id", "start_time", "end_time"]}}]}, "id": 2}
2025-10-14 11:06:18,991 - mcp_server - INFO - Client call: {"method": "tools/call", "params": {"name": "search_logs", "arguments": {"end_time": "now", "organization_id": "11eab4a9-75f1-e0a5-8be1-0242ac110016", "start_time": "8 days ago"}}, "jsonrpc": "2.0", "id": 3}
2025-10-14 11:06:19,582 - mcp_server - INFO - Request data: stdio_main: {'jsonrpc': '2.0', 'error': {'code': -32000, 'message': 'Server error/A query, project_id, or topic must be provided to search logs./ValueError', 'data': 'A query, project_id, or topic must be provided to search logs.'}, 'id': 3}
2025-10-14 11:06:19,582 - mcp_server - INFO - Request data: stdio_main json: {"jsonrpc": "2.0", "error": {"code": -32000, "message": "Server error/A query, project_id, or topic must be provided to search logs./ValueError", "data": "A query, project_id, or topic must be provided to search logs."}, "id": 3}
2025-10-14 12:04:09,291 - mcp_server - INFO - Received request: {"method": "initialize", "params": {"protocolVersion": "2025-06-18", "capabilities": {"roots": {}}, "clientInfo": {"name": "gemini-cli-mcp-client-HCP", "version": "0.0.1"}}, "jsonrpc": "2.0", "id": 0}
2025-10-14 12:04:09,291 - mcp_server - INFO - Request data: stdio_main: {'jsonrpc': '2.0', 'result': {'protocolVersion': '2024-11-05', 'serverInfo': {'name': 'HCP', 'version': '0.0.1'}, 'capabilities': {'tools': {'listChanged': True}, 'prompts': {'listChanged': True}, 'resources': {'listChanged': True}}}, 'id': 0}
2025-10-14 12:04:09,291 - mcp_server - INFO - Request data: stdio_main json: {"jsonrpc": "2.0", "result": {"protocolVersion": "2024-11-05", "serverInfo": {"name": "HCP", "version": "0.0.1"}, "capabilities": {"tools": {"listChanged": true}, "prompts": {"listChanged": true}, "resources": {"listChanged": true}}}, "id": 0}
2025-10-14 12:04:09,292 - mcp_server - INFO - Received request: {"method": "notifications/initialized", "jsonrpc": "2.0"}
2025-10-14 12:04:09,292 - mcp_server - INFO - Client initialized.
2025-10-14 12:04:09,292 - mcp_server - INFO - Received request: {"method": "prompts/list", "params": {}, "jsonrpc": "2.0", "id": 1}
2025-10-14 12:04:09,292 - mcp_server - INFO - Request data: stdio_main: {'jsonrpc': '2.0', 'result': {'prompts': [{'name': 'list_projects', 'title': 'List Projects', 'description': 'Lists all HCP projects for a given organization.', 'arguments': [{'name': 'organization_id', 'description': 'The ID of the organization.', 'required': True}]}, {'name': 'get_project', 'title': 'Get Project', 'description': 'Gets an HCP project by its ID.', 'arguments': [{'name': 'project_id', 'description': 'The ID of the project.', 'required': True}]}, {'name': 'delete_project', 'title': 'Delete Project', 'description': 'Deletes an HCP project by its ID.', 'arguments': [{'name': 'project_id', 'description': 'The ID of the project.', 'required': True}]}, {'name': 'create_project', 'title': 'Create Project', 'description': 'Creates a new HCP project.', 'arguments': [{'name': 'name', 'description': 'The name of the new project.', 'required': True}, {'name': 'organization_id', 'description': 'The ID of the organization.', 'required': True}]}, {'name': 'update_project', 'title': 'Update Project', 'description': 'Updates an HCP project.', 'arguments': [{'name': 'project_id', 'description': 'The ID of the project.', 'required': True}, {'name': 'name', 'description': 'The new name for the project.', 'required': True}, {'name': 'organization_id', 'description': 'The ID of the organization.', 'required': True}]}, {'name': 'get_organization', 'title': 'Get Organization', 'description': 'Gets an HCP organization by its ID.', 'arguments': [{'name': 'organization_id', 'description': 'The ID of the organization.', 'required': True}]}, {'name': 'list_organizations', 'title': 'List Organizations', 'description': 'Lists all HCP organizations.', 'arguments': None}, {'name': 'update_organization', 'title': 'Update Organization', 'description': 'Updates an HCP organization.', 'arguments': [{'name': 'organization_id', 'description': 'The ID of the organization.', 'required': True}, {'name': 'name', 'description': 'The new name for the organization.', 'required': True}]}, {'name': 'list_secrets', 'title': 'List Secrets', 'description': 'Lists all secrets for a given application.', 'arguments': [{'name': 'project_id', 'description': 'The ID of the project.', 'required': True}, {'name': 'app_name', 'description': 'The name of the application.', 'required': True}]}, {'name': 'get_secret', 'title': 'Get Secret', 'description': 'Gets a secret by its name.', 'arguments': [{'name': 'secret_name', 'description': 'The name of the secret.', 'required': True}, {'name': 'project_id', 'description': 'The ID of the project.', 'required': True}, {'name': 'app_name', 'description': 'The name of the application.', 'required': True}]}, {'name': 'delete_secret', 'title': 'Delete Secret', 'description': 'Deletes a secret by its name.', 'arguments': [{'name': 'secret_name', 'description': 'The name of the secret.', 'required': True}, {'name': 'project_id', 'description': 'The ID of the project.', 'required': True}, {'name': 'app_name', 'description': 'The name of the application.', 'required': True}]}, {'name': 'create_secret', 'title': 'Create Secret', 'description': 'Creates a new secret.', 'arguments': [{'name': 'secret_name', 'description': 'The name of the new secret.', 'required': True}, {'name': 'secret_value', 'description': 'The value of the new secret.', 'required': True}, {'name': 'project_id', 'description': 'The ID of the project.', 'required': True}, {'name': 'app_name', 'description': 'The name of the application.', 'required': True}]}, {'name': 'find_project_and_list_secrets', 'title': 'Find Project and List Secrets', 'description': 'Finds a project by name and lists its secrets.', 'arguments': [{'name': 'project_name', 'description': 'The name of the project.', 'required': True}, {'name': 'organization_id', 'description': 'The ID of the organization.', 'required': True}, {'name': 'app_name', 'description': 'The name of the application.', 'required': True}]}, {'name': 'list_resources', 'title': 'List Resources', 'description': 'Lists all resources in a project.', 'arguments': [{'name': 'project_id', 'description': 'The ID of the project.', 'required': True}]}, {'name': 'search_logs', 'title': 'Search Logs', 'description': 'Searches for audit logs in an organization using LogQL. The LLM should determine the best topic to use based on the user\'s query, or default to \'hashicorp.platform.audit\' if the user is not specific. For advanced filtering, use the `query` parameter with LogQL syntax. To filter on specific JSON fields in the log entries, use the `| json` parser in your query. For example: `query=\'| json | control_plane_event_action="CREATE"\'`', 'arguments': [{'name': 'organization_id', 'description': 'The ID of the organization.', 'required': True}, {'name': 'query', 'description': 'The LogQL query string for advanced filtering. Can be combined with `project_id` and `topic`. Example: \'| json | resource_uuid="some-uuid"\'', 'required': False}, {'name': 'project_id', 'description': 'A project ID to filter by.', 'required': False}, {'name': 'topic', 'description': "A log topic to search. Example topics: 'hashicorp.platform.audit', 'hashicorp.packer.registry.audit', 'hashicorp.boundary.cluster.audit', 'hashicorp.consul.cluster.audit'", 'required': True}, {'name': 'start_time', 'description': "The start time for the search. Accepts formats like '24 hours ago', 'yesterday at 5pm', or 'Oct 1, 2025'.", 'required': True}, {'name': 'end_time', 'description': "The end time for the search. Accepts formats like 'now', 'today', or 'Oct 3, 2025'.", 'required': True}]}]}, 'id': 1}
2025-10-14 12:04:09,292 - mcp_server - INFO - Request data: stdio_main json: {"jsonrpc": "2.0", "result": {"prompts": [{"name": "list_projects", "title": "List Projects", "description": "Lists all HCP projects for a given organization.", "arguments": [{"name": "organization_id", "description": "The ID of the organization.", "required": true}]}, {"name": "get_project", "title": "Get Project", "description": "Gets an HCP project by its ID.", "arguments": [{"name": "project_id", "description": "The ID of the project.", "required": true}]}, {"name": "delete_project", "title": "Delete Project", "description": "Deletes an HCP project by its ID.", "arguments": [{"name": "project_id", "description": "The ID of the project.", "required": true}]}, {"name": "create_project", "title": "Create Project", "description": "Creates a new HCP project.", "arguments": [{"name": "name", "description": "The name of the new project.", "required": true}, {"name": "organization_id", "description": "The ID of the organization.", "required": true}]}, {"name": "update_project", "title": "Update Project", "description": "Updates an HCP project.", "arguments": [{"name": "project_id", "description": "The ID of the project.", "required": true}, {"name": "name", "description": "The new name for the project.", "required": true}, {"name": "organization_id", "description": "The ID of the organization.", "required": true}]}, {"name": "get_organization", "title": "Get Organization", "description": "Gets an HCP organization by its ID.", "arguments": [{"name": "organization_id", "description": "The ID of the organization.", "required": true}]}, {"name": "list_organizations", "title": "List Organizations", "description": "Lists all HCP organizations.", "arguments": null}, {"name": "update_organization", "title": "Update Organization", "description": "Updates an HCP organization.", "arguments": [{"name": "organization_id", "description": "The ID of the organization.", "required": true}, {"name": "name", "description": "The new name for the organization.", "required": true}]}, {"name": "list_secrets", "title": "List Secrets", "description": "Lists all secrets for a given application.", "arguments": [{"name": "project_id", "description": "The ID of the project.", "required": true}, {"name": "app_name", "description": "The name of the application.", "required": true}]}, {"name": "get_secret", "title": "Get Secret", "description": "Gets a secret by its name.", "arguments": [{"name": "secret_name", "description": "The name of the secret.", "required": true}, {"name": "project_id", "description": "The ID of the project.", "required": true}, {"name": "app_name", "description": "The name of the application.", "required": true}]}, {"name": "delete_secret", "title": "Delete Secret", "description": "Deletes a secret by its name.", "arguments": [{"name": "secret_name", "description": "The name of the secret.", "required": true}, {"name": "project_id", "description": "The ID of the project.", "required": true}, {"name": "app_name", "description": "The name of the application.", "required": true}]}, {"name": "create_secret", "title": "Create Secret", "description": "Creates a new secret.", "arguments": [{"name": "secret_name", "description": "The name of the new secret.", "required": true}, {"name": "secret_value", "description": "The value of the new secret.", "required": true}, {"name": "project_id", "description": "The ID of the project.", "required": true}, {"name": "app_name", "description": "The name of the application.", "required": true}]}, {"name": "find_project_and_list_secrets", "title": "Find Project and List Secrets", "description": "Finds a project by name and lists its secrets.", "arguments": [{"name": "project_name", "description": "The name of the project.", "required": true}, {"name": "organization_id", "description": "The ID of the organization.", "required": true}, {"name": "app_name", "description": "The name of the application.", "required": true}]}, {"name": "list_resources", "title": "List Resources", "description": "Lists all resources in a project.", "arguments": [{"name": "project_id", "description": "The ID of the project.", "required": true}]}, {"name": "search_logs", "title": "Search Logs", "description": "Searches for audit logs in an organization using LogQL. The LLM should determine the best topic to use based on the user's query, or default to 'hashicorp.platform.audit' if the user is not specific. For advanced filtering, use the `query` parameter with LogQL syntax. To filter on specific JSON fields in the log entries, use the `| json` parser in your query. For example: `query='| json | control_plane_event_action=\"CREATE\"'`", "arguments": [{"name": "organization_id", "description": "The ID of the organization.", "required": true}, {"name": "query", "description": "The LogQL query string for advanced filtering. Can be combined with `project_id` and `topic`. Example: '| json | resource_uuid=\"some-uuid\"'", "required": false}, {"name": "project_id", "description": "A project ID to filter by.", "required": false}, {"name": "topic", "description": "A log topic to search. Example topics: 'hashicorp.platform.audit', 'hashicorp.packer.registry.audit', 'hashicorp.boundary.cluster.audit', 'hashicorp.consul.cluster.audit'", "required": true}, {"name": "start_time", "description": "The start time for the search. Accepts formats like '24 hours ago', 'yesterday at 5pm', or 'Oct 1, 2025'.", "required": true}, {"name": "end_time", "description": "The end time for the search. Accepts formats like 'now', 'today', or 'Oct 3, 2025'.", "required": true}]}]}, "id": 1}
2025-10-14 12:04:09,292 - mcp_server - INFO - Received request: {"method": "tools/list", "params": {}, "jsonrpc": "2.0", "id": 2}
2025-10-14 12:04:09,292 - mcp_server - INFO - Request data: stdio_main: {'jsonrpc': '2.0', 'result': {'tools': [{'name': 'list_projects', 'description': 'Lists all HCP projects for a given organization.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}}, 'required': ['organization_id']}}, {'name': 'get_project', 'description': 'Gets an HCP project by its ID.', 'inputSchema': {'type': 'object', 'properties': {'project_id': {'type': 'string', 'description': 'The ID of the project.'}}, 'required': ['project_id']}}, {'name': 'delete_project', 'description': 'Deletes an HCP project by its ID.', 'inputSchema': {'type': 'object', 'properties': {'project_id': {'type': 'string', 'description': 'The ID of the project.'}}, 'required': ['project_id']}}, {'name': 'create_project', 'description': 'Creates a new HCP project.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'name': {'type': 'string', 'description': 'The name of the new project.'}}, 'required': ['organization_id', 'name']}}, {'name': 'update_project', 'description': 'Updates an HCP project.', 'inputSchema': {'type': 'object', 'properties': {'project_id': {'type': 'string', 'description': 'The ID of the project.'}, 'name': {'type': 'string', 'description': 'The new name of the project.'}}, 'required': ['project_id', 'name']}}, {'name': 'get_organization', 'description': 'Gets an HCP organization by its ID.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}}, 'required': ['organization_id']}}, {'name': 'list_organizations', 'description': 'Lists all HCP organizations.', 'inputSchema': {'type': 'object', 'properties': {}}}, {'name': 'update_organization', 'description': 'Updates an HCP organization.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'name': {'type': 'string', 'description': 'The new name of the organization.'}}, 'required': ['organization_id', 'name']}}, {'name': 'search_principals', 'description': 'Searches for principals in an organization.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'filter_str': {'type': 'string', 'description': 'The filter string to use for the search.'}}, 'required': ['organization_id']}}, {'name': 'get_principals', 'description': 'Gets principals by their IDs.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'principal_ids': {'type': 'array', 'items': {'type': 'string'}, 'description': 'The IDs of the principals to get.'}}, 'required': ['organization_id', 'principal_ids']}}, {'name': 'delete_service_principal', 'description': 'Deletes a service principal by its ID.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'principal_id': {'type': 'string', 'description': 'The ID of the service principal.'}}, 'required': ['organization_id', 'principal_id']}}, {'name': 'create_service_principal', 'description': 'Creates a new service principal.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'name': {'type': 'string', 'description': 'The name of the new service principal.'}}, 'required': ['organization_id', 'name']}}, {'name': 'update_service_principal', 'description': 'Updates a service principal.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'principal_id': {'type': 'string', 'description': 'The ID of the service principal.'}, 'name': {'type': 'string', 'description': 'The new name of the service principal.'}}, 'required': ['organization_id', 'principal_id', 'name']}}, {'name': 'list_secrets', 'description': 'Lists all secrets for a given application.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'project_id': {'type': 'string', 'description': 'The ID of the project.'}, 'app_name': {'type': 'string', 'description': 'The name of the application.'}}, 'required': ['organization_id', 'project_id', 'app_name']}}, {'name': 'get_secret', 'description': 'Gets a secret by its name.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'project_id': {'type': 'string', 'description': 'The ID of the project.'}, 'app_name': {'type': 'string', 'description': 'The name of the application.'}, 'secret_name': {'type': 'string', 'description': 'The name of the secret.'}}, 'required': ['organization_id', 'project_id', 'app_name', 'secret_name']}}, {'name': 'delete_secret', 'description': 'Deletes a secret by its name.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'project_id': {'type': 'string', 'description': 'The ID of the project.'}, 'app_name': {'type': 'string', 'description': 'The name of the application.'}, 'secret_name': {'type': 'string', 'description': 'The name of the secret.'}}, 'required': ['organization_id', 'project_id', 'app_name', 'secret_name']}}, {'name': 'create_secret', 'description': 'Creates a new secret.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'project_id': {'type': 'string', 'description': 'The ID of the project.'}, 'app_name': {'type': 'string', 'description': 'The name of the application.'}, 'secret_name': {'type': 'string', 'description': 'The name of the new secret.'}, 'secret_value': {'type': 'string', 'description': 'The value of the new secret.'}}, 'required': ['organization_id', 'project_id', 'app_name', 'secret_name', 'secret_value']}}, {'name': 'find_project_by_name', 'description': 'Finds a project by its name.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'name': {'type': 'string', 'description': 'The name of the project.'}}, 'required': ['organization_id', 'name']}}, {'name': 'find_user_by_email', 'description': 'Finds a user by their email.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'email': {'type': 'string', 'description': 'The email of the user.'}}, 'required': ['organization_id', 'email']}}, {'name': 'find_organization_by_name', 'description': 'Finds an organization by its name.', 'inputSchema': {'type': 'object', 'properties': {'name': {'type': 'string', 'description': 'The name of the organization.'}}, 'required': ['name']}}, {'name': 'list_resources', 'description': 'Lists all resources in a project.', 'inputSchema': {'type': 'object', 'properties': {'project_id': {'type': 'string', 'description': 'The ID of the project.'}}, 'required': ['project_id']}}, {'name': 'search_logs', 'description': 'Searches for audit logs in an organization using LogQL. At least one of `query`, `project_id`, or `topic` must be provided. For advanced filtering, use the `query` parameter with LogQL syntax. To filter on specific JSON fields in the log entries, use the `| json` parser in your query. For example: `query=\'| json | control_plane_event_action="CREATE"\'`', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'query': {'type': 'string', 'description': 'The LogQL query string for advanced filtering. Can be combined with `project_id` and `topic`. Example: \'| json | resource_uuid="some-uuid"\''}, 'project_id': {'type': 'string', 'description': 'A project ID to filter by.'}, 'topic': {'type': 'string', 'description': "A log topic to search. Example topics: 'hashicorp.platform.audit', 'hashicorp.packer.registry.audit', 'hashicorp.boundary.cluster.audit', 'hashicorp.consul.cluster.audit'"}, 'start_time': {'type': 'string', 'description': "The start time for the search. Accepts formats like '24 hours ago', 'yesterday at 5pm', or 'Oct 1, 2025'."}, 'end_time': {'type': 'string', 'description': "The end time for the search. Accepts formats like 'now', 'today', or 'Oct 3, 2025'."}}, 'required': ['organization_id', 'start_time', 'end_time']}}]}, 'id': 2}
2025-10-14 12:04:09,292 - mcp_server - INFO - Request data: stdio_main json: {"jsonrpc": "2.0", "result": {"tools": [{"name": "list_projects", "description": "Lists all HCP projects for a given organization.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}}, "required": ["organization_id"]}}, {"name": "get_project", "description": "Gets an HCP project by its ID.", "inputSchema": {"type": "object", "properties": {"project_id": {"type": "string", "description": "The ID of the project."}}, "required": ["project_id"]}}, {"name": "delete_project", "description": "Deletes an HCP project by its ID.", "inputSchema": {"type": "object", "properties": {"project_id": {"type": "string", "description": "The ID of the project."}}, "required": ["project_id"]}}, {"name": "create_project", "description": "Creates a new HCP project.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "name": {"type": "string", "description": "The name of the new project."}}, "required": ["organization_id", "name"]}}, {"name": "update_project", "description": "Updates an HCP project.", "inputSchema": {"type": "object", "properties": {"project_id": {"type": "string", "description": "The ID of the project."}, "name": {"type": "string", "description": "The new name of the project."}}, "required": ["project_id", "name"]}}, {"name": "get_organization", "description": "Gets an HCP organization by its ID.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}}, "required": ["organization_id"]}}, {"name": "list_organizations", "description": "Lists all HCP organizations.", "inputSchema": {"type": "object", "properties": {}}}, {"name": "update_organization", "description": "Updates an HCP organization.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "name": {"type": "string", "description": "The new name of the organization."}}, "required": ["organization_id", "name"]}}, {"name": "search_principals", "description": "Searches for principals in an organization.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "filter_str": {"type": "string", "description": "The filter string to use for the search."}}, "required": ["organization_id"]}}, {"name": "get_principals", "description": "Gets principals by their IDs.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "principal_ids": {"type": "array", "items": {"type": "string"}, "description": "The IDs of the principals to get."}}, "required": ["organization_id", "principal_ids"]}}, {"name": "delete_service_principal", "description": "Deletes a service principal by its ID.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "principal_id": {"type": "string", "description": "The ID of the service principal."}}, "required": ["organization_id", "principal_id"]}}, {"name": "create_service_principal", "description": "Creates a new service principal.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "name": {"type": "string", "description": "The name of the new service principal."}}, "required": ["organization_id", "name"]}}, {"name": "update_service_principal", "description": "Updates a service principal.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "principal_id": {"type": "string", "description": "The ID of the service principal."}, "name": {"type": "string", "description": "The new name of the service principal."}}, "required": ["organization_id", "principal_id", "name"]}}, {"name": "list_secrets", "description": "Lists all secrets for a given application.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "project_id": {"type": "string", "description": "The ID of the project."}, "app_name": {"type": "string", "description": "The name of the application."}}, "required": ["organization_id", "project_id", "app_name"]}}, {"name": "get_secret", "description": "Gets a secret by its name.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "project_id": {"type": "string", "description": "The ID of the project."}, "app_name": {"type": "string", "description": "The name of the application."}, "secret_name": {"type": "string", "description": "The name of the secret."}}, "required": ["organization_id", "project_id", "app_name", "secret_name"]}}, {"name": "delete_secret", "description": "Deletes a secret by its name.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "project_id": {"type": "string", "description": "The ID of the project."}, "app_name": {"type": "string", "description": "The name of the application."}, "secret_name": {"type": "string", "description": "The name of the secret."}}, "required": ["organization_id", "project_id", "app_name", "secret_name"]}}, {"name": "create_secret", "description": "Creates a new secret.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "project_id": {"type": "string", "description": "The ID of the project."}, "app_name": {"type": "string", "description": "The name of the application."}, "secret_name": {"type": "string", "description": "The name of the new secret."}, "secret_value": {"type": "string", "description": "The value of the new secret."}}, "required": ["organization_id", "project_id", "app_name", "secret_name", "secret_value"]}}, {"name": "find_project_by_name", "description": "Finds a project by its name.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "name": {"type": "string", "description": "The name of the project."}}, "required": ["organization_id", "name"]}}, {"name": "find_user_by_email", "description": "Finds a user by their email.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "email": {"type": "string", "description": "The email of the user."}}, "required": ["organization_id", "email"]}}, {"name": "find_organization_by_name", "description": "Finds an organization by its name.", "inputSchema": {"type": "object", "properties": {"name": {"type": "string", "description": "The name of the organization."}}, "required": ["name"]}}, {"name": "list_resources", "description": "Lists all resources in a project.", "inputSchema": {"type": "object", "properties": {"project_id": {"type": "string", "description": "The ID of the project."}}, "required": ["project_id"]}}, {"name": "search_logs", "description": "Searches for audit logs in an organization using LogQL. At least one of `query`, `project_id`, or `topic` must be provided. For advanced filtering, use the `query` parameter with LogQL syntax. To filter on specific JSON fields in the log entries, use the `| json` parser in your query. For example: `query='| json | control_plane_event_action=\"CREATE\"'`", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "query": {"type": "string", "description": "The LogQL query string for advanced filtering. Can be combined with `project_id` and `topic`. Example: '| json | resource_uuid=\"some-uuid\"'"}, "project_id": {"type": "string", "description": "A project ID to filter by."}, "topic": {"type": "string", "description": "A log topic to search. Example topics: 'hashicorp.platform.audit', 'hashicorp.packer.registry.audit', 'hashicorp.boundary.cluster.audit', 'hashicorp.consul.cluster.audit'"}, "start_time": {"type": "string", "description": "The start time for the search. Accepts formats like '24 hours ago', 'yesterday at 5pm', or 'Oct 1, 2025'."}, "end_time": {"type": "string", "description": "The end time for the search. Accepts formats like 'now', 'today', or 'Oct 3, 2025'."}}, "required": ["organization_id", "start_time", "end_time"]}}]}, "id": 2}
2025-10-14 12:04:24,449 - mcp_server - INFO - Client call: {"method": "tools/call", "params": {"name": "search_logs", "arguments": {"organization_id": "11eab4a9-75f1-e0a5-8be1-0242ac110016", "end_time": "now", "topic": "hashicorp.platform.audit", "start_time": "8 days ago"}}, "jsonrpc": "2.0", "id": 3}
2025-10-14 12:04:25,025 - mcp_server - ERROR - An unexpected error occurred: name 'prject_id' is not defined
Traceback (most recent call last):
  File "/Users/tpowell/Documents/workspace/hcp_mcp_server/main.py", line 174, in process_mcp_request
    result = await TOOL_MAP[tool_name](**arguments)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/Documents/workspace/hcp_mcp_server/hcp/audit_logs.py", line 41, in search_logs
    hcp_logger.info(f"query: {query}, topic {topic}, project_id {prject_id}")
                                                                 ^^^^^^^^^
NameError: name 'prject_id' is not defined. Did you mean: 'project_id'?
2025-10-14 12:04:25,027 - mcp_server - INFO - Request data: stdio_main: {'jsonrpc': '2.0', 'error': {'code': -32000, 'message': "Server error: name 'prject_id' is not defined", 'data': 'An unexpected error occurred. See logs for details.'}, 'id': 3}
2025-10-14 12:04:25,027 - mcp_server - INFO - Request data: stdio_main json: {"jsonrpc": "2.0", "error": {"code": -32000, "message": "Server error: name 'prject_id' is not defined", "data": "An unexpected error occurred. See logs for details."}, "id": 3}
2025-10-14 12:05:38,152 - mcp_server - INFO - Received request: {"method": "initialize", "params": {"protocolVersion": "2025-06-18", "capabilities": {"roots": {}}, "clientInfo": {"name": "gemini-cli-mcp-client-HCP", "version": "0.0.1"}}, "jsonrpc": "2.0", "id": 0}
2025-10-14 12:05:38,152 - mcp_server - INFO - Request data: stdio_main: {'jsonrpc': '2.0', 'result': {'protocolVersion': '2024-11-05', 'serverInfo': {'name': 'HCP', 'version': '0.0.1'}, 'capabilities': {'tools': {'listChanged': True}, 'prompts': {'listChanged': True}, 'resources': {'listChanged': True}}}, 'id': 0}
2025-10-14 12:05:38,152 - mcp_server - INFO - Request data: stdio_main json: {"jsonrpc": "2.0", "result": {"protocolVersion": "2024-11-05", "serverInfo": {"name": "HCP", "version": "0.0.1"}, "capabilities": {"tools": {"listChanged": true}, "prompts": {"listChanged": true}, "resources": {"listChanged": true}}}, "id": 0}
2025-10-14 12:05:38,153 - mcp_server - INFO - Received request: {"method": "notifications/initialized", "jsonrpc": "2.0"}
2025-10-14 12:05:38,153 - mcp_server - INFO - Client initialized.
2025-10-14 12:05:38,153 - mcp_server - INFO - Received request: {"method": "prompts/list", "params": {}, "jsonrpc": "2.0", "id": 1}
2025-10-14 12:05:38,153 - mcp_server - INFO - Request data: stdio_main: {'jsonrpc': '2.0', 'result': {'prompts': [{'name': 'list_projects', 'title': 'List Projects', 'description': 'Lists all HCP projects for a given organization.', 'arguments': [{'name': 'organization_id', 'description': 'The ID of the organization.', 'required': True}]}, {'name': 'get_project', 'title': 'Get Project', 'description': 'Gets an HCP project by its ID.', 'arguments': [{'name': 'project_id', 'description': 'The ID of the project.', 'required': True}]}, {'name': 'delete_project', 'title': 'Delete Project', 'description': 'Deletes an HCP project by its ID.', 'arguments': [{'name': 'project_id', 'description': 'The ID of the project.', 'required': True}]}, {'name': 'create_project', 'title': 'Create Project', 'description': 'Creates a new HCP project.', 'arguments': [{'name': 'name', 'description': 'The name of the new project.', 'required': True}, {'name': 'organization_id', 'description': 'The ID of the organization.', 'required': True}]}, {'name': 'update_project', 'title': 'Update Project', 'description': 'Updates an HCP project.', 'arguments': [{'name': 'project_id', 'description': 'The ID of the project.', 'required': True}, {'name': 'name', 'description': 'The new name for the project.', 'required': True}, {'name': 'organization_id', 'description': 'The ID of the organization.', 'required': True}]}, {'name': 'get_organization', 'title': 'Get Organization', 'description': 'Gets an HCP organization by its ID.', 'arguments': [{'name': 'organization_id', 'description': 'The ID of the organization.', 'required': True}]}, {'name': 'list_organizations', 'title': 'List Organizations', 'description': 'Lists all HCP organizations.', 'arguments': None}, {'name': 'update_organization', 'title': 'Update Organization', 'description': 'Updates an HCP organization.', 'arguments': [{'name': 'organization_id', 'description': 'The ID of the organization.', 'required': True}, {'name': 'name', 'description': 'The new name for the organization.', 'required': True}]}, {'name': 'list_secrets', 'title': 'List Secrets', 'description': 'Lists all secrets for a given application.', 'arguments': [{'name': 'project_id', 'description': 'The ID of the project.', 'required': True}, {'name': 'app_name', 'description': 'The name of the application.', 'required': True}]}, {'name': 'get_secret', 'title': 'Get Secret', 'description': 'Gets a secret by its name.', 'arguments': [{'name': 'secret_name', 'description': 'The name of the secret.', 'required': True}, {'name': 'project_id', 'description': 'The ID of the project.', 'required': True}, {'name': 'app_name', 'description': 'The name of the application.', 'required': True}]}, {'name': 'delete_secret', 'title': 'Delete Secret', 'description': 'Deletes a secret by its name.', 'arguments': [{'name': 'secret_name', 'description': 'The name of the secret.', 'required': True}, {'name': 'project_id', 'description': 'The ID of the project.', 'required': True}, {'name': 'app_name', 'description': 'The name of the application.', 'required': True}]}, {'name': 'create_secret', 'title': 'Create Secret', 'description': 'Creates a new secret.', 'arguments': [{'name': 'secret_name', 'description': 'The name of the new secret.', 'required': True}, {'name': 'secret_value', 'description': 'The value of the new secret.', 'required': True}, {'name': 'project_id', 'description': 'The ID of the project.', 'required': True}, {'name': 'app_name', 'description': 'The name of the application.', 'required': True}]}, {'name': 'find_project_and_list_secrets', 'title': 'Find Project and List Secrets', 'description': 'Finds a project by name and lists its secrets.', 'arguments': [{'name': 'project_name', 'description': 'The name of the project.', 'required': True}, {'name': 'organization_id', 'description': 'The ID of the organization.', 'required': True}, {'name': 'app_name', 'description': 'The name of the application.', 'required': True}]}, {'name': 'list_resources', 'title': 'List Resources', 'description': 'Lists all resources in a project.', 'arguments': [{'name': 'project_id', 'description': 'The ID of the project.', 'required': True}]}, {'name': 'search_logs', 'title': 'Search Logs', 'description': 'Searches for audit logs in an organization using LogQL. The LLM should determine the best topic to use based on the user\'s query, or default to \'hashicorp.platform.audit\' if the user is not specific. For advanced filtering, use the `query` parameter with LogQL syntax. To filter on specific JSON fields in the log entries, use the `| json` parser in your query. For example: `query=\'| json | control_plane_event_action="CREATE"\'`', 'arguments': [{'name': 'organization_id', 'description': 'The ID of the organization.', 'required': True}, {'name': 'query', 'description': 'The LogQL query string for advanced filtering. Can be combined with `project_id` and `topic`. Example: \'| json | resource_uuid="some-uuid"\'', 'required': False}, {'name': 'project_id', 'description': 'A project ID to filter by.', 'required': False}, {'name': 'topic', 'description': "A log topic to search. Example topics: 'hashicorp.platform.audit', 'hashicorp.packer.registry.audit', 'hashicorp.boundary.cluster.audit', 'hashicorp.consul.cluster.audit'", 'required': True}, {'name': 'start_time', 'description': "The start time for the search. Accepts formats like '24 hours ago', 'yesterday at 5pm', or 'Oct 1, 2025'.", 'required': True}, {'name': 'end_time', 'description': "The end time for the search. Accepts formats like 'now', 'today', or 'Oct 3, 2025'.", 'required': True}]}]}, 'id': 1}
2025-10-14 12:05:38,153 - mcp_server - INFO - Request data: stdio_main json: {"jsonrpc": "2.0", "result": {"prompts": [{"name": "list_projects", "title": "List Projects", "description": "Lists all HCP projects for a given organization.", "arguments": [{"name": "organization_id", "description": "The ID of the organization.", "required": true}]}, {"name": "get_project", "title": "Get Project", "description": "Gets an HCP project by its ID.", "arguments": [{"name": "project_id", "description": "The ID of the project.", "required": true}]}, {"name": "delete_project", "title": "Delete Project", "description": "Deletes an HCP project by its ID.", "arguments": [{"name": "project_id", "description": "The ID of the project.", "required": true}]}, {"name": "create_project", "title": "Create Project", "description": "Creates a new HCP project.", "arguments": [{"name": "name", "description": "The name of the new project.", "required": true}, {"name": "organization_id", "description": "The ID of the organization.", "required": true}]}, {"name": "update_project", "title": "Update Project", "description": "Updates an HCP project.", "arguments": [{"name": "project_id", "description": "The ID of the project.", "required": true}, {"name": "name", "description": "The new name for the project.", "required": true}, {"name": "organization_id", "description": "The ID of the organization.", "required": true}]}, {"name": "get_organization", "title": "Get Organization", "description": "Gets an HCP organization by its ID.", "arguments": [{"name": "organization_id", "description": "The ID of the organization.", "required": true}]}, {"name": "list_organizations", "title": "List Organizations", "description": "Lists all HCP organizations.", "arguments": null}, {"name": "update_organization", "title": "Update Organization", "description": "Updates an HCP organization.", "arguments": [{"name": "organization_id", "description": "The ID of the organization.", "required": true}, {"name": "name", "description": "The new name for the organization.", "required": true}]}, {"name": "list_secrets", "title": "List Secrets", "description": "Lists all secrets for a given application.", "arguments": [{"name": "project_id", "description": "The ID of the project.", "required": true}, {"name": "app_name", "description": "The name of the application.", "required": true}]}, {"name": "get_secret", "title": "Get Secret", "description": "Gets a secret by its name.", "arguments": [{"name": "secret_name", "description": "The name of the secret.", "required": true}, {"name": "project_id", "description": "The ID of the project.", "required": true}, {"name": "app_name", "description": "The name of the application.", "required": true}]}, {"name": "delete_secret", "title": "Delete Secret", "description": "Deletes a secret by its name.", "arguments": [{"name": "secret_name", "description": "The name of the secret.", "required": true}, {"name": "project_id", "description": "The ID of the project.", "required": true}, {"name": "app_name", "description": "The name of the application.", "required": true}]}, {"name": "create_secret", "title": "Create Secret", "description": "Creates a new secret.", "arguments": [{"name": "secret_name", "description": "The name of the new secret.", "required": true}, {"name": "secret_value", "description": "The value of the new secret.", "required": true}, {"name": "project_id", "description": "The ID of the project.", "required": true}, {"name": "app_name", "description": "The name of the application.", "required": true}]}, {"name": "find_project_and_list_secrets", "title": "Find Project and List Secrets", "description": "Finds a project by name and lists its secrets.", "arguments": [{"name": "project_name", "description": "The name of the project.", "required": true}, {"name": "organization_id", "description": "The ID of the organization.", "required": true}, {"name": "app_name", "description": "The name of the application.", "required": true}]}, {"name": "list_resources", "title": "List Resources", "description": "Lists all resources in a project.", "arguments": [{"name": "project_id", "description": "The ID of the project.", "required": true}]}, {"name": "search_logs", "title": "Search Logs", "description": "Searches for audit logs in an organization using LogQL. The LLM should determine the best topic to use based on the user's query, or default to 'hashicorp.platform.audit' if the user is not specific. For advanced filtering, use the `query` parameter with LogQL syntax. To filter on specific JSON fields in the log entries, use the `| json` parser in your query. For example: `query='| json | control_plane_event_action=\"CREATE\"'`", "arguments": [{"name": "organization_id", "description": "The ID of the organization.", "required": true}, {"name": "query", "description": "The LogQL query string for advanced filtering. Can be combined with `project_id` and `topic`. Example: '| json | resource_uuid=\"some-uuid\"'", "required": false}, {"name": "project_id", "description": "A project ID to filter by.", "required": false}, {"name": "topic", "description": "A log topic to search. Example topics: 'hashicorp.platform.audit', 'hashicorp.packer.registry.audit', 'hashicorp.boundary.cluster.audit', 'hashicorp.consul.cluster.audit'", "required": true}, {"name": "start_time", "description": "The start time for the search. Accepts formats like '24 hours ago', 'yesterday at 5pm', or 'Oct 1, 2025'.", "required": true}, {"name": "end_time", "description": "The end time for the search. Accepts formats like 'now', 'today', or 'Oct 3, 2025'.", "required": true}]}]}, "id": 1}
2025-10-14 12:05:38,153 - mcp_server - INFO - Received request: {"method": "tools/list", "params": {}, "jsonrpc": "2.0", "id": 2}
2025-10-14 12:05:38,153 - mcp_server - INFO - Request data: stdio_main: {'jsonrpc': '2.0', 'result': {'tools': [{'name': 'list_projects', 'description': 'Lists all HCP projects for a given organization.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}}, 'required': ['organization_id']}}, {'name': 'get_project', 'description': 'Gets an HCP project by its ID.', 'inputSchema': {'type': 'object', 'properties': {'project_id': {'type': 'string', 'description': 'The ID of the project.'}}, 'required': ['project_id']}}, {'name': 'delete_project', 'description': 'Deletes an HCP project by its ID.', 'inputSchema': {'type': 'object', 'properties': {'project_id': {'type': 'string', 'description': 'The ID of the project.'}}, 'required': ['project_id']}}, {'name': 'create_project', 'description': 'Creates a new HCP project.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'name': {'type': 'string', 'description': 'The name of the new project.'}}, 'required': ['organization_id', 'name']}}, {'name': 'update_project', 'description': 'Updates an HCP project.', 'inputSchema': {'type': 'object', 'properties': {'project_id': {'type': 'string', 'description': 'The ID of the project.'}, 'name': {'type': 'string', 'description': 'The new name of the project.'}}, 'required': ['project_id', 'name']}}, {'name': 'get_organization', 'description': 'Gets an HCP organization by its ID.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}}, 'required': ['organization_id']}}, {'name': 'list_organizations', 'description': 'Lists all HCP organizations.', 'inputSchema': {'type': 'object', 'properties': {}}}, {'name': 'update_organization', 'description': 'Updates an HCP organization.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'name': {'type': 'string', 'description': 'The new name of the organization.'}}, 'required': ['organization_id', 'name']}}, {'name': 'search_principals', 'description': 'Searches for principals in an organization.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'filter_str': {'type': 'string', 'description': 'The filter string to use for the search.'}}, 'required': ['organization_id']}}, {'name': 'get_principals', 'description': 'Gets principals by their IDs.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'principal_ids': {'type': 'array', 'items': {'type': 'string'}, 'description': 'The IDs of the principals to get.'}}, 'required': ['organization_id', 'principal_ids']}}, {'name': 'delete_service_principal', 'description': 'Deletes a service principal by its ID.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'principal_id': {'type': 'string', 'description': 'The ID of the service principal.'}}, 'required': ['organization_id', 'principal_id']}}, {'name': 'create_service_principal', 'description': 'Creates a new service principal.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'name': {'type': 'string', 'description': 'The name of the new service principal.'}}, 'required': ['organization_id', 'name']}}, {'name': 'update_service_principal', 'description': 'Updates a service principal.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'principal_id': {'type': 'string', 'description': 'The ID of the service principal.'}, 'name': {'type': 'string', 'description': 'The new name of the service principal.'}}, 'required': ['organization_id', 'principal_id', 'name']}}, {'name': 'list_secrets', 'description': 'Lists all secrets for a given application.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'project_id': {'type': 'string', 'description': 'The ID of the project.'}, 'app_name': {'type': 'string', 'description': 'The name of the application.'}}, 'required': ['organization_id', 'project_id', 'app_name']}}, {'name': 'get_secret', 'description': 'Gets a secret by its name.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'project_id': {'type': 'string', 'description': 'The ID of the project.'}, 'app_name': {'type': 'string', 'description': 'The name of the application.'}, 'secret_name': {'type': 'string', 'description': 'The name of the secret.'}}, 'required': ['organization_id', 'project_id', 'app_name', 'secret_name']}}, {'name': 'delete_secret', 'description': 'Deletes a secret by its name.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'project_id': {'type': 'string', 'description': 'The ID of the project.'}, 'app_name': {'type': 'string', 'description': 'The name of the application.'}, 'secret_name': {'type': 'string', 'description': 'The name of the secret.'}}, 'required': ['organization_id', 'project_id', 'app_name', 'secret_name']}}, {'name': 'create_secret', 'description': 'Creates a new secret.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'project_id': {'type': 'string', 'description': 'The ID of the project.'}, 'app_name': {'type': 'string', 'description': 'The name of the application.'}, 'secret_name': {'type': 'string', 'description': 'The name of the new secret.'}, 'secret_value': {'type': 'string', 'description': 'The value of the new secret.'}}, 'required': ['organization_id', 'project_id', 'app_name', 'secret_name', 'secret_value']}}, {'name': 'find_project_by_name', 'description': 'Finds a project by its name.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'name': {'type': 'string', 'description': 'The name of the project.'}}, 'required': ['organization_id', 'name']}}, {'name': 'find_user_by_email', 'description': 'Finds a user by their email.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'email': {'type': 'string', 'description': 'The email of the user.'}}, 'required': ['organization_id', 'email']}}, {'name': 'find_organization_by_name', 'description': 'Finds an organization by its name.', 'inputSchema': {'type': 'object', 'properties': {'name': {'type': 'string', 'description': 'The name of the organization.'}}, 'required': ['name']}}, {'name': 'list_resources', 'description': 'Lists all resources in a project.', 'inputSchema': {'type': 'object', 'properties': {'project_id': {'type': 'string', 'description': 'The ID of the project.'}}, 'required': ['project_id']}}, {'name': 'search_logs', 'description': 'Searches for audit logs in an organization using LogQL. At least one of `query`, `project_id`, or `topic` must be provided. For advanced filtering, use the `query` parameter with LogQL syntax. To filter on specific JSON fields in the log entries, use the `| json` parser in your query. For example: `query=\'| json | control_plane_event_action="CREATE"\'`', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'query': {'type': 'string', 'description': 'The LogQL query string for advanced filtering. Can be combined with `project_id` and `topic`. Example: \'| json | resource_uuid="some-uuid"\''}, 'project_id': {'type': 'string', 'description': 'A project ID to filter by.'}, 'topic': {'type': 'string', 'description': "A log topic to search. Example topics: 'hashicorp.platform.audit', 'hashicorp.packer.registry.audit', 'hashicorp.boundary.cluster.audit', 'hashicorp.consul.cluster.audit'"}, 'start_time': {'type': 'string', 'description': "The start time for the search. Accepts formats like '24 hours ago', 'yesterday at 5pm', or 'Oct 1, 2025'."}, 'end_time': {'type': 'string', 'description': "The end time for the search. Accepts formats like 'now', 'today', or 'Oct 3, 2025'."}}, 'required': ['organization_id', 'start_time', 'end_time']}}]}, 'id': 2}
2025-10-14 12:05:38,153 - mcp_server - INFO - Request data: stdio_main json: {"jsonrpc": "2.0", "result": {"tools": [{"name": "list_projects", "description": "Lists all HCP projects for a given organization.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}}, "required": ["organization_id"]}}, {"name": "get_project", "description": "Gets an HCP project by its ID.", "inputSchema": {"type": "object", "properties": {"project_id": {"type": "string", "description": "The ID of the project."}}, "required": ["project_id"]}}, {"name": "delete_project", "description": "Deletes an HCP project by its ID.", "inputSchema": {"type": "object", "properties": {"project_id": {"type": "string", "description": "The ID of the project."}}, "required": ["project_id"]}}, {"name": "create_project", "description": "Creates a new HCP project.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "name": {"type": "string", "description": "The name of the new project."}}, "required": ["organization_id", "name"]}}, {"name": "update_project", "description": "Updates an HCP project.", "inputSchema": {"type": "object", "properties": {"project_id": {"type": "string", "description": "The ID of the project."}, "name": {"type": "string", "description": "The new name of the project."}}, "required": ["project_id", "name"]}}, {"name": "get_organization", "description": "Gets an HCP organization by its ID.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}}, "required": ["organization_id"]}}, {"name": "list_organizations", "description": "Lists all HCP organizations.", "inputSchema": {"type": "object", "properties": {}}}, {"name": "update_organization", "description": "Updates an HCP organization.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "name": {"type": "string", "description": "The new name of the organization."}}, "required": ["organization_id", "name"]}}, {"name": "search_principals", "description": "Searches for principals in an organization.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "filter_str": {"type": "string", "description": "The filter string to use for the search."}}, "required": ["organization_id"]}}, {"name": "get_principals", "description": "Gets principals by their IDs.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "principal_ids": {"type": "array", "items": {"type": "string"}, "description": "The IDs of the principals to get."}}, "required": ["organization_id", "principal_ids"]}}, {"name": "delete_service_principal", "description": "Deletes a service principal by its ID.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "principal_id": {"type": "string", "description": "The ID of the service principal."}}, "required": ["organization_id", "principal_id"]}}, {"name": "create_service_principal", "description": "Creates a new service principal.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "name": {"type": "string", "description": "The name of the new service principal."}}, "required": ["organization_id", "name"]}}, {"name": "update_service_principal", "description": "Updates a service principal.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "principal_id": {"type": "string", "description": "The ID of the service principal."}, "name": {"type": "string", "description": "The new name of the service principal."}}, "required": ["organization_id", "principal_id", "name"]}}, {"name": "list_secrets", "description": "Lists all secrets for a given application.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "project_id": {"type": "string", "description": "The ID of the project."}, "app_name": {"type": "string", "description": "The name of the application."}}, "required": ["organization_id", "project_id", "app_name"]}}, {"name": "get_secret", "description": "Gets a secret by its name.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "project_id": {"type": "string", "description": "The ID of the project."}, "app_name": {"type": "string", "description": "The name of the application."}, "secret_name": {"type": "string", "description": "The name of the secret."}}, "required": ["organization_id", "project_id", "app_name", "secret_name"]}}, {"name": "delete_secret", "description": "Deletes a secret by its name.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "project_id": {"type": "string", "description": "The ID of the project."}, "app_name": {"type": "string", "description": "The name of the application."}, "secret_name": {"type": "string", "description": "The name of the secret."}}, "required": ["organization_id", "project_id", "app_name", "secret_name"]}}, {"name": "create_secret", "description": "Creates a new secret.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "project_id": {"type": "string", "description": "The ID of the project."}, "app_name": {"type": "string", "description": "The name of the application."}, "secret_name": {"type": "string", "description": "The name of the new secret."}, "secret_value": {"type": "string", "description": "The value of the new secret."}}, "required": ["organization_id", "project_id", "app_name", "secret_name", "secret_value"]}}, {"name": "find_project_by_name", "description": "Finds a project by its name.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "name": {"type": "string", "description": "The name of the project."}}, "required": ["organization_id", "name"]}}, {"name": "find_user_by_email", "description": "Finds a user by their email.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "email": {"type": "string", "description": "The email of the user."}}, "required": ["organization_id", "email"]}}, {"name": "find_organization_by_name", "description": "Finds an organization by its name.", "inputSchema": {"type": "object", "properties": {"name": {"type": "string", "description": "The name of the organization."}}, "required": ["name"]}}, {"name": "list_resources", "description": "Lists all resources in a project.", "inputSchema": {"type": "object", "properties": {"project_id": {"type": "string", "description": "The ID of the project."}}, "required": ["project_id"]}}, {"name": "search_logs", "description": "Searches for audit logs in an organization using LogQL. At least one of `query`, `project_id`, or `topic` must be provided. For advanced filtering, use the `query` parameter with LogQL syntax. To filter on specific JSON fields in the log entries, use the `| json` parser in your query. For example: `query='| json | control_plane_event_action=\"CREATE\"'`", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "query": {"type": "string", "description": "The LogQL query string for advanced filtering. Can be combined with `project_id` and `topic`. Example: '| json | resource_uuid=\"some-uuid\"'"}, "project_id": {"type": "string", "description": "A project ID to filter by."}, "topic": {"type": "string", "description": "A log topic to search. Example topics: 'hashicorp.platform.audit', 'hashicorp.packer.registry.audit', 'hashicorp.boundary.cluster.audit', 'hashicorp.consul.cluster.audit'"}, "start_time": {"type": "string", "description": "The start time for the search. Accepts formats like '24 hours ago', 'yesterday at 5pm', or 'Oct 1, 2025'."}, "end_time": {"type": "string", "description": "The end time for the search. Accepts formats like 'now', 'today', or 'Oct 3, 2025'."}}, "required": ["organization_id", "start_time", "end_time"]}}]}, "id": 2}
2025-10-14 12:05:49,301 - mcp_server - INFO - Client call: {"method": "tools/call", "params": {"name": "search_logs", "arguments": {"end_time": "now", "start_time": "8 days ago", "organization_id": "11eab4a9-75f1-e0a5-8be1-0242ac110016", "topic": "hashicorp.platform.audit"}}, "jsonrpc": "2.0", "id": 3}
2025-10-14 12:05:55,213 - mcp_server - ERROR - An unexpected error occurred: 
Traceback (most recent call last):
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpx/_transports/default.py", line 101, in map_httpcore_exceptions
    yield
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpx/_transports/default.py", line 394, in handle_async_request
    resp = await self._pool.handle_async_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpcore/_async/connection_pool.py", line 256, in handle_async_request
    raise exc from None
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpcore/_async/connection_pool.py", line 236, in handle_async_request
    response = await connection.handle_async_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpcore/_async/connection.py", line 103, in handle_async_request
    return await self._connection.handle_async_request(request)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpcore/_async/http11.py", line 136, in handle_async_request
    raise exc
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpcore/_async/http11.py", line 106, in handle_async_request
    ) = await self._receive_response_headers(**kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpcore/_async/http11.py", line 177, in _receive_response_headers
    event = await self._receive_event(timeout=timeout)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpcore/_async/http11.py", line 217, in _receive_event
    data = await self._network_stream.read(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpcore/_backends/anyio.py", line 32, in read
    with map_exceptions(exc_map):
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/contextlib.py", line 158, in __exit__
    self.gen.throw(value)
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ReadTimeout

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/tpowell/Documents/workspace/hcp_mcp_server/main.py", line 174, in process_mcp_request
    result = await TOOL_MAP[tool_name](**arguments)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/Documents/workspace/hcp_mcp_server/hcp/audit_logs.py", line 86, in search_logs
    response = await client.post(
               ^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpx/_client.py", line 1859, in post
    return await self.request(
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpx/_client.py", line 1540, in request
    return await self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpx/_client.py", line 1629, in send
    response = await self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpx/_client.py", line 1657, in _send_handling_auth
    response = await self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpx/_client.py", line 1694, in _send_handling_redirects
    response = await self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpx/_client.py", line 1730, in _send_single_request
    response = await transport.handle_async_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpx/_transports/default.py", line 393, in handle_async_request
    with map_httpcore_exceptions():
         ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/contextlib.py", line 158, in __exit__
    self.gen.throw(value)
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpx/_transports/default.py", line 118, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ReadTimeout
2025-10-14 12:05:55,222 - mcp_server - INFO - Request data: stdio_main: {'jsonrpc': '2.0', 'error': {'code': -32000, 'message': 'Server error: ', 'data': 'An unexpected error occurred. See logs for details.'}, 'id': 3}
2025-10-14 12:05:55,222 - mcp_server - INFO - Request data: stdio_main json: {"jsonrpc": "2.0", "error": {"code": -32000, "message": "Server error: ", "data": "An unexpected error occurred. See logs for details."}, "id": 3}
2025-10-14 13:42:19,919 - mcp_server - INFO - Received request: {"method": "initialize", "params": {"protocolVersion": "2025-06-18", "capabilities": {"roots": {}}, "clientInfo": {"name": "gemini-cli-mcp-client-HCP", "version": "0.0.1"}}, "jsonrpc": "2.0", "id": 0}
2025-10-14 13:42:19,919 - mcp_server - INFO - Request data: stdio_main: {'jsonrpc': '2.0', 'result': {'protocolVersion': '2024-11-05', 'serverInfo': {'name': 'HCP', 'version': '0.0.1'}, 'capabilities': {'tools': {'listChanged': True}, 'prompts': {'listChanged': True}, 'resources': {'listChanged': True}}}, 'id': 0}
2025-10-14 13:42:19,919 - mcp_server - INFO - Request data: stdio_main json: {"jsonrpc": "2.0", "result": {"protocolVersion": "2024-11-05", "serverInfo": {"name": "HCP", "version": "0.0.1"}, "capabilities": {"tools": {"listChanged": true}, "prompts": {"listChanged": true}, "resources": {"listChanged": true}}}, "id": 0}
2025-10-14 13:42:19,920 - mcp_server - INFO - Received request: {"method": "notifications/initialized", "jsonrpc": "2.0"}
2025-10-14 13:42:19,920 - mcp_server - INFO - Client initialized.
2025-10-14 13:42:19,920 - mcp_server - INFO - Received request: {"method": "prompts/list", "params": {}, "jsonrpc": "2.0", "id": 1}
2025-10-14 13:42:19,920 - mcp_server - INFO - Request data: stdio_main: {'jsonrpc': '2.0', 'result': {'prompts': [{'name': 'list_projects', 'title': 'List Projects', 'description': 'Lists all HCP projects for a given organization.', 'arguments': [{'name': 'organization_id', 'description': 'The ID of the organization.', 'required': True}]}, {'name': 'get_project', 'title': 'Get Project', 'description': 'Gets an HCP project by its ID.', 'arguments': [{'name': 'project_id', 'description': 'The ID of the project.', 'required': True}]}, {'name': 'delete_project', 'title': 'Delete Project', 'description': 'Deletes an HCP project by its ID.', 'arguments': [{'name': 'project_id', 'description': 'The ID of the project.', 'required': True}]}, {'name': 'create_project', 'title': 'Create Project', 'description': 'Creates a new HCP project.', 'arguments': [{'name': 'name', 'description': 'The name of the new project.', 'required': True}, {'name': 'organization_id', 'description': 'The ID of the organization.', 'required': True}]}, {'name': 'update_project', 'title': 'Update Project', 'description': 'Updates an HCP project.', 'arguments': [{'name': 'project_id', 'description': 'The ID of the project.', 'required': True}, {'name': 'name', 'description': 'The new name for the project.', 'required': True}, {'name': 'organization_id', 'description': 'The ID of the organization.', 'required': True}]}, {'name': 'get_organization', 'title': 'Get Organization', 'description': 'Gets an HCP organization by its ID.', 'arguments': [{'name': 'organization_id', 'description': 'The ID of the organization.', 'required': True}]}, {'name': 'list_organizations', 'title': 'List Organizations', 'description': 'Lists all HCP organizations.', 'arguments': None}, {'name': 'update_organization', 'title': 'Update Organization', 'description': 'Updates an HCP organization.', 'arguments': [{'name': 'organization_id', 'description': 'The ID of the organization.', 'required': True}, {'name': 'name', 'description': 'The new name for the organization.', 'required': True}]}, {'name': 'list_secrets', 'title': 'List Secrets', 'description': 'Lists all secrets for a given application.', 'arguments': [{'name': 'project_id', 'description': 'The ID of the project.', 'required': True}, {'name': 'app_name', 'description': 'The name of the application.', 'required': True}]}, {'name': 'get_secret', 'title': 'Get Secret', 'description': 'Gets a secret by its name.', 'arguments': [{'name': 'secret_name', 'description': 'The name of the secret.', 'required': True}, {'name': 'project_id', 'description': 'The ID of the project.', 'required': True}, {'name': 'app_name', 'description': 'The name of the application.', 'required': True}]}, {'name': 'delete_secret', 'title': 'Delete Secret', 'description': 'Deletes a secret by its name.', 'arguments': [{'name': 'secret_name', 'description': 'The name of the secret.', 'required': True}, {'name': 'project_id', 'description': 'The ID of the project.', 'required': True}, {'name': 'app_name', 'description': 'The name of the application.', 'required': True}]}, {'name': 'create_secret', 'title': 'Create Secret', 'description': 'Creates a new secret.', 'arguments': [{'name': 'secret_name', 'description': 'The name of the new secret.', 'required': True}, {'name': 'secret_value', 'description': 'The value of the new secret.', 'required': True}, {'name': 'project_id', 'description': 'The ID of the project.', 'required': True}, {'name': 'app_name', 'description': 'The name of the application.', 'required': True}]}, {'name': 'find_project_and_list_secrets', 'title': 'Find Project and List Secrets', 'description': 'Finds a project by name and lists its secrets.', 'arguments': [{'name': 'project_name', 'description': 'The name of the project.', 'required': True}, {'name': 'organization_id', 'description': 'The ID of the organization.', 'required': True}, {'name': 'app_name', 'description': 'The name of the application.', 'required': True}]}, {'name': 'list_resources', 'title': 'List Resources', 'description': 'Lists all resources in a project.', 'arguments': [{'name': 'project_id', 'description': 'The ID of the project.', 'required': True}]}, {'name': 'search_logs', 'title': 'Search Logs', 'description': 'Searches for audit logs in an organization using LogQL. The LLM should determine the best topic to use based on the user\'s query, or default to \'hashicorp.platform.audit\' if the user is not specific. For advanced filtering, use the `query` parameter with LogQL syntax. To filter on specific JSON fields in the log entries, use the `| json` parser in your query. For example: `query=\'| json | control_plane_event_action="CREATE"\'`', 'arguments': [{'name': 'organization_id', 'description': 'The ID of the organization.', 'required': True}, {'name': 'query', 'description': 'The LogQL query string for advanced filtering. Can be combined with `project_id` and `topic`. Example: \'| json | resource_uuid="some-uuid"\'', 'required': False}, {'name': 'project_id', 'description': 'A project ID to filter by.', 'required': False}, {'name': 'topic', 'description': "A log topic to search. Example topics: 'hashicorp.platform.audit', 'hashicorp.packer.registry.audit', 'hashicorp.boundary.cluster.audit', 'hashicorp.consul.cluster.audit'", 'required': True}, {'name': 'start_time', 'description': "The start time for the search. Accepts formats like '24 hours ago', 'yesterday at 5pm', or 'Oct 1, 2025'.", 'required': True}, {'name': 'end_time', 'description': "The end time for the search. Accepts formats like 'now', 'today', or 'Oct 3, 2025'.", 'required': True}]}]}, 'id': 1}
2025-10-14 13:42:19,920 - mcp_server - INFO - Request data: stdio_main json: {"jsonrpc": "2.0", "result": {"prompts": [{"name": "list_projects", "title": "List Projects", "description": "Lists all HCP projects for a given organization.", "arguments": [{"name": "organization_id", "description": "The ID of the organization.", "required": true}]}, {"name": "get_project", "title": "Get Project", "description": "Gets an HCP project by its ID.", "arguments": [{"name": "project_id", "description": "The ID of the project.", "required": true}]}, {"name": "delete_project", "title": "Delete Project", "description": "Deletes an HCP project by its ID.", "arguments": [{"name": "project_id", "description": "The ID of the project.", "required": true}]}, {"name": "create_project", "title": "Create Project", "description": "Creates a new HCP project.", "arguments": [{"name": "name", "description": "The name of the new project.", "required": true}, {"name": "organization_id", "description": "The ID of the organization.", "required": true}]}, {"name": "update_project", "title": "Update Project", "description": "Updates an HCP project.", "arguments": [{"name": "project_id", "description": "The ID of the project.", "required": true}, {"name": "name", "description": "The new name for the project.", "required": true}, {"name": "organization_id", "description": "The ID of the organization.", "required": true}]}, {"name": "get_organization", "title": "Get Organization", "description": "Gets an HCP organization by its ID.", "arguments": [{"name": "organization_id", "description": "The ID of the organization.", "required": true}]}, {"name": "list_organizations", "title": "List Organizations", "description": "Lists all HCP organizations.", "arguments": null}, {"name": "update_organization", "title": "Update Organization", "description": "Updates an HCP organization.", "arguments": [{"name": "organization_id", "description": "The ID of the organization.", "required": true}, {"name": "name", "description": "The new name for the organization.", "required": true}]}, {"name": "list_secrets", "title": "List Secrets", "description": "Lists all secrets for a given application.", "arguments": [{"name": "project_id", "description": "The ID of the project.", "required": true}, {"name": "app_name", "description": "The name of the application.", "required": true}]}, {"name": "get_secret", "title": "Get Secret", "description": "Gets a secret by its name.", "arguments": [{"name": "secret_name", "description": "The name of the secret.", "required": true}, {"name": "project_id", "description": "The ID of the project.", "required": true}, {"name": "app_name", "description": "The name of the application.", "required": true}]}, {"name": "delete_secret", "title": "Delete Secret", "description": "Deletes a secret by its name.", "arguments": [{"name": "secret_name", "description": "The name of the secret.", "required": true}, {"name": "project_id", "description": "The ID of the project.", "required": true}, {"name": "app_name", "description": "The name of the application.", "required": true}]}, {"name": "create_secret", "title": "Create Secret", "description": "Creates a new secret.", "arguments": [{"name": "secret_name", "description": "The name of the new secret.", "required": true}, {"name": "secret_value", "description": "The value of the new secret.", "required": true}, {"name": "project_id", "description": "The ID of the project.", "required": true}, {"name": "app_name", "description": "The name of the application.", "required": true}]}, {"name": "find_project_and_list_secrets", "title": "Find Project and List Secrets", "description": "Finds a project by name and lists its secrets.", "arguments": [{"name": "project_name", "description": "The name of the project.", "required": true}, {"name": "organization_id", "description": "The ID of the organization.", "required": true}, {"name": "app_name", "description": "The name of the application.", "required": true}]}, {"name": "list_resources", "title": "List Resources", "description": "Lists all resources in a project.", "arguments": [{"name": "project_id", "description": "The ID of the project.", "required": true}]}, {"name": "search_logs", "title": "Search Logs", "description": "Searches for audit logs in an organization using LogQL. The LLM should determine the best topic to use based on the user's query, or default to 'hashicorp.platform.audit' if the user is not specific. For advanced filtering, use the `query` parameter with LogQL syntax. To filter on specific JSON fields in the log entries, use the `| json` parser in your query. For example: `query='| json | control_plane_event_action=\"CREATE\"'`", "arguments": [{"name": "organization_id", "description": "The ID of the organization.", "required": true}, {"name": "query", "description": "The LogQL query string for advanced filtering. Can be combined with `project_id` and `topic`. Example: '| json | resource_uuid=\"some-uuid\"'", "required": false}, {"name": "project_id", "description": "A project ID to filter by.", "required": false}, {"name": "topic", "description": "A log topic to search. Example topics: 'hashicorp.platform.audit', 'hashicorp.packer.registry.audit', 'hashicorp.boundary.cluster.audit', 'hashicorp.consul.cluster.audit'", "required": true}, {"name": "start_time", "description": "The start time for the search. Accepts formats like '24 hours ago', 'yesterday at 5pm', or 'Oct 1, 2025'.", "required": true}, {"name": "end_time", "description": "The end time for the search. Accepts formats like 'now', 'today', or 'Oct 3, 2025'.", "required": true}]}]}, "id": 1}
2025-10-14 13:42:19,920 - mcp_server - INFO - Received request: {"method": "tools/list", "params": {}, "jsonrpc": "2.0", "id": 2}
2025-10-14 13:42:19,920 - mcp_server - INFO - Request data: stdio_main: {'jsonrpc': '2.0', 'result': {'tools': [{'name': 'list_projects', 'description': 'Lists all HCP projects for a given organization.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}}, 'required': ['organization_id']}}, {'name': 'get_project', 'description': 'Gets an HCP project by its ID.', 'inputSchema': {'type': 'object', 'properties': {'project_id': {'type': 'string', 'description': 'The ID of the project.'}}, 'required': ['project_id']}}, {'name': 'delete_project', 'description': 'Deletes an HCP project by its ID.', 'inputSchema': {'type': 'object', 'properties': {'project_id': {'type': 'string', 'description': 'The ID of the project.'}}, 'required': ['project_id']}}, {'name': 'create_project', 'description': 'Creates a new HCP project.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'name': {'type': 'string', 'description': 'The name of the new project.'}}, 'required': ['organization_id', 'name']}}, {'name': 'update_project', 'description': 'Updates an HCP project.', 'inputSchema': {'type': 'object', 'properties': {'project_id': {'type': 'string', 'description': 'The ID of the project.'}, 'name': {'type': 'string', 'description': 'The new name of the project.'}}, 'required': ['project_id', 'name']}}, {'name': 'get_organization', 'description': 'Gets an HCP organization by its ID.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}}, 'required': ['organization_id']}}, {'name': 'list_organizations', 'description': 'Lists all HCP organizations.', 'inputSchema': {'type': 'object', 'properties': {}}}, {'name': 'update_organization', 'description': 'Updates an HCP organization.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'name': {'type': 'string', 'description': 'The new name of the organization.'}}, 'required': ['organization_id', 'name']}}, {'name': 'search_principals', 'description': 'Searches for principals in an organization.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'filter_str': {'type': 'string', 'description': 'The filter string to use for the search.'}}, 'required': ['organization_id']}}, {'name': 'get_principals', 'description': 'Gets principals by their IDs.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'principal_ids': {'type': 'array', 'items': {'type': 'string'}, 'description': 'The IDs of the principals to get.'}}, 'required': ['organization_id', 'principal_ids']}}, {'name': 'delete_service_principal', 'description': 'Deletes a service principal by its ID.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'principal_id': {'type': 'string', 'description': 'The ID of the service principal.'}}, 'required': ['organization_id', 'principal_id']}}, {'name': 'create_service_principal', 'description': 'Creates a new service principal.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'name': {'type': 'string', 'description': 'The name of the new service principal.'}}, 'required': ['organization_id', 'name']}}, {'name': 'update_service_principal', 'description': 'Updates a service principal.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'principal_id': {'type': 'string', 'description': 'The ID of the service principal.'}, 'name': {'type': 'string', 'description': 'The new name of the service principal.'}}, 'required': ['organization_id', 'principal_id', 'name']}}, {'name': 'list_secrets', 'description': 'Lists all secrets for a given application.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'project_id': {'type': 'string', 'description': 'The ID of the project.'}, 'app_name': {'type': 'string', 'description': 'The name of the application.'}}, 'required': ['organization_id', 'project_id', 'app_name']}}, {'name': 'get_secret', 'description': 'Gets a secret by its name.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'project_id': {'type': 'string', 'description': 'The ID of the project.'}, 'app_name': {'type': 'string', 'description': 'The name of the application.'}, 'secret_name': {'type': 'string', 'description': 'The name of the secret.'}}, 'required': ['organization_id', 'project_id', 'app_name', 'secret_name']}}, {'name': 'delete_secret', 'description': 'Deletes a secret by its name.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'project_id': {'type': 'string', 'description': 'The ID of the project.'}, 'app_name': {'type': 'string', 'description': 'The name of the application.'}, 'secret_name': {'type': 'string', 'description': 'The name of the secret.'}}, 'required': ['organization_id', 'project_id', 'app_name', 'secret_name']}}, {'name': 'create_secret', 'description': 'Creates a new secret.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'project_id': {'type': 'string', 'description': 'The ID of the project.'}, 'app_name': {'type': 'string', 'description': 'The name of the application.'}, 'secret_name': {'type': 'string', 'description': 'The name of the new secret.'}, 'secret_value': {'type': 'string', 'description': 'The value of the new secret.'}}, 'required': ['organization_id', 'project_id', 'app_name', 'secret_name', 'secret_value']}}, {'name': 'find_project_by_name', 'description': 'Finds a project by its name.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'name': {'type': 'string', 'description': 'The name of the project.'}}, 'required': ['organization_id', 'name']}}, {'name': 'find_user_by_email', 'description': 'Finds a user by their email.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'email': {'type': 'string', 'description': 'The email of the user.'}}, 'required': ['organization_id', 'email']}}, {'name': 'find_organization_by_name', 'description': 'Finds an organization by its name.', 'inputSchema': {'type': 'object', 'properties': {'name': {'type': 'string', 'description': 'The name of the organization.'}}, 'required': ['name']}}, {'name': 'list_resources', 'description': 'Lists all resources in a project.', 'inputSchema': {'type': 'object', 'properties': {'project_id': {'type': 'string', 'description': 'The ID of the project.'}}, 'required': ['project_id']}}, {'name': 'search_logs', 'description': 'Searches for audit logs in an organization using LogQL. At least one of `query`, `project_id`, or `topic` must be provided. For advanced filtering, use the `query` parameter with LogQL syntax. To filter on specific JSON fields in the log entries, use the `| json` parser in your query. For example: `query=\'| json | control_plane_event_action="CREATE"\'`', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'query': {'type': 'string', 'description': 'The LogQL query string for advanced filtering. Can be combined with `project_id` and `topic`. Example: \'| json | resource_uuid="some-uuid"\''}, 'project_id': {'type': 'string', 'description': 'A project ID to filter by.'}, 'topic': {'type': 'string', 'description': "A log topic to search. Example topics: 'hashicorp.platform.audit', 'hashicorp.packer.registry.audit', 'hashicorp.boundary.cluster.audit', 'hashicorp.consul.cluster.audit'"}, 'start_time': {'type': 'string', 'description': "The start time for the search. Accepts formats like '24 hours ago', 'yesterday at 5pm', or 'Oct 1, 2025'."}, 'end_time': {'type': 'string', 'description': "The end time for the search. Accepts formats like 'now', 'today', or 'Oct 3, 2025'."}}, 'required': ['organization_id', 'start_time', 'end_time']}}]}, 'id': 2}
2025-10-14 13:42:19,921 - mcp_server - INFO - Request data: stdio_main json: {"jsonrpc": "2.0", "result": {"tools": [{"name": "list_projects", "description": "Lists all HCP projects for a given organization.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}}, "required": ["organization_id"]}}, {"name": "get_project", "description": "Gets an HCP project by its ID.", "inputSchema": {"type": "object", "properties": {"project_id": {"type": "string", "description": "The ID of the project."}}, "required": ["project_id"]}}, {"name": "delete_project", "description": "Deletes an HCP project by its ID.", "inputSchema": {"type": "object", "properties": {"project_id": {"type": "string", "description": "The ID of the project."}}, "required": ["project_id"]}}, {"name": "create_project", "description": "Creates a new HCP project.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "name": {"type": "string", "description": "The name of the new project."}}, "required": ["organization_id", "name"]}}, {"name": "update_project", "description": "Updates an HCP project.", "inputSchema": {"type": "object", "properties": {"project_id": {"type": "string", "description": "The ID of the project."}, "name": {"type": "string", "description": "The new name of the project."}}, "required": ["project_id", "name"]}}, {"name": "get_organization", "description": "Gets an HCP organization by its ID.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}}, "required": ["organization_id"]}}, {"name": "list_organizations", "description": "Lists all HCP organizations.", "inputSchema": {"type": "object", "properties": {}}}, {"name": "update_organization", "description": "Updates an HCP organization.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "name": {"type": "string", "description": "The new name of the organization."}}, "required": ["organization_id", "name"]}}, {"name": "search_principals", "description": "Searches for principals in an organization.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "filter_str": {"type": "string", "description": "The filter string to use for the search."}}, "required": ["organization_id"]}}, {"name": "get_principals", "description": "Gets principals by their IDs.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "principal_ids": {"type": "array", "items": {"type": "string"}, "description": "The IDs of the principals to get."}}, "required": ["organization_id", "principal_ids"]}}, {"name": "delete_service_principal", "description": "Deletes a service principal by its ID.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "principal_id": {"type": "string", "description": "The ID of the service principal."}}, "required": ["organization_id", "principal_id"]}}, {"name": "create_service_principal", "description": "Creates a new service principal.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "name": {"type": "string", "description": "The name of the new service principal."}}, "required": ["organization_id", "name"]}}, {"name": "update_service_principal", "description": "Updates a service principal.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "principal_id": {"type": "string", "description": "The ID of the service principal."}, "name": {"type": "string", "description": "The new name of the service principal."}}, "required": ["organization_id", "principal_id", "name"]}}, {"name": "list_secrets", "description": "Lists all secrets for a given application.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "project_id": {"type": "string", "description": "The ID of the project."}, "app_name": {"type": "string", "description": "The name of the application."}}, "required": ["organization_id", "project_id", "app_name"]}}, {"name": "get_secret", "description": "Gets a secret by its name.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "project_id": {"type": "string", "description": "The ID of the project."}, "app_name": {"type": "string", "description": "The name of the application."}, "secret_name": {"type": "string", "description": "The name of the secret."}}, "required": ["organization_id", "project_id", "app_name", "secret_name"]}}, {"name": "delete_secret", "description": "Deletes a secret by its name.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "project_id": {"type": "string", "description": "The ID of the project."}, "app_name": {"type": "string", "description": "The name of the application."}, "secret_name": {"type": "string", "description": "The name of the secret."}}, "required": ["organization_id", "project_id", "app_name", "secret_name"]}}, {"name": "create_secret", "description": "Creates a new secret.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "project_id": {"type": "string", "description": "The ID of the project."}, "app_name": {"type": "string", "description": "The name of the application."}, "secret_name": {"type": "string", "description": "The name of the new secret."}, "secret_value": {"type": "string", "description": "The value of the new secret."}}, "required": ["organization_id", "project_id", "app_name", "secret_name", "secret_value"]}}, {"name": "find_project_by_name", "description": "Finds a project by its name.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "name": {"type": "string", "description": "The name of the project."}}, "required": ["organization_id", "name"]}}, {"name": "find_user_by_email", "description": "Finds a user by their email.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "email": {"type": "string", "description": "The email of the user."}}, "required": ["organization_id", "email"]}}, {"name": "find_organization_by_name", "description": "Finds an organization by its name.", "inputSchema": {"type": "object", "properties": {"name": {"type": "string", "description": "The name of the organization."}}, "required": ["name"]}}, {"name": "list_resources", "description": "Lists all resources in a project.", "inputSchema": {"type": "object", "properties": {"project_id": {"type": "string", "description": "The ID of the project."}}, "required": ["project_id"]}}, {"name": "search_logs", "description": "Searches for audit logs in an organization using LogQL. At least one of `query`, `project_id`, or `topic` must be provided. For advanced filtering, use the `query` parameter with LogQL syntax. To filter on specific JSON fields in the log entries, use the `| json` parser in your query. For example: `query='| json | control_plane_event_action=\"CREATE\"'`", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "query": {"type": "string", "description": "The LogQL query string for advanced filtering. Can be combined with `project_id` and `topic`. Example: '| json | resource_uuid=\"some-uuid\"'"}, "project_id": {"type": "string", "description": "A project ID to filter by."}, "topic": {"type": "string", "description": "A log topic to search. Example topics: 'hashicorp.platform.audit', 'hashicorp.packer.registry.audit', 'hashicorp.boundary.cluster.audit', 'hashicorp.consul.cluster.audit'"}, "start_time": {"type": "string", "description": "The start time for the search. Accepts formats like '24 hours ago', 'yesterday at 5pm', or 'Oct 1, 2025'."}, "end_time": {"type": "string", "description": "The end time for the search. Accepts formats like 'now', 'today', or 'Oct 3, 2025'."}}, "required": ["organization_id", "start_time", "end_time"]}}]}, "id": 2}
2025-10-14 13:42:37,780 - mcp_server - INFO - Client call: {"method": "tools/call", "params": {"name": "list_projects", "arguments": {"organization_id": "11eab4a9-75f1-e0a5-8be1-0242ac110016"}}, "jsonrpc": "2.0", "id": 3}
2025-10-14 13:42:38,781 - mcp_server - INFO - Tool request data: {'projects': [{'id': '11eab4a9-760d-c9f2-adc9-0242ac11000a', 'name': 'AppFrontEnd', 'parent': {'type': 'ORGANIZATION', 'id': '11eab4a9-75f1-e0a5-8be1-0242ac110016'}, 'created_at': '2020-06-22T16:57:31.133231Z', 'state': 'ACTIVE', 'description': ''}, {'id': '42e1b671-9a21-4410-91a0-ca6bbff0f3cc', 'name': 'AppBackend', 'parent': {'type': 'ORGANIZATION', 'id': '11eab4a9-75f1-e0a5-8be1-0242ac110016'}, 'created_at': '2023-08-01T17:27:05.509631Z', 'state': 'ACTIVE', 'description': ''}, {'id': '3c77b3e5-4836-4176-9578-34f5380e8120', 'name': 'RadarScans', 'parent': {'type': 'ORGANIZATION', 'id': '11eab4a9-75f1-e0a5-8be1-0242ac110016'}, 'created_at': '2024-01-19T18:13:05.911138Z', 'state': 'ACTIVE', 'description': ''}, {'id': '9926cad3-5aa3-4f9a-a76b-0fc26903bc87', 'name': 'Vagrant_testing', 'parent': {'type': 'ORGANIZATION', 'id': '11eab4a9-75f1-e0a5-8be1-0242ac110016'}, 'created_at': '2024-01-19T18:13:13.985141Z', 'state': 'ACTIVE', 'description': ''}, {'id': '3f1a399c-dcc0-49b2-ba6d-a233bb3b739d', 'name': '555', 'parent': {'type': 'ORGANIZATION', 'id': '11eab4a9-75f1-e0a5-8be1-0242ac110016'}, 'created_at': '2024-01-19T18:13:21.619583Z', 'state': 'ACTIVE', 'description': ''}, {'id': 'ac0f2493-69a1-46d5-a047-9631953b21a0', 'name': '6666', 'parent': {'type': 'ORGANIZATION', 'id': '11eab4a9-75f1-e0a5-8be1-0242ac110016'}, 'created_at': '2024-01-19T18:13:28.099538Z', 'state': 'ACTIVE', 'description': ''}, {'id': 'f65af8f1-de05-464b-8074-62bbaaaf9eb2', 'name': '777', 'parent': {'type': 'ORGANIZATION', 'id': '11eab4a9-75f1-e0a5-8be1-0242ac110016'}, 'created_at': '2024-01-19T18:13:35.698485Z', 'state': 'ACTIVE', 'description': ''}, {'id': 'd0ae362e-0bb7-469a-b293-6693bd98ad0a', 'name': '888', 'parent': {'type': 'ORGANIZATION', 'id': '11eab4a9-75f1-e0a5-8be1-0242ac110016'}, 'created_at': '2024-01-19T18:13:43.357022Z', 'state': 'ACTIVE', 'description': ''}, {'id': '1fcac8c1-7750-4ee0-86b8-af7e25cc9ba3', 'name': 'TEN', 'parent': {'type': 'ORGANIZATION', 'id': '11eab4a9-75f1-e0a5-8be1-0242ac110016'}, 'created_at': '2024-05-09T16:17:44.135177Z', 'state': 'ACTIVE', 'description': ''}, {'id': 'c9d9846f-e704-4ad1-ba04-cddd00c59810', 'name': 'Management', 'parent': {'type': 'ORGANIZATION', 'id': '11eab4a9-75f1-e0a5-8be1-0242ac110016'}, 'created_at': '2024-05-09T16:19:42.520982Z', 'state': 'ACTIVE', 'description': ''}, {'id': '70112112-e88e-4486-8795-4804a0777900', 'name': 'Eleven', 'parent': {'type': 'ORGANIZATION', 'id': '11eab4a9-75f1-e0a5-8be1-0242ac110016'}, 'created_at': '2024-10-25T22:50:01.253796Z', 'state': 'ACTIVE', 'description': ''}, {'id': '069c43aa-3c8e-4e58-9241-e1bc0513ef98', 'name': 'REDPROJECT', 'parent': {'type': 'ORGANIZATION', 'id': '11eab4a9-75f1-e0a5-8be1-0242ac110016'}, 'created_at': '2025-02-12T23:30:07.004203Z', 'state': 'ACTIVE', 'description': 'REDPROJECT'}], 'pagination': {'next_page_token': '', 'previous_page_token': ''}}
2025-10-14 13:42:38,782 - mcp_server - INFO - Request data: stdio_main: {'jsonrpc': '2.0', 'result': {'content': [{'type': 'text', 'text': '{"projects": [{"id": "11eab4a9-760d-c9f2-adc9-0242ac11000a", "name": "AppFrontEnd", "parent": {"type": "ORGANIZATION", "id": "11eab4a9-75f1-e0a5-8be1-0242ac110016"}, "created_at": "2020-06-22T16:57:31.133231Z", "state": "ACTIVE", "description": ""}, {"id": "42e1b671-9a21-4410-91a0-ca6bbff0f3cc", "name": "AppBackend", "parent": {"type": "ORGANIZATION", "id": "11eab4a9-75f1-e0a5-8be1-0242ac110016"}, "created_at": "2023-08-01T17:27:05.509631Z", "state": "ACTIVE", "description": ""}, {"id": "3c77b3e5-4836-4176-9578-34f5380e8120", "name": "RadarScans", "parent": {"type": "ORGANIZATION", "id": "11eab4a9-75f1-e0a5-8be1-0242ac110016"}, "created_at": "2024-01-19T18:13:05.911138Z", "state": "ACTIVE", "description": ""}, {"id": "9926cad3-5aa3-4f9a-a76b-0fc26903bc87", "name": "Vagrant_testing", "parent": {"type": "ORGANIZATION", "id": "11eab4a9-75f1-e0a5-8be1-0242ac110016"}, "created_at": "2024-01-19T18:13:13.985141Z", "state": "ACTIVE", "description": ""}, {"id": "3f1a399c-dcc0-49b2-ba6d-a233bb3b739d", "name": "555", "parent": {"type": "ORGANIZATION", "id": "11eab4a9-75f1-e0a5-8be1-0242ac110016"}, "created_at": "2024-01-19T18:13:21.619583Z", "state": "ACTIVE", "description": ""}, {"id": "ac0f2493-69a1-46d5-a047-9631953b21a0", "name": "6666", "parent": {"type": "ORGANIZATION", "id": "11eab4a9-75f1-e0a5-8be1-0242ac110016"}, "created_at": "2024-01-19T18:13:28.099538Z", "state": "ACTIVE", "description": ""}, {"id": "f65af8f1-de05-464b-8074-62bbaaaf9eb2", "name": "777", "parent": {"type": "ORGANIZATION", "id": "11eab4a9-75f1-e0a5-8be1-0242ac110016"}, "created_at": "2024-01-19T18:13:35.698485Z", "state": "ACTIVE", "description": ""}, {"id": "d0ae362e-0bb7-469a-b293-6693bd98ad0a", "name": "888", "parent": {"type": "ORGANIZATION", "id": "11eab4a9-75f1-e0a5-8be1-0242ac110016"}, "created_at": "2024-01-19T18:13:43.357022Z", "state": "ACTIVE", "description": ""}, {"id": "1fcac8c1-7750-4ee0-86b8-af7e25cc9ba3", "name": "TEN", "parent": {"type": "ORGANIZATION", "id": "11eab4a9-75f1-e0a5-8be1-0242ac110016"}, "created_at": "2024-05-09T16:17:44.135177Z", "state": "ACTIVE", "description": ""}, {"id": "c9d9846f-e704-4ad1-ba04-cddd00c59810", "name": "Management", "parent": {"type": "ORGANIZATION", "id": "11eab4a9-75f1-e0a5-8be1-0242ac110016"}, "created_at": "2024-05-09T16:19:42.520982Z", "state": "ACTIVE", "description": ""}, {"id": "70112112-e88e-4486-8795-4804a0777900", "name": "Eleven", "parent": {"type": "ORGANIZATION", "id": "11eab4a9-75f1-e0a5-8be1-0242ac110016"}, "created_at": "2024-10-25T22:50:01.253796Z", "state": "ACTIVE", "description": ""}, {"id": "069c43aa-3c8e-4e58-9241-e1bc0513ef98", "name": "REDPROJECT", "parent": {"type": "ORGANIZATION", "id": "11eab4a9-75f1-e0a5-8be1-0242ac110016"}, "created_at": "2025-02-12T23:30:07.004203Z", "state": "ACTIVE", "description": "REDPROJECT"}], "pagination": {"next_page_token": "", "previous_page_token": ""}}'}], 'isError': False}, 'id': 3}
2025-10-14 13:42:38,782 - mcp_server - INFO - Request data: stdio_main json: {"jsonrpc": "2.0", "result": {"content": [{"type": "text", "text": "{\"projects\": [{\"id\": \"11eab4a9-760d-c9f2-adc9-0242ac11000a\", \"name\": \"AppFrontEnd\", \"parent\": {\"type\": \"ORGANIZATION\", \"id\": \"11eab4a9-75f1-e0a5-8be1-0242ac110016\"}, \"created_at\": \"2020-06-22T16:57:31.133231Z\", \"state\": \"ACTIVE\", \"description\": \"\"}, {\"id\": \"42e1b671-9a21-4410-91a0-ca6bbff0f3cc\", \"name\": \"AppBackend\", \"parent\": {\"type\": \"ORGANIZATION\", \"id\": \"11eab4a9-75f1-e0a5-8be1-0242ac110016\"}, \"created_at\": \"2023-08-01T17:27:05.509631Z\", \"state\": \"ACTIVE\", \"description\": \"\"}, {\"id\": \"3c77b3e5-4836-4176-9578-34f5380e8120\", \"name\": \"RadarScans\", \"parent\": {\"type\": \"ORGANIZATION\", \"id\": \"11eab4a9-75f1-e0a5-8be1-0242ac110016\"}, \"created_at\": \"2024-01-19T18:13:05.911138Z\", \"state\": \"ACTIVE\", \"description\": \"\"}, {\"id\": \"9926cad3-5aa3-4f9a-a76b-0fc26903bc87\", \"name\": \"Vagrant_testing\", \"parent\": {\"type\": \"ORGANIZATION\", \"id\": \"11eab4a9-75f1-e0a5-8be1-0242ac110016\"}, \"created_at\": \"2024-01-19T18:13:13.985141Z\", \"state\": \"ACTIVE\", \"description\": \"\"}, {\"id\": \"3f1a399c-dcc0-49b2-ba6d-a233bb3b739d\", \"name\": \"555\", \"parent\": {\"type\": \"ORGANIZATION\", \"id\": \"11eab4a9-75f1-e0a5-8be1-0242ac110016\"}, \"created_at\": \"2024-01-19T18:13:21.619583Z\", \"state\": \"ACTIVE\", \"description\": \"\"}, {\"id\": \"ac0f2493-69a1-46d5-a047-9631953b21a0\", \"name\": \"6666\", \"parent\": {\"type\": \"ORGANIZATION\", \"id\": \"11eab4a9-75f1-e0a5-8be1-0242ac110016\"}, \"created_at\": \"2024-01-19T18:13:28.099538Z\", \"state\": \"ACTIVE\", \"description\": \"\"}, {\"id\": \"f65af8f1-de05-464b-8074-62bbaaaf9eb2\", \"name\": \"777\", \"parent\": {\"type\": \"ORGANIZATION\", \"id\": \"11eab4a9-75f1-e0a5-8be1-0242ac110016\"}, \"created_at\": \"2024-01-19T18:13:35.698485Z\", \"state\": \"ACTIVE\", \"description\": \"\"}, {\"id\": \"d0ae362e-0bb7-469a-b293-6693bd98ad0a\", \"name\": \"888\", \"parent\": {\"type\": \"ORGANIZATION\", \"id\": \"11eab4a9-75f1-e0a5-8be1-0242ac110016\"}, \"created_at\": \"2024-01-19T18:13:43.357022Z\", \"state\": \"ACTIVE\", \"description\": \"\"}, {\"id\": \"1fcac8c1-7750-4ee0-86b8-af7e25cc9ba3\", \"name\": \"TEN\", \"parent\": {\"type\": \"ORGANIZATION\", \"id\": \"11eab4a9-75f1-e0a5-8be1-0242ac110016\"}, \"created_at\": \"2024-05-09T16:17:44.135177Z\", \"state\": \"ACTIVE\", \"description\": \"\"}, {\"id\": \"c9d9846f-e704-4ad1-ba04-cddd00c59810\", \"name\": \"Management\", \"parent\": {\"type\": \"ORGANIZATION\", \"id\": \"11eab4a9-75f1-e0a5-8be1-0242ac110016\"}, \"created_at\": \"2024-05-09T16:19:42.520982Z\", \"state\": \"ACTIVE\", \"description\": \"\"}, {\"id\": \"70112112-e88e-4486-8795-4804a0777900\", \"name\": \"Eleven\", \"parent\": {\"type\": \"ORGANIZATION\", \"id\": \"11eab4a9-75f1-e0a5-8be1-0242ac110016\"}, \"created_at\": \"2024-10-25T22:50:01.253796Z\", \"state\": \"ACTIVE\", \"description\": \"\"}, {\"id\": \"069c43aa-3c8e-4e58-9241-e1bc0513ef98\", \"name\": \"REDPROJECT\", \"parent\": {\"type\": \"ORGANIZATION\", \"id\": \"11eab4a9-75f1-e0a5-8be1-0242ac110016\"}, \"created_at\": \"2025-02-12T23:30:07.004203Z\", \"state\": \"ACTIVE\", \"description\": \"REDPROJECT\"}], \"pagination\": {\"next_page_token\": \"\", \"previous_page_token\": \"\"}}"}], "isError": false}, "id": 3}
2025-10-14 13:43:04,045 - mcp_server - INFO - Client call: {"method": "tools/call", "params": {"name": "search_logs", "arguments": {"organization_id": "11eab4a9-75f1-e0a5-8be1-0242ac110016", "start_time": "8 days ago", "end_time": "now"}}, "jsonrpc": "2.0", "id": 4}
2025-10-14 13:43:04,551 - mcp_server - INFO - Request data: stdio_main: {'jsonrpc': '2.0', 'error': {'code': -32000, 'message': 'Server error: A query, project_id, or topic must be provided to search logs. ', 'data': 'A query, project_id, or topic must be provided to search logs.'}, 'id': 4}
2025-10-14 13:43:04,551 - mcp_server - INFO - Request data: stdio_main json: {"jsonrpc": "2.0", "error": {"code": -32000, "message": "Server error: A query, project_id, or topic must be provided to search logs. ", "data": "A query, project_id, or topic must be provided to search logs."}, "id": 4}
2025-10-14 13:49:57,207 - mcp_server - INFO - Received request: {"method": "initialize", "params": {"protocolVersion": "2025-06-18", "capabilities": {"roots": {}}, "clientInfo": {"name": "gemini-cli-mcp-client-HCP", "version": "0.0.1"}}, "jsonrpc": "2.0", "id": 0}
2025-10-14 13:49:57,207 - mcp_server - INFO - Request data: stdio_main: {'jsonrpc': '2.0', 'result': {'protocolVersion': '2024-11-05', 'serverInfo': {'name': 'HCP', 'version': '0.0.1'}, 'capabilities': {'tools': {'listChanged': True}, 'prompts': {'listChanged': True}, 'resources': {'listChanged': True}}}, 'id': 0}
2025-10-14 13:49:57,208 - mcp_server - INFO - Request data: stdio_main json: {"jsonrpc": "2.0", "result": {"protocolVersion": "2024-11-05", "serverInfo": {"name": "HCP", "version": "0.0.1"}, "capabilities": {"tools": {"listChanged": true}, "prompts": {"listChanged": true}, "resources": {"listChanged": true}}}, "id": 0}
2025-10-14 13:49:57,208 - mcp_server - INFO - Received request: {"method": "notifications/initialized", "jsonrpc": "2.0"}
2025-10-14 13:49:57,208 - mcp_server - INFO - Client initialized.
2025-10-14 13:49:57,208 - mcp_server - INFO - Received request: {"method": "prompts/list", "params": {}, "jsonrpc": "2.0", "id": 1}
2025-10-14 13:49:57,208 - mcp_server - INFO - Request data: stdio_main: {'jsonrpc': '2.0', 'result': {'prompts': [{'name': 'list_projects', 'title': 'List Projects', 'description': 'Lists all HCP projects for a given organization.', 'arguments': [{'name': 'organization_id', 'description': 'The ID of the organization.', 'required': True}]}, {'name': 'get_project', 'title': 'Get Project', 'description': 'Gets an HCP project by its ID.', 'arguments': [{'name': 'project_id', 'description': 'The ID of the project.', 'required': True}]}, {'name': 'delete_project', 'title': 'Delete Project', 'description': 'Deletes an HCP project by its ID.', 'arguments': [{'name': 'project_id', 'description': 'The ID of the project.', 'required': True}]}, {'name': 'create_project', 'title': 'Create Project', 'description': 'Creates a new HCP project.', 'arguments': [{'name': 'name', 'description': 'The name of the new project.', 'required': True}, {'name': 'organization_id', 'description': 'The ID of the organization.', 'required': True}]}, {'name': 'update_project', 'title': 'Update Project', 'description': 'Updates an HCP project.', 'arguments': [{'name': 'project_id', 'description': 'The ID of the project.', 'required': True}, {'name': 'name', 'description': 'The new name for the project.', 'required': True}, {'name': 'organization_id', 'description': 'The ID of the organization.', 'required': True}]}, {'name': 'get_organization', 'title': 'Get Organization', 'description': 'Gets an HCP organization by its ID.', 'arguments': [{'name': 'organization_id', 'description': 'The ID of the organization.', 'required': True}]}, {'name': 'list_organizations', 'title': 'List Organizations', 'description': 'Lists all HCP organizations.', 'arguments': None}, {'name': 'update_organization', 'title': 'Update Organization', 'description': 'Updates an HCP organization.', 'arguments': [{'name': 'organization_id', 'description': 'The ID of the organization.', 'required': True}, {'name': 'name', 'description': 'The new name for the organization.', 'required': True}]}, {'name': 'list_secrets', 'title': 'List Secrets', 'description': 'Lists all secrets for a given application.', 'arguments': [{'name': 'project_id', 'description': 'The ID of the project.', 'required': True}, {'name': 'app_name', 'description': 'The name of the application.', 'required': True}]}, {'name': 'get_secret', 'title': 'Get Secret', 'description': 'Gets a secret by its name.', 'arguments': [{'name': 'secret_name', 'description': 'The name of the secret.', 'required': True}, {'name': 'project_id', 'description': 'The ID of the project.', 'required': True}, {'name': 'app_name', 'description': 'The name of the application.', 'required': True}]}, {'name': 'delete_secret', 'title': 'Delete Secret', 'description': 'Deletes a secret by its name.', 'arguments': [{'name': 'secret_name', 'description': 'The name of the secret.', 'required': True}, {'name': 'project_id', 'description': 'The ID of the project.', 'required': True}, {'name': 'app_name', 'description': 'The name of the application.', 'required': True}]}, {'name': 'create_secret', 'title': 'Create Secret', 'description': 'Creates a new secret.', 'arguments': [{'name': 'secret_name', 'description': 'The name of the new secret.', 'required': True}, {'name': 'secret_value', 'description': 'The value of the new secret.', 'required': True}, {'name': 'project_id', 'description': 'The ID of the project.', 'required': True}, {'name': 'app_name', 'description': 'The name of the application.', 'required': True}]}, {'name': 'find_project_and_list_secrets', 'title': 'Find Project and List Secrets', 'description': 'Finds a project by name and lists its secrets.', 'arguments': [{'name': 'project_name', 'description': 'The name of the project.', 'required': True}, {'name': 'organization_id', 'description': 'The ID of the organization.', 'required': True}, {'name': 'app_name', 'description': 'The name of the application.', 'required': True}]}, {'name': 'list_resources', 'title': 'List Resources', 'description': 'Lists all resources in a project.', 'arguments': [{'name': 'project_id', 'description': 'The ID of the project.', 'required': True}]}, {'name': 'search_logs', 'title': 'Search Logs', 'description': 'Searches for audit logs in an organization. The user must specify a topic. If the user\'s query is ambiguous, default to the \'hashicorp.platform.audit\' topic. For advanced filtering, use the `query` parameter with LogQL syntax. To filter on specific JSON fields in the log entries, use the `| json` parser in your query. For example: `query=\'| json | control_plane_event_action="CREATE"\'`', 'arguments': [{'name': 'organization_id', 'description': 'The ID of the organization.', 'required': True}, {'name': 'query', 'description': 'The LogQL query string for advanced filtering. Can be combined with `project_id` and `topic`. Example: \'| json | resource_uuid="some-uuid"\'', 'required': False}, {'name': 'project_id', 'description': 'A project ID to filter by.', 'required': False}, {'name': 'topic', 'description': "The log topic to search. MUST be one of: 'hashicorp.platform.audit', 'hashicorp.packer.registry.audit', 'hashicorp.boundary.cluster.audit', 'hashicorp.consul.cluster.audit'", 'required': True}, {'name': 'start_time', 'description': "The start time for the search. Accepts formats like '24 hours ago', 'yesterday at 5pm', or 'Oct 1, 2025'.", 'required': True}, {'name': 'end_time', 'description': "The end time for the search. Accepts formats like 'now', 'today', or 'Oct 3, 2025'.", 'required': True}]}]}, 'id': 1}
2025-10-14 13:49:57,208 - mcp_server - INFO - Request data: stdio_main json: {"jsonrpc": "2.0", "result": {"prompts": [{"name": "list_projects", "title": "List Projects", "description": "Lists all HCP projects for a given organization.", "arguments": [{"name": "organization_id", "description": "The ID of the organization.", "required": true}]}, {"name": "get_project", "title": "Get Project", "description": "Gets an HCP project by its ID.", "arguments": [{"name": "project_id", "description": "The ID of the project.", "required": true}]}, {"name": "delete_project", "title": "Delete Project", "description": "Deletes an HCP project by its ID.", "arguments": [{"name": "project_id", "description": "The ID of the project.", "required": true}]}, {"name": "create_project", "title": "Create Project", "description": "Creates a new HCP project.", "arguments": [{"name": "name", "description": "The name of the new project.", "required": true}, {"name": "organization_id", "description": "The ID of the organization.", "required": true}]}, {"name": "update_project", "title": "Update Project", "description": "Updates an HCP project.", "arguments": [{"name": "project_id", "description": "The ID of the project.", "required": true}, {"name": "name", "description": "The new name for the project.", "required": true}, {"name": "organization_id", "description": "The ID of the organization.", "required": true}]}, {"name": "get_organization", "title": "Get Organization", "description": "Gets an HCP organization by its ID.", "arguments": [{"name": "organization_id", "description": "The ID of the organization.", "required": true}]}, {"name": "list_organizations", "title": "List Organizations", "description": "Lists all HCP organizations.", "arguments": null}, {"name": "update_organization", "title": "Update Organization", "description": "Updates an HCP organization.", "arguments": [{"name": "organization_id", "description": "The ID of the organization.", "required": true}, {"name": "name", "description": "The new name for the organization.", "required": true}]}, {"name": "list_secrets", "title": "List Secrets", "description": "Lists all secrets for a given application.", "arguments": [{"name": "project_id", "description": "The ID of the project.", "required": true}, {"name": "app_name", "description": "The name of the application.", "required": true}]}, {"name": "get_secret", "title": "Get Secret", "description": "Gets a secret by its name.", "arguments": [{"name": "secret_name", "description": "The name of the secret.", "required": true}, {"name": "project_id", "description": "The ID of the project.", "required": true}, {"name": "app_name", "description": "The name of the application.", "required": true}]}, {"name": "delete_secret", "title": "Delete Secret", "description": "Deletes a secret by its name.", "arguments": [{"name": "secret_name", "description": "The name of the secret.", "required": true}, {"name": "project_id", "description": "The ID of the project.", "required": true}, {"name": "app_name", "description": "The name of the application.", "required": true}]}, {"name": "create_secret", "title": "Create Secret", "description": "Creates a new secret.", "arguments": [{"name": "secret_name", "description": "The name of the new secret.", "required": true}, {"name": "secret_value", "description": "The value of the new secret.", "required": true}, {"name": "project_id", "description": "The ID of the project.", "required": true}, {"name": "app_name", "description": "The name of the application.", "required": true}]}, {"name": "find_project_and_list_secrets", "title": "Find Project and List Secrets", "description": "Finds a project by name and lists its secrets.", "arguments": [{"name": "project_name", "description": "The name of the project.", "required": true}, {"name": "organization_id", "description": "The ID of the organization.", "required": true}, {"name": "app_name", "description": "The name of the application.", "required": true}]}, {"name": "list_resources", "title": "List Resources", "description": "Lists all resources in a project.", "arguments": [{"name": "project_id", "description": "The ID of the project.", "required": true}]}, {"name": "search_logs", "title": "Search Logs", "description": "Searches for audit logs in an organization. The user must specify a topic. If the user's query is ambiguous, default to the 'hashicorp.platform.audit' topic. For advanced filtering, use the `query` parameter with LogQL syntax. To filter on specific JSON fields in the log entries, use the `| json` parser in your query. For example: `query='| json | control_plane_event_action=\"CREATE\"'`", "arguments": [{"name": "organization_id", "description": "The ID of the organization.", "required": true}, {"name": "query", "description": "The LogQL query string for advanced filtering. Can be combined with `project_id` and `topic`. Example: '| json | resource_uuid=\"some-uuid\"'", "required": false}, {"name": "project_id", "description": "A project ID to filter by.", "required": false}, {"name": "topic", "description": "The log topic to search. MUST be one of: 'hashicorp.platform.audit', 'hashicorp.packer.registry.audit', 'hashicorp.boundary.cluster.audit', 'hashicorp.consul.cluster.audit'", "required": true}, {"name": "start_time", "description": "The start time for the search. Accepts formats like '24 hours ago', 'yesterday at 5pm', or 'Oct 1, 2025'.", "required": true}, {"name": "end_time", "description": "The end time for the search. Accepts formats like 'now', 'today', or 'Oct 3, 2025'.", "required": true}]}]}, "id": 1}
2025-10-14 13:49:57,209 - mcp_server - INFO - Received request: {"method": "tools/list", "params": {}, "jsonrpc": "2.0", "id": 2}
2025-10-14 13:49:57,209 - mcp_server - INFO - Request data: stdio_main: {'jsonrpc': '2.0', 'result': {'tools': [{'name': 'list_projects', 'description': 'Lists all HCP projects for a given organization.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}}, 'required': ['organization_id']}}, {'name': 'get_project', 'description': 'Gets an HCP project by its ID.', 'inputSchema': {'type': 'object', 'properties': {'project_id': {'type': 'string', 'description': 'The ID of the project.'}}, 'required': ['project_id']}}, {'name': 'delete_project', 'description': 'Deletes an HCP project by its ID.', 'inputSchema': {'type': 'object', 'properties': {'project_id': {'type': 'string', 'description': 'The ID of the project.'}}, 'required': ['project_id']}}, {'name': 'create_project', 'description': 'Creates a new HCP project.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'name': {'type': 'string', 'description': 'The name of the new project.'}}, 'required': ['organization_id', 'name']}}, {'name': 'update_project', 'description': 'Updates an HCP project.', 'inputSchema': {'type': 'object', 'properties': {'project_id': {'type': 'string', 'description': 'The ID of the project.'}, 'name': {'type': 'string', 'description': 'The new name of the project.'}}, 'required': ['project_id', 'name']}}, {'name': 'get_organization', 'description': 'Gets an HCP organization by its ID.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}}, 'required': ['organization_id']}}, {'name': 'list_organizations', 'description': 'Lists all HCP organizations.', 'inputSchema': {'type': 'object', 'properties': {}}}, {'name': 'update_organization', 'description': 'Updates an HCP organization.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'name': {'type': 'string', 'description': 'The new name of the organization.'}}, 'required': ['organization_id', 'name']}}, {'name': 'search_principals', 'description': 'Searches for principals in an organization.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'filter_str': {'type': 'string', 'description': 'The filter string to use for the search.'}}, 'required': ['organization_id']}}, {'name': 'get_principals', 'description': 'Gets principals by their IDs.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'principal_ids': {'type': 'array', 'items': {'type': 'string'}, 'description': 'The IDs of the principals to get.'}}, 'required': ['organization_id', 'principal_ids']}}, {'name': 'delete_service_principal', 'description': 'Deletes a service principal by its ID.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'principal_id': {'type': 'string', 'description': 'The ID of the service principal.'}}, 'required': ['organization_id', 'principal_id']}}, {'name': 'create_service_principal', 'description': 'Creates a new service principal.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'name': {'type': 'string', 'description': 'The name of the new service principal.'}}, 'required': ['organization_id', 'name']}}, {'name': 'update_service_principal', 'description': 'Updates a service principal.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'principal_id': {'type': 'string', 'description': 'The ID of the service principal.'}, 'name': {'type': 'string', 'description': 'The new name of the service principal.'}}, 'required': ['organization_id', 'principal_id', 'name']}}, {'name': 'list_secrets', 'description': 'Lists all secrets for a given application.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'project_id': {'type': 'string', 'description': 'The ID of the project.'}, 'app_name': {'type': 'string', 'description': 'The name of the application.'}}, 'required': ['organization_id', 'project_id', 'app_name']}}, {'name': 'get_secret', 'description': 'Gets a secret by its name.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'project_id': {'type': 'string', 'description': 'The ID of the project.'}, 'app_name': {'type': 'string', 'description': 'The name of the application.'}, 'secret_name': {'type': 'string', 'description': 'The name of the secret.'}}, 'required': ['organization_id', 'project_id', 'app_name', 'secret_name']}}, {'name': 'delete_secret', 'description': 'Deletes a secret by its name.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'project_id': {'type': 'string', 'description': 'The ID of the project.'}, 'app_name': {'type': 'string', 'description': 'The name of the application.'}, 'secret_name': {'type': 'string', 'description': 'The name of the secret.'}}, 'required': ['organization_id', 'project_id', 'app_name', 'secret_name']}}, {'name': 'create_secret', 'description': 'Creates a new secret.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'project_id': {'type': 'string', 'description': 'The ID of the project.'}, 'app_name': {'type': 'string', 'description': 'The name of the application.'}, 'secret_name': {'type': 'string', 'description': 'The name of the new secret.'}, 'secret_value': {'type': 'string', 'description': 'The value of the new secret.'}}, 'required': ['organization_id', 'project_id', 'app_name', 'secret_name', 'secret_value']}}, {'name': 'find_project_by_name', 'description': 'Finds a project by its name.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'name': {'type': 'string', 'description': 'The name of the project.'}}, 'required': ['organization_id', 'name']}}, {'name': 'find_user_by_email', 'description': 'Finds a user by their email.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'email': {'type': 'string', 'description': 'The email of the user.'}}, 'required': ['organization_id', 'email']}}, {'name': 'find_organization_by_name', 'description': 'Finds an organization by its name.', 'inputSchema': {'type': 'object', 'properties': {'name': {'type': 'string', 'description': 'The name of the organization.'}}, 'required': ['name']}}, {'name': 'list_resources', 'description': 'Lists all resources in a project.', 'inputSchema': {'type': 'object', 'properties': {'project_id': {'type': 'string', 'description': 'The ID of the project.'}}, 'required': ['project_id']}}, {'name': 'search_logs', 'description': 'Searches for audit logs in an organization using LogQL. At least one of `query`, `project_id`, or `topic` must be provided. For advanced filtering, use the `query` parameter with LogQL syntax. To filter on specific JSON fields in the log entries, use the `| json` parser in your query. For example: `query=\'| json | control_plane_event_action="CREATE"\'`', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'query': {'type': 'string', 'description': 'The LogQL query string for advanced filtering. Can be combined with `project_id` and `topic`. Example: \'| json | resource_uuid="some-uuid"\''}, 'project_id': {'type': 'string', 'description': 'A project ID to filter by.'}, 'topic': {'type': 'string', 'description': "A log topic to search. Example topics: 'hashicorp.platform.audit', 'hashicorp.packer.registry.audit', 'hashicorp.boundary.cluster.audit', 'hashicorp.consul.cluster.audit'"}, 'start_time': {'type': 'string', 'description': "The start time for the search. Accepts formats like '24 hours ago', 'yesterday at 5pm', or 'Oct 1, 2025'."}, 'end_time': {'type': 'string', 'description': "The end time for the search. Accepts formats like 'now', 'today', or 'Oct 3, 2025'."}}, 'required': ['organization_id', 'start_time', 'end_time']}}]}, 'id': 2}
2025-10-14 13:49:57,209 - mcp_server - INFO - Request data: stdio_main json: {"jsonrpc": "2.0", "result": {"tools": [{"name": "list_projects", "description": "Lists all HCP projects for a given organization.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}}, "required": ["organization_id"]}}, {"name": "get_project", "description": "Gets an HCP project by its ID.", "inputSchema": {"type": "object", "properties": {"project_id": {"type": "string", "description": "The ID of the project."}}, "required": ["project_id"]}}, {"name": "delete_project", "description": "Deletes an HCP project by its ID.", "inputSchema": {"type": "object", "properties": {"project_id": {"type": "string", "description": "The ID of the project."}}, "required": ["project_id"]}}, {"name": "create_project", "description": "Creates a new HCP project.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "name": {"type": "string", "description": "The name of the new project."}}, "required": ["organization_id", "name"]}}, {"name": "update_project", "description": "Updates an HCP project.", "inputSchema": {"type": "object", "properties": {"project_id": {"type": "string", "description": "The ID of the project."}, "name": {"type": "string", "description": "The new name of the project."}}, "required": ["project_id", "name"]}}, {"name": "get_organization", "description": "Gets an HCP organization by its ID.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}}, "required": ["organization_id"]}}, {"name": "list_organizations", "description": "Lists all HCP organizations.", "inputSchema": {"type": "object", "properties": {}}}, {"name": "update_organization", "description": "Updates an HCP organization.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "name": {"type": "string", "description": "The new name of the organization."}}, "required": ["organization_id", "name"]}}, {"name": "search_principals", "description": "Searches for principals in an organization.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "filter_str": {"type": "string", "description": "The filter string to use for the search."}}, "required": ["organization_id"]}}, {"name": "get_principals", "description": "Gets principals by their IDs.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "principal_ids": {"type": "array", "items": {"type": "string"}, "description": "The IDs of the principals to get."}}, "required": ["organization_id", "principal_ids"]}}, {"name": "delete_service_principal", "description": "Deletes a service principal by its ID.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "principal_id": {"type": "string", "description": "The ID of the service principal."}}, "required": ["organization_id", "principal_id"]}}, {"name": "create_service_principal", "description": "Creates a new service principal.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "name": {"type": "string", "description": "The name of the new service principal."}}, "required": ["organization_id", "name"]}}, {"name": "update_service_principal", "description": "Updates a service principal.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "principal_id": {"type": "string", "description": "The ID of the service principal."}, "name": {"type": "string", "description": "The new name of the service principal."}}, "required": ["organization_id", "principal_id", "name"]}}, {"name": "list_secrets", "description": "Lists all secrets for a given application.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "project_id": {"type": "string", "description": "The ID of the project."}, "app_name": {"type": "string", "description": "The name of the application."}}, "required": ["organization_id", "project_id", "app_name"]}}, {"name": "get_secret", "description": "Gets a secret by its name.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "project_id": {"type": "string", "description": "The ID of the project."}, "app_name": {"type": "string", "description": "The name of the application."}, "secret_name": {"type": "string", "description": "The name of the secret."}}, "required": ["organization_id", "project_id", "app_name", "secret_name"]}}, {"name": "delete_secret", "description": "Deletes a secret by its name.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "project_id": {"type": "string", "description": "The ID of the project."}, "app_name": {"type": "string", "description": "The name of the application."}, "secret_name": {"type": "string", "description": "The name of the secret."}}, "required": ["organization_id", "project_id", "app_name", "secret_name"]}}, {"name": "create_secret", "description": "Creates a new secret.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "project_id": {"type": "string", "description": "The ID of the project."}, "app_name": {"type": "string", "description": "The name of the application."}, "secret_name": {"type": "string", "description": "The name of the new secret."}, "secret_value": {"type": "string", "description": "The value of the new secret."}}, "required": ["organization_id", "project_id", "app_name", "secret_name", "secret_value"]}}, {"name": "find_project_by_name", "description": "Finds a project by its name.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "name": {"type": "string", "description": "The name of the project."}}, "required": ["organization_id", "name"]}}, {"name": "find_user_by_email", "description": "Finds a user by their email.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "email": {"type": "string", "description": "The email of the user."}}, "required": ["organization_id", "email"]}}, {"name": "find_organization_by_name", "description": "Finds an organization by its name.", "inputSchema": {"type": "object", "properties": {"name": {"type": "string", "description": "The name of the organization."}}, "required": ["name"]}}, {"name": "list_resources", "description": "Lists all resources in a project.", "inputSchema": {"type": "object", "properties": {"project_id": {"type": "string", "description": "The ID of the project."}}, "required": ["project_id"]}}, {"name": "search_logs", "description": "Searches for audit logs in an organization using LogQL. At least one of `query`, `project_id`, or `topic` must be provided. For advanced filtering, use the `query` parameter with LogQL syntax. To filter on specific JSON fields in the log entries, use the `| json` parser in your query. For example: `query='| json | control_plane_event_action=\"CREATE\"'`", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "query": {"type": "string", "description": "The LogQL query string for advanced filtering. Can be combined with `project_id` and `topic`. Example: '| json | resource_uuid=\"some-uuid\"'"}, "project_id": {"type": "string", "description": "A project ID to filter by."}, "topic": {"type": "string", "description": "A log topic to search. Example topics: 'hashicorp.platform.audit', 'hashicorp.packer.registry.audit', 'hashicorp.boundary.cluster.audit', 'hashicorp.consul.cluster.audit'"}, "start_time": {"type": "string", "description": "The start time for the search. Accepts formats like '24 hours ago', 'yesterday at 5pm', or 'Oct 1, 2025'."}, "end_time": {"type": "string", "description": "The end time for the search. Accepts formats like 'now', 'today', or 'Oct 3, 2025'."}}, "required": ["organization_id", "start_time", "end_time"]}}]}, "id": 2}
2025-10-14 13:50:41,345 - mcp_server - INFO - Client call: {"method": "tools/call", "params": {"name": "search_logs", "arguments": {"start_time": "8 days ago", "end_time": "now", "organization_id": "11eab4a9-75f1-e0a5-8be1-0242ac110016"}}, "jsonrpc": "2.0", "id": 3}
2025-10-14 13:50:41,911 - mcp_server - INFO - Request data: stdio_main: {'jsonrpc': '2.0', 'error': {'code': -32000, 'message': 'Server error: A query, project_id, or topic must be provided to search logs. ', 'data': 'A query, project_id, or topic must be provided to search logs.'}, 'id': 3}
2025-10-14 13:50:41,911 - mcp_server - INFO - Request data: stdio_main json: {"jsonrpc": "2.0", "error": {"code": -32000, "message": "Server error: A query, project_id, or topic must be provided to search logs. ", "data": "A query, project_id, or topic must be provided to search logs."}, "id": 3}
2025-10-14 13:53:03,619 - mcp_server - INFO - Received request: {"method": "initialize", "params": {"protocolVersion": "2025-06-18", "capabilities": {"roots": {}}, "clientInfo": {"name": "gemini-cli-mcp-client-HCP", "version": "0.0.1"}}, "jsonrpc": "2.0", "id": 0}
2025-10-14 13:53:03,619 - mcp_server - INFO - Request data: stdio_main: {'jsonrpc': '2.0', 'result': {'protocolVersion': '2024-11-05', 'serverInfo': {'name': 'HCP', 'version': '0.0.1'}, 'capabilities': {'tools': {'listChanged': True}, 'prompts': {'listChanged': True}, 'resources': {'listChanged': True}}}, 'id': 0}
2025-10-14 13:53:03,620 - mcp_server - INFO - Request data: stdio_main json: {"jsonrpc": "2.0", "result": {"protocolVersion": "2024-11-05", "serverInfo": {"name": "HCP", "version": "0.0.1"}, "capabilities": {"tools": {"listChanged": true}, "prompts": {"listChanged": true}, "resources": {"listChanged": true}}}, "id": 0}
2025-10-14 13:53:03,620 - mcp_server - INFO - Received request: {"method": "notifications/initialized", "jsonrpc": "2.0"}
2025-10-14 13:53:03,620 - mcp_server - INFO - Client initialized.
2025-10-14 13:53:03,620 - mcp_server - INFO - Received request: {"method": "prompts/list", "params": {}, "jsonrpc": "2.0", "id": 1}
2025-10-14 13:53:03,620 - mcp_server - INFO - Request data: stdio_main: {'jsonrpc': '2.0', 'result': {'prompts': [{'name': 'list_projects', 'title': 'List Projects', 'description': 'Lists all HCP projects for a given organization.', 'arguments': [{'name': 'organization_id', 'description': 'The ID of the organization.', 'required': True}]}, {'name': 'get_project', 'title': 'Get Project', 'description': 'Gets an HCP project by its ID.', 'arguments': [{'name': 'project_id', 'description': 'The ID of the project.', 'required': True}]}, {'name': 'delete_project', 'title': 'Delete Project', 'description': 'Deletes an HCP project by its ID.', 'arguments': [{'name': 'project_id', 'description': 'The ID of the project.', 'required': True}]}, {'name': 'create_project', 'title': 'Create Project', 'description': 'Creates a new HCP project.', 'arguments': [{'name': 'name', 'description': 'The name of the new project.', 'required': True}, {'name': 'organization_id', 'description': 'The ID of the organization.', 'required': True}]}, {'name': 'update_project', 'title': 'Update Project', 'description': 'Updates an HCP project.', 'arguments': [{'name': 'project_id', 'description': 'The ID of the project.', 'required': True}, {'name': 'name', 'description': 'The new name for the project.', 'required': True}, {'name': 'organization_id', 'description': 'The ID of the organization.', 'required': True}]}, {'name': 'get_organization', 'title': 'Get Organization', 'description': 'Gets an HCP organization by its ID.', 'arguments': [{'name': 'organization_id', 'description': 'The ID of the organization.', 'required': True}]}, {'name': 'list_organizations', 'title': 'List Organizations', 'description': 'Lists all HCP organizations.', 'arguments': None}, {'name': 'update_organization', 'title': 'Update Organization', 'description': 'Updates an HCP organization.', 'arguments': [{'name': 'organization_id', 'description': 'The ID of the organization.', 'required': True}, {'name': 'name', 'description': 'The new name for the organization.', 'required': True}]}, {'name': 'list_secrets', 'title': 'List Secrets', 'description': 'Lists all secrets for a given application.', 'arguments': [{'name': 'project_id', 'description': 'The ID of the project.', 'required': True}, {'name': 'app_name', 'description': 'The name of the application.', 'required': True}]}, {'name': 'get_secret', 'title': 'Get Secret', 'description': 'Gets a secret by its name.', 'arguments': [{'name': 'secret_name', 'description': 'The name of the secret.', 'required': True}, {'name': 'project_id', 'description': 'The ID of the project.', 'required': True}, {'name': 'app_name', 'description': 'The name of the application.', 'required': True}]}, {'name': 'delete_secret', 'title': 'Delete Secret', 'description': 'Deletes a secret by its name.', 'arguments': [{'name': 'secret_name', 'description': 'The name of the secret.', 'required': True}, {'name': 'project_id', 'description': 'The ID of the project.', 'required': True}, {'name': 'app_name', 'description': 'The name of the application.', 'required': True}]}, {'name': 'create_secret', 'title': 'Create Secret', 'description': 'Creates a new secret.', 'arguments': [{'name': 'secret_name', 'description': 'The name of the new secret.', 'required': True}, {'name': 'secret_value', 'description': 'The value of the new secret.', 'required': True}, {'name': 'project_id', 'description': 'The ID of the project.', 'required': True}, {'name': 'app_name', 'description': 'The name of the application.', 'required': True}]}, {'name': 'find_project_and_list_secrets', 'title': 'Find Project and List Secrets', 'description': 'Finds a project by name and lists its secrets.', 'arguments': [{'name': 'project_name', 'description': 'The name of the project.', 'required': True}, {'name': 'organization_id', 'description': 'The ID of the organization.', 'required': True}, {'name': 'app_name', 'description': 'The name of the application.', 'required': True}]}, {'name': 'list_resources', 'title': 'List Resources', 'description': 'Lists all resources in a project.', 'arguments': [{'name': 'project_id', 'description': 'The ID of the project.', 'required': True}]}, {'name': 'search_logs', 'title': 'Search Logs', 'description': 'Searches for audit logs in an organization. The user must specify a topic. If the user\'s query is ambiguous, default to the \'hashicorp.platform.audit\' topic. For advanced filtering, use the `query` parameter with LogQL syntax. To filter on specific JSON fields in the log entries, use the `| json` parser in your query. For example: `query=\'| json | control_plane_event_action="CREATE"\'`', 'arguments': [{'name': 'organization_id', 'description': 'The ID of the organization.', 'required': True}, {'name': 'query', 'description': 'The LogQL query string for advanced filtering. Can be combined with `project_id` and `topic`. Example: \'| json | resource_uuid="some-uuid"\'', 'required': False}, {'name': 'project_id', 'description': 'A project ID to filter by.', 'required': False}, {'name': 'topic', 'description': "The log topic to search. MUST be one of: 'hashicorp.platform.audit', 'hashicorp.packer.registry.audit', 'hashicorp.boundary.cluster.audit', 'hashicorp.consul.cluster.audit'", 'required': True}, {'name': 'start_time', 'description': "The start time for the search. Accepts formats like '24 hours ago', 'yesterday at 5pm', or 'Oct 1, 2025'.", 'required': True}, {'name': 'end_time', 'description': "The end time for the search. Accepts formats like 'now', 'today', or 'Oct 3, 2025'.", 'required': True}]}]}, 'id': 1}
2025-10-14 13:53:03,620 - mcp_server - INFO - Request data: stdio_main json: {"jsonrpc": "2.0", "result": {"prompts": [{"name": "list_projects", "title": "List Projects", "description": "Lists all HCP projects for a given organization.", "arguments": [{"name": "organization_id", "description": "The ID of the organization.", "required": true}]}, {"name": "get_project", "title": "Get Project", "description": "Gets an HCP project by its ID.", "arguments": [{"name": "project_id", "description": "The ID of the project.", "required": true}]}, {"name": "delete_project", "title": "Delete Project", "description": "Deletes an HCP project by its ID.", "arguments": [{"name": "project_id", "description": "The ID of the project.", "required": true}]}, {"name": "create_project", "title": "Create Project", "description": "Creates a new HCP project.", "arguments": [{"name": "name", "description": "The name of the new project.", "required": true}, {"name": "organization_id", "description": "The ID of the organization.", "required": true}]}, {"name": "update_project", "title": "Update Project", "description": "Updates an HCP project.", "arguments": [{"name": "project_id", "description": "The ID of the project.", "required": true}, {"name": "name", "description": "The new name for the project.", "required": true}, {"name": "organization_id", "description": "The ID of the organization.", "required": true}]}, {"name": "get_organization", "title": "Get Organization", "description": "Gets an HCP organization by its ID.", "arguments": [{"name": "organization_id", "description": "The ID of the organization.", "required": true}]}, {"name": "list_organizations", "title": "List Organizations", "description": "Lists all HCP organizations.", "arguments": null}, {"name": "update_organization", "title": "Update Organization", "description": "Updates an HCP organization.", "arguments": [{"name": "organization_id", "description": "The ID of the organization.", "required": true}, {"name": "name", "description": "The new name for the organization.", "required": true}]}, {"name": "list_secrets", "title": "List Secrets", "description": "Lists all secrets for a given application.", "arguments": [{"name": "project_id", "description": "The ID of the project.", "required": true}, {"name": "app_name", "description": "The name of the application.", "required": true}]}, {"name": "get_secret", "title": "Get Secret", "description": "Gets a secret by its name.", "arguments": [{"name": "secret_name", "description": "The name of the secret.", "required": true}, {"name": "project_id", "description": "The ID of the project.", "required": true}, {"name": "app_name", "description": "The name of the application.", "required": true}]}, {"name": "delete_secret", "title": "Delete Secret", "description": "Deletes a secret by its name.", "arguments": [{"name": "secret_name", "description": "The name of the secret.", "required": true}, {"name": "project_id", "description": "The ID of the project.", "required": true}, {"name": "app_name", "description": "The name of the application.", "required": true}]}, {"name": "create_secret", "title": "Create Secret", "description": "Creates a new secret.", "arguments": [{"name": "secret_name", "description": "The name of the new secret.", "required": true}, {"name": "secret_value", "description": "The value of the new secret.", "required": true}, {"name": "project_id", "description": "The ID of the project.", "required": true}, {"name": "app_name", "description": "The name of the application.", "required": true}]}, {"name": "find_project_and_list_secrets", "title": "Find Project and List Secrets", "description": "Finds a project by name and lists its secrets.", "arguments": [{"name": "project_name", "description": "The name of the project.", "required": true}, {"name": "organization_id", "description": "The ID of the organization.", "required": true}, {"name": "app_name", "description": "The name of the application.", "required": true}]}, {"name": "list_resources", "title": "List Resources", "description": "Lists all resources in a project.", "arguments": [{"name": "project_id", "description": "The ID of the project.", "required": true}]}, {"name": "search_logs", "title": "Search Logs", "description": "Searches for audit logs in an organization. The user must specify a topic. If the user's query is ambiguous, default to the 'hashicorp.platform.audit' topic. For advanced filtering, use the `query` parameter with LogQL syntax. To filter on specific JSON fields in the log entries, use the `| json` parser in your query. For example: `query='| json | control_plane_event_action=\"CREATE\"'`", "arguments": [{"name": "organization_id", "description": "The ID of the organization.", "required": true}, {"name": "query", "description": "The LogQL query string for advanced filtering. Can be combined with `project_id` and `topic`. Example: '| json | resource_uuid=\"some-uuid\"'", "required": false}, {"name": "project_id", "description": "A project ID to filter by.", "required": false}, {"name": "topic", "description": "The log topic to search. MUST be one of: 'hashicorp.platform.audit', 'hashicorp.packer.registry.audit', 'hashicorp.boundary.cluster.audit', 'hashicorp.consul.cluster.audit'", "required": true}, {"name": "start_time", "description": "The start time for the search. Accepts formats like '24 hours ago', 'yesterday at 5pm', or 'Oct 1, 2025'.", "required": true}, {"name": "end_time", "description": "The end time for the search. Accepts formats like 'now', 'today', or 'Oct 3, 2025'.", "required": true}]}]}, "id": 1}
2025-10-14 13:53:03,621 - mcp_server - INFO - Received request: {"method": "tools/list", "params": {}, "jsonrpc": "2.0", "id": 2}
2025-10-14 13:53:03,621 - mcp_server - INFO - Request data: stdio_main: {'jsonrpc': '2.0', 'result': {'tools': [{'name': 'list_projects', 'description': 'Lists all HCP projects for a given organization.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}}, 'required': ['organization_id']}}, {'name': 'get_project', 'description': 'Gets an HCP project by its ID.', 'inputSchema': {'type': 'object', 'properties': {'project_id': {'type': 'string', 'description': 'The ID of the project.'}}, 'required': ['project_id']}}, {'name': 'delete_project', 'description': 'Deletes an HCP project by its ID.', 'inputSchema': {'type': 'object', 'properties': {'project_id': {'type': 'string', 'description': 'The ID of the project.'}}, 'required': ['project_id']}}, {'name': 'create_project', 'description': 'Creates a new HCP project.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'name': {'type': 'string', 'description': 'The name of the new project.'}}, 'required': ['organization_id', 'name']}}, {'name': 'update_project', 'description': 'Updates an HCP project.', 'inputSchema': {'type': 'object', 'properties': {'project_id': {'type': 'string', 'description': 'The ID of the project.'}, 'name': {'type': 'string', 'description': 'The new name of the project.'}}, 'required': ['project_id', 'name']}}, {'name': 'get_organization', 'description': 'Gets an HCP organization by its ID.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}}, 'required': ['organization_id']}}, {'name': 'list_organizations', 'description': 'Lists all HCP organizations.', 'inputSchema': {'type': 'object', 'properties': {}}}, {'name': 'update_organization', 'description': 'Updates an HCP organization.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'name': {'type': 'string', 'description': 'The new name of the organization.'}}, 'required': ['organization_id', 'name']}}, {'name': 'search_principals', 'description': 'Searches for principals in an organization.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'filter_str': {'type': 'string', 'description': 'The filter string to use for the search.'}}, 'required': ['organization_id']}}, {'name': 'get_principals', 'description': 'Gets principals by their IDs.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'principal_ids': {'type': 'array', 'items': {'type': 'string'}, 'description': 'The IDs of the principals to get.'}}, 'required': ['organization_id', 'principal_ids']}}, {'name': 'delete_service_principal', 'description': 'Deletes a service principal by its ID.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'principal_id': {'type': 'string', 'description': 'The ID of the service principal.'}}, 'required': ['organization_id', 'principal_id']}}, {'name': 'create_service_principal', 'description': 'Creates a new service principal.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'name': {'type': 'string', 'description': 'The name of the new service principal.'}}, 'required': ['organization_id', 'name']}}, {'name': 'update_service_principal', 'description': 'Updates a service principal.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'principal_id': {'type': 'string', 'description': 'The ID of the service principal.'}, 'name': {'type': 'string', 'description': 'The new name of the service principal.'}}, 'required': ['organization_id', 'principal_id', 'name']}}, {'name': 'list_secrets', 'description': 'Lists all secrets for a given application.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'project_id': {'type': 'string', 'description': 'The ID of the project.'}, 'app_name': {'type': 'string', 'description': 'The name of the application.'}}, 'required': ['organization_id', 'project_id', 'app_name']}}, {'name': 'get_secret', 'description': 'Gets a secret by its name.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'project_id': {'type': 'string', 'description': 'The ID of the project.'}, 'app_name': {'type': 'string', 'description': 'The name of the application.'}, 'secret_name': {'type': 'string', 'description': 'The name of the secret.'}}, 'required': ['organization_id', 'project_id', 'app_name', 'secret_name']}}, {'name': 'delete_secret', 'description': 'Deletes a secret by its name.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'project_id': {'type': 'string', 'description': 'The ID of the project.'}, 'app_name': {'type': 'string', 'description': 'The name of the application.'}, 'secret_name': {'type': 'string', 'description': 'The name of the secret.'}}, 'required': ['organization_id', 'project_id', 'app_name', 'secret_name']}}, {'name': 'create_secret', 'description': 'Creates a new secret.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'project_id': {'type': 'string', 'description': 'The ID of the project.'}, 'app_name': {'type': 'string', 'description': 'The name of the application.'}, 'secret_name': {'type': 'string', 'description': 'The name of the new secret.'}, 'secret_value': {'type': 'string', 'description': 'The value of the new secret.'}}, 'required': ['organization_id', 'project_id', 'app_name', 'secret_name', 'secret_value']}}, {'name': 'find_project_by_name', 'description': 'Finds a project by its name.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'name': {'type': 'string', 'description': 'The name of the project.'}}, 'required': ['organization_id', 'name']}}, {'name': 'find_user_by_email', 'description': 'Finds a user by their email.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'email': {'type': 'string', 'description': 'The email of the user.'}}, 'required': ['organization_id', 'email']}}, {'name': 'find_organization_by_name', 'description': 'Finds an organization by its name.', 'inputSchema': {'type': 'object', 'properties': {'name': {'type': 'string', 'description': 'The name of the organization.'}}, 'required': ['name']}}, {'name': 'list_resources', 'description': 'Lists all resources in a project.', 'inputSchema': {'type': 'object', 'properties': {'project_id': {'type': 'string', 'description': 'The ID of the project.'}}, 'required': ['project_id']}}, {'name': 'search_logs', 'description': 'Searches for audit logs in an organization using LogQL. At least one of `query`, `project_id`, or `topic` must be provided. For advanced filtering, use the `query` parameter with LogQL syntax. To filter on specific JSON fields in the log entries, use the `| json` parser in your query. For example: `query=\'| json | control_plane_event_action="CREATE"\'`', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'query': {'type': 'string', 'description': 'The LogQL query string for advanced filtering. Can be combined with `project_id` and `topic`. Example: \'| json | resource_uuid="some-uuid"\''}, 'project_id': {'type': 'string', 'description': 'A project ID to filter by.'}, 'topic': {'type': 'string', 'description': "A log topic to search. Example topics: 'hashicorp.platform.audit', 'hashicorp.packer.registry.audit', 'hashicorp.boundary.cluster.audit', 'hashicorp.consul.cluster.audit'"}, 'start_time': {'type': 'string', 'description': "The start time for the search. Accepts formats like '24 hours ago', 'yesterday at 5pm', or 'Oct 1, 2025'."}, 'end_time': {'type': 'string', 'description': "The end time for the search. Accepts formats like 'now', 'today', or 'Oct 3, 2025'."}}, 'required': ['organization_id', 'start_time', 'end_time']}}]}, 'id': 2}
2025-10-14 13:53:03,621 - mcp_server - INFO - Request data: stdio_main json: {"jsonrpc": "2.0", "result": {"tools": [{"name": "list_projects", "description": "Lists all HCP projects for a given organization.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}}, "required": ["organization_id"]}}, {"name": "get_project", "description": "Gets an HCP project by its ID.", "inputSchema": {"type": "object", "properties": {"project_id": {"type": "string", "description": "The ID of the project."}}, "required": ["project_id"]}}, {"name": "delete_project", "description": "Deletes an HCP project by its ID.", "inputSchema": {"type": "object", "properties": {"project_id": {"type": "string", "description": "The ID of the project."}}, "required": ["project_id"]}}, {"name": "create_project", "description": "Creates a new HCP project.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "name": {"type": "string", "description": "The name of the new project."}}, "required": ["organization_id", "name"]}}, {"name": "update_project", "description": "Updates an HCP project.", "inputSchema": {"type": "object", "properties": {"project_id": {"type": "string", "description": "The ID of the project."}, "name": {"type": "string", "description": "The new name of the project."}}, "required": ["project_id", "name"]}}, {"name": "get_organization", "description": "Gets an HCP organization by its ID.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}}, "required": ["organization_id"]}}, {"name": "list_organizations", "description": "Lists all HCP organizations.", "inputSchema": {"type": "object", "properties": {}}}, {"name": "update_organization", "description": "Updates an HCP organization.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "name": {"type": "string", "description": "The new name of the organization."}}, "required": ["organization_id", "name"]}}, {"name": "search_principals", "description": "Searches for principals in an organization.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "filter_str": {"type": "string", "description": "The filter string to use for the search."}}, "required": ["organization_id"]}}, {"name": "get_principals", "description": "Gets principals by their IDs.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "principal_ids": {"type": "array", "items": {"type": "string"}, "description": "The IDs of the principals to get."}}, "required": ["organization_id", "principal_ids"]}}, {"name": "delete_service_principal", "description": "Deletes a service principal by its ID.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "principal_id": {"type": "string", "description": "The ID of the service principal."}}, "required": ["organization_id", "principal_id"]}}, {"name": "create_service_principal", "description": "Creates a new service principal.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "name": {"type": "string", "description": "The name of the new service principal."}}, "required": ["organization_id", "name"]}}, {"name": "update_service_principal", "description": "Updates a service principal.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "principal_id": {"type": "string", "description": "The ID of the service principal."}, "name": {"type": "string", "description": "The new name of the service principal."}}, "required": ["organization_id", "principal_id", "name"]}}, {"name": "list_secrets", "description": "Lists all secrets for a given application.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "project_id": {"type": "string", "description": "The ID of the project."}, "app_name": {"type": "string", "description": "The name of the application."}}, "required": ["organization_id", "project_id", "app_name"]}}, {"name": "get_secret", "description": "Gets a secret by its name.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "project_id": {"type": "string", "description": "The ID of the project."}, "app_name": {"type": "string", "description": "The name of the application."}, "secret_name": {"type": "string", "description": "The name of the secret."}}, "required": ["organization_id", "project_id", "app_name", "secret_name"]}}, {"name": "delete_secret", "description": "Deletes a secret by its name.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "project_id": {"type": "string", "description": "The ID of the project."}, "app_name": {"type": "string", "description": "The name of the application."}, "secret_name": {"type": "string", "description": "The name of the secret."}}, "required": ["organization_id", "project_id", "app_name", "secret_name"]}}, {"name": "create_secret", "description": "Creates a new secret.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "project_id": {"type": "string", "description": "The ID of the project."}, "app_name": {"type": "string", "description": "The name of the application."}, "secret_name": {"type": "string", "description": "The name of the new secret."}, "secret_value": {"type": "string", "description": "The value of the new secret."}}, "required": ["organization_id", "project_id", "app_name", "secret_name", "secret_value"]}}, {"name": "find_project_by_name", "description": "Finds a project by its name.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "name": {"type": "string", "description": "The name of the project."}}, "required": ["organization_id", "name"]}}, {"name": "find_user_by_email", "description": "Finds a user by their email.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "email": {"type": "string", "description": "The email of the user."}}, "required": ["organization_id", "email"]}}, {"name": "find_organization_by_name", "description": "Finds an organization by its name.", "inputSchema": {"type": "object", "properties": {"name": {"type": "string", "description": "The name of the organization."}}, "required": ["name"]}}, {"name": "list_resources", "description": "Lists all resources in a project.", "inputSchema": {"type": "object", "properties": {"project_id": {"type": "string", "description": "The ID of the project."}}, "required": ["project_id"]}}, {"name": "search_logs", "description": "Searches for audit logs in an organization using LogQL. At least one of `query`, `project_id`, or `topic` must be provided. For advanced filtering, use the `query` parameter with LogQL syntax. To filter on specific JSON fields in the log entries, use the `| json` parser in your query. For example: `query='| json | control_plane_event_action=\"CREATE\"'`", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "query": {"type": "string", "description": "The LogQL query string for advanced filtering. Can be combined with `project_id` and `topic`. Example: '| json | resource_uuid=\"some-uuid\"'"}, "project_id": {"type": "string", "description": "A project ID to filter by."}, "topic": {"type": "string", "description": "A log topic to search. Example topics: 'hashicorp.platform.audit', 'hashicorp.packer.registry.audit', 'hashicorp.boundary.cluster.audit', 'hashicorp.consul.cluster.audit'"}, "start_time": {"type": "string", "description": "The start time for the search. Accepts formats like '24 hours ago', 'yesterday at 5pm', or 'Oct 1, 2025'."}, "end_time": {"type": "string", "description": "The end time for the search. Accepts formats like 'now', 'today', or 'Oct 3, 2025'."}}, "required": ["organization_id", "start_time", "end_time"]}}]}, "id": 2}
2025-10-14 14:00:40,610 - mcp_server - INFO - Client call: {"method": "tools/call", "params": {"name": "search_logs", "arguments": {"start_time": "8 days ago", "end_time": "now", "organization_id": "11eab4a9-75f1-e0a5-8be1-0242ac110016"}}, "jsonrpc": "2.0", "id": 3}
2025-10-14 14:00:41,208 - mcp_server - INFO - Request data: stdio_main: {'jsonrpc': '2.0', 'error': {'code': -32000, 'message': 'Server error: A query, project_id, or topic must be provided to search logs. ', 'data': 'A query, project_id, or topic must be provided to search logs.'}, 'id': 3}
2025-10-14 14:00:41,208 - mcp_server - INFO - Request data: stdio_main json: {"jsonrpc": "2.0", "error": {"code": -32000, "message": "Server error: A query, project_id, or topic must be provided to search logs. ", "data": "A query, project_id, or topic must be provided to search logs."}, "id": 3}
2025-10-14 14:03:06,262 - mcp_server - INFO - Received request: {"method": "initialize", "params": {"protocolVersion": "2025-06-18", "capabilities": {"roots": {}}, "clientInfo": {"name": "gemini-cli-mcp-client-HCP", "version": "0.0.1"}}, "jsonrpc": "2.0", "id": 0}
2025-10-14 14:03:06,263 - mcp_server - INFO - Request data: stdio_main: {'jsonrpc': '2.0', 'result': {'protocolVersion': '2024-11-05', 'serverInfo': {'name': 'HCP', 'version': '0.0.1'}, 'capabilities': {'tools': {'listChanged': True}, 'prompts': {'listChanged': True}, 'resources': {'listChanged': True}}}, 'id': 0}
2025-10-14 14:03:06,263 - mcp_server - INFO - Request data: stdio_main json: {"jsonrpc": "2.0", "result": {"protocolVersion": "2024-11-05", "serverInfo": {"name": "HCP", "version": "0.0.1"}, "capabilities": {"tools": {"listChanged": true}, "prompts": {"listChanged": true}, "resources": {"listChanged": true}}}, "id": 0}
2025-10-14 14:03:06,263 - mcp_server - INFO - Received request: {"method": "notifications/initialized", "jsonrpc": "2.0"}
2025-10-14 14:03:06,263 - mcp_server - INFO - Client initialized.
2025-10-14 14:03:06,263 - mcp_server - INFO - Received request: {"method": "prompts/list", "params": {}, "jsonrpc": "2.0", "id": 1}
2025-10-14 14:03:06,263 - mcp_server - INFO - Request data: stdio_main: {'jsonrpc': '2.0', 'result': {'prompts': [{'name': 'list_projects', 'title': 'List Projects', 'description': 'Lists all HCP projects for a given organization.', 'arguments': [{'name': 'organization_id', 'description': 'The ID of the organization.', 'required': True}]}, {'name': 'get_project', 'title': 'Get Project', 'description': 'Gets an HCP project by its ID.', 'arguments': [{'name': 'project_id', 'description': 'The ID of the project.', 'required': True}]}, {'name': 'delete_project', 'title': 'Delete Project', 'description': 'Deletes an HCP project by its ID.', 'arguments': [{'name': 'project_id', 'description': 'The ID of the project.', 'required': True}]}, {'name': 'create_project', 'title': 'Create Project', 'description': 'Creates a new HCP project.', 'arguments': [{'name': 'name', 'description': 'The name of the new project.', 'required': True}, {'name': 'organization_id', 'description': 'The ID of the organization.', 'required': True}]}, {'name': 'update_project', 'title': 'Update Project', 'description': 'Updates an HCP project.', 'arguments': [{'name': 'project_id', 'description': 'The ID of the project.', 'required': True}, {'name': 'name', 'description': 'The new name for the project.', 'required': True}, {'name': 'organization_id', 'description': 'The ID of the organization.', 'required': True}]}, {'name': 'get_organization', 'title': 'Get Organization', 'description': 'Gets an HCP organization by its ID.', 'arguments': [{'name': 'organization_id', 'description': 'The ID of the organization.', 'required': True}]}, {'name': 'list_organizations', 'title': 'List Organizations', 'description': 'Lists all HCP organizations.', 'arguments': None}, {'name': 'update_organization', 'title': 'Update Organization', 'description': 'Updates an HCP organization.', 'arguments': [{'name': 'organization_id', 'description': 'The ID of the organization.', 'required': True}, {'name': 'name', 'description': 'The new name for the organization.', 'required': True}]}, {'name': 'list_secrets', 'title': 'List Secrets', 'description': 'Lists all secrets for a given application.', 'arguments': [{'name': 'project_id', 'description': 'The ID of the project.', 'required': True}, {'name': 'app_name', 'description': 'The name of the application.', 'required': True}]}, {'name': 'get_secret', 'title': 'Get Secret', 'description': 'Gets a secret by its name.', 'arguments': [{'name': 'secret_name', 'description': 'The name of the secret.', 'required': True}, {'name': 'project_id', 'description': 'The ID of the project.', 'required': True}, {'name': 'app_name', 'description': 'The name of the application.', 'required': True}]}, {'name': 'delete_secret', 'title': 'Delete Secret', 'description': 'Deletes a secret by its name.', 'arguments': [{'name': 'secret_name', 'description': 'The name of the secret.', 'required': True}, {'name': 'project_id', 'description': 'The ID of the project.', 'required': True}, {'name': 'app_name', 'description': 'The name of the application.', 'required': True}]}, {'name': 'create_secret', 'title': 'Create Secret', 'description': 'Creates a new secret.', 'arguments': [{'name': 'secret_name', 'description': 'The name of the new secret.', 'required': True}, {'name': 'secret_value', 'description': 'The value of the new secret.', 'required': True}, {'name': 'project_id', 'description': 'The ID of the project.', 'required': True}, {'name': 'app_name', 'description': 'The name of the application.', 'required': True}]}, {'name': 'find_project_and_list_secrets', 'title': 'Find Project and List Secrets', 'description': 'Finds a project by name and lists its secrets.', 'arguments': [{'name': 'project_name', 'description': 'The name of the project.', 'required': True}, {'name': 'organization_id', 'description': 'The ID of the organization.', 'required': True}, {'name': 'app_name', 'description': 'The name of the application.', 'required': True}]}, {'name': 'list_resources', 'title': 'List Resources', 'description': 'Lists all resources in a project.', 'arguments': [{'name': 'project_id', 'description': 'The ID of the project.', 'required': True}]}, {'name': 'search_logs', 'title': 'Search Logs', 'description': 'Searches for audit logs in an organization using LogQL. The LLM should determine the best topic to use based on the user\'s query, or default to \'hashicorp.platform.audit\' if the user is not specific. For advanced filtering, use the `query` parameter with LogQL syntax. To filter on specific JSON fields in the log entries, use the `| json` parser in your query. For example: `query=\'| json | control_plane_event_action="CREATE"\'`', 'arguments': [{'name': 'organization_id', 'description': 'The ID of the organization.', 'required': True}, {'name': 'query', 'description': 'The LogQL query string for advanced filtering. Can be combined with `project_id` and `topic`. Example: \'| json | resource_uuid="some-uuid"\'', 'required': False}, {'name': 'project_id', 'description': 'A project ID to filter by.', 'required': False}, {'name': 'topic', 'description': "A log topic to search. Example topics: 'hashicorp.platform.audit', 'hashicorp.packer.registry.audit', 'hashicorp.boundary.cluster.audit', 'hashicorp.consul.cluster.audit'", 'required': False}, {'name': 'start_time', 'description': "The start time for the search. Accepts formats like '24 hours ago', 'yesterday at 5pm', or 'Oct 1, 2025'.", 'required': True}, {'name': 'end_time', 'description': "The end time for the search. Accepts formats like 'now', 'today', or 'Oct 3, 2025'.", 'required': True}]}]}, 'id': 1}
2025-10-14 14:03:06,263 - mcp_server - INFO - Request data: stdio_main json: {"jsonrpc": "2.0", "result": {"prompts": [{"name": "list_projects", "title": "List Projects", "description": "Lists all HCP projects for a given organization.", "arguments": [{"name": "organization_id", "description": "The ID of the organization.", "required": true}]}, {"name": "get_project", "title": "Get Project", "description": "Gets an HCP project by its ID.", "arguments": [{"name": "project_id", "description": "The ID of the project.", "required": true}]}, {"name": "delete_project", "title": "Delete Project", "description": "Deletes an HCP project by its ID.", "arguments": [{"name": "project_id", "description": "The ID of the project.", "required": true}]}, {"name": "create_project", "title": "Create Project", "description": "Creates a new HCP project.", "arguments": [{"name": "name", "description": "The name of the new project.", "required": true}, {"name": "organization_id", "description": "The ID of the organization.", "required": true}]}, {"name": "update_project", "title": "Update Project", "description": "Updates an HCP project.", "arguments": [{"name": "project_id", "description": "The ID of the project.", "required": true}, {"name": "name", "description": "The new name for the project.", "required": true}, {"name": "organization_id", "description": "The ID of the organization.", "required": true}]}, {"name": "get_organization", "title": "Get Organization", "description": "Gets an HCP organization by its ID.", "arguments": [{"name": "organization_id", "description": "The ID of the organization.", "required": true}]}, {"name": "list_organizations", "title": "List Organizations", "description": "Lists all HCP organizations.", "arguments": null}, {"name": "update_organization", "title": "Update Organization", "description": "Updates an HCP organization.", "arguments": [{"name": "organization_id", "description": "The ID of the organization.", "required": true}, {"name": "name", "description": "The new name for the organization.", "required": true}]}, {"name": "list_secrets", "title": "List Secrets", "description": "Lists all secrets for a given application.", "arguments": [{"name": "project_id", "description": "The ID of the project.", "required": true}, {"name": "app_name", "description": "The name of the application.", "required": true}]}, {"name": "get_secret", "title": "Get Secret", "description": "Gets a secret by its name.", "arguments": [{"name": "secret_name", "description": "The name of the secret.", "required": true}, {"name": "project_id", "description": "The ID of the project.", "required": true}, {"name": "app_name", "description": "The name of the application.", "required": true}]}, {"name": "delete_secret", "title": "Delete Secret", "description": "Deletes a secret by its name.", "arguments": [{"name": "secret_name", "description": "The name of the secret.", "required": true}, {"name": "project_id", "description": "The ID of the project.", "required": true}, {"name": "app_name", "description": "The name of the application.", "required": true}]}, {"name": "create_secret", "title": "Create Secret", "description": "Creates a new secret.", "arguments": [{"name": "secret_name", "description": "The name of the new secret.", "required": true}, {"name": "secret_value", "description": "The value of the new secret.", "required": true}, {"name": "project_id", "description": "The ID of the project.", "required": true}, {"name": "app_name", "description": "The name of the application.", "required": true}]}, {"name": "find_project_and_list_secrets", "title": "Find Project and List Secrets", "description": "Finds a project by name and lists its secrets.", "arguments": [{"name": "project_name", "description": "The name of the project.", "required": true}, {"name": "organization_id", "description": "The ID of the organization.", "required": true}, {"name": "app_name", "description": "The name of the application.", "required": true}]}, {"name": "list_resources", "title": "List Resources", "description": "Lists all resources in a project.", "arguments": [{"name": "project_id", "description": "The ID of the project.", "required": true}]}, {"name": "search_logs", "title": "Search Logs", "description": "Searches for audit logs in an organization using LogQL. The LLM should determine the best topic to use based on the user's query, or default to 'hashicorp.platform.audit' if the user is not specific. For advanced filtering, use the `query` parameter with LogQL syntax. To filter on specific JSON fields in the log entries, use the `| json` parser in your query. For example: `query='| json | control_plane_event_action=\"CREATE\"'`", "arguments": [{"name": "organization_id", "description": "The ID of the organization.", "required": true}, {"name": "query", "description": "The LogQL query string for advanced filtering. Can be combined with `project_id` and `topic`. Example: '| json | resource_uuid=\"some-uuid\"'", "required": false}, {"name": "project_id", "description": "A project ID to filter by.", "required": false}, {"name": "topic", "description": "A log topic to search. Example topics: 'hashicorp.platform.audit', 'hashicorp.packer.registry.audit', 'hashicorp.boundary.cluster.audit', 'hashicorp.consul.cluster.audit'", "required": false}, {"name": "start_time", "description": "The start time for the search. Accepts formats like '24 hours ago', 'yesterday at 5pm', or 'Oct 1, 2025'.", "required": true}, {"name": "end_time", "description": "The end time for the search. Accepts formats like 'now', 'today', or 'Oct 3, 2025'.", "required": true}]}]}, "id": 1}
2025-10-14 14:03:06,264 - mcp_server - INFO - Received request: {"method": "tools/list", "params": {}, "jsonrpc": "2.0", "id": 2}
2025-10-14 14:03:06,264 - mcp_server - INFO - Request data: stdio_main: {'jsonrpc': '2.0', 'result': {'tools': [{'name': 'list_projects', 'description': 'Lists all HCP projects for a given organization.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}}, 'required': ['organization_id']}}, {'name': 'get_project', 'description': 'Gets an HCP project by its ID.', 'inputSchema': {'type': 'object', 'properties': {'project_id': {'type': 'string', 'description': 'The ID of the project.'}}, 'required': ['project_id']}}, {'name': 'delete_project', 'description': 'Deletes an HCP project by its ID.', 'inputSchema': {'type': 'object', 'properties': {'project_id': {'type': 'string', 'description': 'The ID of the project.'}}, 'required': ['project_id']}}, {'name': 'create_project', 'description': 'Creates a new HCP project.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'name': {'type': 'string', 'description': 'The name of the new project.'}}, 'required': ['organization_id', 'name']}}, {'name': 'update_project', 'description': 'Updates an HCP project.', 'inputSchema': {'type': 'object', 'properties': {'project_id': {'type': 'string', 'description': 'The ID of the project.'}, 'name': {'type': 'string', 'description': 'The new name of the project.'}}, 'required': ['project_id', 'name']}}, {'name': 'get_organization', 'description': 'Gets an HCP organization by its ID.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}}, 'required': ['organization_id']}}, {'name': 'list_organizations', 'description': 'Lists all HCP organizations.', 'inputSchema': {'type': 'object', 'properties': {}}}, {'name': 'update_organization', 'description': 'Updates an HCP organization.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'name': {'type': 'string', 'description': 'The new name of the organization.'}}, 'required': ['organization_id', 'name']}}, {'name': 'search_principals', 'description': 'Searches for principals in an organization.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'filter_str': {'type': 'string', 'description': 'The filter string to use for the search.'}}, 'required': ['organization_id']}}, {'name': 'get_principals', 'description': 'Gets principals by their IDs.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'principal_ids': {'type': 'array', 'items': {'type': 'string'}, 'description': 'The IDs of the principals to get.'}}, 'required': ['organization_id', 'principal_ids']}}, {'name': 'delete_service_principal', 'description': 'Deletes a service principal by its ID.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'principal_id': {'type': 'string', 'description': 'The ID of the service principal.'}}, 'required': ['organization_id', 'principal_id']}}, {'name': 'create_service_principal', 'description': 'Creates a new service principal.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'name': {'type': 'string', 'description': 'The name of the new service principal.'}}, 'required': ['organization_id', 'name']}}, {'name': 'update_service_principal', 'description': 'Updates a service principal.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'principal_id': {'type': 'string', 'description': 'The ID of the service principal.'}, 'name': {'type': 'string', 'description': 'The new name of the service principal.'}}, 'required': ['organization_id', 'principal_id', 'name']}}, {'name': 'list_secrets', 'description': 'Lists all secrets for a given application.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'project_id': {'type': 'string', 'description': 'The ID of the project.'}, 'app_name': {'type': 'string', 'description': 'The name of the application.'}}, 'required': ['organization_id', 'project_id', 'app_name']}}, {'name': 'get_secret', 'description': 'Gets a secret by its name.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'project_id': {'type': 'string', 'description': 'The ID of the project.'}, 'app_name': {'type': 'string', 'description': 'The name of the application.'}, 'secret_name': {'type': 'string', 'description': 'The name of the secret.'}}, 'required': ['organization_id', 'project_id', 'app_name', 'secret_name']}}, {'name': 'delete_secret', 'description': 'Deletes a secret by its name.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'project_id': {'type': 'string', 'description': 'The ID of the project.'}, 'app_name': {'type': 'string', 'description': 'The name of the application.'}, 'secret_name': {'type': 'string', 'description': 'The name of the secret.'}}, 'required': ['organization_id', 'project_id', 'app_name', 'secret_name']}}, {'name': 'create_secret', 'description': 'Creates a new secret.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'project_id': {'type': 'string', 'description': 'The ID of the project.'}, 'app_name': {'type': 'string', 'description': 'The name of the application.'}, 'secret_name': {'type': 'string', 'description': 'The name of the new secret.'}, 'secret_value': {'type': 'string', 'description': 'The value of the new secret.'}}, 'required': ['organization_id', 'project_id', 'app_name', 'secret_name', 'secret_value']}}, {'name': 'find_project_by_name', 'description': 'Finds a project by its name.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'name': {'type': 'string', 'description': 'The name of the project.'}}, 'required': ['organization_id', 'name']}}, {'name': 'find_user_by_email', 'description': 'Finds a user by their email.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'email': {'type': 'string', 'description': 'The email of the user.'}}, 'required': ['organization_id', 'email']}}, {'name': 'find_organization_by_name', 'description': 'Finds an organization by its name.', 'inputSchema': {'type': 'object', 'properties': {'name': {'type': 'string', 'description': 'The name of the organization.'}}, 'required': ['name']}}, {'name': 'list_resources', 'description': 'Lists all resources in a project.', 'inputSchema': {'type': 'object', 'properties': {'project_id': {'type': 'string', 'description': 'The ID of the project.'}}, 'required': ['project_id']}}, {'name': 'search_logs', 'description': 'Searches for audit logs in an organization using LogQL. The LLM should determine the best topic to use based on the user\'s query, or default to \'hashicorp.platform.audit\' if the user is not specific. For advanced filtering, use the `query` parameter with LogQL syntax. To filter on specific JSON fields in the log entries, use the `| json` parser in your query. For example: `query=\'| json | control_plane_event_action="CREATE"\'`', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'query': {'type': 'string', 'description': 'The LogQL query string for advanced filtering. Can be combined with `project_id` and `topic`. Example: \'| json | resource_uuid="some-uuid"\''}, 'project_id': {'type': 'string', 'description': 'A project ID to filter by.'}, 'topic': {'type': 'string', 'description': "A log topic to search. Example topics: 'hashicorp.platform.audit', 'hashicorp.packer.registry.audit', 'hashicorp.boundary.cluster.audit', 'hashicorp.consul.cluster.audit'"}, 'start_time': {'type': 'string', 'description': "The start time for the search. Accepts formats like '24 hours ago', 'yesterday at 5pm', or 'Oct 1, 2025'."}, 'end_time': {'type': 'string', 'description': "The end time for the search. Accepts formats like 'now', 'today', or 'Oct 3, 2025'."}}, 'required': ['organization_id', 'start_time', 'end_time']}}]}, 'id': 2}
2025-10-14 14:03:06,264 - mcp_server - INFO - Request data: stdio_main json: {"jsonrpc": "2.0", "result": {"tools": [{"name": "list_projects", "description": "Lists all HCP projects for a given organization.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}}, "required": ["organization_id"]}}, {"name": "get_project", "description": "Gets an HCP project by its ID.", "inputSchema": {"type": "object", "properties": {"project_id": {"type": "string", "description": "The ID of the project."}}, "required": ["project_id"]}}, {"name": "delete_project", "description": "Deletes an HCP project by its ID.", "inputSchema": {"type": "object", "properties": {"project_id": {"type": "string", "description": "The ID of the project."}}, "required": ["project_id"]}}, {"name": "create_project", "description": "Creates a new HCP project.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "name": {"type": "string", "description": "The name of the new project."}}, "required": ["organization_id", "name"]}}, {"name": "update_project", "description": "Updates an HCP project.", "inputSchema": {"type": "object", "properties": {"project_id": {"type": "string", "description": "The ID of the project."}, "name": {"type": "string", "description": "The new name of the project."}}, "required": ["project_id", "name"]}}, {"name": "get_organization", "description": "Gets an HCP organization by its ID.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}}, "required": ["organization_id"]}}, {"name": "list_organizations", "description": "Lists all HCP organizations.", "inputSchema": {"type": "object", "properties": {}}}, {"name": "update_organization", "description": "Updates an HCP organization.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "name": {"type": "string", "description": "The new name of the organization."}}, "required": ["organization_id", "name"]}}, {"name": "search_principals", "description": "Searches for principals in an organization.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "filter_str": {"type": "string", "description": "The filter string to use for the search."}}, "required": ["organization_id"]}}, {"name": "get_principals", "description": "Gets principals by their IDs.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "principal_ids": {"type": "array", "items": {"type": "string"}, "description": "The IDs of the principals to get."}}, "required": ["organization_id", "principal_ids"]}}, {"name": "delete_service_principal", "description": "Deletes a service principal by its ID.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "principal_id": {"type": "string", "description": "The ID of the service principal."}}, "required": ["organization_id", "principal_id"]}}, {"name": "create_service_principal", "description": "Creates a new service principal.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "name": {"type": "string", "description": "The name of the new service principal."}}, "required": ["organization_id", "name"]}}, {"name": "update_service_principal", "description": "Updates a service principal.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "principal_id": {"type": "string", "description": "The ID of the service principal."}, "name": {"type": "string", "description": "The new name of the service principal."}}, "required": ["organization_id", "principal_id", "name"]}}, {"name": "list_secrets", "description": "Lists all secrets for a given application.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "project_id": {"type": "string", "description": "The ID of the project."}, "app_name": {"type": "string", "description": "The name of the application."}}, "required": ["organization_id", "project_id", "app_name"]}}, {"name": "get_secret", "description": "Gets a secret by its name.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "project_id": {"type": "string", "description": "The ID of the project."}, "app_name": {"type": "string", "description": "The name of the application."}, "secret_name": {"type": "string", "description": "The name of the secret."}}, "required": ["organization_id", "project_id", "app_name", "secret_name"]}}, {"name": "delete_secret", "description": "Deletes a secret by its name.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "project_id": {"type": "string", "description": "The ID of the project."}, "app_name": {"type": "string", "description": "The name of the application."}, "secret_name": {"type": "string", "description": "The name of the secret."}}, "required": ["organization_id", "project_id", "app_name", "secret_name"]}}, {"name": "create_secret", "description": "Creates a new secret.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "project_id": {"type": "string", "description": "The ID of the project."}, "app_name": {"type": "string", "description": "The name of the application."}, "secret_name": {"type": "string", "description": "The name of the new secret."}, "secret_value": {"type": "string", "description": "The value of the new secret."}}, "required": ["organization_id", "project_id", "app_name", "secret_name", "secret_value"]}}, {"name": "find_project_by_name", "description": "Finds a project by its name.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "name": {"type": "string", "description": "The name of the project."}}, "required": ["organization_id", "name"]}}, {"name": "find_user_by_email", "description": "Finds a user by their email.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "email": {"type": "string", "description": "The email of the user."}}, "required": ["organization_id", "email"]}}, {"name": "find_organization_by_name", "description": "Finds an organization by its name.", "inputSchema": {"type": "object", "properties": {"name": {"type": "string", "description": "The name of the organization."}}, "required": ["name"]}}, {"name": "list_resources", "description": "Lists all resources in a project.", "inputSchema": {"type": "object", "properties": {"project_id": {"type": "string", "description": "The ID of the project."}}, "required": ["project_id"]}}, {"name": "search_logs", "description": "Searches for audit logs in an organization using LogQL. The LLM should determine the best topic to use based on the user's query, or default to 'hashicorp.platform.audit' if the user is not specific. For advanced filtering, use the `query` parameter with LogQL syntax. To filter on specific JSON fields in the log entries, use the `| json` parser in your query. For example: `query='| json | control_plane_event_action=\"CREATE\"'`", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "query": {"type": "string", "description": "The LogQL query string for advanced filtering. Can be combined with `project_id` and `topic`. Example: '| json | resource_uuid=\"some-uuid\"'"}, "project_id": {"type": "string", "description": "A project ID to filter by."}, "topic": {"type": "string", "description": "A log topic to search. Example topics: 'hashicorp.platform.audit', 'hashicorp.packer.registry.audit', 'hashicorp.boundary.cluster.audit', 'hashicorp.consul.cluster.audit'"}, "start_time": {"type": "string", "description": "The start time for the search. Accepts formats like '24 hours ago', 'yesterday at 5pm', or 'Oct 1, 2025'."}, "end_time": {"type": "string", "description": "The end time for the search. Accepts formats like 'now', 'today', or 'Oct 3, 2025'."}}, "required": ["organization_id", "start_time", "end_time"]}}]}, "id": 2}
2025-10-14 14:03:33,332 - mcp_server - INFO - Client call: {"method": "tools/call", "params": {"name": "search_logs", "arguments": {"organization_id": "11eab4a9-75f1-e0a5-8be1-0242ac110016", "end_time": "now", "topic": "hashicorp.platform.audit", "start_time": "8 days ago"}}, "jsonrpc": "2.0", "id": 3}
2025-10-14 14:03:39,263 - mcp_server - ERROR - An unexpected error occurred: 
Traceback (most recent call last):
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpx/_transports/default.py", line 101, in map_httpcore_exceptions
    yield
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpx/_transports/default.py", line 394, in handle_async_request
    resp = await self._pool.handle_async_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpcore/_async/connection_pool.py", line 256, in handle_async_request
    raise exc from None
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpcore/_async/connection_pool.py", line 236, in handle_async_request
    response = await connection.handle_async_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpcore/_async/connection.py", line 103, in handle_async_request
    return await self._connection.handle_async_request(request)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpcore/_async/http11.py", line 136, in handle_async_request
    raise exc
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpcore/_async/http11.py", line 106, in handle_async_request
    ) = await self._receive_response_headers(**kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpcore/_async/http11.py", line 177, in _receive_response_headers
    event = await self._receive_event(timeout=timeout)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpcore/_async/http11.py", line 217, in _receive_event
    data = await self._network_stream.read(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpcore/_backends/anyio.py", line 32, in read
    with map_exceptions(exc_map):
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/contextlib.py", line 158, in __exit__
    self.gen.throw(value)
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ReadTimeout

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/tpowell/Documents/workspace/hcp_mcp_server/main.py", line 174, in process_mcp_request
    result = await TOOL_MAP[tool_name](**arguments)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/Documents/workspace/hcp_mcp_server/hcp/audit_logs.py", line 89, in search_logs
    response = await client.post(
               ^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpx/_client.py", line 1859, in post
    return await self.request(
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpx/_client.py", line 1540, in request
    return await self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpx/_client.py", line 1629, in send
    response = await self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpx/_client.py", line 1657, in _send_handling_auth
    response = await self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpx/_client.py", line 1694, in _send_handling_redirects
    response = await self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpx/_client.py", line 1730, in _send_single_request
    response = await transport.handle_async_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpx/_transports/default.py", line 393, in handle_async_request
    with map_httpcore_exceptions():
         ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/contextlib.py", line 158, in __exit__
    self.gen.throw(value)
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpx/_transports/default.py", line 118, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ReadTimeout
2025-10-14 14:03:39,272 - mcp_server - INFO - Request data: stdio_main: {'jsonrpc': '2.0', 'error': {'code': -32000, 'message': 'Server error: ', 'data': 'An unexpected error occurred. See logs for details.'}, 'id': 3}
2025-10-14 14:03:39,272 - mcp_server - INFO - Request data: stdio_main json: {"jsonrpc": "2.0", "error": {"code": -32000, "message": "Server error: ", "data": "An unexpected error occurred. See logs for details."}, "id": 3}
2025-10-14 14:06:36,685 - mcp_server - INFO - Received request: {"method": "initialize", "params": {"protocolVersion": "2025-06-18", "capabilities": {"roots": {}}, "clientInfo": {"name": "gemini-cli-mcp-client-HCP", "version": "0.0.1"}}, "jsonrpc": "2.0", "id": 0}
2025-10-14 14:06:36,685 - mcp_server - INFO - Request data: stdio_main: {'jsonrpc': '2.0', 'result': {'protocolVersion': '2024-11-05', 'serverInfo': {'name': 'HCP', 'version': '0.0.1'}, 'capabilities': {'tools': {'listChanged': True}, 'prompts': {'listChanged': True}, 'resources': {'listChanged': True}}}, 'id': 0}
2025-10-14 14:06:36,685 - mcp_server - INFO - Request data: stdio_main json: {"jsonrpc": "2.0", "result": {"protocolVersion": "2024-11-05", "serverInfo": {"name": "HCP", "version": "0.0.1"}, "capabilities": {"tools": {"listChanged": true}, "prompts": {"listChanged": true}, "resources": {"listChanged": true}}}, "id": 0}
2025-10-14 14:06:36,686 - mcp_server - INFO - Received request: {"method": "notifications/initialized", "jsonrpc": "2.0"}
2025-10-14 14:06:36,686 - mcp_server - INFO - Client initialized.
2025-10-14 14:06:36,686 - mcp_server - INFO - Received request: {"method": "prompts/list", "params": {}, "jsonrpc": "2.0", "id": 1}
2025-10-14 14:06:36,686 - mcp_server - INFO - Request data: stdio_main: {'jsonrpc': '2.0', 'result': {'prompts': [{'name': 'list_projects', 'title': 'List Projects', 'description': 'Lists all HCP projects for a given organization.', 'arguments': [{'name': 'organization_id', 'description': 'The ID of the organization.', 'required': True}]}, {'name': 'get_project', 'title': 'Get Project', 'description': 'Gets an HCP project by its ID.', 'arguments': [{'name': 'project_id', 'description': 'The ID of the project.', 'required': True}]}, {'name': 'delete_project', 'title': 'Delete Project', 'description': 'Deletes an HCP project by its ID.', 'arguments': [{'name': 'project_id', 'description': 'The ID of the project.', 'required': True}]}, {'name': 'create_project', 'title': 'Create Project', 'description': 'Creates a new HCP project.', 'arguments': [{'name': 'name', 'description': 'The name of the new project.', 'required': True}, {'name': 'organization_id', 'description': 'The ID of the organization.', 'required': True}]}, {'name': 'update_project', 'title': 'Update Project', 'description': 'Updates an HCP project.', 'arguments': [{'name': 'project_id', 'description': 'The ID of the project.', 'required': True}, {'name': 'name', 'description': 'The new name for the project.', 'required': True}, {'name': 'organization_id', 'description': 'The ID of the organization.', 'required': True}]}, {'name': 'get_organization', 'title': 'Get Organization', 'description': 'Gets an HCP organization by its ID.', 'arguments': [{'name': 'organization_id', 'description': 'The ID of the organization.', 'required': True}]}, {'name': 'list_organizations', 'title': 'List Organizations', 'description': 'Lists all HCP organizations.', 'arguments': None}, {'name': 'update_organization', 'title': 'Update Organization', 'description': 'Updates an HCP organization.', 'arguments': [{'name': 'organization_id', 'description': 'The ID of the organization.', 'required': True}, {'name': 'name', 'description': 'The new name for the organization.', 'required': True}]}, {'name': 'list_secrets', 'title': 'List Secrets', 'description': 'Lists all secrets for a given application.', 'arguments': [{'name': 'project_id', 'description': 'The ID of the project.', 'required': True}, {'name': 'app_name', 'description': 'The name of the application.', 'required': True}]}, {'name': 'get_secret', 'title': 'Get Secret', 'description': 'Gets a secret by its name.', 'arguments': [{'name': 'secret_name', 'description': 'The name of the secret.', 'required': True}, {'name': 'project_id', 'description': 'The ID of the project.', 'required': True}, {'name': 'app_name', 'description': 'The name of the application.', 'required': True}]}, {'name': 'delete_secret', 'title': 'Delete Secret', 'description': 'Deletes a secret by its name.', 'arguments': [{'name': 'secret_name', 'description': 'The name of the secret.', 'required': True}, {'name': 'project_id', 'description': 'The ID of the project.', 'required': True}, {'name': 'app_name', 'description': 'The name of the application.', 'required': True}]}, {'name': 'create_secret', 'title': 'Create Secret', 'description': 'Creates a new secret.', 'arguments': [{'name': 'secret_name', 'description': 'The name of the new secret.', 'required': True}, {'name': 'secret_value', 'description': 'The value of the new secret.', 'required': True}, {'name': 'project_id', 'description': 'The ID of the project.', 'required': True}, {'name': 'app_name', 'description': 'The name of the application.', 'required': True}]}, {'name': 'find_project_and_list_secrets', 'title': 'Find Project and List Secrets', 'description': 'Finds a project by name and lists its secrets.', 'arguments': [{'name': 'project_name', 'description': 'The name of the project.', 'required': True}, {'name': 'organization_id', 'description': 'The ID of the organization.', 'required': True}, {'name': 'app_name', 'description': 'The name of the application.', 'required': True}]}, {'name': 'list_resources', 'title': 'List Resources', 'description': 'Lists all resources in a project.', 'arguments': [{'name': 'project_id', 'description': 'The ID of the project.', 'required': True}]}, {'name': 'search_logs', 'title': 'Search Logs', 'description': 'Searches for audit logs in an organization using LogQL. The LLM should determine the best topic to use based on the user\'s query, or default to \'hashicorp.platform.audit\' if the user is not specific. For advanced filtering, use the `query` parameter with LogQL syntax. To filter on specific JSON fields in the log entries, use the `| json` parser in your query. For example: `query=\'| json | control_plane_event_action="CREATE"\'`', 'arguments': [{'name': 'organization_id', 'description': 'The ID of the organization.', 'required': True}, {'name': 'query', 'description': 'The LogQL query string for advanced filtering. Can be combined with `project_id` and `topic`. Example: \'| json | resource_uuid="some-uuid"\'', 'required': False}, {'name': 'project_id', 'description': 'A project ID to filter by.', 'required': False}, {'name': 'topic', 'description': "A log topic to search. Example topics: 'hashicorp.platform.audit', 'hashicorp.packer.registry.audit', 'hashicorp.boundary.cluster.audit', 'hashicorp.consul.cluster.audit'", 'required': False}, {'name': 'start_time', 'description': "The start time for the search. Accepts formats like '24 hours ago', 'yesterday at 5pm', or 'Oct 1, 2025'.", 'required': True}, {'name': 'end_time', 'description': "The end time for the search. Accepts formats like 'now', 'today', or 'Oct 3, 2025'.", 'required': True}]}]}, 'id': 1}
2025-10-14 14:06:36,686 - mcp_server - INFO - Request data: stdio_main json: {"jsonrpc": "2.0", "result": {"prompts": [{"name": "list_projects", "title": "List Projects", "description": "Lists all HCP projects for a given organization.", "arguments": [{"name": "organization_id", "description": "The ID of the organization.", "required": true}]}, {"name": "get_project", "title": "Get Project", "description": "Gets an HCP project by its ID.", "arguments": [{"name": "project_id", "description": "The ID of the project.", "required": true}]}, {"name": "delete_project", "title": "Delete Project", "description": "Deletes an HCP project by its ID.", "arguments": [{"name": "project_id", "description": "The ID of the project.", "required": true}]}, {"name": "create_project", "title": "Create Project", "description": "Creates a new HCP project.", "arguments": [{"name": "name", "description": "The name of the new project.", "required": true}, {"name": "organization_id", "description": "The ID of the organization.", "required": true}]}, {"name": "update_project", "title": "Update Project", "description": "Updates an HCP project.", "arguments": [{"name": "project_id", "description": "The ID of the project.", "required": true}, {"name": "name", "description": "The new name for the project.", "required": true}, {"name": "organization_id", "description": "The ID of the organization.", "required": true}]}, {"name": "get_organization", "title": "Get Organization", "description": "Gets an HCP organization by its ID.", "arguments": [{"name": "organization_id", "description": "The ID of the organization.", "required": true}]}, {"name": "list_organizations", "title": "List Organizations", "description": "Lists all HCP organizations.", "arguments": null}, {"name": "update_organization", "title": "Update Organization", "description": "Updates an HCP organization.", "arguments": [{"name": "organization_id", "description": "The ID of the organization.", "required": true}, {"name": "name", "description": "The new name for the organization.", "required": true}]}, {"name": "list_secrets", "title": "List Secrets", "description": "Lists all secrets for a given application.", "arguments": [{"name": "project_id", "description": "The ID of the project.", "required": true}, {"name": "app_name", "description": "The name of the application.", "required": true}]}, {"name": "get_secret", "title": "Get Secret", "description": "Gets a secret by its name.", "arguments": [{"name": "secret_name", "description": "The name of the secret.", "required": true}, {"name": "project_id", "description": "The ID of the project.", "required": true}, {"name": "app_name", "description": "The name of the application.", "required": true}]}, {"name": "delete_secret", "title": "Delete Secret", "description": "Deletes a secret by its name.", "arguments": [{"name": "secret_name", "description": "The name of the secret.", "required": true}, {"name": "project_id", "description": "The ID of the project.", "required": true}, {"name": "app_name", "description": "The name of the application.", "required": true}]}, {"name": "create_secret", "title": "Create Secret", "description": "Creates a new secret.", "arguments": [{"name": "secret_name", "description": "The name of the new secret.", "required": true}, {"name": "secret_value", "description": "The value of the new secret.", "required": true}, {"name": "project_id", "description": "The ID of the project.", "required": true}, {"name": "app_name", "description": "The name of the application.", "required": true}]}, {"name": "find_project_and_list_secrets", "title": "Find Project and List Secrets", "description": "Finds a project by name and lists its secrets.", "arguments": [{"name": "project_name", "description": "The name of the project.", "required": true}, {"name": "organization_id", "description": "The ID of the organization.", "required": true}, {"name": "app_name", "description": "The name of the application.", "required": true}]}, {"name": "list_resources", "title": "List Resources", "description": "Lists all resources in a project.", "arguments": [{"name": "project_id", "description": "The ID of the project.", "required": true}]}, {"name": "search_logs", "title": "Search Logs", "description": "Searches for audit logs in an organization using LogQL. The LLM should determine the best topic to use based on the user's query, or default to 'hashicorp.platform.audit' if the user is not specific. For advanced filtering, use the `query` parameter with LogQL syntax. To filter on specific JSON fields in the log entries, use the `| json` parser in your query. For example: `query='| json | control_plane_event_action=\"CREATE\"'`", "arguments": [{"name": "organization_id", "description": "The ID of the organization.", "required": true}, {"name": "query", "description": "The LogQL query string for advanced filtering. Can be combined with `project_id` and `topic`. Example: '| json | resource_uuid=\"some-uuid\"'", "required": false}, {"name": "project_id", "description": "A project ID to filter by.", "required": false}, {"name": "topic", "description": "A log topic to search. Example topics: 'hashicorp.platform.audit', 'hashicorp.packer.registry.audit', 'hashicorp.boundary.cluster.audit', 'hashicorp.consul.cluster.audit'", "required": false}, {"name": "start_time", "description": "The start time for the search. Accepts formats like '24 hours ago', 'yesterday at 5pm', or 'Oct 1, 2025'.", "required": true}, {"name": "end_time", "description": "The end time for the search. Accepts formats like 'now', 'today', or 'Oct 3, 2025'.", "required": true}]}]}, "id": 1}
2025-10-14 14:06:36,687 - mcp_server - INFO - Received request: {"method": "tools/list", "params": {}, "jsonrpc": "2.0", "id": 2}
2025-10-14 14:06:36,687 - mcp_server - INFO - Request data: stdio_main: {'jsonrpc': '2.0', 'result': {'tools': [{'name': 'list_projects', 'description': 'Lists all HCP projects for a given organization.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}}, 'required': ['organization_id']}}, {'name': 'get_project', 'description': 'Gets an HCP project by its ID.', 'inputSchema': {'type': 'object', 'properties': {'project_id': {'type': 'string', 'description': 'The ID of the project.'}}, 'required': ['project_id']}}, {'name': 'delete_project', 'description': 'Deletes an HCP project by its ID.', 'inputSchema': {'type': 'object', 'properties': {'project_id': {'type': 'string', 'description': 'The ID of the project.'}}, 'required': ['project_id']}}, {'name': 'create_project', 'description': 'Creates a new HCP project.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'name': {'type': 'string', 'description': 'The name of the new project.'}}, 'required': ['organization_id', 'name']}}, {'name': 'update_project', 'description': 'Updates an HCP project.', 'inputSchema': {'type': 'object', 'properties': {'project_id': {'type': 'string', 'description': 'The ID of the project.'}, 'name': {'type': 'string', 'description': 'The new name of the project.'}}, 'required': ['project_id', 'name']}}, {'name': 'get_organization', 'description': 'Gets an HCP organization by its ID.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}}, 'required': ['organization_id']}}, {'name': 'list_organizations', 'description': 'Lists all HCP organizations.', 'inputSchema': {'type': 'object', 'properties': {}}}, {'name': 'update_organization', 'description': 'Updates an HCP organization.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'name': {'type': 'string', 'description': 'The new name of the organization.'}}, 'required': ['organization_id', 'name']}}, {'name': 'search_principals', 'description': 'Searches for principals in an organization.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'filter_str': {'type': 'string', 'description': 'The filter string to use for the search.'}}, 'required': ['organization_id']}}, {'name': 'get_principals', 'description': 'Gets principals by their IDs.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'principal_ids': {'type': 'array', 'items': {'type': 'string'}, 'description': 'The IDs of the principals to get.'}}, 'required': ['organization_id', 'principal_ids']}}, {'name': 'delete_service_principal', 'description': 'Deletes a service principal by its ID.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'principal_id': {'type': 'string', 'description': 'The ID of the service principal.'}}, 'required': ['organization_id', 'principal_id']}}, {'name': 'create_service_principal', 'description': 'Creates a new service principal.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'name': {'type': 'string', 'description': 'The name of the new service principal.'}}, 'required': ['organization_id', 'name']}}, {'name': 'update_service_principal', 'description': 'Updates a service principal.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'principal_id': {'type': 'string', 'description': 'The ID of the service principal.'}, 'name': {'type': 'string', 'description': 'The new name of the service principal.'}}, 'required': ['organization_id', 'principal_id', 'name']}}, {'name': 'list_secrets', 'description': 'Lists all secrets for a given application.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'project_id': {'type': 'string', 'description': 'The ID of the project.'}, 'app_name': {'type': 'string', 'description': 'The name of the application.'}}, 'required': ['organization_id', 'project_id', 'app_name']}}, {'name': 'get_secret', 'description': 'Gets a secret by its name.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'project_id': {'type': 'string', 'description': 'The ID of the project.'}, 'app_name': {'type': 'string', 'description': 'The name of the application.'}, 'secret_name': {'type': 'string', 'description': 'The name of the secret.'}}, 'required': ['organization_id', 'project_id', 'app_name', 'secret_name']}}, {'name': 'delete_secret', 'description': 'Deletes a secret by its name.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'project_id': {'type': 'string', 'description': 'The ID of the project.'}, 'app_name': {'type': 'string', 'description': 'The name of the application.'}, 'secret_name': {'type': 'string', 'description': 'The name of the secret.'}}, 'required': ['organization_id', 'project_id', 'app_name', 'secret_name']}}, {'name': 'create_secret', 'description': 'Creates a new secret.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'project_id': {'type': 'string', 'description': 'The ID of the project.'}, 'app_name': {'type': 'string', 'description': 'The name of the application.'}, 'secret_name': {'type': 'string', 'description': 'The name of the new secret.'}, 'secret_value': {'type': 'string', 'description': 'The value of the new secret.'}}, 'required': ['organization_id', 'project_id', 'app_name', 'secret_name', 'secret_value']}}, {'name': 'find_project_by_name', 'description': 'Finds a project by its name.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'name': {'type': 'string', 'description': 'The name of the project.'}}, 'required': ['organization_id', 'name']}}, {'name': 'find_user_by_email', 'description': 'Finds a user by their email.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'email': {'type': 'string', 'description': 'The email of the user.'}}, 'required': ['organization_id', 'email']}}, {'name': 'find_organization_by_name', 'description': 'Finds an organization by its name.', 'inputSchema': {'type': 'object', 'properties': {'name': {'type': 'string', 'description': 'The name of the organization.'}}, 'required': ['name']}}, {'name': 'list_resources', 'description': 'Lists all resources in a project.', 'inputSchema': {'type': 'object', 'properties': {'project_id': {'type': 'string', 'description': 'The ID of the project.'}}, 'required': ['project_id']}}, {'name': 'search_logs', 'description': 'Searches for audit logs in an organization using LogQL. The LLM should determine the best topic to use based on the user\'s query, or default to \'hashicorp.platform.audit\' if the user is not specific. For advanced filtering, use the `query` parameter with LogQL syntax. To filter on specific JSON fields in the log entries, use the `| json` parser in your query. For example: `query=\'| json | control_plane_event_action="CREATE"\'`', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'query': {'type': 'string', 'description': 'The LogQL query string for advanced filtering. Can be combined with `project_id` and `topic`. Example: \'| json | resource_uuid="some-uuid"\''}, 'project_id': {'type': 'string', 'description': 'A project ID to filter by.'}, 'topic': {'type': 'string', 'description': "A log topic to search. Example topics: 'hashicorp.platform.audit', 'hashicorp.packer.registry.audit', 'hashicorp.boundary.cluster.audit', 'hashicorp.consul.cluster.audit'"}, 'start_time': {'type': 'string', 'description': "The start time for the search. Accepts formats like '24 hours ago', 'yesterday at 5pm', or 'Oct 1, 2025'."}, 'end_time': {'type': 'string', 'description': "The end time for the search. Accepts formats like 'now', 'today', or 'Oct 3, 2025'."}}, 'required': ['organization_id', 'start_time', 'end_time']}}]}, 'id': 2}
2025-10-14 14:06:36,687 - mcp_server - INFO - Request data: stdio_main json: {"jsonrpc": "2.0", "result": {"tools": [{"name": "list_projects", "description": "Lists all HCP projects for a given organization.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}}, "required": ["organization_id"]}}, {"name": "get_project", "description": "Gets an HCP project by its ID.", "inputSchema": {"type": "object", "properties": {"project_id": {"type": "string", "description": "The ID of the project."}}, "required": ["project_id"]}}, {"name": "delete_project", "description": "Deletes an HCP project by its ID.", "inputSchema": {"type": "object", "properties": {"project_id": {"type": "string", "description": "The ID of the project."}}, "required": ["project_id"]}}, {"name": "create_project", "description": "Creates a new HCP project.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "name": {"type": "string", "description": "The name of the new project."}}, "required": ["organization_id", "name"]}}, {"name": "update_project", "description": "Updates an HCP project.", "inputSchema": {"type": "object", "properties": {"project_id": {"type": "string", "description": "The ID of the project."}, "name": {"type": "string", "description": "The new name of the project."}}, "required": ["project_id", "name"]}}, {"name": "get_organization", "description": "Gets an HCP organization by its ID.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}}, "required": ["organization_id"]}}, {"name": "list_organizations", "description": "Lists all HCP organizations.", "inputSchema": {"type": "object", "properties": {}}}, {"name": "update_organization", "description": "Updates an HCP organization.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "name": {"type": "string", "description": "The new name of the organization."}}, "required": ["organization_id", "name"]}}, {"name": "search_principals", "description": "Searches for principals in an organization.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "filter_str": {"type": "string", "description": "The filter string to use for the search."}}, "required": ["organization_id"]}}, {"name": "get_principals", "description": "Gets principals by their IDs.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "principal_ids": {"type": "array", "items": {"type": "string"}, "description": "The IDs of the principals to get."}}, "required": ["organization_id", "principal_ids"]}}, {"name": "delete_service_principal", "description": "Deletes a service principal by its ID.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "principal_id": {"type": "string", "description": "The ID of the service principal."}}, "required": ["organization_id", "principal_id"]}}, {"name": "create_service_principal", "description": "Creates a new service principal.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "name": {"type": "string", "description": "The name of the new service principal."}}, "required": ["organization_id", "name"]}}, {"name": "update_service_principal", "description": "Updates a service principal.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "principal_id": {"type": "string", "description": "The ID of the service principal."}, "name": {"type": "string", "description": "The new name of the service principal."}}, "required": ["organization_id", "principal_id", "name"]}}, {"name": "list_secrets", "description": "Lists all secrets for a given application.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "project_id": {"type": "string", "description": "The ID of the project."}, "app_name": {"type": "string", "description": "The name of the application."}}, "required": ["organization_id", "project_id", "app_name"]}}, {"name": "get_secret", "description": "Gets a secret by its name.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "project_id": {"type": "string", "description": "The ID of the project."}, "app_name": {"type": "string", "description": "The name of the application."}, "secret_name": {"type": "string", "description": "The name of the secret."}}, "required": ["organization_id", "project_id", "app_name", "secret_name"]}}, {"name": "delete_secret", "description": "Deletes a secret by its name.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "project_id": {"type": "string", "description": "The ID of the project."}, "app_name": {"type": "string", "description": "The name of the application."}, "secret_name": {"type": "string", "description": "The name of the secret."}}, "required": ["organization_id", "project_id", "app_name", "secret_name"]}}, {"name": "create_secret", "description": "Creates a new secret.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "project_id": {"type": "string", "description": "The ID of the project."}, "app_name": {"type": "string", "description": "The name of the application."}, "secret_name": {"type": "string", "description": "The name of the new secret."}, "secret_value": {"type": "string", "description": "The value of the new secret."}}, "required": ["organization_id", "project_id", "app_name", "secret_name", "secret_value"]}}, {"name": "find_project_by_name", "description": "Finds a project by its name.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "name": {"type": "string", "description": "The name of the project."}}, "required": ["organization_id", "name"]}}, {"name": "find_user_by_email", "description": "Finds a user by their email.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "email": {"type": "string", "description": "The email of the user."}}, "required": ["organization_id", "email"]}}, {"name": "find_organization_by_name", "description": "Finds an organization by its name.", "inputSchema": {"type": "object", "properties": {"name": {"type": "string", "description": "The name of the organization."}}, "required": ["name"]}}, {"name": "list_resources", "description": "Lists all resources in a project.", "inputSchema": {"type": "object", "properties": {"project_id": {"type": "string", "description": "The ID of the project."}}, "required": ["project_id"]}}, {"name": "search_logs", "description": "Searches for audit logs in an organization using LogQL. The LLM should determine the best topic to use based on the user's query, or default to 'hashicorp.platform.audit' if the user is not specific. For advanced filtering, use the `query` parameter with LogQL syntax. To filter on specific JSON fields in the log entries, use the `| json` parser in your query. For example: `query='| json | control_plane_event_action=\"CREATE\"'`", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "query": {"type": "string", "description": "The LogQL query string for advanced filtering. Can be combined with `project_id` and `topic`. Example: '| json | resource_uuid=\"some-uuid\"'"}, "project_id": {"type": "string", "description": "A project ID to filter by."}, "topic": {"type": "string", "description": "A log topic to search. Example topics: 'hashicorp.platform.audit', 'hashicorp.packer.registry.audit', 'hashicorp.boundary.cluster.audit', 'hashicorp.consul.cluster.audit'"}, "start_time": {"type": "string", "description": "The start time for the search. Accepts formats like '24 hours ago', 'yesterday at 5pm', or 'Oct 1, 2025'."}, "end_time": {"type": "string", "description": "The end time for the search. Accepts formats like 'now', 'today', or 'Oct 3, 2025'."}}, "required": ["organization_id", "start_time", "end_time"]}}]}, "id": 2}
2025-10-14 14:06:53,998 - mcp_server - INFO - Client call: {"method": "tools/call", "params": {"name": "search_logs", "arguments": {"topic": "hashicorp.platform.audit", "organization_id": "11eab4a9-75f1-e0a5-8be1-0242ac110016", "end_time": "now", "start_time": "8 days ago"}}, "jsonrpc": "2.0", "id": 3}
2025-10-14 14:06:59,897 - mcp_server - ERROR - An unexpected error occurred: 
Traceback (most recent call last):
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpx/_transports/default.py", line 101, in map_httpcore_exceptions
    yield
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpx/_transports/default.py", line 394, in handle_async_request
    resp = await self._pool.handle_async_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpcore/_async/connection_pool.py", line 256, in handle_async_request
    raise exc from None
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpcore/_async/connection_pool.py", line 236, in handle_async_request
    response = await connection.handle_async_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpcore/_async/connection.py", line 103, in handle_async_request
    return await self._connection.handle_async_request(request)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpcore/_async/http11.py", line 136, in handle_async_request
    raise exc
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpcore/_async/http11.py", line 106, in handle_async_request
    ) = await self._receive_response_headers(**kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpcore/_async/http11.py", line 177, in _receive_response_headers
    event = await self._receive_event(timeout=timeout)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpcore/_async/http11.py", line 217, in _receive_event
    data = await self._network_stream.read(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpcore/_backends/anyio.py", line 32, in read
    with map_exceptions(exc_map):
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/contextlib.py", line 158, in __exit__
    self.gen.throw(value)
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ReadTimeout

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/tpowell/Documents/workspace/hcp_mcp_server/main.py", line 174, in process_mcp_request
    result = await TOOL_MAP[tool_name](**arguments)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/Documents/workspace/hcp_mcp_server/hcp/audit_logs.py", line 89, in search_logs
    response = await client.post(
               ^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpx/_client.py", line 1859, in post
    return await self.request(
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpx/_client.py", line 1540, in request
    return await self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpx/_client.py", line 1629, in send
    response = await self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpx/_client.py", line 1657, in _send_handling_auth
    response = await self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpx/_client.py", line 1694, in _send_handling_redirects
    response = await self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpx/_client.py", line 1730, in _send_single_request
    response = await transport.handle_async_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpx/_transports/default.py", line 393, in handle_async_request
    with map_httpcore_exceptions():
         ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/contextlib.py", line 158, in __exit__
    self.gen.throw(value)
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpx/_transports/default.py", line 118, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ReadTimeout
2025-10-14 14:06:59,903 - mcp_server - INFO - Request data: stdio_main: {'jsonrpc': '2.0', 'error': {'code': -32000, 'message': 'Exception/Server error: ', 'data': 'An unexpected error occurred. See logs for details.'}, 'id': 3}
2025-10-14 14:06:59,903 - mcp_server - INFO - Request data: stdio_main json: {"jsonrpc": "2.0", "error": {"code": -32000, "message": "Exception/Server error: ", "data": "An unexpected error occurred. See logs for details."}, "id": 3}
2025-10-14 14:08:25,046 - mcp_server - INFO - Client call: {"method": "tools/call", "params": {"name": "search_logs", "arguments": {"organization_id": "11eab4a9-75f1-e0a5-8be1-0242ac110016", "start_time": "8 days ago", "end_time": "now", "topic": "hashicorp.platform.audit"}}, "jsonrpc": "2.0", "id": 4}
2025-10-14 14:08:32,195 - mcp_server - ERROR - An unexpected error occurred: 
Traceback (most recent call last):
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpx/_transports/default.py", line 101, in map_httpcore_exceptions
    yield
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpx/_transports/default.py", line 394, in handle_async_request
    resp = await self._pool.handle_async_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpcore/_async/connection_pool.py", line 256, in handle_async_request
    raise exc from None
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpcore/_async/connection_pool.py", line 236, in handle_async_request
    response = await connection.handle_async_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpcore/_async/connection.py", line 103, in handle_async_request
    return await self._connection.handle_async_request(request)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpcore/_async/http11.py", line 136, in handle_async_request
    raise exc
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpcore/_async/http11.py", line 106, in handle_async_request
    ) = await self._receive_response_headers(**kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpcore/_async/http11.py", line 177, in _receive_response_headers
    event = await self._receive_event(timeout=timeout)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpcore/_async/http11.py", line 217, in _receive_event
    data = await self._network_stream.read(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpcore/_backends/anyio.py", line 32, in read
    with map_exceptions(exc_map):
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/contextlib.py", line 158, in __exit__
    self.gen.throw(value)
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ReadTimeout

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/tpowell/Documents/workspace/hcp_mcp_server/main.py", line 174, in process_mcp_request
    result = await TOOL_MAP[tool_name](**arguments)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/Documents/workspace/hcp_mcp_server/hcp/audit_logs.py", line 89, in search_logs
    response = await client.post(
               ^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpx/_client.py", line 1859, in post
    return await self.request(
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpx/_client.py", line 1540, in request
    return await self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpx/_client.py", line 1629, in send
    response = await self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpx/_client.py", line 1657, in _send_handling_auth
    response = await self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpx/_client.py", line 1694, in _send_handling_redirects
    response = await self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpx/_client.py", line 1730, in _send_single_request
    response = await transport.handle_async_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpx/_transports/default.py", line 393, in handle_async_request
    with map_httpcore_exceptions():
         ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/contextlib.py", line 158, in __exit__
    self.gen.throw(value)
  File "/Users/tpowell/.pyenv/versions/3.12.7/lib/python3.12/site-packages/httpx/_transports/default.py", line 118, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ReadTimeout
2025-10-14 14:08:32,200 - mcp_server - INFO - Request data: stdio_main: {'jsonrpc': '2.0', 'error': {'code': -32000, 'message': 'Exception/Server error: ', 'data': 'An unexpected error occurred. See logs for details.'}, 'id': 4}
2025-10-14 14:08:32,200 - mcp_server - INFO - Request data: stdio_main json: {"jsonrpc": "2.0", "error": {"code": -32000, "message": "Exception/Server error: ", "data": "An unexpected error occurred. See logs for details."}, "id": 4}
2025-10-14 14:15:43,508 - mcp_server - INFO - Received request: {"method": "initialize", "params": {"protocolVersion": "2025-06-18", "capabilities": {"roots": {}}, "clientInfo": {"name": "gemini-cli-mcp-client-HCP", "version": "0.0.1"}}, "jsonrpc": "2.0", "id": 0}
2025-10-14 14:15:43,508 - mcp_server - INFO - Request data: stdio_main: {'jsonrpc': '2.0', 'result': {'protocolVersion': '2024-11-05', 'serverInfo': {'name': 'HCP', 'version': '0.0.1'}, 'capabilities': {'tools': {'listChanged': True}, 'prompts': {'listChanged': True}, 'resources': {'listChanged': True}}}, 'id': 0}
2025-10-14 14:15:43,508 - mcp_server - INFO - Request data: stdio_main json: {"jsonrpc": "2.0", "result": {"protocolVersion": "2024-11-05", "serverInfo": {"name": "HCP", "version": "0.0.1"}, "capabilities": {"tools": {"listChanged": true}, "prompts": {"listChanged": true}, "resources": {"listChanged": true}}}, "id": 0}
2025-10-14 14:15:43,509 - mcp_server - INFO - Received request: {"method": "notifications/initialized", "jsonrpc": "2.0"}
2025-10-14 14:15:43,509 - mcp_server - INFO - Client initialized.
2025-10-14 14:15:43,509 - mcp_server - INFO - Received request: {"method": "prompts/list", "params": {}, "jsonrpc": "2.0", "id": 1}
2025-10-14 14:15:43,509 - mcp_server - INFO - Request data: stdio_main: {'jsonrpc': '2.0', 'result': {'prompts': [{'name': 'list_projects', 'title': 'List Projects', 'description': 'Lists all HCP projects for a given organization.', 'arguments': [{'name': 'organization_id', 'description': 'The ID of the organization.', 'required': True}]}, {'name': 'get_project', 'title': 'Get Project', 'description': 'Gets an HCP project by its ID.', 'arguments': [{'name': 'project_id', 'description': 'The ID of the project.', 'required': True}]}, {'name': 'delete_project', 'title': 'Delete Project', 'description': 'Deletes an HCP project by its ID.', 'arguments': [{'name': 'project_id', 'description': 'The ID of the project.', 'required': True}]}, {'name': 'create_project', 'title': 'Create Project', 'description': 'Creates a new HCP project.', 'arguments': [{'name': 'name', 'description': 'The name of the new project.', 'required': True}, {'name': 'organization_id', 'description': 'The ID of the organization.', 'required': True}]}, {'name': 'update_project', 'title': 'Update Project', 'description': 'Updates an HCP project.', 'arguments': [{'name': 'project_id', 'description': 'The ID of the project.', 'required': True}, {'name': 'name', 'description': 'The new name for the project.', 'required': True}, {'name': 'organization_id', 'description': 'The ID of the organization.', 'required': True}]}, {'name': 'get_organization', 'title': 'Get Organization', 'description': 'Gets an HCP organization by its ID.', 'arguments': [{'name': 'organization_id', 'description': 'The ID of the organization.', 'required': True}]}, {'name': 'list_organizations', 'title': 'List Organizations', 'description': 'Lists all HCP organizations.', 'arguments': None}, {'name': 'update_organization', 'title': 'Update Organization', 'description': 'Updates an HCP organization.', 'arguments': [{'name': 'organization_id', 'description': 'The ID of the organization.', 'required': True}, {'name': 'name', 'description': 'The new name for the organization.', 'required': True}]}, {'name': 'list_secrets', 'title': 'List Secrets', 'description': 'Lists all secrets for a given application.', 'arguments': [{'name': 'project_id', 'description': 'The ID of the project.', 'required': True}, {'name': 'app_name', 'description': 'The name of the application.', 'required': True}]}, {'name': 'get_secret', 'title': 'Get Secret', 'description': 'Gets a secret by its name.', 'arguments': [{'name': 'secret_name', 'description': 'The name of the secret.', 'required': True}, {'name': 'project_id', 'description': 'The ID of the project.', 'required': True}, {'name': 'app_name', 'description': 'The name of the application.', 'required': True}]}, {'name': 'delete_secret', 'title': 'Delete Secret', 'description': 'Deletes a secret by its name.', 'arguments': [{'name': 'secret_name', 'description': 'The name of the secret.', 'required': True}, {'name': 'project_id', 'description': 'The ID of the project.', 'required': True}, {'name': 'app_name', 'description': 'The name of the application.', 'required': True}]}, {'name': 'create_secret', 'title': 'Create Secret', 'description': 'Creates a new secret.', 'arguments': [{'name': 'secret_name', 'description': 'The name of the new secret.', 'required': True}, {'name': 'secret_value', 'description': 'The value of the new secret.', 'required': True}, {'name': 'project_id', 'description': 'The ID of the project.', 'required': True}, {'name': 'app_name', 'description': 'The name of the application.', 'required': True}]}, {'name': 'find_project_and_list_secrets', 'title': 'Find Project and List Secrets', 'description': 'Finds a project by name and lists its secrets.', 'arguments': [{'name': 'project_name', 'description': 'The name of the project.', 'required': True}, {'name': 'organization_id', 'description': 'The ID of the organization.', 'required': True}, {'name': 'app_name', 'description': 'The name of the application.', 'required': True}]}, {'name': 'list_resources', 'title': 'List Resources', 'description': 'Lists all resources in a project.', 'arguments': [{'name': 'project_id', 'description': 'The ID of the project.', 'required': True}]}, {'name': 'search_logs', 'title': 'Search Logs', 'description': 'Searches for audit logs in an organization using LogQL. The LLM should determine the best topic to use based on the user\'s query, or default to \'hashicorp.platform.audit\' if the user is not specific. For advanced filtering, use the `query` parameter with LogQL syntax. To filter on specific JSON fields in the log entries, use the `| json` parser in your query. For example: `query=\'| json | control_plane_event_action="CREATE"\'`', 'arguments': [{'name': 'organization_id', 'description': 'The ID of the organization.', 'required': True}, {'name': 'query', 'description': 'The LogQL query string for advanced filtering. Can be combined with `project_id` and `topic`. Example: \'| json | resource_uuid="some-uuid"\'', 'required': False}, {'name': 'project_id', 'description': 'A project ID to filter by.', 'required': False}, {'name': 'topic', 'description': "A log topic to search. Example topics: 'hashicorp.platform.audit', 'hashicorp.packer.registry.audit', 'hashicorp.boundary.cluster.audit', 'hashicorp.consul.cluster.audit'", 'required': False}, {'name': 'start_time', 'description': "The start time for the search. Accepts formats like '24 hours ago', 'yesterday at 5pm', or 'Oct 1, 2025'.", 'required': True}, {'name': 'end_time', 'description': "The end time for the search. Accepts formats like 'now', 'today', or 'Oct 3, 2025'.", 'required': True}]}]}, 'id': 1}
2025-10-14 14:15:43,510 - mcp_server - INFO - Request data: stdio_main json: {"jsonrpc": "2.0", "result": {"prompts": [{"name": "list_projects", "title": "List Projects", "description": "Lists all HCP projects for a given organization.", "arguments": [{"name": "organization_id", "description": "The ID of the organization.", "required": true}]}, {"name": "get_project", "title": "Get Project", "description": "Gets an HCP project by its ID.", "arguments": [{"name": "project_id", "description": "The ID of the project.", "required": true}]}, {"name": "delete_project", "title": "Delete Project", "description": "Deletes an HCP project by its ID.", "arguments": [{"name": "project_id", "description": "The ID of the project.", "required": true}]}, {"name": "create_project", "title": "Create Project", "description": "Creates a new HCP project.", "arguments": [{"name": "name", "description": "The name of the new project.", "required": true}, {"name": "organization_id", "description": "The ID of the organization.", "required": true}]}, {"name": "update_project", "title": "Update Project", "description": "Updates an HCP project.", "arguments": [{"name": "project_id", "description": "The ID of the project.", "required": true}, {"name": "name", "description": "The new name for the project.", "required": true}, {"name": "organization_id", "description": "The ID of the organization.", "required": true}]}, {"name": "get_organization", "title": "Get Organization", "description": "Gets an HCP organization by its ID.", "arguments": [{"name": "organization_id", "description": "The ID of the organization.", "required": true}]}, {"name": "list_organizations", "title": "List Organizations", "description": "Lists all HCP organizations.", "arguments": null}, {"name": "update_organization", "title": "Update Organization", "description": "Updates an HCP organization.", "arguments": [{"name": "organization_id", "description": "The ID of the organization.", "required": true}, {"name": "name", "description": "The new name for the organization.", "required": true}]}, {"name": "list_secrets", "title": "List Secrets", "description": "Lists all secrets for a given application.", "arguments": [{"name": "project_id", "description": "The ID of the project.", "required": true}, {"name": "app_name", "description": "The name of the application.", "required": true}]}, {"name": "get_secret", "title": "Get Secret", "description": "Gets a secret by its name.", "arguments": [{"name": "secret_name", "description": "The name of the secret.", "required": true}, {"name": "project_id", "description": "The ID of the project.", "required": true}, {"name": "app_name", "description": "The name of the application.", "required": true}]}, {"name": "delete_secret", "title": "Delete Secret", "description": "Deletes a secret by its name.", "arguments": [{"name": "secret_name", "description": "The name of the secret.", "required": true}, {"name": "project_id", "description": "The ID of the project.", "required": true}, {"name": "app_name", "description": "The name of the application.", "required": true}]}, {"name": "create_secret", "title": "Create Secret", "description": "Creates a new secret.", "arguments": [{"name": "secret_name", "description": "The name of the new secret.", "required": true}, {"name": "secret_value", "description": "The value of the new secret.", "required": true}, {"name": "project_id", "description": "The ID of the project.", "required": true}, {"name": "app_name", "description": "The name of the application.", "required": true}]}, {"name": "find_project_and_list_secrets", "title": "Find Project and List Secrets", "description": "Finds a project by name and lists its secrets.", "arguments": [{"name": "project_name", "description": "The name of the project.", "required": true}, {"name": "organization_id", "description": "The ID of the organization.", "required": true}, {"name": "app_name", "description": "The name of the application.", "required": true}]}, {"name": "list_resources", "title": "List Resources", "description": "Lists all resources in a project.", "arguments": [{"name": "project_id", "description": "The ID of the project.", "required": true}]}, {"name": "search_logs", "title": "Search Logs", "description": "Searches for audit logs in an organization using LogQL. The LLM should determine the best topic to use based on the user's query, or default to 'hashicorp.platform.audit' if the user is not specific. For advanced filtering, use the `query` parameter with LogQL syntax. To filter on specific JSON fields in the log entries, use the `| json` parser in your query. For example: `query='| json | control_plane_event_action=\"CREATE\"'`", "arguments": [{"name": "organization_id", "description": "The ID of the organization.", "required": true}, {"name": "query", "description": "The LogQL query string for advanced filtering. Can be combined with `project_id` and `topic`. Example: '| json | resource_uuid=\"some-uuid\"'", "required": false}, {"name": "project_id", "description": "A project ID to filter by.", "required": false}, {"name": "topic", "description": "A log topic to search. Example topics: 'hashicorp.platform.audit', 'hashicorp.packer.registry.audit', 'hashicorp.boundary.cluster.audit', 'hashicorp.consul.cluster.audit'", "required": false}, {"name": "start_time", "description": "The start time for the search. Accepts formats like '24 hours ago', 'yesterday at 5pm', or 'Oct 1, 2025'.", "required": true}, {"name": "end_time", "description": "The end time for the search. Accepts formats like 'now', 'today', or 'Oct 3, 2025'.", "required": true}]}]}, "id": 1}
2025-10-14 14:15:43,511 - mcp_server - INFO - Received request: {"method": "tools/list", "params": {}, "jsonrpc": "2.0", "id": 2}
2025-10-14 14:15:43,511 - mcp_server - INFO - Request data: stdio_main: {'jsonrpc': '2.0', 'result': {'tools': [{'name': 'list_projects', 'description': 'Lists all HCP projects for a given organization.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}}, 'required': ['organization_id']}}, {'name': 'get_project', 'description': 'Gets an HCP project by its ID.', 'inputSchema': {'type': 'object', 'properties': {'project_id': {'type': 'string', 'description': 'The ID of the project.'}}, 'required': ['project_id']}}, {'name': 'delete_project', 'description': 'Deletes an HCP project by its ID.', 'inputSchema': {'type': 'object', 'properties': {'project_id': {'type': 'string', 'description': 'The ID of the project.'}}, 'required': ['project_id']}}, {'name': 'create_project', 'description': 'Creates a new HCP project.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'name': {'type': 'string', 'description': 'The name of the new project.'}}, 'required': ['organization_id', 'name']}}, {'name': 'update_project', 'description': 'Updates an HCP project.', 'inputSchema': {'type': 'object', 'properties': {'project_id': {'type': 'string', 'description': 'The ID of the project.'}, 'name': {'type': 'string', 'description': 'The new name of the project.'}}, 'required': ['project_id', 'name']}}, {'name': 'get_organization', 'description': 'Gets an HCP organization by its ID.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}}, 'required': ['organization_id']}}, {'name': 'list_organizations', 'description': 'Lists all HCP organizations.', 'inputSchema': {'type': 'object', 'properties': {}}}, {'name': 'update_organization', 'description': 'Updates an HCP organization.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'name': {'type': 'string', 'description': 'The new name of the organization.'}}, 'required': ['organization_id', 'name']}}, {'name': 'search_principals', 'description': 'Searches for principals in an organization.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'filter_str': {'type': 'string', 'description': 'The filter string to use for the search.'}}, 'required': ['organization_id']}}, {'name': 'get_principals', 'description': 'Gets principals by their IDs.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'principal_ids': {'type': 'array', 'items': {'type': 'string'}, 'description': 'The IDs of the principals to get.'}}, 'required': ['organization_id', 'principal_ids']}}, {'name': 'delete_service_principal', 'description': 'Deletes a service principal by its ID.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'principal_id': {'type': 'string', 'description': 'The ID of the service principal.'}}, 'required': ['organization_id', 'principal_id']}}, {'name': 'create_service_principal', 'description': 'Creates a new service principal.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'name': {'type': 'string', 'description': 'The name of the new service principal.'}}, 'required': ['organization_id', 'name']}}, {'name': 'update_service_principal', 'description': 'Updates a service principal.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'principal_id': {'type': 'string', 'description': 'The ID of the service principal.'}, 'name': {'type': 'string', 'description': 'The new name of the service principal.'}}, 'required': ['organization_id', 'principal_id', 'name']}}, {'name': 'list_secrets', 'description': 'Lists all secrets for a given application.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'project_id': {'type': 'string', 'description': 'The ID of the project.'}, 'app_name': {'type': 'string', 'description': 'The name of the application.'}}, 'required': ['organization_id', 'project_id', 'app_name']}}, {'name': 'get_secret', 'description': 'Gets a secret by its name.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'project_id': {'type': 'string', 'description': 'The ID of the project.'}, 'app_name': {'type': 'string', 'description': 'The name of the application.'}, 'secret_name': {'type': 'string', 'description': 'The name of the secret.'}}, 'required': ['organization_id', 'project_id', 'app_name', 'secret_name']}}, {'name': 'delete_secret', 'description': 'Deletes a secret by its name.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'project_id': {'type': 'string', 'description': 'The ID of the project.'}, 'app_name': {'type': 'string', 'description': 'The name of the application.'}, 'secret_name': {'type': 'string', 'description': 'The name of the secret.'}}, 'required': ['organization_id', 'project_id', 'app_name', 'secret_name']}}, {'name': 'create_secret', 'description': 'Creates a new secret.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'project_id': {'type': 'string', 'description': 'The ID of the project.'}, 'app_name': {'type': 'string', 'description': 'The name of the application.'}, 'secret_name': {'type': 'string', 'description': 'The name of the new secret.'}, 'secret_value': {'type': 'string', 'description': 'The value of the new secret.'}}, 'required': ['organization_id', 'project_id', 'app_name', 'secret_name', 'secret_value']}}, {'name': 'find_project_by_name', 'description': 'Finds a project by its name.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'name': {'type': 'string', 'description': 'The name of the project.'}}, 'required': ['organization_id', 'name']}}, {'name': 'find_user_by_email', 'description': 'Finds a user by their email.', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'email': {'type': 'string', 'description': 'The email of the user.'}}, 'required': ['organization_id', 'email']}}, {'name': 'find_organization_by_name', 'description': 'Finds an organization by its name.', 'inputSchema': {'type': 'object', 'properties': {'name': {'type': 'string', 'description': 'The name of the organization.'}}, 'required': ['name']}}, {'name': 'list_resources', 'description': 'Lists all resources in a project.', 'inputSchema': {'type': 'object', 'properties': {'project_id': {'type': 'string', 'description': 'The ID of the project.'}}, 'required': ['project_id']}}, {'name': 'search_logs', 'description': 'Searches for audit logs in an organization using LogQL. The LLM should determine the best topic to use based on the user\'s query, or default to \'hashicorp.platform.audit\' if the user is not specific. For advanced filtering, use the `query` parameter with LogQL syntax. To filter on specific JSON fields in the log entries, use the `| json` parser in your query. For example: `query=\'| json | control_plane_event_action="CREATE"\'`', 'inputSchema': {'type': 'object', 'properties': {'organization_id': {'type': 'string', 'description': 'The ID of the organization.'}, 'query': {'type': 'string', 'description': 'The LogQL query string for advanced filtering. Can be combined with `project_id` and `topic`. Example: \'| json | resource_uuid="some-uuid"\''}, 'project_id': {'type': 'string', 'description': 'A project ID to filter by.'}, 'topic': {'type': 'string', 'description': "A log topic to search. Example topics: 'hashicorp.platform.audit', 'hashicorp.packer.registry.audit', 'hashicorp.boundary.cluster.audit', 'hashicorp.consul.cluster.audit'"}, 'start_time': {'type': 'string', 'description': "The start time for the search. Accepts formats like '24 hours ago', 'yesterday at 5pm', or 'Oct 1, 2025'."}, 'end_time': {'type': 'string', 'description': "The end time for the search. Accepts formats like 'now', 'today', or 'Oct 3, 2025'."}}, 'required': ['organization_id', 'start_time', 'end_time']}}]}, 'id': 2}
2025-10-14 14:15:43,511 - mcp_server - INFO - Request data: stdio_main json: {"jsonrpc": "2.0", "result": {"tools": [{"name": "list_projects", "description": "Lists all HCP projects for a given organization.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}}, "required": ["organization_id"]}}, {"name": "get_project", "description": "Gets an HCP project by its ID.", "inputSchema": {"type": "object", "properties": {"project_id": {"type": "string", "description": "The ID of the project."}}, "required": ["project_id"]}}, {"name": "delete_project", "description": "Deletes an HCP project by its ID.", "inputSchema": {"type": "object", "properties": {"project_id": {"type": "string", "description": "The ID of the project."}}, "required": ["project_id"]}}, {"name": "create_project", "description": "Creates a new HCP project.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "name": {"type": "string", "description": "The name of the new project."}}, "required": ["organization_id", "name"]}}, {"name": "update_project", "description": "Updates an HCP project.", "inputSchema": {"type": "object", "properties": {"project_id": {"type": "string", "description": "The ID of the project."}, "name": {"type": "string", "description": "The new name of the project."}}, "required": ["project_id", "name"]}}, {"name": "get_organization", "description": "Gets an HCP organization by its ID.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}}, "required": ["organization_id"]}}, {"name": "list_organizations", "description": "Lists all HCP organizations.", "inputSchema": {"type": "object", "properties": {}}}, {"name": "update_organization", "description": "Updates an HCP organization.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "name": {"type": "string", "description": "The new name of the organization."}}, "required": ["organization_id", "name"]}}, {"name": "search_principals", "description": "Searches for principals in an organization.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "filter_str": {"type": "string", "description": "The filter string to use for the search."}}, "required": ["organization_id"]}}, {"name": "get_principals", "description": "Gets principals by their IDs.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "principal_ids": {"type": "array", "items": {"type": "string"}, "description": "The IDs of the principals to get."}}, "required": ["organization_id", "principal_ids"]}}, {"name": "delete_service_principal", "description": "Deletes a service principal by its ID.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "principal_id": {"type": "string", "description": "The ID of the service principal."}}, "required": ["organization_id", "principal_id"]}}, {"name": "create_service_principal", "description": "Creates a new service principal.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "name": {"type": "string", "description": "The name of the new service principal."}}, "required": ["organization_id", "name"]}}, {"name": "update_service_principal", "description": "Updates a service principal.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "principal_id": {"type": "string", "description": "The ID of the service principal."}, "name": {"type": "string", "description": "The new name of the service principal."}}, "required": ["organization_id", "principal_id", "name"]}}, {"name": "list_secrets", "description": "Lists all secrets for a given application.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "project_id": {"type": "string", "description": "The ID of the project."}, "app_name": {"type": "string", "description": "The name of the application."}}, "required": ["organization_id", "project_id", "app_name"]}}, {"name": "get_secret", "description": "Gets a secret by its name.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "project_id": {"type": "string", "description": "The ID of the project."}, "app_name": {"type": "string", "description": "The name of the application."}, "secret_name": {"type": "string", "description": "The name of the secret."}}, "required": ["organization_id", "project_id", "app_name", "secret_name"]}}, {"name": "delete_secret", "description": "Deletes a secret by its name.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "project_id": {"type": "string", "description": "The ID of the project."}, "app_name": {"type": "string", "description": "The name of the application."}, "secret_name": {"type": "string", "description": "The name of the secret."}}, "required": ["organization_id", "project_id", "app_name", "secret_name"]}}, {"name": "create_secret", "description": "Creates a new secret.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "project_id": {"type": "string", "description": "The ID of the project."}, "app_name": {"type": "string", "description": "The name of the application."}, "secret_name": {"type": "string", "description": "The name of the new secret."}, "secret_value": {"type": "string", "description": "The value of the new secret."}}, "required": ["organization_id", "project_id", "app_name", "secret_name", "secret_value"]}}, {"name": "find_project_by_name", "description": "Finds a project by its name.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "name": {"type": "string", "description": "The name of the project."}}, "required": ["organization_id", "name"]}}, {"name": "find_user_by_email", "description": "Finds a user by their email.", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "email": {"type": "string", "description": "The email of the user."}}, "required": ["organization_id", "email"]}}, {"name": "find_organization_by_name", "description": "Finds an organization by its name.", "inputSchema": {"type": "object", "properties": {"name": {"type": "string", "description": "The name of the organization."}}, "required": ["name"]}}, {"name": "list_resources", "description": "Lists all resources in a project.", "inputSchema": {"type": "object", "properties": {"project_id": {"type": "string", "description": "The ID of the project."}}, "required": ["project_id"]}}, {"name": "search_logs", "description": "Searches for audit logs in an organization using LogQL. The LLM should determine the best topic to use based on the user's query, or default to 'hashicorp.platform.audit' if the user is not specific. For advanced filtering, use the `query` parameter with LogQL syntax. To filter on specific JSON fields in the log entries, use the `| json` parser in your query. For example: `query='| json | control_plane_event_action=\"CREATE\"'`", "inputSchema": {"type": "object", "properties": {"organization_id": {"type": "string", "description": "The ID of the organization."}, "query": {"type": "string", "description": "The LogQL query string for advanced filtering. Can be combined with `project_id` and `topic`. Example: '| json | resource_uuid=\"some-uuid\"'"}, "project_id": {"type": "string", "description": "A project ID to filter by."}, "topic": {"type": "string", "description": "A log topic to search. Example topics: 'hashicorp.platform.audit', 'hashicorp.packer.registry.audit', 'hashicorp.boundary.cluster.audit', 'hashicorp.consul.cluster.audit'"}, "start_time": {"type": "string", "description": "The start time for the search. Accepts formats like '24 hours ago', 'yesterday at 5pm', or 'Oct 1, 2025'."}, "end_time": {"type": "string", "description": "The end time for the search. Accepts formats like 'now', 'today', or 'Oct 3, 2025'."}}, "required": ["organization_id", "start_time", "end_time"]}}]}, "id": 2}
2025-10-14 14:16:41,697 - mcp_server - INFO - Client call: {"method": "tools/call", "params": {"name": "search_logs", "arguments": {"start_time": "8 days ago", "topic": "hashicorp.platform.audit", "organization_id": "11eab4a9-75f1-e0a5-8be1-0242ac110016", "end_time": "now"}}, "jsonrpc": "2.0", "id": 3}
2025-10-14 14:16:47,804 - mcp_server - INFO - Tool request data: {'streams': {'entries': [{'id': '464ad470-cffe-484b-b6c8-9de25b80f5b5', 'timestamp': '2025-10-14T16:21:40.048255790Z', 'stream': {'organization_id': '11eab4a9-75f1-e0a5-8be1-0242ac110016', 'project_id': '', 'topic': 'hashicorp.platform.audit'}, 'resource': None, 'control_plane_event': {'request_info': {'http_verb': 'GET', 'http_path': '/consent/complete', 'http_user_agent': '', 'http_client_ip': ''}, 'authentication_info': {'principal': {'id': '5f32f218-a0c0-4191-bd10-f2c1169bcfde', 'type': 'PRINCIPAL_TYPE_USER', 'user': {'id': '5f32f218-a0c0-4191-bd10-f2c1169bcfde', 'email': 'tpowell@hashicorp.com', 'full_name': 'tpowell@hashicorp.com', 'identity_type': 'UNSET', 'identity_types': [], 'subject': '5f32f218-a0c0-4191-bd10-f2c1169bcfde', 'scim_synchronized': False}, 'group_ids': []}, 'service_principal_delegation_chain': []}, 'authorization_info': [], 'metadata': {'email': 'tpowell@hashicorp.com', 'event_type': 'hcp_id_auth_success', 'ip': '73.252.181.35', 'message': 'Authenticated successfully', 'timestamp': '2025-10-14 16:21:38 +0000 UTC', 'user_id': '5f32f218-a0c0-4191-bd10-f2c1169bcfde'}, 'operation_info': {'operation_id': ''}, 'description': 'Authenticated successfully', 'action': 'CREATE', 'status_code': 'OK'}, 'subject': None}, {'id': 'c9c4a9de-0f45-4278-9ac6-c7823f96213b', 'timestamp': '2025-10-14T06:01:56.751655060Z', 'stream': {'organization_id': '11eab4a9-75f1-e0a5-8be1-0242ac110016', 'project_id': '11eab4a9-760d-c9f2-adc9-0242ac11000a', 'topic': 'hashicorp.platform.audit'}, 'resource': None, 'control_plane_event': {'request_info': {'http_verb': 'POST', 'http_path': '/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster1/host-alive', 'http_user_agent': 'HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (8731de7)', 'http_client_ip': '35.91.214.177'}, 'authentication_info': {'principal': None, 'service_principal_delegation_chain': []}, 'authorization_info': [], 'metadata': {'cluster_id': 'vault-cluster1'}, 'operation_info': {'operation_id': ''}, 'description': 'Host Manager Alive Requested', 'action': 'CREATE', 'status_code': 'OK'}, 'subject': None}, {'id': 'b956e78f-eb73-4fe1-a802-9c5ba7583dc6', 'timestamp': '2025-10-13T08:57:10.551034186Z', 'stream': {'organization_id': '11eab4a9-75f1-e0a5-8be1-0242ac110016', 'project_id': '11eab4a9-760d-c9f2-adc9-0242ac11000a', 'topic': 'hashicorp.platform.audit'}, 'resource': None, 'control_plane_event': {'request_info': {'http_verb': 'POST', 'http_path': '/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive', 'http_user_agent': 'HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (4777474)', 'http_client_ip': '35.86.254.254'}, 'authentication_info': {'principal': None, 'service_principal_delegation_chain': []}, 'authorization_info': [], 'metadata': {'cluster_id': 'vault-cluster'}, 'operation_info': {'operation_id': ''}, 'description': 'Host Manager Alive Requested', 'action': 'CREATE', 'status_code': 'OK'}, 'subject': None}, {'id': '38f0ecc0-3b8d-4ec6-8408-f9621645f415', 'timestamp': '2025-10-13T08:56:55.153597336Z', 'stream': {'organization_id': '11eab4a9-75f1-e0a5-8be1-0242ac110016', 'project_id': '11eab4a9-760d-c9f2-adc9-0242ac11000a', 'topic': 'hashicorp.platform.audit'}, 'resource': None, 'control_plane_event': {'request_info': {'http_verb': 'POST', 'http_path': '/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive', 'http_user_agent': 'HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (4777474)', 'http_client_ip': '44.254.251.242'}, 'authentication_info': {'principal': None, 'service_principal_delegation_chain': []}, 'authorization_info': [], 'metadata': {'cluster_id': 'vault-cluster'}, 'operation_info': {'operation_id': ''}, 'description': 'Host Manager Alive Requested', 'action': 'CREATE', 'status_code': 'OK'}, 'subject': None}, {'id': '1a5c8ab1-122c-4c71-ae08-f5265d4a99d5', 'timestamp': '2025-10-13T08:56:48.072589201Z', 'stream': {'organization_id': '11eab4a9-75f1-e0a5-8be1-0242ac110016', 'project_id': '11eab4a9-760d-c9f2-adc9-0242ac11000a', 'topic': 'hashicorp.platform.audit'}, 'resource': None, 'control_plane_event': {'request_info': {'http_verb': 'POST', 'http_path': '/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive', 'http_user_agent': 'HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (4777474)', 'http_client_ip': '35.167.5.113'}, 'authentication_info': {'principal': None, 'service_principal_delegation_chain': []}, 'authorization_info': [], 'metadata': {'cluster_id': 'vault-cluster'}, 'operation_info': {'operation_id': ''}, 'description': 'Host Manager Alive Requested', 'action': 'CREATE', 'status_code': 'OK'}, 'subject': None}, {'id': 'fe8ee3c2-d5b2-4b2b-9d97-29bf69d74f14', 'timestamp': '2025-10-13T06:31:49.904996190Z', 'stream': {'organization_id': '11eab4a9-75f1-e0a5-8be1-0242ac110016', 'project_id': '11eab4a9-760d-c9f2-adc9-0242ac11000a', 'topic': 'hashicorp.platform.audit'}, 'resource': None, 'control_plane_event': {'request_info': {'http_verb': 'POST', 'http_path': '/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster-4/host-alive', 'http_user_agent': 'HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (4777474)', 'http_client_ip': '54.185.214.230'}, 'authentication_info': {'principal': None, 'service_principal_delegation_chain': []}, 'authorization_info': [], 'metadata': {'cluster_id': 'vault-cluster-4'}, 'operation_info': {'operation_id': ''}, 'description': 'Host Manager Alive Requested', 'action': 'CREATE', 'status_code': 'OK'}, 'subject': None}, {'id': '0b907cfc-786b-4910-889c-d389ff480367', 'timestamp': '2025-10-11T06:01:51.975346169Z', 'stream': {'organization_id': '11eab4a9-75f1-e0a5-8be1-0242ac110016', 'project_id': '11eab4a9-760d-c9f2-adc9-0242ac11000a', 'topic': 'hashicorp.platform.audit'}, 'resource': None, 'control_plane_event': {'request_info': {'http_verb': 'POST', 'http_path': '/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster1/host-alive', 'http_user_agent': 'HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (91f0b20)', 'http_client_ip': '34.222.155.8'}, 'authentication_info': {'principal': None, 'service_principal_delegation_chain': []}, 'authorization_info': [], 'metadata': {'cluster_id': 'vault-cluster1'}, 'operation_info': {'operation_id': ''}, 'description': 'Host Manager Alive Requested', 'action': 'CREATE', 'status_code': 'OK'}, 'subject': None}, {'id': '122f81e8-22e6-4904-93b9-66bc619eabfe', 'timestamp': '2025-10-10T08:56:52.023953993Z', 'stream': {'organization_id': '11eab4a9-75f1-e0a5-8be1-0242ac110016', 'project_id': '11eab4a9-760d-c9f2-adc9-0242ac11000a', 'topic': 'hashicorp.platform.audit'}, 'resource': None, 'control_plane_event': {'request_info': {'http_verb': 'POST', 'http_path': '/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive', 'http_user_agent': 'HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (1f2925d)', 'http_client_ip': '35.91.140.117'}, 'authentication_info': {'principal': None, 'service_principal_delegation_chain': []}, 'authorization_info': [], 'metadata': {'cluster_id': 'vault-cluster'}, 'operation_info': {'operation_id': ''}, 'description': 'Host Manager Alive Requested', 'action': 'CREATE', 'status_code': 'OK'}, 'subject': None}, {'id': '02427d1f-9e48-4055-9eeb-1f938f6ca429', 'timestamp': '2025-10-10T08:56:50.585409396Z', 'stream': {'organization_id': '11eab4a9-75f1-e0a5-8be1-0242ac110016', 'project_id': '11eab4a9-760d-c9f2-adc9-0242ac11000a', 'topic': 'hashicorp.platform.audit'}, 'resource': None, 'control_plane_event': {'request_info': {'http_verb': 'POST', 'http_path': '/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive', 'http_user_agent': 'HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (1f2925d)', 'http_client_ip': '35.87.142.147'}, 'authentication_info': {'principal': None, 'service_principal_delegation_chain': []}, 'authorization_info': [], 'metadata': {'cluster_id': 'vault-cluster'}, 'operation_info': {'operation_id': ''}, 'description': 'Host Manager Alive Requested', 'action': 'CREATE', 'status_code': 'OK'}, 'subject': None}, {'id': '69a76856-4cb0-4609-b574-01b4cdba84d6', 'timestamp': '2025-10-10T08:56:48.565603242Z', 'stream': {'organization_id': '11eab4a9-75f1-e0a5-8be1-0242ac110016', 'project_id': '11eab4a9-760d-c9f2-adc9-0242ac11000a', 'topic': 'hashicorp.platform.audit'}, 'resource': None, 'control_plane_event': {'request_info': {'http_verb': 'POST', 'http_path': '/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive', 'http_user_agent': 'HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (1f2925d)', 'http_client_ip': '54.187.49.218'}, 'authentication_info': {'principal': None, 'service_principal_delegation_chain': []}, 'authorization_info': [], 'metadata': {'cluster_id': 'vault-cluster'}, 'operation_info': {'operation_id': ''}, 'description': 'Host Manager Alive Requested', 'action': 'CREATE', 'status_code': 'OK'}, 'subject': None}, {'id': '08813e54-bd3e-4e42-81a3-daadd2672e7e', 'timestamp': '2025-10-10T06:31:50.900038725Z', 'stream': {'organization_id': '11eab4a9-75f1-e0a5-8be1-0242ac110016', 'project_id': '11eab4a9-760d-c9f2-adc9-0242ac11000a', 'topic': 'hashicorp.platform.audit'}, 'resource': None, 'control_plane_event': {'request_info': {'http_verb': 'POST', 'http_path': '/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster-4/host-alive', 'http_user_agent': 'HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (98d7292)', 'http_client_ip': '54.188.11.180'}, 'authentication_info': {'principal': None, 'service_principal_delegation_chain': []}, 'authorization_info': [], 'metadata': {'cluster_id': 'vault-cluster-4'}, 'operation_info': {'operation_id': ''}, 'description': 'Host Manager Alive Requested', 'action': 'CREATE', 'status_code': 'OK'}, 'subject': None}, {'id': 'bd27928c-ae21-462e-be06-6630a49057d8', 'timestamp': '2025-10-09T20:24:13.287295802Z', 'stream': {'organization_id': '11eab4a9-75f1-e0a5-8be1-0242ac110016', 'project_id': '', 'topic': 'hashicorp.platform.audit'}, 'resource': None, 'control_plane_event': {'request_info': {'http_verb': 'GET', 'http_path': '/consent/complete', 'http_user_agent': '', 'http_client_ip': ''}, 'authentication_info': {'principal': {'id': '5f32f218-a0c0-4191-bd10-f2c1169bcfde', 'type': 'PRINCIPAL_TYPE_USER', 'user': {'id': '5f32f218-a0c0-4191-bd10-f2c1169bcfde', 'email': 'tpowell@hashicorp.com', 'full_name': 'tpowell@hashicorp.com', 'identity_type': 'UNSET', 'identity_types': [], 'subject': '5f32f218-a0c0-4191-bd10-f2c1169bcfde', 'scim_synchronized': False}, 'group_ids': []}, 'service_principal_delegation_chain': []}, 'authorization_info': [], 'metadata': {'email': 'tpowell@hashicorp.com', 'event_type': 'hcp_id_auth_success', 'ip': '73.252.181.35', 'message': 'Authenticated successfully', 'timestamp': '2025-10-09 20:24:12 +0000 UTC', 'user_id': '5f32f218-a0c0-4191-bd10-f2c1169bcfde'}, 'operation_info': {'operation_id': ''}, 'description': 'Authenticated successfully', 'action': 'CREATE', 'status_code': 'OK'}, 'subject': None}, {'id': '0e7bdf42-82d1-422c-9c34-ca0107593c76', 'timestamp': '2025-10-08T06:01:56.587155304Z', 'stream': {'organization_id': '11eab4a9-75f1-e0a5-8be1-0242ac110016', 'project_id': '11eab4a9-760d-c9f2-adc9-0242ac11000a', 'topic': 'hashicorp.platform.audit'}, 'resource': None, 'control_plane_event': {'request_info': {'http_verb': 'POST', 'http_path': '/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster1/host-alive', 'http_user_agent': 'HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (ee02d1c)', 'http_client_ip': '34.221.205.1'}, 'authentication_info': {'principal': None, 'service_principal_delegation_chain': []}, 'authorization_info': [], 'metadata': {'cluster_id': 'vault-cluster1'}, 'operation_info': {'operation_id': ''}, 'description': 'Host Manager Alive Requested', 'action': 'CREATE', 'status_code': 'OK'}, 'subject': None}, {'id': '89634f56-97e0-4ac6-bf39-7dc90a3ab1a1', 'timestamp': '2025-10-07T08:56:55.771365379Z', 'stream': {'organization_id': '11eab4a9-75f1-e0a5-8be1-0242ac110016', 'project_id': '11eab4a9-760d-c9f2-adc9-0242ac11000a', 'topic': 'hashicorp.platform.audit'}, 'resource': None, 'control_plane_event': {'request_info': {'http_verb': 'POST', 'http_path': '/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive', 'http_user_agent': 'HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (bfea313)', 'http_client_ip': '35.90.87.232'}, 'authentication_info': {'principal': None, 'service_principal_delegation_chain': []}, 'authorization_info': [], 'metadata': {'cluster_id': 'vault-cluster'}, 'operation_info': {'operation_id': ''}, 'description': 'Host Manager Alive Requested', 'action': 'CREATE', 'status_code': 'OK'}, 'subject': None}, {'id': '3ee2bab5-e951-4489-ae35-d3a052ab05c3', 'timestamp': '2025-10-07T08:56:49.242102158Z', 'stream': {'organization_id': '11eab4a9-75f1-e0a5-8be1-0242ac110016', 'project_id': '11eab4a9-760d-c9f2-adc9-0242ac11000a', 'topic': 'hashicorp.platform.audit'}, 'resource': None, 'control_plane_event': {'request_info': {'http_verb': 'POST', 'http_path': '/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive', 'http_user_agent': 'HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (bfea313)', 'http_client_ip': '16.144.10.31'}, 'authentication_info': {'principal': None, 'service_principal_delegation_chain': []}, 'authorization_info': [], 'metadata': {'cluster_id': 'vault-cluster'}, 'operation_info': {'operation_id': ''}, 'description': 'Host Manager Alive Requested', 'action': 'CREATE', 'status_code': 'OK'}, 'subject': None}, {'id': '118d591d-5d43-496a-8cfd-f377861a82a3', 'timestamp': '2025-10-07T08:56:48.074774296Z', 'stream': {'organization_id': '11eab4a9-75f1-e0a5-8be1-0242ac110016', 'project_id': '11eab4a9-760d-c9f2-adc9-0242ac11000a', 'topic': 'hashicorp.platform.audit'}, 'resource': None, 'control_plane_event': {'request_info': {'http_verb': 'POST', 'http_path': '/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive', 'http_user_agent': 'HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (bfea313)', 'http_client_ip': '34.216.173.150'}, 'authentication_info': {'principal': None, 'service_principal_delegation_chain': []}, 'authorization_info': [], 'metadata': {'cluster_id': 'vault-cluster'}, 'operation_info': {'operation_id': ''}, 'description': 'Host Manager Alive Requested', 'action': 'CREATE', 'status_code': 'OK'}, 'subject': None}, {'id': '490c67cd-67c2-4365-a3fe-55741bc09bf0', 'timestamp': '2025-10-07T06:31:50.875751353Z', 'stream': {'organization_id': '11eab4a9-75f1-e0a5-8be1-0242ac110016', 'project_id': '11eab4a9-760d-c9f2-adc9-0242ac11000a', 'topic': 'hashicorp.platform.audit'}, 'resource': None, 'control_plane_event': {'request_info': {'http_verb': 'POST', 'http_path': '/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster-4/host-alive', 'http_user_agent': 'HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (bfea313)', 'http_client_ip': '54.200.13.172'}, 'authentication_info': {'principal': None, 'service_principal_delegation_chain': []}, 'authorization_info': [], 'metadata': {'cluster_id': 'vault-cluster-4'}, 'operation_info': {'operation_id': ''}, 'description': 'Host Manager Alive Requested', 'action': 'CREATE', 'status_code': 'OK'}, 'subject': None}]}, 'next_page_token': 'eyJ0aW1lc3RhbXAiOiIyMDI1LTEwLTA3VDA2OjMxOjUwLjg3NTc1MTM1M1oiLCJpZCI6IjQ5MGM2N2NkLTY3YzItNDM2NS1hM2ZlLTU1NzQxYmMwOWJmMCIsIm9mZnNldCI6MX0='}
2025-10-14 14:16:47,804 - mcp_server - INFO - Request data: stdio_main: {'jsonrpc': '2.0', 'result': {'content': [{'type': 'text', 'text': '{"streams": {"entries": [{"id": "464ad470-cffe-484b-b6c8-9de25b80f5b5", "timestamp": "2025-10-14T16:21:40.048255790Z", "stream": {"organization_id": "11eab4a9-75f1-e0a5-8be1-0242ac110016", "project_id": "", "topic": "hashicorp.platform.audit"}, "resource": null, "control_plane_event": {"request_info": {"http_verb": "GET", "http_path": "/consent/complete", "http_user_agent": "", "http_client_ip": ""}, "authentication_info": {"principal": {"id": "5f32f218-a0c0-4191-bd10-f2c1169bcfde", "type": "PRINCIPAL_TYPE_USER", "user": {"id": "5f32f218-a0c0-4191-bd10-f2c1169bcfde", "email": "tpowell@hashicorp.com", "full_name": "tpowell@hashicorp.com", "identity_type": "UNSET", "identity_types": [], "subject": "5f32f218-a0c0-4191-bd10-f2c1169bcfde", "scim_synchronized": false}, "group_ids": []}, "service_principal_delegation_chain": []}, "authorization_info": [], "metadata": {"email": "tpowell@hashicorp.com", "event_type": "hcp_id_auth_success", "ip": "73.252.181.35", "message": "Authenticated successfully", "timestamp": "2025-10-14 16:21:38 +0000 UTC", "user_id": "5f32f218-a0c0-4191-bd10-f2c1169bcfde"}, "operation_info": {"operation_id": ""}, "description": "Authenticated successfully", "action": "CREATE", "status_code": "OK"}, "subject": null}, {"id": "c9c4a9de-0f45-4278-9ac6-c7823f96213b", "timestamp": "2025-10-14T06:01:56.751655060Z", "stream": {"organization_id": "11eab4a9-75f1-e0a5-8be1-0242ac110016", "project_id": "11eab4a9-760d-c9f2-adc9-0242ac11000a", "topic": "hashicorp.platform.audit"}, "resource": null, "control_plane_event": {"request_info": {"http_verb": "POST", "http_path": "/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster1/host-alive", "http_user_agent": "HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (8731de7)", "http_client_ip": "35.91.214.177"}, "authentication_info": {"principal": null, "service_principal_delegation_chain": []}, "authorization_info": [], "metadata": {"cluster_id": "vault-cluster1"}, "operation_info": {"operation_id": ""}, "description": "Host Manager Alive Requested", "action": "CREATE", "status_code": "OK"}, "subject": null}, {"id": "b956e78f-eb73-4fe1-a802-9c5ba7583dc6", "timestamp": "2025-10-13T08:57:10.551034186Z", "stream": {"organization_id": "11eab4a9-75f1-e0a5-8be1-0242ac110016", "project_id": "11eab4a9-760d-c9f2-adc9-0242ac11000a", "topic": "hashicorp.platform.audit"}, "resource": null, "control_plane_event": {"request_info": {"http_verb": "POST", "http_path": "/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive", "http_user_agent": "HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (4777474)", "http_client_ip": "35.86.254.254"}, "authentication_info": {"principal": null, "service_principal_delegation_chain": []}, "authorization_info": [], "metadata": {"cluster_id": "vault-cluster"}, "operation_info": {"operation_id": ""}, "description": "Host Manager Alive Requested", "action": "CREATE", "status_code": "OK"}, "subject": null}, {"id": "38f0ecc0-3b8d-4ec6-8408-f9621645f415", "timestamp": "2025-10-13T08:56:55.153597336Z", "stream": {"organization_id": "11eab4a9-75f1-e0a5-8be1-0242ac110016", "project_id": "11eab4a9-760d-c9f2-adc9-0242ac11000a", "topic": "hashicorp.platform.audit"}, "resource": null, "control_plane_event": {"request_info": {"http_verb": "POST", "http_path": "/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive", "http_user_agent": "HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (4777474)", "http_client_ip": "44.254.251.242"}, "authentication_info": {"principal": null, "service_principal_delegation_chain": []}, "authorization_info": [], "metadata": {"cluster_id": "vault-cluster"}, "operation_info": {"operation_id": ""}, "description": "Host Manager Alive Requested", "action": "CREATE", "status_code": "OK"}, "subject": null}, {"id": "1a5c8ab1-122c-4c71-ae08-f5265d4a99d5", "timestamp": "2025-10-13T08:56:48.072589201Z", "stream": {"organization_id": "11eab4a9-75f1-e0a5-8be1-0242ac110016", "project_id": "11eab4a9-760d-c9f2-adc9-0242ac11000a", "topic": "hashicorp.platform.audit"}, "resource": null, "control_plane_event": {"request_info": {"http_verb": "POST", "http_path": "/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive", "http_user_agent": "HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (4777474)", "http_client_ip": "35.167.5.113"}, "authentication_info": {"principal": null, "service_principal_delegation_chain": []}, "authorization_info": [], "metadata": {"cluster_id": "vault-cluster"}, "operation_info": {"operation_id": ""}, "description": "Host Manager Alive Requested", "action": "CREATE", "status_code": "OK"}, "subject": null}, {"id": "fe8ee3c2-d5b2-4b2b-9d97-29bf69d74f14", "timestamp": "2025-10-13T06:31:49.904996190Z", "stream": {"organization_id": "11eab4a9-75f1-e0a5-8be1-0242ac110016", "project_id": "11eab4a9-760d-c9f2-adc9-0242ac11000a", "topic": "hashicorp.platform.audit"}, "resource": null, "control_plane_event": {"request_info": {"http_verb": "POST", "http_path": "/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster-4/host-alive", "http_user_agent": "HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (4777474)", "http_client_ip": "54.185.214.230"}, "authentication_info": {"principal": null, "service_principal_delegation_chain": []}, "authorization_info": [], "metadata": {"cluster_id": "vault-cluster-4"}, "operation_info": {"operation_id": ""}, "description": "Host Manager Alive Requested", "action": "CREATE", "status_code": "OK"}, "subject": null}, {"id": "0b907cfc-786b-4910-889c-d389ff480367", "timestamp": "2025-10-11T06:01:51.975346169Z", "stream": {"organization_id": "11eab4a9-75f1-e0a5-8be1-0242ac110016", "project_id": "11eab4a9-760d-c9f2-adc9-0242ac11000a", "topic": "hashicorp.platform.audit"}, "resource": null, "control_plane_event": {"request_info": {"http_verb": "POST", "http_path": "/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster1/host-alive", "http_user_agent": "HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (91f0b20)", "http_client_ip": "34.222.155.8"}, "authentication_info": {"principal": null, "service_principal_delegation_chain": []}, "authorization_info": [], "metadata": {"cluster_id": "vault-cluster1"}, "operation_info": {"operation_id": ""}, "description": "Host Manager Alive Requested", "action": "CREATE", "status_code": "OK"}, "subject": null}, {"id": "122f81e8-22e6-4904-93b9-66bc619eabfe", "timestamp": "2025-10-10T08:56:52.023953993Z", "stream": {"organization_id": "11eab4a9-75f1-e0a5-8be1-0242ac110016", "project_id": "11eab4a9-760d-c9f2-adc9-0242ac11000a", "topic": "hashicorp.platform.audit"}, "resource": null, "control_plane_event": {"request_info": {"http_verb": "POST", "http_path": "/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive", "http_user_agent": "HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (1f2925d)", "http_client_ip": "35.91.140.117"}, "authentication_info": {"principal": null, "service_principal_delegation_chain": []}, "authorization_info": [], "metadata": {"cluster_id": "vault-cluster"}, "operation_info": {"operation_id": ""}, "description": "Host Manager Alive Requested", "action": "CREATE", "status_code": "OK"}, "subject": null}, {"id": "02427d1f-9e48-4055-9eeb-1f938f6ca429", "timestamp": "2025-10-10T08:56:50.585409396Z", "stream": {"organization_id": "11eab4a9-75f1-e0a5-8be1-0242ac110016", "project_id": "11eab4a9-760d-c9f2-adc9-0242ac11000a", "topic": "hashicorp.platform.audit"}, "resource": null, "control_plane_event": {"request_info": {"http_verb": "POST", "http_path": "/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive", "http_user_agent": "HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (1f2925d)", "http_client_ip": "35.87.142.147"}, "authentication_info": {"principal": null, "service_principal_delegation_chain": []}, "authorization_info": [], "metadata": {"cluster_id": "vault-cluster"}, "operation_info": {"operation_id": ""}, "description": "Host Manager Alive Requested", "action": "CREATE", "status_code": "OK"}, "subject": null}, {"id": "69a76856-4cb0-4609-b574-01b4cdba84d6", "timestamp": "2025-10-10T08:56:48.565603242Z", "stream": {"organization_id": "11eab4a9-75f1-e0a5-8be1-0242ac110016", "project_id": "11eab4a9-760d-c9f2-adc9-0242ac11000a", "topic": "hashicorp.platform.audit"}, "resource": null, "control_plane_event": {"request_info": {"http_verb": "POST", "http_path": "/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive", "http_user_agent": "HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (1f2925d)", "http_client_ip": "54.187.49.218"}, "authentication_info": {"principal": null, "service_principal_delegation_chain": []}, "authorization_info": [], "metadata": {"cluster_id": "vault-cluster"}, "operation_info": {"operation_id": ""}, "description": "Host Manager Alive Requested", "action": "CREATE", "status_code": "OK"}, "subject": null}, {"id": "08813e54-bd3e-4e42-81a3-daadd2672e7e", "timestamp": "2025-10-10T06:31:50.900038725Z", "stream": {"organization_id": "11eab4a9-75f1-e0a5-8be1-0242ac110016", "project_id": "11eab4a9-760d-c9f2-adc9-0242ac11000a", "topic": "hashicorp.platform.audit"}, "resource": null, "control_plane_event": {"request_info": {"http_verb": "POST", "http_path": "/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster-4/host-alive", "http_user_agent": "HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (98d7292)", "http_client_ip": "54.188.11.180"}, "authentication_info": {"principal": null, "service_principal_delegation_chain": []}, "authorization_info": [], "metadata": {"cluster_id": "vault-cluster-4"}, "operation_info": {"operation_id": ""}, "description": "Host Manager Alive Requested", "action": "CREATE", "status_code": "OK"}, "subject": null}, {"id": "bd27928c-ae21-462e-be06-6630a49057d8", "timestamp": "2025-10-09T20:24:13.287295802Z", "stream": {"organization_id": "11eab4a9-75f1-e0a5-8be1-0242ac110016", "project_id": "", "topic": "hashicorp.platform.audit"}, "resource": null, "control_plane_event": {"request_info": {"http_verb": "GET", "http_path": "/consent/complete", "http_user_agent": "", "http_client_ip": ""}, "authentication_info": {"principal": {"id": "5f32f218-a0c0-4191-bd10-f2c1169bcfde", "type": "PRINCIPAL_TYPE_USER", "user": {"id": "5f32f218-a0c0-4191-bd10-f2c1169bcfde", "email": "tpowell@hashicorp.com", "full_name": "tpowell@hashicorp.com", "identity_type": "UNSET", "identity_types": [], "subject": "5f32f218-a0c0-4191-bd10-f2c1169bcfde", "scim_synchronized": false}, "group_ids": []}, "service_principal_delegation_chain": []}, "authorization_info": [], "metadata": {"email": "tpowell@hashicorp.com", "event_type": "hcp_id_auth_success", "ip": "73.252.181.35", "message": "Authenticated successfully", "timestamp": "2025-10-09 20:24:12 +0000 UTC", "user_id": "5f32f218-a0c0-4191-bd10-f2c1169bcfde"}, "operation_info": {"operation_id": ""}, "description": "Authenticated successfully", "action": "CREATE", "status_code": "OK"}, "subject": null}, {"id": "0e7bdf42-82d1-422c-9c34-ca0107593c76", "timestamp": "2025-10-08T06:01:56.587155304Z", "stream": {"organization_id": "11eab4a9-75f1-e0a5-8be1-0242ac110016", "project_id": "11eab4a9-760d-c9f2-adc9-0242ac11000a", "topic": "hashicorp.platform.audit"}, "resource": null, "control_plane_event": {"request_info": {"http_verb": "POST", "http_path": "/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster1/host-alive", "http_user_agent": "HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (ee02d1c)", "http_client_ip": "34.221.205.1"}, "authentication_info": {"principal": null, "service_principal_delegation_chain": []}, "authorization_info": [], "metadata": {"cluster_id": "vault-cluster1"}, "operation_info": {"operation_id": ""}, "description": "Host Manager Alive Requested", "action": "CREATE", "status_code": "OK"}, "subject": null}, {"id": "89634f56-97e0-4ac6-bf39-7dc90a3ab1a1", "timestamp": "2025-10-07T08:56:55.771365379Z", "stream": {"organization_id": "11eab4a9-75f1-e0a5-8be1-0242ac110016", "project_id": "11eab4a9-760d-c9f2-adc9-0242ac11000a", "topic": "hashicorp.platform.audit"}, "resource": null, "control_plane_event": {"request_info": {"http_verb": "POST", "http_path": "/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive", "http_user_agent": "HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (bfea313)", "http_client_ip": "35.90.87.232"}, "authentication_info": {"principal": null, "service_principal_delegation_chain": []}, "authorization_info": [], "metadata": {"cluster_id": "vault-cluster"}, "operation_info": {"operation_id": ""}, "description": "Host Manager Alive Requested", "action": "CREATE", "status_code": "OK"}, "subject": null}, {"id": "3ee2bab5-e951-4489-ae35-d3a052ab05c3", "timestamp": "2025-10-07T08:56:49.242102158Z", "stream": {"organization_id": "11eab4a9-75f1-e0a5-8be1-0242ac110016", "project_id": "11eab4a9-760d-c9f2-adc9-0242ac11000a", "topic": "hashicorp.platform.audit"}, "resource": null, "control_plane_event": {"request_info": {"http_verb": "POST", "http_path": "/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive", "http_user_agent": "HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (bfea313)", "http_client_ip": "16.144.10.31"}, "authentication_info": {"principal": null, "service_principal_delegation_chain": []}, "authorization_info": [], "metadata": {"cluster_id": "vault-cluster"}, "operation_info": {"operation_id": ""}, "description": "Host Manager Alive Requested", "action": "CREATE", "status_code": "OK"}, "subject": null}, {"id": "118d591d-5d43-496a-8cfd-f377861a82a3", "timestamp": "2025-10-07T08:56:48.074774296Z", "stream": {"organization_id": "11eab4a9-75f1-e0a5-8be1-0242ac110016", "project_id": "11eab4a9-760d-c9f2-adc9-0242ac11000a", "topic": "hashicorp.platform.audit"}, "resource": null, "control_plane_event": {"request_info": {"http_verb": "POST", "http_path": "/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive", "http_user_agent": "HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (bfea313)", "http_client_ip": "34.216.173.150"}, "authentication_info": {"principal": null, "service_principal_delegation_chain": []}, "authorization_info": [], "metadata": {"cluster_id": "vault-cluster"}, "operation_info": {"operation_id": ""}, "description": "Host Manager Alive Requested", "action": "CREATE", "status_code": "OK"}, "subject": null}, {"id": "490c67cd-67c2-4365-a3fe-55741bc09bf0", "timestamp": "2025-10-07T06:31:50.875751353Z", "stream": {"organization_id": "11eab4a9-75f1-e0a5-8be1-0242ac110016", "project_id": "11eab4a9-760d-c9f2-adc9-0242ac11000a", "topic": "hashicorp.platform.audit"}, "resource": null, "control_plane_event": {"request_info": {"http_verb": "POST", "http_path": "/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster-4/host-alive", "http_user_agent": "HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (bfea313)", "http_client_ip": "54.200.13.172"}, "authentication_info": {"principal": null, "service_principal_delegation_chain": []}, "authorization_info": [], "metadata": {"cluster_id": "vault-cluster-4"}, "operation_info": {"operation_id": ""}, "description": "Host Manager Alive Requested", "action": "CREATE", "status_code": "OK"}, "subject": null}]}, "next_page_token": "eyJ0aW1lc3RhbXAiOiIyMDI1LTEwLTA3VDA2OjMxOjUwLjg3NTc1MTM1M1oiLCJpZCI6IjQ5MGM2N2NkLTY3YzItNDM2NS1hM2ZlLTU1NzQxYmMwOWJmMCIsIm9mZnNldCI6MX0="}'}], 'isError': False}, 'id': 3}
2025-10-14 14:16:47,804 - mcp_server - INFO - Request data: stdio_main json: {"jsonrpc": "2.0", "result": {"content": [{"type": "text", "text": "{\"streams\": {\"entries\": [{\"id\": \"464ad470-cffe-484b-b6c8-9de25b80f5b5\", \"timestamp\": \"2025-10-14T16:21:40.048255790Z\", \"stream\": {\"organization_id\": \"11eab4a9-75f1-e0a5-8be1-0242ac110016\", \"project_id\": \"\", \"topic\": \"hashicorp.platform.audit\"}, \"resource\": null, \"control_plane_event\": {\"request_info\": {\"http_verb\": \"GET\", \"http_path\": \"/consent/complete\", \"http_user_agent\": \"\", \"http_client_ip\": \"\"}, \"authentication_info\": {\"principal\": {\"id\": \"5f32f218-a0c0-4191-bd10-f2c1169bcfde\", \"type\": \"PRINCIPAL_TYPE_USER\", \"user\": {\"id\": \"5f32f218-a0c0-4191-bd10-f2c1169bcfde\", \"email\": \"tpowell@hashicorp.com\", \"full_name\": \"tpowell@hashicorp.com\", \"identity_type\": \"UNSET\", \"identity_types\": [], \"subject\": \"5f32f218-a0c0-4191-bd10-f2c1169bcfde\", \"scim_synchronized\": false}, \"group_ids\": []}, \"service_principal_delegation_chain\": []}, \"authorization_info\": [], \"metadata\": {\"email\": \"tpowell@hashicorp.com\", \"event_type\": \"hcp_id_auth_success\", \"ip\": \"73.252.181.35\", \"message\": \"Authenticated successfully\", \"timestamp\": \"2025-10-14 16:21:38 +0000 UTC\", \"user_id\": \"5f32f218-a0c0-4191-bd10-f2c1169bcfde\"}, \"operation_info\": {\"operation_id\": \"\"}, \"description\": \"Authenticated successfully\", \"action\": \"CREATE\", \"status_code\": \"OK\"}, \"subject\": null}, {\"id\": \"c9c4a9de-0f45-4278-9ac6-c7823f96213b\", \"timestamp\": \"2025-10-14T06:01:56.751655060Z\", \"stream\": {\"organization_id\": \"11eab4a9-75f1-e0a5-8be1-0242ac110016\", \"project_id\": \"11eab4a9-760d-c9f2-adc9-0242ac11000a\", \"topic\": \"hashicorp.platform.audit\"}, \"resource\": null, \"control_plane_event\": {\"request_info\": {\"http_verb\": \"POST\", \"http_path\": \"/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster1/host-alive\", \"http_user_agent\": \"HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (8731de7)\", \"http_client_ip\": \"35.91.214.177\"}, \"authentication_info\": {\"principal\": null, \"service_principal_delegation_chain\": []}, \"authorization_info\": [], \"metadata\": {\"cluster_id\": \"vault-cluster1\"}, \"operation_info\": {\"operation_id\": \"\"}, \"description\": \"Host Manager Alive Requested\", \"action\": \"CREATE\", \"status_code\": \"OK\"}, \"subject\": null}, {\"id\": \"b956e78f-eb73-4fe1-a802-9c5ba7583dc6\", \"timestamp\": \"2025-10-13T08:57:10.551034186Z\", \"stream\": {\"organization_id\": \"11eab4a9-75f1-e0a5-8be1-0242ac110016\", \"project_id\": \"11eab4a9-760d-c9f2-adc9-0242ac11000a\", \"topic\": \"hashicorp.platform.audit\"}, \"resource\": null, \"control_plane_event\": {\"request_info\": {\"http_verb\": \"POST\", \"http_path\": \"/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive\", \"http_user_agent\": \"HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (4777474)\", \"http_client_ip\": \"35.86.254.254\"}, \"authentication_info\": {\"principal\": null, \"service_principal_delegation_chain\": []}, \"authorization_info\": [], \"metadata\": {\"cluster_id\": \"vault-cluster\"}, \"operation_info\": {\"operation_id\": \"\"}, \"description\": \"Host Manager Alive Requested\", \"action\": \"CREATE\", \"status_code\": \"OK\"}, \"subject\": null}, {\"id\": \"38f0ecc0-3b8d-4ec6-8408-f9621645f415\", \"timestamp\": \"2025-10-13T08:56:55.153597336Z\", \"stream\": {\"organization_id\": \"11eab4a9-75f1-e0a5-8be1-0242ac110016\", \"project_id\": \"11eab4a9-760d-c9f2-adc9-0242ac11000a\", \"topic\": \"hashicorp.platform.audit\"}, \"resource\": null, \"control_plane_event\": {\"request_info\": {\"http_verb\": \"POST\", \"http_path\": \"/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive\", \"http_user_agent\": \"HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (4777474)\", \"http_client_ip\": \"44.254.251.242\"}, \"authentication_info\": {\"principal\": null, \"service_principal_delegation_chain\": []}, \"authorization_info\": [], \"metadata\": {\"cluster_id\": \"vault-cluster\"}, \"operation_info\": {\"operation_id\": \"\"}, \"description\": \"Host Manager Alive Requested\", \"action\": \"CREATE\", \"status_code\": \"OK\"}, \"subject\": null}, {\"id\": \"1a5c8ab1-122c-4c71-ae08-f5265d4a99d5\", \"timestamp\": \"2025-10-13T08:56:48.072589201Z\", \"stream\": {\"organization_id\": \"11eab4a9-75f1-e0a5-8be1-0242ac110016\", \"project_id\": \"11eab4a9-760d-c9f2-adc9-0242ac11000a\", \"topic\": \"hashicorp.platform.audit\"}, \"resource\": null, \"control_plane_event\": {\"request_info\": {\"http_verb\": \"POST\", \"http_path\": \"/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive\", \"http_user_agent\": \"HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (4777474)\", \"http_client_ip\": \"35.167.5.113\"}, \"authentication_info\": {\"principal\": null, \"service_principal_delegation_chain\": []}, \"authorization_info\": [], \"metadata\": {\"cluster_id\": \"vault-cluster\"}, \"operation_info\": {\"operation_id\": \"\"}, \"description\": \"Host Manager Alive Requested\", \"action\": \"CREATE\", \"status_code\": \"OK\"}, \"subject\": null}, {\"id\": \"fe8ee3c2-d5b2-4b2b-9d97-29bf69d74f14\", \"timestamp\": \"2025-10-13T06:31:49.904996190Z\", \"stream\": {\"organization_id\": \"11eab4a9-75f1-e0a5-8be1-0242ac110016\", \"project_id\": \"11eab4a9-760d-c9f2-adc9-0242ac11000a\", \"topic\": \"hashicorp.platform.audit\"}, \"resource\": null, \"control_plane_event\": {\"request_info\": {\"http_verb\": \"POST\", \"http_path\": \"/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster-4/host-alive\", \"http_user_agent\": \"HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (4777474)\", \"http_client_ip\": \"54.185.214.230\"}, \"authentication_info\": {\"principal\": null, \"service_principal_delegation_chain\": []}, \"authorization_info\": [], \"metadata\": {\"cluster_id\": \"vault-cluster-4\"}, \"operation_info\": {\"operation_id\": \"\"}, \"description\": \"Host Manager Alive Requested\", \"action\": \"CREATE\", \"status_code\": \"OK\"}, \"subject\": null}, {\"id\": \"0b907cfc-786b-4910-889c-d389ff480367\", \"timestamp\": \"2025-10-11T06:01:51.975346169Z\", \"stream\": {\"organization_id\": \"11eab4a9-75f1-e0a5-8be1-0242ac110016\", \"project_id\": \"11eab4a9-760d-c9f2-adc9-0242ac11000a\", \"topic\": \"hashicorp.platform.audit\"}, \"resource\": null, \"control_plane_event\": {\"request_info\": {\"http_verb\": \"POST\", \"http_path\": \"/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster1/host-alive\", \"http_user_agent\": \"HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (91f0b20)\", \"http_client_ip\": \"34.222.155.8\"}, \"authentication_info\": {\"principal\": null, \"service_principal_delegation_chain\": []}, \"authorization_info\": [], \"metadata\": {\"cluster_id\": \"vault-cluster1\"}, \"operation_info\": {\"operation_id\": \"\"}, \"description\": \"Host Manager Alive Requested\", \"action\": \"CREATE\", \"status_code\": \"OK\"}, \"subject\": null}, {\"id\": \"122f81e8-22e6-4904-93b9-66bc619eabfe\", \"timestamp\": \"2025-10-10T08:56:52.023953993Z\", \"stream\": {\"organization_id\": \"11eab4a9-75f1-e0a5-8be1-0242ac110016\", \"project_id\": \"11eab4a9-760d-c9f2-adc9-0242ac11000a\", \"topic\": \"hashicorp.platform.audit\"}, \"resource\": null, \"control_plane_event\": {\"request_info\": {\"http_verb\": \"POST\", \"http_path\": \"/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive\", \"http_user_agent\": \"HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (1f2925d)\", \"http_client_ip\": \"35.91.140.117\"}, \"authentication_info\": {\"principal\": null, \"service_principal_delegation_chain\": []}, \"authorization_info\": [], \"metadata\": {\"cluster_id\": \"vault-cluster\"}, \"operation_info\": {\"operation_id\": \"\"}, \"description\": \"Host Manager Alive Requested\", \"action\": \"CREATE\", \"status_code\": \"OK\"}, \"subject\": null}, {\"id\": \"02427d1f-9e48-4055-9eeb-1f938f6ca429\", \"timestamp\": \"2025-10-10T08:56:50.585409396Z\", \"stream\": {\"organization_id\": \"11eab4a9-75f1-e0a5-8be1-0242ac110016\", \"project_id\": \"11eab4a9-760d-c9f2-adc9-0242ac11000a\", \"topic\": \"hashicorp.platform.audit\"}, \"resource\": null, \"control_plane_event\": {\"request_info\": {\"http_verb\": \"POST\", \"http_path\": \"/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive\", \"http_user_agent\": \"HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (1f2925d)\", \"http_client_ip\": \"35.87.142.147\"}, \"authentication_info\": {\"principal\": null, \"service_principal_delegation_chain\": []}, \"authorization_info\": [], \"metadata\": {\"cluster_id\": \"vault-cluster\"}, \"operation_info\": {\"operation_id\": \"\"}, \"description\": \"Host Manager Alive Requested\", \"action\": \"CREATE\", \"status_code\": \"OK\"}, \"subject\": null}, {\"id\": \"69a76856-4cb0-4609-b574-01b4cdba84d6\", \"timestamp\": \"2025-10-10T08:56:48.565603242Z\", \"stream\": {\"organization_id\": \"11eab4a9-75f1-e0a5-8be1-0242ac110016\", \"project_id\": \"11eab4a9-760d-c9f2-adc9-0242ac11000a\", \"topic\": \"hashicorp.platform.audit\"}, \"resource\": null, \"control_plane_event\": {\"request_info\": {\"http_verb\": \"POST\", \"http_path\": \"/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive\", \"http_user_agent\": \"HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (1f2925d)\", \"http_client_ip\": \"54.187.49.218\"}, \"authentication_info\": {\"principal\": null, \"service_principal_delegation_chain\": []}, \"authorization_info\": [], \"metadata\": {\"cluster_id\": \"vault-cluster\"}, \"operation_info\": {\"operation_id\": \"\"}, \"description\": \"Host Manager Alive Requested\", \"action\": \"CREATE\", \"status_code\": \"OK\"}, \"subject\": null}, {\"id\": \"08813e54-bd3e-4e42-81a3-daadd2672e7e\", \"timestamp\": \"2025-10-10T06:31:50.900038725Z\", \"stream\": {\"organization_id\": \"11eab4a9-75f1-e0a5-8be1-0242ac110016\", \"project_id\": \"11eab4a9-760d-c9f2-adc9-0242ac11000a\", \"topic\": \"hashicorp.platform.audit\"}, \"resource\": null, \"control_plane_event\": {\"request_info\": {\"http_verb\": \"POST\", \"http_path\": \"/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster-4/host-alive\", \"http_user_agent\": \"HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (98d7292)\", \"http_client_ip\": \"54.188.11.180\"}, \"authentication_info\": {\"principal\": null, \"service_principal_delegation_chain\": []}, \"authorization_info\": [], \"metadata\": {\"cluster_id\": \"vault-cluster-4\"}, \"operation_info\": {\"operation_id\": \"\"}, \"description\": \"Host Manager Alive Requested\", \"action\": \"CREATE\", \"status_code\": \"OK\"}, \"subject\": null}, {\"id\": \"bd27928c-ae21-462e-be06-6630a49057d8\", \"timestamp\": \"2025-10-09T20:24:13.287295802Z\", \"stream\": {\"organization_id\": \"11eab4a9-75f1-e0a5-8be1-0242ac110016\", \"project_id\": \"\", \"topic\": \"hashicorp.platform.audit\"}, \"resource\": null, \"control_plane_event\": {\"request_info\": {\"http_verb\": \"GET\", \"http_path\": \"/consent/complete\", \"http_user_agent\": \"\", \"http_client_ip\": \"\"}, \"authentication_info\": {\"principal\": {\"id\": \"5f32f218-a0c0-4191-bd10-f2c1169bcfde\", \"type\": \"PRINCIPAL_TYPE_USER\", \"user\": {\"id\": \"5f32f218-a0c0-4191-bd10-f2c1169bcfde\", \"email\": \"tpowell@hashicorp.com\", \"full_name\": \"tpowell@hashicorp.com\", \"identity_type\": \"UNSET\", \"identity_types\": [], \"subject\": \"5f32f218-a0c0-4191-bd10-f2c1169bcfde\", \"scim_synchronized\": false}, \"group_ids\": []}, \"service_principal_delegation_chain\": []}, \"authorization_info\": [], \"metadata\": {\"email\": \"tpowell@hashicorp.com\", \"event_type\": \"hcp_id_auth_success\", \"ip\": \"73.252.181.35\", \"message\": \"Authenticated successfully\", \"timestamp\": \"2025-10-09 20:24:12 +0000 UTC\", \"user_id\": \"5f32f218-a0c0-4191-bd10-f2c1169bcfde\"}, \"operation_info\": {\"operation_id\": \"\"}, \"description\": \"Authenticated successfully\", \"action\": \"CREATE\", \"status_code\": \"OK\"}, \"subject\": null}, {\"id\": \"0e7bdf42-82d1-422c-9c34-ca0107593c76\", \"timestamp\": \"2025-10-08T06:01:56.587155304Z\", \"stream\": {\"organization_id\": \"11eab4a9-75f1-e0a5-8be1-0242ac110016\", \"project_id\": \"11eab4a9-760d-c9f2-adc9-0242ac11000a\", \"topic\": \"hashicorp.platform.audit\"}, \"resource\": null, \"control_plane_event\": {\"request_info\": {\"http_verb\": \"POST\", \"http_path\": \"/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster1/host-alive\", \"http_user_agent\": \"HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (ee02d1c)\", \"http_client_ip\": \"34.221.205.1\"}, \"authentication_info\": {\"principal\": null, \"service_principal_delegation_chain\": []}, \"authorization_info\": [], \"metadata\": {\"cluster_id\": \"vault-cluster1\"}, \"operation_info\": {\"operation_id\": \"\"}, \"description\": \"Host Manager Alive Requested\", \"action\": \"CREATE\", \"status_code\": \"OK\"}, \"subject\": null}, {\"id\": \"89634f56-97e0-4ac6-bf39-7dc90a3ab1a1\", \"timestamp\": \"2025-10-07T08:56:55.771365379Z\", \"stream\": {\"organization_id\": \"11eab4a9-75f1-e0a5-8be1-0242ac110016\", \"project_id\": \"11eab4a9-760d-c9f2-adc9-0242ac11000a\", \"topic\": \"hashicorp.platform.audit\"}, \"resource\": null, \"control_plane_event\": {\"request_info\": {\"http_verb\": \"POST\", \"http_path\": \"/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive\", \"http_user_agent\": \"HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (bfea313)\", \"http_client_ip\": \"35.90.87.232\"}, \"authentication_info\": {\"principal\": null, \"service_principal_delegation_chain\": []}, \"authorization_info\": [], \"metadata\": {\"cluster_id\": \"vault-cluster\"}, \"operation_info\": {\"operation_id\": \"\"}, \"description\": \"Host Manager Alive Requested\", \"action\": \"CREATE\", \"status_code\": \"OK\"}, \"subject\": null}, {\"id\": \"3ee2bab5-e951-4489-ae35-d3a052ab05c3\", \"timestamp\": \"2025-10-07T08:56:49.242102158Z\", \"stream\": {\"organization_id\": \"11eab4a9-75f1-e0a5-8be1-0242ac110016\", \"project_id\": \"11eab4a9-760d-c9f2-adc9-0242ac11000a\", \"topic\": \"hashicorp.platform.audit\"}, \"resource\": null, \"control_plane_event\": {\"request_info\": {\"http_verb\": \"POST\", \"http_path\": \"/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive\", \"http_user_agent\": \"HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (bfea313)\", \"http_client_ip\": \"16.144.10.31\"}, \"authentication_info\": {\"principal\": null, \"service_principal_delegation_chain\": []}, \"authorization_info\": [], \"metadata\": {\"cluster_id\": \"vault-cluster\"}, \"operation_info\": {\"operation_id\": \"\"}, \"description\": \"Host Manager Alive Requested\", \"action\": \"CREATE\", \"status_code\": \"OK\"}, \"subject\": null}, {\"id\": \"118d591d-5d43-496a-8cfd-f377861a82a3\", \"timestamp\": \"2025-10-07T08:56:48.074774296Z\", \"stream\": {\"organization_id\": \"11eab4a9-75f1-e0a5-8be1-0242ac110016\", \"project_id\": \"11eab4a9-760d-c9f2-adc9-0242ac11000a\", \"topic\": \"hashicorp.platform.audit\"}, \"resource\": null, \"control_plane_event\": {\"request_info\": {\"http_verb\": \"POST\", \"http_path\": \"/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster/host-alive\", \"http_user_agent\": \"HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (bfea313)\", \"http_client_ip\": \"34.216.173.150\"}, \"authentication_info\": {\"principal\": null, \"service_principal_delegation_chain\": []}, \"authorization_info\": [], \"metadata\": {\"cluster_id\": \"vault-cluster\"}, \"operation_info\": {\"operation_id\": \"\"}, \"description\": \"Host Manager Alive Requested\", \"action\": \"CREATE\", \"status_code\": \"OK\"}, \"subject\": null}, {\"id\": \"490c67cd-67c2-4365-a3fe-55741bc09bf0\", \"timestamp\": \"2025-10-07T06:31:50.875751353Z\", \"stream\": {\"organization_id\": \"11eab4a9-75f1-e0a5-8be1-0242ac110016\", \"project_id\": \"11eab4a9-760d-c9f2-adc9-0242ac11000a\", \"topic\": \"hashicorp.platform.audit\"}, \"resource\": null, \"control_plane_event\": {\"request_info\": {\"http_verb\": \"POST\", \"http_path\": \"/vault/2020-11-25/.data-plane/organizations/11eab4a9-75f1-e0a5-8be1-0242ac110016/projects/11eab4a9-760d-c9f2-adc9-0242ac11000a/clusters/vault-cluster-4/host-alive\", \"http_user_agent\": \"HashiCorp Cloud Platform Vault Host-Manager/0.1.0 (bfea313)\", \"http_client_ip\": \"54.200.13.172\"}, \"authentication_info\": {\"principal\": null, \"service_principal_delegation_chain\": []}, \"authorization_info\": [], \"metadata\": {\"cluster_id\": \"vault-cluster-4\"}, \"operation_info\": {\"operation_id\": \"\"}, \"description\": \"Host Manager Alive Requested\", \"action\": \"CREATE\", \"status_code\": \"OK\"}, \"subject\": null}]}, \"next_page_token\": \"eyJ0aW1lc3RhbXAiOiIyMDI1LTEwLTA3VDA2OjMxOjUwLjg3NTc1MTM1M1oiLCJpZCI6IjQ5MGM2N2NkLTY3YzItNDM2NS1hM2ZlLTU1NzQxYmMwOWJmMCIsIm9mZnNldCI6MX0=\"}"}], "isError": false}, "id": 3}
2025-10-14 14:20:49,087 - mcp_server - INFO - Client call: {"method": "tools/call", "params": {"name": "search_logs", "arguments": {"end_time": "now", "start_time": "16 days ago", "organization_id": "11eab4a9-75f1-e0a5-8be1-0242ac110016", "topic": "hashicorp.platform.audit"}}, "jsonrpc": "2.0", "id": 4}
